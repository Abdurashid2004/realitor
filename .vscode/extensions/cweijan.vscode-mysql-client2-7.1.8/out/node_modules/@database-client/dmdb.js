var E=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var J=E(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});var Mn=require("iconv-lite"),Za=function(){function i(){}return i.l=function(t,e,r){var n=Buffer.alloc(1);return n.writeInt8(r,0),t.set(n,e),1},i.Yn=function(t,e,r){var n=Buffer.alloc(1);return n.writeUInt8(r,0),t.set(n,e),1},i.y=function(t,e,r){var n=Buffer.alloc(2);return n.writeInt16LE(r,0),t.set(n,e),2},i.w=function(t,e,r){var n=Buffer.alloc(2);return n.writeUInt16LE(r,0),t.set(n,e),2},i.v=function(t,e,r){var n=Buffer.alloc(4);return n.writeInt32LE(r,0),t.set(n,e),4},i.Zn=function(t,e,r){var n=Buffer.alloc(4);return n.writeUInt32LE(r,0),t.set(n,e),4},i.U=function(t,e,r){var n=Buffer.alloc(8);return this.Br(n,r,0),t.set(n,e),8},i.$n=function(t,e,r){var n=Buffer.alloc(8);return this.Ir(n,r,0),t.set(n,e),8},i.Mr=function(t,e,r){var n=Buffer.alloc(4);return n.writeFloatLE(r,0),t.set(n,e),4},i.Er=function(t,e,r){var n=Buffer.alloc(8);return n.writeDoubleLE(r,0),t.set(n,e),8},i.L=function(t,e,r,n,o){return n!==void 0&&o!==void 0?(t.set(r.subarray(n,n+o),e),o):(t.set(r,e),r.length)},i.ti=function(t,e,r,n,o){return n!==void 0&&o!=null?(e+=this.w(t,e,o),4+this.L(t,e,r,n,o)):(e+=this.w(t,e,r.length),4+this.L(t,e,r))},i.ii=function(t,e,r,n,o){return n!==void 0&&o!=null?(e+=this.Zn(t,e,o),2+this.L(t,e,r,n,o)):(e+=this.Zn(t,e,r.length),2+this.L(t,e,r))},i.ui=function(t,e,r,n){var o=this.b(r,n);return e+=this.v(t,e,o.length),4+this.L(t,e,o)},i.ei=function(t,e,r,n){var o=this.b(r,n);return e+=this.w(t,e,o.length),2+this.L(t,e,o)},i.e=function(t,e){return t.readInt8(e)},i.M=function(t,e){return t.readUInt8(e)},i.r=function(t,e){return t.readInt16LE(e)},i.oi=function(t,e){return t.readUInt16LE(e)},i.t=function(t,e){return t.readInt32LE(e)},i.hi=function(t,e){return t.readUInt32LE(e)},i.n=function(t,e){return this.Nr(t,e)},i.ci=function(t,e){return this.Rr(t,e)},i.u=function(t,e){return t.readFloatLE(e)},i.i=function(t,e){return t.readDoubleLE(e)},i.li=function(t,e){var r=this.hi(t,e);return t.subarray(e+4,e+4+r)},i.bi=function(t,e){var r=this.oi(t,e);return t.subarray(e+2,e+2+r)},i.p=function(t,e,r){return t.subarray(e,e+r)},i.c=function(t,e,r,n){return Mn.decode(t.subarray(e,e+r),n)},i.Ui=function(t,e,r){var n=this.t(t,e);return e+=4,this.c(t,e,n,r)},i.mi=function(t,e,r){var n=this.oi(t,e);return e+=2,this.c(t,e,n,r)},i.a=function(t){var e=Buffer.alloc(1);return e.writeInt8(t,0),e},i.En=function(t){var e=Buffer.alloc(1);return e.writeUInt8(t,0),e},i._=function(t){var e=Buffer.alloc(2);return e.writeInt16LE(t,0),e},i.Mn=function(t){var e=Buffer.alloc(2);return e.writeUInt16LE(t,0),e},i.s=function(t){var e=Buffer.alloc(4);return e.writeInt32LE(t,0),e},i.An=function(t){var e=Buffer.alloc(4);return e.writeUInt32LE(t,0),e},i.o=function(t){var e=Buffer.alloc(8);return this.Br(e,t,0),e},i.Hn=function(t){var e=Buffer.alloc(8);return this.Ir(e,t,0),e},i.f=function(t){var e=Buffer.alloc(4);return e.writeFloatLE(t,0),e},i.d=function(t){var e=Buffer.alloc(8);return e.writeDoubleLE(t,0),e},i.b=function(t,e){return Mn.encode(t,e)},i.fn=function(t){return this.e(t,0)},i.on=function(t){return this.M(t,0)},i.cn=function(t){return this.r(t,0)},i.ln=function(t){return this.oi(t,0)},i._n=function(t){return this.t(t,0)},i.an=function(t){return this.hi(t,0)},i.vn=function(t){return this.n(t,0)},i.gn=function(t){return this.ci(t,0)},i.wn=function(t){return this.u(t,0)},i.Bn=function(t){return this.i(t,0)},i.G=function(t,e){return Mn.decode(t,e)},i.Ar=function(t,e){var r=t[e],n=t[e+7];if(r===void 0||n===void 0)throw new Error("RangeError: Attempt to access memory outside buffer bounds");return{first:r,last:n}},i.Tr=function(t,e,r,n,o,a){if(t<e||r<t)throw new Error("RangeError: The value is out of range. It must be >= "+e+" and <= "+r+". Received "+t);this.Ar(n,o)},i.zr=function(t,e,r,n,o){this.Tr(e,n,o,t,r,7);var a=Number(e&BigInt(4294967295));t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a;var c=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=c,c>>=8,t[r++]=c,c>>=8,t[r++]=c,c>>=8,t[r++]=c,r},i.Cr=function(t,e,r,n,o){this.Tr(e,n,o,t,r,7);var a=Number(e&BigInt(4294967295));t[r+7]=a,a>>=8,t[r+6]=a,a>>=8,t[r+5]=a,a>>=8,t[r+4]=a;var c=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=c,c>>=8,t[r+2]=c,c>>=8,t[r+1]=c,c>>=8,t[r]=c,r+8},i.Dr=function(t,e){var r=this.Ar(t,e),n=r.first,o=r.last,a=(n<<24)+t[++e]*Math.pow(2,16)+t[++e]*Math.pow(2,8)+t[++e];return(BigInt(a)<<BigInt(32))+BigInt(t[++e]*Math.pow(2,24)+t[++e]*Math.pow(2,16)+t[++e]*Math.pow(2,8)+o)},i.Fr=function(t,e,r){return this.Cr(t,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},i.Nr=function(t,e){var r=this.Ar(t,e),n=r.first,o=r.last,a=t[e+4]+t[e+5]*Math.pow(2,8)+t[e+6]*Math.pow(2,16)+(o<<24);return(BigInt(a)<<BigInt(32))+BigInt(n+t[++e]*Math.pow(2,8)+t[++e]*Math.pow(2,16)+t[++e]*Math.pow(2,24))},i.Br=function(t,e,r){return this.zr(t,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},i.Gr=function(t,e){var r=this.Ar(t,e),n=r.first,o=r.last,a=n*Math.pow(2,24)+t[++e]*Math.pow(2,16)+t[++e]*Math.pow(2,8)+t[++e],c=t[++e]*Math.pow(2,24)+t[++e]*Math.pow(2,16)+t[++e]*Math.pow(2,8)+o;return(BigInt(a)<<BigInt(32))+BigInt(c)},i.Hr=function(t,e,r){return this.Cr(t,e,r,BigInt(0),BigInt("0xffffffffffffffff"))},i.Rr=function(t,e){var r=this.Ar(t,e),n=r.first,o=r.last,a=n+t[++e]*Math.pow(2,8)+t[++e]*Math.pow(2,16)+t[++e]*Math.pow(2,24),c=t[++e]+t[++e]*Math.pow(2,8)+t[++e]*Math.pow(2,16)+o*Math.pow(2,24);return BigInt(a)+(BigInt(c)<<BigInt(32))},i.Ir=function(t,e,r){return this.zr(t,e,r,BigInt(0),BigInt("0xffffffffffffffff"))},i}();Pn.BufferUtil=Za});var Io=E(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0}),Un.Messages_zh_CN=new Map([["warning.bpWithErr","\u8B66\u544A:\u6279\u91CF\u6267\u884C\u90E8\u5206\u884C\u4EA7\u751F\u9519\u8BEF"],["error.communicationError","\u7F51\u7EDC\u901A\u4FE1\u5F02\u5E38"],["error.msgCheckError","\u6D88\u606F\u6821\u9A8C\u5F02\u5E38"],["error.sqlIsNullOrEmpty","SQL\u8BED\u53E5\u4E3A\u7A7A\u503C"],["error.invalidTimeIntervalValue","\u9519\u8BEF\u7684\u65F6\u95F4\u95F4\u9694\u7C7B\u578B\u6570\u636E"],["error.unsupportedType","\u4E0D\u652F\u6301\u8BE5\u6570\u636E\u7C7B\u578B"],["error.dataConvertionError","\u7C7B\u578B\u8F6C\u6362\u5F02\u5E38"],["error.invalidSqlType","\u975E\u6CD5\u7684SQL\u8BED\u53E5\u7C7B\u578B"],["error.invalidDateTimeTypeFormat","\u9519\u8BEF\u7684\u65E5\u671F\u65F6\u95F4\u7C7B\u578B\u683C\u5F0F"],["error.invalidColumnType","\u65E0\u6548\u7684\u5217\u7C7B\u578B"],["error.resultsetInReadOnlyStatus","\u7ED3\u679C\u96C6\u5904\u4E8E\u53EA\u8BFB\u72B6\u6001"],["error.resultsetClosed","\u7ED3\u679C\u96C6\u5DF2\u7ECF\u5173\u95ED"],["error.commitInAutoCommitMode","\u81EA\u52A8\u63D0\u4EA4\u6A21\u5F0F\u4E0B\u4E0D\u80FD\u8C03\u7528commit()\u65B9\u6CD5"],["error.rollbackInAutoCommitMode","\u81EA\u52A8\u63D0\u4EA4\u6A21\u5F0F\u4E0B\u4E0D\u80FD\u8C03\u7528rollback()\u65B9\u6CD5"],["error.invalidLenOrOffset","\u957F\u5EA6\u6216\u504F\u79FB\u9519\u8BEF"],["error.connectionClosed","\u8FDE\u63A5\u5DF2\u7ECF\u5173\u95ED"],["error.intervalValueOverflow","\u65F6\u95F4\u95F4\u9694\u7C7B\u578B\u6570\u636E\u6EA2\u51FA"],["error.invalidBFile","\u65E0\u6548\u7684BFile\u683C\u5F0F\u4E32"],["error.invalidHex","\u65E0\u6548\u7684\u5341\u516D\u8FDB\u5236\u6570\u5B57"],["error.invalidCipher","\u4E0D\u652F\u6301\u7684\u52A0\u5BC6\u7C7B\u578B"],["error.cipher.encrypt.fail","\u6D88\u606F\u52A0\u5BC6\u5931\u8D25"],["error.cipher.decrypt.fail","\u6D88\u606F\u89E3\u5BC6\u5931\u8D25"],["error.osAuthUserConflict","\u540C\u65F6\u4F7F\u7528\u4E86\u6307\u5B9A\u7528\u6237\u767B\u5F55\u548COS\u8BA4\u8BC1\u767B\u5F55, \u8BF7\u786E\u5B9A\u4E00\u79CD\u65B9\u5F0F"],["error.version.server","\u670D\u52A1\u5668\u7248\u672C\u592A\u4F4E"],["error.usernameTooLong","\u7528\u6237\u540D\u8D85\u957F"],["error.passwordTooLong","\u5BC6\u7801\u8D85\u957F"],["error.invalidObjBlob","\u65E0\u6548\u7684\u5BF9\u8C61BLOB\u6570\u636E"],["error.invalidServerMode","\u670D\u52A1\u5668\u6A21\u5F0F\u4E0D\u5339\u914D"],["error.dataTooLong","\u6570\u636E\u5927\u5C0F\u5DF2\u8D85\u8FC7\u53EF\u652F\u6301\u8303\u56F4"],["error.batchError","\u6279\u91CF\u6267\u884C\u51FA\u9519"],["error.msgTooLong","\u6D88\u606F\u957F\u5EA6\u8D85\u51FA\u9650\u5236512M"],["error.invalidDateTimeValue","\u65E0\u6548\u7684\u65E5\u671F\u65F6\u95F4\u7C7B\u578B\u503C"],["error.invalidParam","\u65E0\u6548\u7684\u53C2\u6570"],["error.poolClosed","\u8FDE\u63A5\u6C60\u5DF2\u7ECF\u5173\u95ED"],["error.poolAliasConflict","\u8FDE\u63A5\u6C60\u522B\u540D\u5DF2\u5B58\u5728"],["error.invalidUrlOrAliasOrAttr","\u65E0\u6548\u7684\u8FDE\u63A5\u4E32\u6216\u8FDE\u63A5\u6C60\u522B\u540D\u6216\u8FDE\u63A5\u5C5E\u6027"],["error.connectTimeout","\u8FDE\u63A5\u8D85\u65F6"],["error.LobDataHasFreed","LOB\u6570\u636E\u5DF2\u7ECF\u88AB\u91CA\u653E"],["error.fatalError","\u81F4\u547D\u9519\u8BEF"],["error.SSLInitFailed","\u521D\u59CB\u5316SSL\u73AF\u5883\u5931\u8D25"],["error.invalidPoolNum","poolMin\u548CpoolMax\u914D\u7F6E\u9519\u8BEF"],["error.socketTimeout","\u7F51\u7EDC\u901A\u8BAF\u8D85\u65F6"],["error.invalidOutFormat","\u65E0\u6548\u7684\u6267\u884C\u9009\u9879outFormat"],["error.noMoreConnection","\u8FDE\u63A5\u6C60\u5DF2\u8FBE\u5230\u6700\u5927\u8FDE\u63A5\u6570\uFF0C\u65E0\u6CD5\u521B\u5EFA\u66F4\u591A\u8FDE\u63A5"],["error.poolDraining","\u8FDE\u63A5\u6C60\u6B63\u5728\u5173\u95ED"],["error.switchedSused","\u8FDE\u63A5\u5DF2\u91CD\u7F6E, \u91CD\u7F6E\u539F\u56E0\uFF1A"],["error.switchedFailed","\u8FDE\u63A5\u91CD\u7F6E\u5931\u8D25, \u91CD\u7F6E\u539F\u56E0\uFF1A"],["error.invalidSql","\u65E0\u6548\u7684sql\u8BED\u53E5"],["error.overflow","\u6570\u5B57\u6EA2\u51FA"],["error.datetimeOverflow","\u65E5\u671F\u65F6\u95F4\u6570\u5B57\u6EA2\u51FA"]])});var Ao=E(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.Messages_en_US=new Map([["warning.bpWithErr","Warning:Partial failure on execute with batch"],["error.communicationError","Communication Error"],["error.msgCheckError","Message check error"],["error.sqlIsNullOrEmpty","Sql is null of empty"],["error.invalidTimeIntervalValue","Invalid time interval type value"],["error.unsupportedType","Not support this type"],["error.dataConvertionError","Data convertion error"],["error.invalidSqlType","Invalid sql type"],["error.invalidDateTimeTypeFormat","Invalid datetime type format"],["error.invalidColumnType","Invalid column type"],["error.resultsetInReadOnlyStatus","Resultset in readonly status"],["error.resultsetClosed","Resultset is closed"],["error.commitInAutoCommitMode","Can't call commit() in Auto commit status"],["error.rollbackInAutoCommitMode","Can't call rollback() in Auto commit status"],["error.invalidLenOrOffset","Invalid length or offset"],["error.connectionClosed","Connection is closed"],["error.intervalValueOverflow","interval type value overflow"],["error.invalidBFile","Invalid BFile format string"],["error.invalidHex","Invalid hex number"],["error.invalidCipher","Invalid cipher type"],["error.cipher.encrypt.fail","Fail to encrypt message"],["error.cipher.decrypt.fail","Fail to decrypt message"],["error.osAuthUserConflict","At the same time using the specifed user login and OS authentication login, please determine a way."],["error.version.server","Server version is too low"],["error.usernameTooLong","Username is too long."],["error.passwordTooLong","Password to login is too long."],["error.invalidObjBlob","invalid Object Blob Data."],["error.invalidServerMode","Server Mode invalid."],["error.dataTooLong","The data is too large to support"],["error.batchError","Error in executing with batch"],["error.msgTooLong","Message too long, limit 512M"],["error.invalidDateTimeValue","Invalid datetime value"],["error.invalidParam","invalid parameter(s)"],["error.poolClosed","Pool is closed"],["error.poolAliasConflict","Pool alias has already existed"],["error.invalidUrlOrAliasOrAttr","Invalid URL or pool alias or connection attributes"],["error.connectTimeout","connect timeout"],["error.LobDataHasFreed","Lob Data has been freed"],["error.fatalError","Fatal error"],["error.SSLInitFailed","Failed to initialize SSL"],["error.invalidPoolNum","Invalid poolMin or poolMax of pool"],["error.socketTimeout","Socket timeout"],["error.invalidOutFormat","Invalid outFormat"],["error.noMoreConnection","Pool cannot open more connections"],["error.poolDraining","Pool is closing"],["error.switchedSused","Connection has been switched"],["error.switchedFailed","Connection switched failed"],["error.invalidSql","Invalid sql"],["error.overflow","Digital overflow"],["error.datetimeOverflow","Digital of datetime overflow"]])});var Oo=E(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});var Qa=Io(),Ja=Ao(),ja=function(){function i(){}return i.get=function(t,e){switch(e){case 0:return Qa.Messages_zh_CN.get(t)||t;case 1:return Ja.Messages_en_US.get(t)||t;default:return t}},i}();xn.I18n=ja});var Bt=E(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});var Wa=function(){function i(){}return i.equalsIgnoreCase=function(t,e){return t&&e?t.toLowerCase()===e.toLowerCase():t===e},i.isDigit=function(t){return/(^[0-9]+$)/.test(t)},i.isUnicodeLetter=function(t){return/^\p{L}/u.test(t)},i.isLetterOrDigit=function(t){return i.isDigit(t)||i.isUnicodeLetter(t)},i.hexStringToBuffer=function(t){var e=Buffer.alloc(0),r=!1;if((t=t.trim()).indexOf("0x")!==0&&t.indexOf("0X")!==0||(t=t.substring(2,t.length)),t.length===0)return e;t.length%2!=0&&t.padStart(t.length+1,"0"),e=Buffer.alloc(t.length/2);for(var n=0,o=0;o<t.length;o+=2){var a=this.convertHex(t.charCodeAt(o)),c=this.convertHex(t.charCodeAt(o+1));if(a===-1||c===-1){r=!0;break}e[n++]=16*a+c}return r&&(e=Buffer.from(t)),e},i.isHighSurrogate=function(t){return 55296<=t&&t<=56319},i.charCount=function(t){return 65536<=t?2:1},i.processDoubleQuoteOfName=function(t){return i.processQuoteOfName(t,'"')},i.processSingleQuoteOfName=function(t){return i.processQuoteOfName(t,"'")},i.processQuoteOfName=function(t,e){if(!e||!t)return t;for(var r,n=t,o="",a=e.length;(r=n.indexOf(e))!==-1;)o+=n.substring(0,r+a)+e,n=n.substring(r+a);return o+=n},i.convertHex=function(t){return t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)?t-"0".charCodeAt(0):t>="a".charCodeAt(0)&&t<="f".charCodeAt(0)?t-"a".charCodeAt(0)+10:t>="A".charCodeAt(0)&&t<="F".charCodeAt(0)?t-"A".charCodeAt(0)+10:-1},i}();kn.StringUtil=Wa});var qn=E(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});var Xa=Bt(),Ka=function(){function i(){}return i.toBoolean=function(t){return(t=t.trim())!=="0"&&(t==="1"||Xa.StringUtil.equalsIgnoreCase(t,"true"))},i}();Yn.ConvertUtil=Ka});var ln=E(me=>{"use strict";var Vn=me&&me.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Hn=me&&me.__read||function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r,n,o=e.call(i),a=[];try{for(;(t===void 0||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(c){n={error:c}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(n)throw n.error}}return a};Object.defineProperty(me,"__esModule",{value:!0});var $a=qn(),tc=function(){function i(t){this.innerProps=new Map,t!==void 0&&this.setProps(t.innerProps)}return i.prototype.setProps=function(t){var e,r;if(t!==void 0)try{for(var n=Vn(t),o=n.next();!o.done;o=n.next()){var a=Hn(o.value,2),c=a[0],u=a[1];this.innerProps.set(c,u)}}catch(h){e={error:h}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},i.prototype.setDiffProps=function(t){var e,r,n,o;if(t!==void 0){if(t instanceof i)try{for(var a=Vn(t.innerProps),c=a.next();!c.done;c=a.next()){var u=Hn(c.value,2),h=u[0],s=u[1];this.innerProps.has(h)||this.innerProps.set(h,s)}}catch(y){e={error:y}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}else if(t instanceof Map)try{for(var l=Vn(t),_=l.next();!_.done;_=l.next()){var f=Hn(_.value,2),h=f[0],s=f[1];this.innerProps.has(h)||this.innerProps.set(h,s)}}catch(y){n={error:y}}finally{try{_&&!_.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}}},i.prototype.setAny=function(t,e){this.innerProps.set(t.toLowerCase(),e)},i.prototype.set=function(t,e){this.innerProps.set(t.toLowerCase(),e)},i.prototype.setIfNotExist=function(t,e){this.innerProps.has(t.toLowerCase())||this.set(t,e)},i.prototype.getAny=function(t){return this.innerProps.get(t.toLowerCase())},i.prototype.getBoolean=function(t,e){var r=this.innerProps.get(t.toLowerCase());return r!==void 0?$a.ConvertUtil.toBoolean(r.toString()):e},i.prototype.getNumber=function(t,e,r,n){var o=this.innerProps.get(t.toLowerCase());if(!o)return e;var a=Number.parseInt(o);return isNaN(a)||r!==void 0&&a<r||n!==void 0&&n<a?e:a},i.prototype.getTrimString=function(t,e){var r=this.innerProps.get(t.toLowerCase());return r?r.trim():e},i.prototype.getStringArray=function(t,e){var r=this.getTrimString(t,"");if(r){var n=r.split(",");if(0<n.length)return n}return e},i.prototype.size=function(){return this.innerProps.size},i}();me.Properties=tc});var D=E(Gn=>{"use strict";Object.defineProperty(Gn,"__esModule",{value:!0});var ec=function(){function i(){}return i.INT8_MAX=127,i.INT8_MIN=-128,i.INT16_MAX=32767,i.INT16_MIN=-32768,i.INT32_MAX=2147483647,i.INT32_MIN=-2147483648,i.INT64_MAX=BigInt("9223372036854775807"),i.INT64_MIN=BigInt("-9223372036854775808"),i.REAL_MAX=34e37,i.REAL_MIN=-34e37,i.HOST_NAME="",i.MAX_NAME_LEN=128,i.MAX_PATH_LEN=256,i.MAX_DEC_LEN=38,i.MAX_PARAM_DATA_LEN=65535,i.LANGUAGE_CN=0,i.LANGUAGE_EN=1,i.DEFAULT_ROW_PREFETCH=10,i.MIN_BUF_PREFETCH=32,i.MAX_BUF_PREFETCH=65536,i.PORT_DEFAULT=5236,i.SESS3_CLT_JDBC=2,i.SESS3_CLT_NODE=6,i.BYTE_SIZE=1,i.USINT_SIZE=2,i.ULINT_SIZE=4,i.DDWORD_SIZE=8,i.LINT64_SIZE=8,i.ULINT_UNDEFINED=-1,i.EXECUTE_TYPE_ANY=0,i.EXECUTE_TYPE_QUERY=1,i.EXECUTE_TYPE_UPDATE=2,i.EXECUTE_TYPE_CALL=3,i.EXECUTE_TYPE_SET_DB=4,i.DATA_LOB_CTL_LEN=(i.USINT_MAX=65534)-3,i.DATA_NULL_LEN=i.USINT_MAX,i.DATA_FULL_LEN=65535,i.REC4_DELETE_MASK=128,i.REC4_ROWID_MASK=96,i.REC4_SQL_NULL=i.DATA_NULL_LEN,i.REC4_SQL_FULL=i.DATA_FULL_LEN,i.REC4_FLD_FULL=0,i.REC4_FLD_NULL=3,i.REC4_1BYTE_LEN_MASK=128,i.RS_ROW=0,i.RS_BDTA=2,i.ENCODING_UTF8="UTF-8",i.ENCODING_EUCKR="EUC-KR",i.ENCODING_GB18030="GB18030",i.TRX_STATUS_NOT_START=0,i.TRX_STATUS_COMMITTED=32,i.TRX_STATUS_ROLLBACKED=64,i.TRX_STATUS_STATE_MASK=4095,i.ISO_LEVEL_READ_UNCOMMITTED=0,i.ISO_LEVEL_READ_COMMITTED=1,i.ISO_LEVEL_REPEATABLE_READ=2,i.ISO_LEVEL_SERIALIZABLE=3,i.CLI_READ_UNCOMMITTED=1,i.CLI_READ_COMMITTED=2,i.CLI_REPEATABLE_READ=4,i.CLI_SERIALIZABLE=8,i.TRX_ACCESS_MODE_READ_WRITE=0,i.TRX_ACCESS_MODE_READ_ONLY=1,i.DO_SWITCH_OFF=0,i.DO_SWITCH_WHEN_CONN_ERROR=1,i.DO_SWITCH_WHEN_EP_RECOVER=2,i.CLUSTER_TYPE_NORMAL=0,i.CLUSTER_TYPE_RW=1,i.CLUSTER_TYPE_DW=2,i.CLUSTER_TYPE_DSC=3,i.CLUSTER_TYPE_MPP=4,i.EP_STATUS_OK=1,i.EP_STATUS_ERROR=2,i.LOGIN_MODE_PRIMARY_FIRST=0,i.LOGIN_MODE_PRIMARY_ONLY=1,i.LOGIN_MODE_STANDBY_ONLY=2,i.LOGIN_MODE_STANDBY_FIRST=3,i.LOGIN_MODE_NORMAL_FIRST=4,i.SERVER_MODE_NORMAL=0,i.SERVER_MODE_PRIMARY=1,i.SERVER_MODE_STANDBY=2,i.SERVER_STATUS_MOUNT=3,i.SERVER_STATUS_OPEN=4,i.SERVER_STATUS_SUSPEND=5,i.OSAUTH_OFF=0,i.OSAUTH_DBA=1,i.OSAUTH_SSO=2,i.OSAUTH_AUDITOR=3,i.OSAUTH_AUTOMATCH=4,i.OSAUTH_DEFAULT=i.OSAUTH_OFF,i.MSG_COMPRESS_THRESHOLD=8192,i.MSG_COMPRESS_SIMPLE=1,i.MSG_COMPRESS_AUTO=2,i.MSG_COMPRESS_NO=0,i.MSG_CPR_FUN_ID_ZIP=0,i.MSG_CPR_FUN_ID_SNAPPY=1,i.MSG_CPR_FUN_ID_NONE=-1,i.IGNORE_TARGET_LENGTH=-1,i.IGNORE_TARGET_SCALE=-1,i.IGNORE_TARGET_TYPE=i.INT32_MIN,i.COMPATIBLE_MODE_ORACLE=1,i.COMPATIBLE_MODE_MYSQL=2,i.COLUMN_NAME_NATURAL_CASE=0,i.COLUMN_NAME_UPPER_CASE=1,i.COLUMN_NAME_LOWER_CASE=2,i.LOG_OFF=0,i.LOG_ERROR=1,i.LOG_WARN=2,i.LOG_SQL=3,i.LOG_INFO=4,i.LOG_DEBUG=5,i.LOG_ALL=9,i.PUT_LOB_LEN=2048,i.BIND_DATA_OFF_ROW=-1,i.BIND_DATA_READ_OVER=0,i.MAX_BLOB_LEN_PER_MSG=16e3,i.MAX_BLOB_GET_LEN_PER_MSG=32e3,i.SQL_TYPE_DDL_CDB=(i.SQL_TYPE_BASE=127)+1,i.SQL_TYPE_DDL_CTAB=i.SQL_TYPE_BASE+2,i.SQL_TYPE_DDL_DTAB=i.SQL_TYPE_BASE+3,i.SQL_TYPE_DDL_CVIEW=i.SQL_TYPE_BASE+4,i.SQL_TYPE_DDL_DVIEW=i.SQL_TYPE_BASE+5,i.SQL_TYPE_DDL_CIND=i.SQL_TYPE_BASE+6,i.SQL_TYPE_DDL_DIND=i.SQL_TYPE_BASE+7,i.SQL_TYPE_DDL_CUSR=i.SQL_TYPE_BASE+8,i.SQL_TYPE_DDL_DUSR=i.SQL_TYPE_BASE+9,i.SQL_TYPE_DDL_CROL=i.SQL_TYPE_BASE+10,i.SQL_TYPE_DDL_DROL=i.SQL_TYPE_BASE+11,i.SQL_TYPE_DDL_DROP=i.SQL_TYPE_BASE+12,i.SQL_TYPE_DDL_ALTDB=i.SQL_TYPE_BASE+13,i.SQL_TYPE_DDL_ALTUSR=i.SQL_TYPE_BASE+14,i.SQL_TYPE_DDL_CFUNC=i.SQL_TYPE_BASE+15,i.SQL_TYPE_DDL_CPROC=i.SQL_TYPE_BASE+16,i.SQL_TYPE_DDL_GRANT=i.SQL_TYPE_BASE+17,i.SQL_TYPE_DDL_REVOKE=i.SQL_TYPE_BASE+18,i.SQL_TYPE_DDL_ALTTAB=i.SQL_TYPE_BASE+19,i.SQL_TYPE_COMMIT=i.SQL_TYPE_BASE+20,i.SQL_TYPE_ROLLBACK=i.SQL_TYPE_BASE+21,i.SQL_TYPE_EXPLAIN=i.SQL_TYPE_BASE+22,i.SQL_TYPE_SET_TRAN=i.SQL_TYPE_BASE+23,i.SQL_TYPE_SAVEPNT=i.SQL_TYPE_BASE+24,i.SQL_TYPE_SET_CURDB=i.SQL_TYPE_BASE+25,i.SQL_TYPE_SET_CURSCH=i.SQL_TYPE_BASE+26,i.SQL_TYPE_LOCK_TAB=i.SQL_TYPE_BASE+27,i.SQL_TYPE_DDL_AUDIT=i.SQL_TYPE_BASE+28,i.SQL_TYPE_DML_INSERT=i.SQL_TYPE_BASE+30,i.SQL_TYPE_DML_DELETE=i.SQL_TYPE_BASE+31,i.SQL_TYPE_DML_UPDATE=i.SQL_TYPE_BASE+32,i.SQL_TYPE_DML_SELECT=i.SQL_TYPE_BASE+33,i.SQL_TYPE_DML_SELECT_INTO=i.SQL_TYPE_BASE+34,i.SQL_TYPE_DML_CALL=i.SQL_TYPE_BASE+35,i.SQL_TYPE_LOGIN=i.SQL_TYPE_BASE+36,i.SQL_TYPE_SET_TIME_ZONE=i.SQL_TYPE_BASE+38,i.SQL_TYPE_SET_SESS_TRAN=i.SQL_TYPE_BASE+39,i.SQL_TYPE_FETCH_NOT_OVER=i.SQL_TYPE_BASE+40,i.SQL_TYPE_EXEC_PROC=i.SQL_TYPE_BASE+51,i.SQL_TYPE_SIMPLE=i.SQL_TYPE_BASE+60,i.SQL_TYPE_DDL_CSCHEMA=i.SQL_TYPE_BASE+61,i.SQL_TYPE_PLAN_ERRCODE=i.SQL_TYPE_BASE+62,i.SQL_TYPE_DDL_ALTTRIG=i.SQL_TYPE_BASE+63,i.SQL_TYPE_DDL_DROP_TABLE=i.SQL_TYPE_BASE+64,i.SQL_TYPE_DDL_DROP_INDEX=i.SQL_TYPE_BASE+65,i.SQL_TYPE_DDL_DROP_VIEW=i.SQL_TYPE_BASE+66,i.SQL_TYPE_DML_TRCT=i.SQL_TYPE_BASE+67,i.SQL_TYPE_SET_IDENTINS=i.SQL_TYPE_BASE+68,i.SQL_TYPE_DDL_CSEQ=i.SQL_TYPE_BASE+69,i.SQL_TYPE_DML_CURSOR_DECLARE=i.SQL_TYPE_BASE+70,i.SQL_TYPE_DML_CURSOR_OPEN=i.SQL_TYPE_BASE+71,i.SQL_TYPE_DML_CURSOR_CLOSE=i.SQL_TYPE_BASE+72,i.SQL_TYPE_DML_CURSOR_UPDATE=i.SQL_TYPE_BASE+73,i.SQL_TYPE_DML_CURSOR_DELETE=i.SQL_TYPE_BASE+74,i.SQL_TYPE_DML_CURSOR_FETCH=i.SQL_TYPE_BASE+75,i.SQL_TYPE_DML_CURSOR_SEEK=i.SQL_TYPE_BASE+76,i.SQL_TYPE_DDL_CLGN=i.SQL_TYPE_BASE+77,i.SQL_TYPE_DDL_ALTLGN=i.SQL_TYPE_BASE+78,i.SQL_TYPE_DDL_CCONIND=i.SQL_TYPE_BASE+79,i.SQL_TYPE_DDL_DCONIND=i.SQL_TYPE_BASE+80,i.SQL_TYPE_DDL_ALTCONIND=i.SQL_TYPE_BASE+81,i.SQL_TYPE_STARTUP=i.SQL_TYPE_BASE+101,i.SQL_TYPE_DDL_ALTSESS_DATEFMT=i.SQL_TYPE_BASE+124,i.SQL_TYPE_DDL_ALTSESS_TIMEFMT=i.SQL_TYPE_BASE+125,i.SQL_TYPE_DDL_ALTSESS_DTFMT=i.SQL_TYPE_BASE+126,i.SQL_TYPE_DDL_ALTSESS_DTTZFMT=i.SQL_TYPE_BASE+127,i.SQL_TYPE_DDL_ALTSESS_TIMETZFMT=i.SQL_TYPE_BASE+128,i.SQL_TYPE_DDL_ALTSESS_DATE_LANGUAGE=i.SQL_TYPE_BASE+129,i}();Gn.Const=ec});var Jn=E(zt=>{"use strict";var Zn=zt&&zt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Qn=zt&&zt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}},rc=zt&&zt.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(zt,"__esModule",{value:!0});var nc=require("os"),Sr=R(),Lt=D(),ic=function(){function i(t,e){this.name=t,this.epList=e,this.epStartPos=e&&e.length!==0?Math.floor(Math.random()*e.length)-1:-1}return i.prototype.connect=function(t){return Zn(this,void 0,void 0,function(){var e,r,n,o,a;return Qn(this,function(c){switch(c.label){case 0:e=this.getEPSelector(t),n=this.epList.length===1?1:t.conn_prop_switchTimes+1,o=0,c.label=1;case 1:if(!(o<n))return[3,7];c.label=2;case 2:return c.trys.push([2,4,,6]),[4,this.traverseServerList(t,e,o===0,o===n-1)];case 3:return c.sent(),[2,t];case 4:return a=c.sent(),r=a,[4,new Promise(function(u,h){setTimeout(function(){u()},t.conn_prop_switchInterval)})];case 5:return c.sent(),[3,6];case 6:return o++,[3,1];case 7:throw r}})})},i.prototype.traverseServerList=function(t,e,r,n){return Zn(this,void 0,void 0,function(){var o,a,c,u,h,s,l,_,f,y;return Qn(this,function(T){switch(T.label){case 0:o=e.sortDBList(r),a="",c=null,T.label=1;case 1:T.trys.push([1,11,12,13]),u=rc(o),h=u.next(),T.label=2;case 2:if(h.done)return[3,10];s=h.value,T.label=3;case 3:return T.trys.push([3,8,,9]),[4,s.connect(t)];case 4:return T.sent(),[4,e.checkServerMode(t,n)];case 5:return T.sent()?[3,7]:[4,t.free()];case 6:throw T.sent(),Sr.DBError.ECJS_INVALID_SERVER_MODE();case 7:return[2];case 8:return l=T.sent(),c=c||l,a+="["+s.toString()+"]"+l.message+nc.EOL,[3,9];case 9:return h=u.next(),[3,2];case 10:return[3,13];case 11:return _=T.sent(),f={error:_},[3,13];case 12:try{h&&!h.done&&(y=u.return)&&y.call(u)}finally{if(f)throw f.error}return[7];case 13:throw c||new Sr.DBError(Sr.DBError.ECJS_COMMUNICATION_ERROR().errCode,a)}})})},i.prototype.getEPSelector=function(t){if(t.conn_prop_epSelector===zn.TYPE_HEAD_FIRST)return new zn(this.epList.slice(0));var e=this.epList.length;this.epStartPos=(this.epStartPos+1)%e;for(var r=new Array(e),n=0;n<e;n++)r[n]=this.epList[(n+this.epStartPos)%e];return new zn(r)},i}();zt.EPGroup=ic;var zn=function(){function i(t){this.dbs=t}return i.prototype.sortDBList=function(t){return t||this.dbs.sort(function(e,r){return r.getSort(t)-e.getSort(t)}),this.dbs},i.prototype.checkServerMode=function(t,e){return Zn(this,void 0,void 0,function(){return Qn(this,function(r){switch(r.label){case 0:return!t.conn_prop_loginDscCtrl||t.dscControl?[3,2]:[4,t.free()];case 1:throw r.sent(),Sr.DBError.ECJS_INVALID_SERVER_MODE();case 2:return 0<t.conn_prop_loginStatus&&t.svrStat!=t.conn_prop_loginStatus?[4,t.free()]:[3,4];case 3:throw r.sent(),Sr.DBError.ECJS_INVALID_SERVER_MODE();case 4:if(e)switch(t.conn_prop_loginMode){case Lt.Const.LOGIN_MODE_PRIMARY_ONLY:return[2,t.svrMode===Lt.Const.SERVER_MODE_PRIMARY];case Lt.Const.LOGIN_MODE_STANDBY_ONLY:return[2,t.svrMode===Lt.Const.SERVER_MODE_STANDBY];default:return[2,!0]}switch(t.conn_prop_loginMode){case Lt.Const.LOGIN_MODE_NORMAL_FIRST:return[2,t.svrMode==Lt.Const.SERVER_MODE_NORMAL];case Lt.Const.LOGIN_MODE_PRIMARY_FIRST:case Lt.Const.LOGIN_MODE_PRIMARY_ONLY:return[2,t.svrMode==Lt.Const.SERVER_MODE_PRIMARY];case Lt.Const.LOGIN_MODE_STANDBY_FIRST:case Lt.Const.LOGIN_MODE_STANDBY_ONLY:return[2,t.svrMode==Lt.Const.SERVER_MODE_STANDBY]}return[2,!1]}})})},i.TYPE_WELL_DISTRIBUTE=0,i.TYPE_HEAD_FIRST=1,i}()});var gr=E(Se=>{"use strict";var oc=Se&&Se.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},sc=Se&&Se.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Se,"__esModule",{value:!0});var G=D(),ac=function(){function i(t,e){this.alive=!1,this.statusRefreshTs=0,this.serverMode=-1,this.serverStatus=-1,this.dscControl=!1,this.sort=i.SORT_UNKNOWN,this.host=t,this.port=e}return i.prototype.connect=function(t){return oc(this,void 0,void 0,function(){var e;return sc(this,function(r){switch(r.label){case 0:t.conn_prop_host=this.host,t.conn_prop_port=this.port,t.props.set("host",this.host),t.props.set("port",this.port.toString()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.do_openConnection()];case 2:return r.sent(),this.refreshStatus(t,!0),[3,4];case 3:throw e=r.sent(),this.refreshStatus(t,!1),e;case 4:return[2]}})})},i.prototype.getSort=function(t){return!t||Date.now()-this.statusRefreshTs<i.STATUS_VALID_TIME?this.sort:i.SORT_UNKNOWN},i.prototype.getServerModeDesc=function(t){switch(t){case G.Const.SERVER_MODE_NORMAL:return"NORMAL";case G.Const.SERVER_MODE_PRIMARY:return"PRIMARY";case G.Const.SERVER_MODE_STANDBY:return"STANDBY";default:return"UNKNOW"}},i.prototype.getServerStatusDesc=function(t){switch(t){case G.Const.SERVER_STATUS_OPEN:return"OPEN";case G.Const.SERVER_STATUS_MOUNT:return"MOUNT";case G.Const.SERVER_STATUS_SUSPEND:return"SUSPEND";default:return"UNKNOW"}},i.prototype.toString=function(){return this.host+":"+this.port+" ("+this.getServerModeDesc(this.serverMode)+", "+this.getServerStatusDesc(this.serverStatus)+(this.dscControl?", DSC CONTROL":"")+"))"},i.prototype.refreshStatus=function(t,e){this.alive=e,this.statusRefreshTs=Date.now(),this.serverMode=e?t.svrMode:-1,this.serverStatus=e?t.svrStat:-1,this.dscControl=!!e&&t.dscControl,this.sort=e?this.calcSort(t.conn_prop_loginMode):i.SORT_SERVER_NOT_ALIVE},i.prototype.calcSort=function(t){var e=0;switch(t){case G.Const.LOGIN_MODE_PRIMARY_FIRST:switch(this.serverMode){case G.Const.SERVER_MODE_NORMAL:e+=10*i.SORT_NORMAL;break;case G.Const.SERVER_MODE_PRIMARY:e+=100*i.SORT_PRIMARY;break;case G.Const.SERVER_MODE_STANDBY:e+=i.SORT_STANDBY}break;case G.Const.LOGIN_MODE_STANDBY_FIRST:switch(this.serverMode){case G.Const.SERVER_MODE_NORMAL:e+=i.SORT_NORMAL;break;case G.Const.SERVER_MODE_PRIMARY:e+=10*i.SORT_PRIMARY;break;case G.Const.SERVER_MODE_STANDBY:e+=100*i.SORT_STANDBY}break;case G.Const.LOGIN_MODE_PRIMARY_ONLY:if(this.serverMode!=G.Const.SERVER_MODE_PRIMARY)return i.SORT_SERVER_MODE_INVALID;e+=i.SORT_PRIMARY;break;case G.Const.LOGIN_MODE_STANDBY_ONLY:if(this.serverMode!=G.Const.SERVER_MODE_STANDBY)return i.SORT_SERVER_MODE_INVALID;e+=i.SORT_STANDBY}switch(this.serverStatus){case G.Const.SERVER_STATUS_MOUNT:e+=i.SORT_MOUNT;break;case G.Const.SERVER_STATUS_OPEN:e+=i.SORT_OPEN;break;case G.Const.SERVER_STATUS_SUSPEND:e+=i.SORT_SUSPEND}return e},i.STATUS_VALID_TIME=2e4,i.SORT_SERVER_MODE_INVALID=-1,i.SORT_SERVER_NOT_ALIVE=-2,i.SORT_UNKNOWN=G.Const.INT32_MAX,i.SORT_NORMAL=30,i.SORT_PRIMARY=20,i.SORT_STANDBY=10,i.SORT_OPEN=3,i.SORT_MOUNT=2,i.SORT_SUSPEND=1,i}();Se.EP=ac});var fn=E(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});var jn=D(),Lo=require("path"),cc=function(){function i(){}return i.compareDBVersion=function(t,e){for(var r=t.split("."),n=e.split("."),o=0;o<r.length;o++){var a=parseInt(r[0]),c=parseInt(n[0]);if(a<c)return-1;if(c<a)return 1}return 0},i.isSupportedCharset=function(t){return t.toUpperCase()in[jn.Const.ENCODING_UTF8,jn.Const.ENCODING_GB18030,jn.Const.ENCODING_EUCKR]},i.formatDir=function(t){return(t=t.trim())&&!t.endsWith(Lo.sep)&&(t+=Lo.sep),t},i.isFunction=function(t){return typeof t=="function"},i.isObject=function(t){return t!==null&&typeof t=="object"},i.isObjectOrArray=function(t){return t!==null&&typeof t=="object"||Array.isArray(t)},i}();Wn.DriverUtil=cc});var rr=E(Zt=>{"use strict";var Do=Zt&&Zt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Co=Zt&&Zt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}},uc=Zt&&Zt.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Zt,"__esModule",{value:!0});var hc=require("fs"),lc=require("readline"),wo=ln(),fc=Jn(),Ro=gr(),at=D(),_c=fn(),_n=Bt(),pc=require("process"),dc=require("os"),Ec=function(){function i(){this.logLevel=at.Const.LOG_OFF,this.logDir=pc.cwd(),this.logFlushFreq=30,this.logBufferSize=32768,this.serverGroupMap=new Map,this.globalProperties=new wo.Properties}return i.getDmsvcconfDefPath=function(){switch(dc.platform()){case"win32":return process.env.SystemRoot+"\\system32\\dm_svc.conf";case"linux":return"/etc/dm_svc.conf";default:return}},i.load=function(t,e){return Do(this,void 0,void 0,function(){var r=this;return Co(this,function(n){return[2,new Promise(function(o,a){var c,u=new i,h=lc.createInterface({input:hc.createReadStream(t).on("error",function(){return Do(r,void 0,void 0,function(){var s,l;return Co(this,function(_){switch(_.label){case 0:return s=o,e?(l=u,[3,3]):[3,1];case 1:return[4,this.load(this.getDmsvcconfDefPath()||"",!0)];case 2:l=_.sent(),_.label=3;case 3:return s.apply(void 0,[l]),[2]}})})})});h.on("line",function(s){var l=s.indexOf("#");if(l!=-1&&(s=s.substring(0,l)),s=s.trim())if(s.startsWith("[")&&s.endsWith("]")){var _=s.substring(1,s.length-1).toLowerCase();if(!_||!u.serverGroupMap.has(_))return;(c=u.serverGroupMap.get(_).props)||(c=new wo.Properties(u.globalProperties),u.serverGroupMap.get(_).props=c)}else{var f=s.split("=");if(f.length<2)return;var y,T=f[0].trim(),m=f[1].trim();if(m.startsWith("(")&&m.endsWith(")")&&(m=m.substring(1,m.length-1).trim()),!T||!m)return;u.setServerGroupProperties(c||u.globalProperties,T,m)||(y=r.parseServerName(T,m))&&u.serverGroupMap.set(T.toLowerCase(),y)}}),h.on("close",function(){o(u)})})]})})},i.parseServerName=function(t,e){var r,n,o,a,c=e.split(","),u=new Array;try{for(var h=uc(c),s=h.next();!s.done;s=h.next()){var l,_,f=s.value,y=void 0,T=f.indexOf("["),m=-1;T!==-1&&(m=f.indexOf("]",T)),m===-1?(a=(o=f.split(":"))[0].trim(),_=2<=o.length?parseInt(o[1]):at.Const.PORT_DEFAULT,y=new Ro.EP(a,_),u.push(y)):(a=f.substring(T+1,m),_=(l=f.indexOf(":",m))!==-1?parseInt(f.substring(l+1).trim()):at.Const.PORT_DEFAULT,y=new Ro.EP(a,_),u.push(y))}}catch(P){r={error:P}}finally{try{s&&!s.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}return 0<u.length?new fc.EPGroup(t,u):void 0},i.parseLogLevel=function(t){var e=t.getTrimString("logLevel","");if(!e||_n.StringUtil.isDigit(e))return t.getNumber("logLevel",at.Const.LOG_OFF,at.Const.LOG_OFF,at.Const.LOG_ALL);switch(e.toLowerCase()){case"debug":return at.Const.LOG_DEBUG;case"info":return at.Const.LOG_INFO;case"sql":return at.Const.LOG_SQL;case"warn":return at.Const.LOG_WARN;case"error":return at.Const.LOG_ERROR;case"off":return at.Const.LOG_OFF;case"all":return at.Const.LOG_ALL;default:return at.Const.LOG_OFF}},i.parseCompatibleMode=function(t){var e=t.getTrimString("compatibleMode","");return e&&!_n.StringUtil.isDigit(e)?_n.StringUtil.equalsIgnoreCase(e,"oracle")?at.Const.COMPATIBLE_MODE_ORACLE:_n.StringUtil.equalsIgnoreCase(e,"mysql")?at.Const.COMPATIBLE_MODE_MYSQL:0:t.getNumber("compatibleMode",0,0,2)},i.prototype.setServerGroupProperties=function(t,e,r){switch(e.toUpperCase()){case"ADDRESS_REMAP":t.set("addressRemap",t.getTrimString("addressRemap","")+"("+r+")");break;case"ALWAYS_ALLOW_COMMIT":t.set("alwaysAllowCommit",r);break;case"APP_NAME":t.set("appName",r);break;case"AUTO_COMMIT":t.set("autoCommit",r);break;case"BATCH_ALLOW_MAX_ERRORS":t.set("batchAllowMaxErrors",r);break;case"BATCH_CONTINUE_ON_ERROR":case"CONTINUE_BATCH_ON_ERROR":t.set("continueBatchOnError",r);break;case"BATCH_NOT_ON_CALL":t.set("batchNotOnCall",r);break;case"BATCH_TYPE":t.set("batchType",r);break;case"BUF_PREFETCH":t.set("bufPrefetch",r);break;case"CLUSTER":t.set("cluster",r);break;case"COLUMN_NAME_UPPER_CASE":t.set("columnNameUpperCase",r);break;case"COLUMN_NAME_CASE":t.set("columnNameCase",r);break;case"COMPATIBLE_MODE":t.set("compatibleMode",r);break;case"COMPRESS":case"COMPRESS_MSG":t.set("compress",r);break;case"COMPRESS_ID":t.set("compressID",r);break;case"CONNECT_TIMEOUT":t.set("connectTimeout",r);break;case"DO_SWITCH":case"AUTO_RECONNECT":t.set("doSwitch",r);break;case"ENABLE_RS_CACHE":t.set("enRsCache",r);break;case"EP_SELECTION":t.set("epSelector",r);break;case"ESCAPE_PROCESS":t.set("escapeProcess",r);break;case"IS_BDTA_RS":t.set("isBdtaRS",r);break;case"KEY_WORDS":case"KEYWORDS":t.set("keyWords",r);break;case"LANGUAGE":t.set("language",r);break;case"LOB_MODE":t.set("LobMode",r);break;case"LOG_DIR":t.set("logDir",r);break;case"LOG_FLUSH_FREQ":t.set("logFlushFreq",r);break;case"LOG_LEVEL":t.set("logLevel",r);break;case"LOGIN_CERTIFICATE":t.set("loginCertificate",r);break;case"LOGIN_DSC_CTRL":t.set("loginDscCtrl",r);break;case"LOGIN_ENCRYPT":t.set("loginEncrypt",r);break;case"LOGIN_MODE":t.set("loginMode",r);break;case"LOGIN_STATUS":t.set("loginStatus",r);break;case"MAX_ROWS":t.set("maxRows",r);break;case"MPP_LOCAL":t.set("mppLocal",r);break;case"OS_AUTH_TYPE":t.set("osAuthType",r);break;case"OS_NAME":t.set("osName",r);break;case"RS_CACHE_SIZE":t.set("rsCacheSize",r);break;case"RS_REFRESH_FREQ":t.set("rsRefreshFreq",r);break;case"RW_HA":t.set("rwHA",r);break;case"RW_IGNORE_SQL":t.set("rwIgnoreSql",r);break;case"RW_PERCENT":t.set("rwPercent",r);break;case"RW_SEPARATE":t.set("rwSeparate",r);break;case"RW_STANDBY_RECOVER_TIME":t.set("rwStandbyRecoverTime",r);break;case"SCHEMA":t.set("schema",r);break;case"SESS_ENCODE":t.set("sessEncode",r);break;case"SESSION_TIMEOUT":t.set("sessionTimeout",r);break;case"SSL_FILES_PATH":t.set("sslPath",r);break;case"SWITCH_INTERVAL":t.set("switchInterval",r);break;case"SWITCH_TIME":case"SWITCH_TIMES":t.set("switchTimes",r);break;case"TIME_ZONE":t.set("localTimezone",r);break;case"USER_REMAP":t.set("userRemap",t.getTrimString("userRemap","")+"("+r+")");break;default:return!1}return!0},i.prototype.setAttributes=function(t){t&&t.size()!==0&&(this.logLevel=i.parseLogLevel(t),this.logDir=_c.DriverUtil.formatDir(t.getTrimString("logDir",this.logDir)),this.logBufferSize=t.getNumber("logBufferSize",this.logBufferSize,1),this.logFlushFreq=t.getNumber("logflushFreq",this.logFlushFreq,0))},i.LOCALE=0,i}();Zt.SvcConf=Ec});var nr=E(pn=>{"use strict";function Tc(){return function(i,t){No(i,[t])}}function No(i,t){var e=Object.getOwnPropertyDescriptors(i);t.forEach(function(r){e[r]&&(e[r].enumerable=!1)}),Object.defineProperties(i,e)}Object.defineProperty(pn,"__esModule",{value:!0}),pn.unenumerable=Tc,pn.setUnenumerable=No});var R=E(vr=>{"use strict";var yc=vr&&vr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(vr,"__esModule",{value:!0});var mc=Oo(),Sc=rr(),gc=nr(),vc=function(i){function t(e,r,n){var o=i.call(this,"["+e+"] "+mc.I18n.get(r,Sc.SvcConf.LOCALE)+(n?`
`+n:""))||this;return o.errCode=e,Object.setPrototypeOf(o,t.prototype),gc.setUnenumerable(o,["errCode","fatal"]),o}return yc(t,i),t.EC_BP_WITH_ERROR=function(e){return new t(121,"warning.bpWithErr",e)},t.ECJS_COMMUNICATION_ERROR=function(e){return new t(6001,"error.communicationError",e)},t.ECJS_MSG_CHECK_ERROR=function(e){return new t(6002,"error.msgCheckError",e)},t.ECJS_SQL_IS_EMPTY=function(e){return new t(6003,"error.sqlIsNullOrEmpty",e)},t.ECJS_INVALID_TIME_INTERVAL=function(e){return new t(6005,"error.invalidTimeIntervalValue",e)},t.ECJS_UNSUPPORTED_TYPE=function(e){return new t(6006,"error.unsupportedType",e)},t.ECJS_DATA_CONVERTION_ERROR=function(e){return new t(6007,"error.dataConvertionError",e)},t.ECJS_INVALID_SQL_TYPE=function(e){return new t(6009,"error.invalidSqlType",e)},t.ECJS_INVALID_DATETIME_FORMAT=function(e){return new t(6015,"error.invalidDateTimeTypeFormat",e)},t.ECJS_INVALID_COLUMN_TYPE=function(e){return new t(6016,"error.invalidColumnType",e)},t.ECJS_RESULTSET_IS_READ_ONLY=function(e){return new t(6029,"error.resultsetInReadOnlyStatus",e)},t.ECJS_RESULTSET_CLOSED=function(e){return new t(6034,"error.resultsetClosed",e)},t.ECJS_COMMIT_IN_AUTOCOMMIT_MODE=function(e){return new t(6042,"error.commitInAutoCommitMode",e)},t.ECJS_ROLLBACK_IN_AUTOCOMMIT_MODE=function(e){return new t(6043,"error.rollbackInAutoCommitMode",e)},t.ECJS_INVALID_LENGTH_OR_OFFSET=function(e){return new t(6057,"error.invalidLenOrOffset",e)},t.ECJS_CONNECTION_CLOSED=function(e){return new t(6060,"error.connectionClosed",e)},t.ECJS_INTERVAL_OVERFLOW=function(e){return new t(6066,"error.intervalValueOverflow",e)},t.ECJS_INVALID_BFILE_STR=function(e){return new t(6067,"error.invalidBFile",e)},t.ECJS_INVALID_HEX=function(e){return new t(6068,"error.invalidHex",e)},t.ECJS_INVALID_CIPHER=function(e){return new t(6069,"error.invalidCipher",e)},t.ECJS_MESSAGE_ENCRYPT_FAIL=function(e){return new t(6071,"error.cipher.encrypt.fail",e)},t.ECJS_MESSAGE_DECRYPT_FAIL=function(e){return new t(6072,"error.cipher.decrypt.fail",e)},t.ECJS_OSAUTH_ERROR=function(e){return new t(6073,"error.osAuthUserConflict",e)},t.ECJS_ERR_SERVER_VERSION=function(e){return new t(6074,"error.version.server",e)},t.ECJS_USERNAME_TOO_LONG=function(e){return new t(6075,"error.usernameTooLong",e)},t.ECJS_PASSWORD_TOO_LONG=function(e){return new t(6076,"error.passwordTooLong",e)},t.ECJS_INVALID_OBJ_BLOB=function(e){return new t(6081,"error.invalidObjBlob",e)},t.ECJS_INVALID_SERVER_MODE=function(e){return new t(6091,"error.invalidServerMode",e)},t.ECJS_DATA_TOO_LONG=function(e){return new t(6092,"error.dataTooLong",e)},t.ECJS_BATCH_ERROR=function(e){return new t(6093,"error.batchError",e)},t.ECJS_MSG_TOO_LONG=function(e){return new t(6101,"error.msgTooLong",e)},t.ECJS_INVALID_DATETIME_VALUE=function(e){return new t(6103,"error.invalidDateTimeValue",e)},t.ECJS_FATAL_ERROR=function(e){return new t(2e4,"error.fatalError",e)},t.ECJS_INVALID_PARAM=function(e){return new t(20001,"error.invalidParam",e)},t.ECJS_INVALID_URL_OR_ALIAS_OR_ATTR=function(e){return new t(20002,"error.invalidUrlOrAliasOrAttr",e)},t.ECJS_INVALID_OUTFORMAT=function(e){return new t(20003,"error.invalidOutFormat",e)},t.ECJS_POOL_CLOSED=function(e){return new t(20004,"error.poolClosed",e)},t.ECJS_POOL_DRAINING=function(e){return new t(20005,"error.poolDraining",e)},t.ECJS_POOL_ALIAS_CONFLICT=function(e){return new t(20006,"error.poolAliasConflict",e)},t.ECJS_POOL_NO_MORE_CONNECTION=function(e){return new t(20007,"error.noMoreConnection",e)},t.ECJS_INVALID_POOL_NUM=function(e){return new t(20008,"error.invalidPoolNum",e)},t.ECJS_CONNECT_TIMEOUT=function(e){return new t(20009,"error.connectTimeout",e)},t.ECJS_SOCKET_TIMEOUT=function(e){return new t(20010,"error.socketTimeout",e)},t.ECJS_LOB_FREED=function(e){return new t(20011,"error.LobDataHasFreed",e)},t.ECJS_INIT_SSL_FAILED=function(e){return new t(20012,"error.SSLInitFailed",e)},t.ECJS_CONNECTION_SWITCHED=function(e){return new t(20013,"error.switchedSused",e)},t.ECJS_CONNECTION_SWITCH_FAILED=function(e){return new t(20014,"error.switchedFailed",e)},t.ECJS_INVALID_SQL=function(e){return new t(20015,"error.invalidSql",e)},t.EC_EXCEED_SESSION_REQUEST_LIMIT=function(e){return new t(-608,"",e)},t.EC_DATA_OVERFLOW=function(e){return new t(-6102,"error.overflow",e)},t.EC_DATETIME_OVERFLOW=function(e){return new t(-6112,"error.datetimeOverflow",e)},t.EC_RN_OPERATION_CANCELED=function(e){return new t(-6515,"",e)},t.EC_RN_EXCEED_ROWSET_SIZE=function(e){return new t(-7036,"",e)},t}(Error);vr.DBError=vc});var Kn=E(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});var bc=function(){function i(t){this._timeoutCb=t,this._timeout=null}return i.prototype.refresh=function(){this._timeout&&this._timeout.refresh()},i.prototype.start=function(t){this.stop(),this._timeout=setTimeout(this._timeoutCb,t)},i.prototype.stop=function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)},i}();Xn.Timer=bc});var V=E(br=>{"use strict";var Ic=br&&br.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(br,"__esModule",{value:!0});var Ac=Tn(),dn=R(),En=D(),Oc=require("events"),Lc=Kn(),N=function(i){function t(e,r,n,o){var a=i.call(this)||this;return a.vs=e,a.mt=new Ac.DmBuffer(t.Rs),a.Qt=r,a.fs=0,a.ir=n,a._callback=o,a._timeout=e.at.conn_prop_socketTimeout,a._timer=new Lc.Timer(function(){a.emit("timeout")}),a}return Ic(t,i),t.prototype.Tt=function(){this.emit("packet",this.mt.Xt)},t.prototype.I=function(e){var r=void 0,n=null;try{if(e)throw e;r=this.Ps()}catch(o){n=o,this.emit("error",o)}finally{try{this._callback&&this._callback.apply(this,[n,r])}finally{this.emit("end")}}},t.prototype.At=function(){this.Xs(),this.te(),this.Ks()},t.prototype.Xs=function(){this.mt.pt(0),this.mt.$t(t.lt,!0,!0)},t.prototype.Ks=function(){this.mt.v(t.Js,this.ir?this.ir.handle:0),this.mt.y(t.Qs,this.Qt),this.mt.v(t.in,this.mt.St-t.lt)},t.prototype.Ps=function(){this.Vs();try{return this.ee()}finally{this.Ws()}},t.prototype.Vs=function(){this.mt.Ut(t.lt),this.$s()},t.prototype.Ws=function(){},t.prototype.$s=function(){if(this.fs=this.mt.t(t.Mi),this.fs<0){if(this.fs!==dn.DBError.EC_RN_EXCEED_ROWSET_SIZE().errCode)throw new dn.DBError(this.fs,(this.vs.at.rwStandby?"[S] ":"")+this.Ci())}else 0<this.fs||this.Qt!==t.Vt&&this.Qt!==t.Ms||this.Ci()},t.prototype.Ci=function(){var e=this.vs.at.getServerEncoding();return e&&this.vs.at.conn_prop_locale!==1&&e===En.Const.ENCODING_EUCKR&&(e=En.Const.ENCODING_GB18030),this.mt.$t(this.mt.N(),!1,!0),this.mt.$t(this.mt.N(),!1,!0),this.mt.$t(this.mt.N(),!1,!0),this.mt.Pn(e)},t.prototype.kt=function(){var e,r;this.vs.st?(e=this.dt(),this.yt(e+t.Di),r=this.Ei(this.mt,0,t.lt+e),this.mt.q(r)):this.mt.Yn(t.Ti,this.Ai(this.mt))},t.prototype.gt=function(){if(this.vs.st){var e=this.dt()-t.Di,r=t.lt+e;if(this.mt.t(r)!==this.Ei(this.mt,0,r))throw dn.DBError.ECJS_MSG_CHECK_ERROR();this.yt(e),this.mt.pt(r)}else if(this.mt.M(t.Ti)!==this.Ai(this.mt))throw dn.DBError.ECJS_MSG_CHECK_ERROR()},t.prototype.Ai=function(e){for(var r=e.M(0),n=1;n<t.Ti;n++)r^=e.M(n);return r},t.prototype.Ei=function(e,r,n){for(var o=4294967295,a=r,c=n-r;8<=c;){var u=e.t(a)^o;a+=En.Const.ULINT_SIZE;var h=e.t(a);a+=En.Const.ULINT_SIZE,o=t.Si[7][255&u]^t.Si[6][u>>8&255]^t.Si[5][u>>16&255]^t.Si[4][u>>24&255]^t.Si[3][255&h]^t.Si[2][h>>8&255]^t.Si[1][h>>16&255]^t.Si[0][h>>24&255],c-=8}for(;0<c;)o=o>>8&16777215^t.Si[0][255&o^e.M(a)],a++,c--;return~o},t.prototype.dt=function(){return this.mt.t(t.in)},t.prototype.yt=function(e){this.mt.v(t.in,e)},t.prototype.xt=function(){return Dc.get(this.Qt)||"unknown cmd type "+this.Qt},t.VERSION=2,t.Rs=32640,t.Rt=536870912,t.Ms=1,t.Ri=2,t.wi=3,t.yi=4,t.Ni=5,t.es=6,t.se=7,t.ne=8,t.Bi=9,t.ss=13,t.Gi=14,t.Pi=15,t.Xi=17,t.qi=21,t.Ii=24,t.ki=27,t.Li=29,t.Fi=30,t.pi=31,t.xi=32,t.xe=44,t.Hi=52,t.Ki=60,t.zi=71,t.Ji=90,t.tr=91,t.Vt=200,t.lt=64,t.os=20,t.Js=0,t.Qs=4,t.in=6,t.Mi=10,t.Qi=14,t.Dt=18,t.Ti=19,t.Si=[[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],[0,421212481,842424962,724390851,1684849924,2105013317,1448781702,1329698503,3369699848,3519200073,4210026634,3824474571,2897563404,3048111693,2659397006,2274893007,1254232657,1406739216,2029285587,1643069842,783210325,934667796,479770071,92505238,2182846553,2600511768,2955803355,2838940570,3866582365,4285295644,3561045983,3445231262,2508465314,2359236067,2813478432,3198777185,4058571174,3908292839,3286139684,3670389349,1566420650,1145479147,1869335592,1987116393,959540142,539646703,185010476,303839341,3745920755,3327985586,3983561841,4100678960,3140154359,2721170102,2300350837,2416418868,396344571,243568058,631889529,1018359608,1945336319,1793607870,1103436669,1490954812,4034481925,3915546180,3259968903,3679722694,2484439553,2366552896,2787371139,3208174018,950060301,565965900,177645455,328046286,1556873225,1171730760,1861902987,2011255754,3132841300,2745199637,2290958294,2442530455,3738671184,3352078609,3974232786,4126854035,1919080284,1803150877,1079293406,1498383519,370020952,253043481,607678682,1025720731,1711106983,2095471334,1472923941,1322268772,26324643,411738082,866634785,717028704,2904875439,3024081134,2668790573,2248782444,3376948395,3495106026,4219356713,3798300520,792689142,908347575,487136116,68299317,1263779058,1380486579,2036719216,1618931505,3890672638,4278043327,3587215740,3435896893,2206873338,2593195963,2981909624,2829542713,998479947,580430090,162921161,279890824,1609522511,1190423566,1842954189,1958874764,4082766403,3930137346,3245109441,3631694208,2536953671,2385372678,2768287173,3155920004,1900120602,1750776667,1131931800,1517083097,355290910,204897887,656092572,1040194781,3113746450,2692952403,2343461520,2461357009,3723805974,3304059991,4022511508,4141455061,2919742697,3072101800,2620513899,2234183466,3396041197,3547351212,4166851439,3779471918,1725839073,2143618976,1424512099,1307796770,45282277,464110244,813994343,698327078,3838160568,4259225593,3606301754,3488152955,2158586812,2578602749,2996767038,2877569151,740041904,889656817,506086962,120682355,1215357364,1366020341,2051441462,1667084919,3422213966,3538019855,4190942668,3772220557,2945847882,3062702859,2644537544,2226864521,52649286,439905287,823476164,672009861,1733269570,2119477507,1434057408,1281543041,2167981343,2552493150,3004082077,2853541596,3847487515,4233048410,3613549209,3464057816,1239502615,1358593622,2077699477,1657543892,764250643,882293586,532408465,111204816,1585378284,1197851309,1816695150,1968414767,974272232,587794345,136598634,289367339,2527558116,2411481253,2760973158,3179948583,4073438432,3956313505,3237863010,3655790371,347922877,229101820,646611775,1066513022,1892689081,1774917112,1122387515,1543337850,3697634229,3313392372,3998419255,4148705398,3087642289,2702352368,2319436851,2468674930],[0,29518391,59036782,38190681,118073564,114017003,76381362,89069189,236147128,265370511,228034006,206958561,152762724,148411219,178138378,190596925,472294256,501532999,530741022,509615401,456068012,451764635,413917122,426358261,305525448,334993663,296822438,275991697,356276756,352202787,381193850,393929805,944588512,965684439,1003065998,973863097,1061482044,1049003019,1019230802,1023561829,912136024,933002607,903529270,874031361,827834244,815125939,852716522,856752605,611050896,631869351,669987326,640506825,593644876,580921211,551983394,556069653,712553512,733666847,704405574,675154545,762387700,749958851,787859610,792175277,1889177024,1901651959,1931368878,1927033753,2006131996,1985040171,1947726194,1976933189,2122964088,2135668303,2098006038,2093965857,2038461604,2017599123,2047123658,2076625661,1824272048,1836991623,1866005214,1861914857,1807058540,1786244187,1748062722,1777547317,1655668488,1668093247,1630251878,1625932113,1705433044,1684323811,1713505210,1742760333,1222101792,1226154263,1263738702,1251046777,1339974652,1310460363,1281013650,1301863845,1187289752,1191637167,1161842422,1149379777,1103966788,1074747507,1112139306,1133218845,1425107024,1429406311,1467333694,1454888457,1408811148,1379576507,1350309090,1371438805,1524775400,1528845279,1499917702,1487177649,1575719220,1546255107,1584350554,1605185389,3778354048,3774312887,3803303918,3816007129,3862737756,3892238699,3854067506,3833203973,4012263992,4007927823,3970080342,3982554209,3895452388,3924658387,3953866378,3932773565,4245928176,4241609415,4271336606,4283762345,4196012076,4225268251,4187931714,4166823541,4076923208,4072833919,4035198246,4047918865,4094247316,4123732899,4153251322,4132437965,3648544096,3636082519,3673983246,3678331705,3732010428,3753090955,3723829714,3694611429,3614117080,3601426159,3572488374,3576541825,3496125444,3516976691,3555094634,3525581405,3311336976,3298595879,3336186494,3340255305,3260503756,3281337595,3251864226,3222399125,3410866088,3398419871,3368647622,3372945905,3427010420,3448139075,3485520666,3456284973,2444203584,2423127159,2452308526,2481530905,2527477404,2539934891,2502093554,2497740997,2679949304,2659102159,2620920726,2650438049,2562027300,2574714131,2603727690,2599670141,2374579504,2353749767,2383274334,2412743529,2323684844,2336421851,2298759554,2294686645,2207933576,2186809023,2149495014,2178734801,2224278612,2236720739,2266437690,2262135309,2850214048,2820717207,2858812622,2879680249,2934667388,2938704459,2909776914,2897069605,2817622296,2788420399,2759153014,2780249921,2700618180,2704950259,2742877610,2730399645,3049550800,3020298727,3057690558,3078802825,2999835404,3004150075,2974355298,2961925461,3151438440,3121956959,3092510214,3113327665,3168701108,3172786307,3210370778,3197646061],[0,3099354981,2852767883,313896942,2405603159,937357362,627793884,2648127673,3316918511,2097696650,1874714724,3607201537,1255587768,4067088605,3772741427,1482887254,1343838111,3903140090,4195393300,1118632049,3749429448,1741137837,1970407491,3452858150,2511175536,756094997,1067759611,2266550430,449832999,2725482306,2965774508,142231497,2687676222,412010587,171665333,2995192016,793786473,2548850444,2237264098,1038456711,1703315409,3711623348,3482275674,1999841343,3940814982,1381529571,1089329165,4166106984,4029413537,1217896388,1512189994,3802027855,2135519222,3354724499,3577784189,1845280792,899665998,2367928107,2677414085,657096608,3137160985,37822588,284462994,2823350519,2601801789,598228824,824021174,2309093331,343330666,2898962447,3195996129,113467524,1587572946,3860600759,4104763481,1276501820,3519211397,1769898208,2076913422,3279374443,3406630818,1941006535,1627703081,3652755532,1148164341,4241751952,3999682686,1457141531,247015245,3053797416,2763059142,470583459,2178658330,963106687,735213713,2473467892,992409347,2207944806,2435792776,697522413,3024379988,217581361,508405983,2800865210,4271038444,1177467017,1419450215,3962007554,1911572667,3377213406,3690561584,1665525589,1799331996,3548628985,3241568279,2039091058,3831314379,1558270126,1314193216,4142438437,2928380019,372764438,75645176,3158189981,568925988,2572515393,2346768303,861712586,3982079547,1441124702,1196457648,4293663189,1648042348,3666298377,3358779879,1888390786,686661332,2421291441,2196002399,978858298,2811169155,523464422,226935048,3040519789,3175145892,100435649,390670639,2952089162,841119475,2325614998,2553003640,546822429,2029308235,3225988654,3539796416,1782671013,4153826844,1328167289,1570739863,3844338162,1298864389,4124540512,3882013070,1608431339,3255406162,2058742071,1744848601,3501990332,2296328682,811816591,584513889,2590678532,129869501,3204563416,2914283062,352848211,494030490,2781751807,3078325777,264757620,2450577869,715964072,941166918,2158327331,3636881013,1618608400,1926213374,3396585883,1470427426,4011365959,4255988137,1158766284,1984818694,3471935843,3695453837,1693991400,4180638033,1100160564,1395044826,3952793279,3019491049,189112716,435162722,2706139399,1016811966,2217162459,2526189877,774831696,643086745,2666061564,2354934034,887166583,2838900430,294275499,54519365,3145957664,3823145334,1532818963,1240029693,4048895640,1820460577,3560857924,3331051178,2117577167,3598663992,1858283101,2088143283,3301633750,1495127663,3785470218,4078182116,1269332353,332098007,2876706482,3116540252,25085497,2628386432,605395429,916469259,2384220526,2254837415,1054503362,745528876,2496903497,151290352,2981684885,2735556987,464596510,1137851976,4218313005,3923506883,1365741990,3434129695,1946996346,1723425172,3724871409],[0,1029712304,2059424608,1201699536,4118849216,3370159984,2403399072,2988497936,812665793,219177585,1253054625,2010132753,3320900865,4170237105,3207642721,2186319825,1625331586,1568718386,438355170,658566482,2506109250,2818578674,4020265506,3535817618,1351670851,1844508147,709922595,389064339,2769320579,2557498163,3754961379,3803185235,3250663172,4238411444,3137436772,2254525908,876710340,153198708,1317132964,1944187668,4054934725,3436268917,2339452837,3054575125,70369797,961670069,2129760613,1133623509,2703341702,2621542710,3689016294,3867263574,1419845190,1774270454,778128678,318858390,2438067015,2888948471,3952189479,3606153623,1691440519,1504803895,504432359,594620247,1492342857,1704161785,573770537,525542041,2910060169,2417219385,3618876905,3939730521,1753420680,1440954936,306397416,790849880,2634265928,2690882808,3888375336,3668168600,940822475,91481723,1121164459,2142483739,3448989963,4042473659,3075684971,2318603227,140739594,889433530,1923340138,1338244826,4259521226,3229813626,2267247018,3124975642,2570221389,2756861693,3824297005,3734113693,1823658381,1372780605,376603373,722643805,2839690380,2485261628,3548540908,4007806556,1556257356,1638052860,637716780,459464860,4191346895,3300051327,2199040943,3195181599,206718479,825388991,1989285231,1274166495,3382881038,4106388158,3009607790,2382549470,1008864718,21111934,1189240494,2072147742,2984685714,2357631266,3408323570,4131834434,1147541074,2030452706,1051084082,63335554,2174155603,3170292451,4216760371,3325460867,1947622803,1232499747,248909555,867575619,3506841360,3966111392,2881909872,2527485376,612794832,434546784,1581699760,1663499008,3782634705,3692447073,2612412337,2799048193,351717905,697754529,1849071985,1398190273,1881644950,1296545318,182963446,931652934,2242328918,3100053734,4284967478,3255255942,1079497815,2100821479,983009079,133672583,3050795671,2293717799,3474399735,4067887175,281479188,765927844,1778867060,1466397380,3846680276,3626469220,2676489652,2733102084,548881365,500656741,1517752501,1729575173,3577210133,3898068133,2952246901,2459410373,3910527195,3564487019,2480257979,2931134987,479546907,569730987,1716854139,1530213579,3647316762,3825568426,2745561210,2663766474,753206746,293940330,1445287610,1799716618,2314567513,3029685993,4080348217,3461678473,2088098201,1091956777,112560889,1003856713,3112514712,2229607720,3276105720,4263857736,1275433560,1902492648,918929720,195422344,685033439,364179055,1377080511,1869921551,3713294623,3761522863,2811507327,2599689167,413436958,633644462,1650777982,1594160846,3978570462,3494118254,2548332990,2860797966,1211387997,1968470509,854852413,261368461,3182753437,2161434413,3346310653,4195650637,2017729436,1160000044,42223868,1071931724,2378480988,2963576044,4144295484,3395602316],[0,3411858341,1304994059,2257875630,2609988118,1355649459,3596215069,486879416,3964895853,655315400,2711298918,1791488195,2009251963,3164476382,973758832,4048990933,64357019,3364540734,1310630800,2235723829,2554806413,1394316072,3582976390,517157411,4018503926,618222419,2722963965,1762783832,1947517664,3209171269,970744811,4068520014,128714038,3438335635,1248109629,2167961496,2621261600,1466012805,3522553387,447296910,3959392091,547575038,2788632144,1835791861,1886307661,3140622056,1034314822,4143626211,75106221,3475428360,1236444838,2196665603,2682996155,1421317662,3525567664,427767573,3895035328,594892389,2782995659,1857943406,1941489622,3101955187,1047553757,4113347960,257428076,3288652233,1116777319,2311878850,2496219258,1603640287,3640781169,308099796,3809183745,676813732,2932025610,1704983215,2023410199,3016104370,894593820,4262377657,210634999,3352484690,1095150076,2316991065,2535410401,1547934020,3671583722,294336591,3772615322,729897279,2903845777,1716123700,2068629644,2953845545,914647431,4258839074,150212442,3282623743,1161604689,2388688372,2472889676,1480171241,3735940167,368132066,3836185911,805002898,2842635324,1647574937,2134298401,3026852996,855535146,4188192143,186781121,3229539940,1189784778,2377547631,2427670487,1542429810,3715886812,371670393,3882979244,741170185,2864262823,1642462466,2095107514,3082559007,824732849,4201955092,514856152,3589064573,1400419795,2552522358,2233554638,1316849003,3370776517,62202976,4075001525,968836368,3207280574,1954014235,1769133219,2720925446,616199592,4024870413,493229635,3594175974,1353627464,2616354029,2264355925,1303087088,3409966430,6498043,4046820398,979978123,3170710821,2007099008,1789187640,2717386141,661419827,3962610838,421269998,3527459403,1423225061,2676515648,2190300152,1238466653,3477467891,68755798,4115633027,1041448998,3095868040,1943789869,1860096405,2776760880,588673182,3897205563,449450869,3516317904,1459794558,2623431131,2170245475,1242006214,3432247400,131015629,4137259288,1036337853,3142660115,1879958454,1829294862,2790523051,549483013,3952910752,300424884,3669282065,1545650111,2541513754,2323209378,1092980487,3350330793,216870412,4256931033,921128828,2960342482,2066738807,1714085583,2910195050,736264132,3770592353,306060335,3647131530,1610005796,2494197377,2309971513,1123257756,3295149874,255536279,4268596802,892423655,3013951305,2029645036,1711070292,2929725425,674528607,3815288570,373562242,3709388839,1535949449,2429577516,2379569556,1183418929,3223189663,188820282,4195850735,827017802,3084859620,2089020225,1636228089,2866415708,743340786,3876759895,361896217,3738094268,1482340370,2466671543,2382584591,1163888810,3284924932,144124321,4190215028,849168593,3020503679,2136336858,1649465698,2836138695,798521449,3838094284],[0,2792819636,2543784233,837294749,4098827283,1379413927,1674589498,3316072078,871321191,2509784531,2758827854,34034938,3349178996,1641505216,1346337629,4131942633,1742642382,3249117050,4030828007,1446413907,2475800797,904311657,68069876,2725880384,1412551337,4064729373,3283010432,1708771380,2692675258,101317902,937551763,2442587175,3485284764,1774858792,1478633653,4266992385,1005723023,2642744891,2892827814,169477906,4233263099,1512406095,1808623314,3451546982,136139752,2926205020,2676114113,972376437,2825102674,236236518,1073525883,2576072655,1546420545,4200303349,3417542760,1841601500,2609703733,1039917185,202635804,2858742184,1875103526,3384067218,4166835727,1579931067,1141601657,3799809741,3549717584,1977839588,2957267306,372464350,668680259,2175552503,2011446046,3516084394,3766168119,1175200131,2209029901,635180217,338955812,2990736784,601221559,2242044419,3024812190,306049834,3617246628,1911408144,1074125965,3866285881,272279504,3058543716,2275784441,567459149,3832906691,1107462263,1944752874,3583875422,2343980261,767641425,472473036,3126744696,2147051766,3649987394,3899029983,1309766251,3092841090,506333494,801510315,2310084639,1276520081,3932237093,3683203e3,2113813516,3966292011,1243601823,2079834370,3716205238,405271608,3192979340,2411259153,701492901,3750207052,2045810168,1209569125,4000285905,734575199,2378150379,3159862134,438345922,2283203314,778166598,529136603,3120492655,2086260449,3660498261,3955679176,1303499900,3153699989,495890209,744928700,2316418568,1337360518,3921775410,3626602927,2120129051,4022892092,1237286280,2018993941,3726666913,461853231,3186645403,2350400262,711936178,3693557851,2052076527,1270360434,3989775046,677911624,2384402428,3220639073,427820757,1202443118,3789347034,3493118535,1984154099,3018127229,362020041,612099668,2181885408,1950653705,3526596285,3822816288,1168934804,2148251930,645706414,395618355,2984485767,544559008,2248295444,3085590153,295523645,3560598451,1917673479,1134918298,3855773998,328860103,3052210803,2214924526,577903450,3889505748,1101147744,1883911421,3594338121,3424493451,1785369663,1535282850,4260726038,944946072,2653270060,2949491377,163225861,4294103532,1501944408,1752023237,3457862513,196998655,2915761739,2619532502,978710370,2881684293,229902577,1012666988,2586515928,1603020630,4193987810,3356702335,1852063179,2553040162,1046169238,263412747,2848217023,1818454321,3390333573,4227627032,1569420204,60859927,2782375331,2487203646,843627658,4159668740,1368951216,1617990445,3322386585,810543216,2520310724,2815490393,27783917,3288386659,1652017111,1402985802,4125677310,1685994201,3255382381,4091620336,1435902020,2419138250,910562686,128847843,2715354199,1469150398,4058414858,3222168983,1719234083,2749255853,94984985,876691844,2453031472],[0,3433693342,1109723005,2391738339,2219446010,1222643300,3329165703,180685081,3555007413,525277995,2445286600,1567235158,1471092047,2600801745,361370162,3642757804,2092642603,2953916853,1050555990,4063508168,4176560081,878395215,3134470316,1987983410,2942184094,1676945920,3984272867,567356797,722740324,3887998202,1764827929,2778407815,4185285206,903635656,3142804779,2012833205,2101111980,2979425330,1058630609,4088621903,714308067,3862526333,1756790430,2753330688,2933487385,1651734407,3975966820,542535930,2244825981,1231508451,3353891840,188896414,25648519,3442302233,1134713594,2399689316,1445480648,2592229462,336416693,3634843435,3529655858,516441772,2420588879,1559052753,698204909,3845636723,1807271312,2803025166,2916600855,1635634313,4025666410,593021940,4202223960,919787974,3093159461,1962401467,2117261218,2996361020,1008193759,4038971457,1428616134,2576151384,386135227,3685348389,3513580860,499580322,2471098945,1608776415,2260985971,1248454893,3303468814,139259792,42591881,3458459159,1085071860,2349261162,3505103035,474062885,2463016902,1583654744,1419882049,2550902495,377792828,3660491170,51297038,3483679632,1093385331,2374089965,2269427188,1273935210,3311514249,164344343,2890961296,1627033870,4000683757,585078387,672833386,3836780532,1782552599,2794821769,2142603813,3005188795,1032883544,4047146438,4227826911,928351297,3118105506,1970307900,1396409818,2677114180,287212199,3719594553,3614542624,467372990,2505346141,1509854403,2162073199,1282711281,3271268626,240228748,76845205,3359543307,1186043880,2317064054,796964081,3811226735,1839575948,2702160658,2882189835,1734392469,3924802934,625327592,4234522436,818917338,3191908409,1927981223,2016387518,3028656416,973776579,4137723485,2857232268,1726474002,3899187441,616751215,772270454,3803048424,1814228491,2693328533,2041117753,3036871847,999160644,4146592730,4259508931,826864221,3217552830,1936586016,3606501031,442291769,2496909786,1484378436,1388107869,2652297411,278519584,3694387134,85183762,3384397196,1194773103,2342308593,2170143720,1307820918,3279733909,265733131,2057717559,3054258089,948125770,4096344276,4276898253,843467091,3167309488,1885556270,2839764098,1709792284,3949353983,667704161,755585656,3785577190,1865176325,2743489947,102594076,3401021058,1144549729,2291298815,2186770662,1325234296,3228729243,215514885,3589828009,424832311,2547870420,1534552650,1370645331,2635621325,328688686,3745342640,2211456353,1333405183,3254067740,224338562,127544219,3408931589,1170156774,2299866232,1345666772,2627681866,303053225,3736746295,3565105198,416624816,2522494803,1525692365,4285207626,868291796,3176010551,1910772649,2065767088,3079346734,956571085,4121828691,747507711,3760459617,1856702594,2717976604,2831417605,1684930971,3940615800,642451174]],t.Di=4,t}(Oc.EventEmitter);br.Msg=N;var Dc=new Map([[N.Ms,"CMD_LOGIN"],[N.Ri,"CMD_LOGOUT"],[N.wi,"CMD_STMT_ALLOCATE"],[N.yi,"CMD_STMT_FREE"],[N.Ni,"CMD_PREPARE"],[N.es,"CMD_EXECUTE"],[N.se,"CMD_FETCH"],[N.ne,"CMD_COMMIT"],[N.Bi,"CMD_ROLLBACK"],[N.ss,"CMD_EXECUTE2"],[N.Gi,"CMD_PUT_DATA"],[N.Pi,"CMD_GET_DATA"],[N.Xi,"CMD_STMT_CLOSE"],[N.qi,"CMD_EXPLAIN"],[N.Ii,"CMD_GET_DATA_ARR"],[N.ki,"CMD_CURSOR_SET_NAME"],[N.Li,"CMD_GET_LOB_LEN"],[N.Fi,"CMD_SET_LOB_DATA"],[N.pi,"CMD_LOB_TRUNCATE"],[N.xi,"CMD_GET_LOB_DATA"],[N.xe,"CMD_MORE_RESULT"],[N.Hi,"CMD_SESS_ISO"],[N.Ki,"CMD_XA"],[N.zi,"CMD_TABLE_TS"],[N.Ji,"CMD_PRE_EXEC"],[N.tr,"CMD_EXEC_DIRECT"],[N.Vt,"CMD_STARTUP"]])});var Tn=E(ge=>{"use strict";var Bo=ge&&ge.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Mo=ge&&ge.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(ge,"__esModule",{value:!0});var g=J(),Cc=V(),wc=function(){function i(t){this._readOff=0,this._writeOff=0,typeof t=="number"?(t<0&&(t=0),this._buf=Buffer.alloc(t)):(this._buf=Buffer.from(t),this._writeOff=t.length)}return Object.defineProperty(i.prototype,"Xt",{get:function(){return this._buf.slice(0,this._writeOff)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Yt",{get:function(){return this._readOff},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"St",{get:function(){return this._writeOff},enumerable:!0,configurable:!0}),i.prototype.pt=function(t){return this._writeOff=t,this._readOff>t&&(this._readOff=t),this},i.prototype.Ut=function(t){return this._readOff=t,this},i.prototype.Zt=function(){return this.St-this._readOff},i.prototype.$t=function(t,e,r){return e?r?this.tn(t):this.pt(t):r?this._readOff+=t:this._readOff-=t,this},i.prototype.nn=function(t,e){return Bo(this,void 0,void 0,function(){var r=this;return Mo(this,function(n){return[2,new Promise(function(o,a){setTimeout(function(){a(new Error("Socket read timeout"))},3e3);var c=null,u=setInterval(function(){c!==null&&(clearInterval(u),r.qt(c),o(c.length))},1);t.once("readable",function(){var h=t.read(e),s=h.readInt32LE(Cc.Msg.in);0<s&&(h=Buffer.concat([h,t.read(s)])),c=h})})]})})},i.prototype.rn=function(t){return Bo(this,void 0,void 0,function(){var e=this;return Mo(this,function(r){return[2,new Promise(function(n,o){t.write(e._buf,function(a){a?o(a):(console.log("send msg"),n(e))})})]})})},i.prototype.un=function(){return g.BufferUtil.fn(this.en(1))},i.prototype.sn=function(){return g.BufferUtil.on(this.en(1))},i.prototype.hn=function(){return g.BufferUtil.cn(this.en(2))},i.prototype.x=function(){return g.BufferUtil.ln(this.en(2))},i.prototype.N=function(){return g.BufferUtil._n(this.en(4))},i.prototype.bn=function(){return g.BufferUtil.an(this.en(4))},i.prototype.Un=function(){return g.BufferUtil.vn(this.en(8))},i.prototype.mn=function(){return g.BufferUtil.gn(this.en(8))},i.prototype.dn=function(){return g.BufferUtil.wn(this.en(4))},i.prototype.yn=function(){return g.BufferUtil.Bn(this.en(8))},i.prototype.en=function(t){var e=g.BufferUtil.p(this._buf,this._readOff,t);return this._readOff+=t,e},i.prototype.pn=function(){return this.en(this.bn())},i.prototype.kn=function(){return this.en(this.sn())},i.prototype.On=function(){return this.en(this.x())},i.prototype.jn=function(){for(var t=0;this.sn()!=0;)t++;return this.$t(t,!1,!1),this.en(t)},i.prototype.xn=function(t,e){return g.BufferUtil.G(this.en(t),e)},i.prototype.Pn=function(t){return g.BufferUtil.G(this.pn(),t)},i.prototype.Sn=function(t){return g.BufferUtil.G(this.kn(),t)},i.prototype.g=function(t){return g.BufferUtil.G(this.On(),t)},i.prototype.qn=function(t){return g.BufferUtil.G(this.jn(),t)},i.prototype.Dn=function(t){return this.qt(g.BufferUtil.En(t?1:0))},i.prototype.In=function(t){return this.qt(g.BufferUtil.a(t))},i.prototype.Tn=function(t){return this.qt(g.BufferUtil.En(t))},i.prototype.m=function(t){return this.qt(g.BufferUtil._(t))},i.prototype.Gn=function(t){return this.qt(g.BufferUtil.Mn(t))},i.prototype.q=function(t){return this.qt(g.BufferUtil.s(t))},i.prototype.zn=function(t){return this.qt(g.BufferUtil.An(t))},i.prototype.Cn=function(t){return this.qt(g.BufferUtil.o(t))},i.prototype.Fn=function(t){return this.qt(g.BufferUtil.Hn(t))},i.prototype.Jn=function(t){return this.qt(g.BufferUtil.f(t))},i.prototype.Kn=function(t){return this.qt(g.BufferUtil.d(t))},i.prototype.qt=function(t){var e=t.length;if(e==0)return e;var r,n=this._buf.length;return this._writeOff+e>n&&(r=Buffer.alloc(2*n),this._buf=r.fill(this._buf,0,this._buf.length)),this._buf=this._buf.fill(t,this._writeOff,this._writeOff+e),this._writeOff+=e,e},i.prototype.Ln=function(t){return this.zn(t.length)+this.qt(t)},i.prototype.Nn=function(t){return this.Tn(t.length)+this.qt(t)},i.prototype.Qn=function(t){return this.Gn(t.length)+this.qt(t)},i.prototype.Rn=function(t){return this.qt(t)+this.Tn(0)},i.prototype.Vn=function(t,e){var r=g.BufferUtil.b(t,e);return this.Ln(r)},i.prototype.Wn=function(t,e){var r=g.BufferUtil.b(t,e);return this.Nn(r)},i.prototype.k=function(t,e){var r=g.BufferUtil.b(t,e);return this.Qn(r)},i.prototype.Xn=function(t,e){var r=g.BufferUtil.b(t,e);return this.Rn(r)},i.prototype.l=function(t,e){return this.L(t,g.BufferUtil.a(e))},i.prototype.Yn=function(t,e){return this.L(t,g.BufferUtil.En(e))},i.prototype.y=function(t,e){return this.L(t,g.BufferUtil._(e))},i.prototype.w=function(t,e){return this.L(t,g.BufferUtil.Mn(e))},i.prototype.v=function(t,e){return this.L(t,g.BufferUtil.s(e))},i.prototype.Zn=function(t,e){return this.L(t,g.BufferUtil.An(e))},i.prototype.U=function(t,e){return this.L(t,g.BufferUtil.o(e))},i.prototype.$n=function(t,e){return this.L(t,g.BufferUtil.Hn(e))},i.prototype.L=function(t,e){return this._buf.set(e,t),e.length},i.prototype.ti=function(t,e){return this.Zn(t,e.length)+this.L(t+4,e)},i.prototype.ni=function(t,e){return this.Yn(t,e.length)+this.L(t+1,e)},i.prototype.ii=function(t,e){return this.w(t,e.length)+this.L(t+2,e)},i.prototype.ri=function(t,e){return this.L(t,e)+this.Yn(t+e.length,0)},i.prototype.ui=function(t,e,r){return this.ti(t,g.BufferUtil.b(e,r))},i.prototype.fi=function(t,e,r){return this.ni(t,g.BufferUtil.b(e,r))},i.prototype.ei=function(t,e,r){return this.ii(t,g.BufferUtil.b(e,r))},i.prototype.si=function(t,e,r){return this.ri(t,g.BufferUtil.b(e,r))},i.prototype.e=function(t){return g.BufferUtil.fn(this.p(t,1))},i.prototype.M=function(t){return g.BufferUtil.on(this.p(t,1))},i.prototype.r=function(t){return g.BufferUtil.cn(this.p(t,2))},i.prototype.oi=function(t){return g.BufferUtil.ln(this.p(t,2))},i.prototype.t=function(t){return g.BufferUtil._n(this.p(t,4))},i.prototype.hi=function(t){return g.BufferUtil.an(this.p(t,4))},i.prototype.n=function(t){return g.BufferUtil.vn(this.p(t,8))},i.prototype.ci=function(t){return g.BufferUtil.gn(this.p(t,8))},i.prototype.u=function(t){return g.BufferUtil.wn(this.p(t,4))},i.prototype.i=function(t){return g.BufferUtil.Bn(this.p(t,8))},i.prototype.p=function(t,e){return this._buf.subarray(t,t+e)},i.prototype.li=function(t){var e=this.hi(t);return this.p(t+4,e)},i.prototype._i=function(t){var e=this.M(t);return this.p(t+1,e)},i.prototype.bi=function(t){var e=this.oi(t);return this.p(t+2,e)},i.prototype.ai=function(t){for(var e=0;this.M(t)!==0;)t++,e++;return this.p(t-e,e)},i.prototype.Ui=function(t,e){return g.BufferUtil.G(this.li(t),e)},i.prototype.vi=function(t,e){return g.BufferUtil.G(this._i(t),e)},i.prototype.mi=function(t,e){return g.BufferUtil.G(this.bi(t),e)},i.prototype.gi=function(t,e){return g.BufferUtil.G(this.ai(t),e)},i.prototype.tn=function(t){var e,r=this._buf.length;this._writeOff+t>r&&(e=Buffer.alloc(2*r),this._buf=e.fill(this._buf,0,r));for(var n=0;n<t;n++)this._buf.writeUInt8(0,this._writeOff++);return this},i}();ge.DmBuffer=wc});var Po=E($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});var Rc=function(){function i(){}return i.VERSION="7.6.0.0",i.BUILD_DATE="2018.10.32",i.SVN="",i.VERSION_LOWEST_DATABASE="7.0.0.9",i.VERSION_MALINI2="8.0.0.73",i.VERSION_EXECUTE2="7.1.2.128",i.VERSION_LOB_EMPTY_COMP_ORCL="7.1.5.144",i.VERSION_LOB_GET_DATA_ARR="7.1.6.123",i}();$n.Driver=Rc});var Uo=E(Or=>{"use strict";var Nc=Or&&Or.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Or,"__esModule",{value:!0});var Ir=V(),U=D(),Ar=Po(),Bc=R(),yn=fn(),Mc=function(i){function t(e,r){var n=i.call(this,e,Ir.Msg.Vt,null,r)||this;return n.at=e.at,n}return Nc(t,i),t.prototype.te=function(){var e,r=this.at.getServerEncoding();this.sr=this.at.conn_prop_uKeyName?1:0,this.mt.v(t.hr,0),this.mt.v(t.nr,this.at.conn_prop_compress),this.mt.l(t._r,this.at.conn_prop_loginEncrypt?1:0),this.mt.l(t.or,this.at.conn_prop_loginEncrypt?2:0),this.mt.l(t.cr,this.at.conn_prop_isBdtaRS?U.Const.RS_BDTA:U.Const.RS_ROW),this.mt.l(t.ur,this.at.conn_prop_compressID),this.mt.l(t.vr,this.at.conn_prop_loginCertificate!==""?1:0),this.mt.l(t.ar,0),this.mt.l(t.dr,1),this.mt.w(t.fr,this.at.msgVersion),this.mt.Vn(Ar.Driver.VERSION,r),this.mt.In(0),this.sr,this.at.conn_prop_loginEncrypt&&(e=this.vs.Nt(),this.mt.Ln(e))},t.prototype.Vs=function(){this.mt.Ut(Ir.Msg.lt)},t.prototype.ee=function(){switch(this.at.sslEncrypt=this.mt.t(t.lr),this.mt.t(t.gr),this.mt.t(t.mr)){case 1:this.at.serverEncoding=U.Const.ENCODING_UTF8;break;case 2:this.at.serverEncoding=U.Const.ENCODING_EUCKR;break;case 3:this.at.serverEncoding=U.Const.ENCODING_GB18030}this.at.conn_prop_compress=this.mt.t(t.Ur);var e=this.mt.e(t.br),r=this.mt.e(t.pr);this.at.conn_prop_isBdtaRS=0<this.mt.e(t.qr),this.at.conn_prop_compressID=this.mt.e(t.xr),this.vs.st=this.mt.e(t.jr)===1,this.at.newClientType=this.mt.e(t.wr)==1,this.at.msgVersion=this.mt.oi(t.MSG_RES_STARTUP_PROTOCOL_VERSION),this.$s();var n=this.at.getServerEncoding(),o=this.mt.Pn(n);if(yn.DriverUtil.compareDBVersion(o,Ar.Driver.VERSION_LOWEST_DATABASE)<0)throw Bc.DBError.ECJS_ERR_SERVER_VERSION();this.at.malini2=0<yn.DriverUtil.compareDBVersion(o,Ar.Driver.VERSION_MALINI2),this.at.execute2=0<yn.DriverUtil.compareDBVersion(o,Ar.Driver.VERSION_EXECUTE2),this.at.lobEmptyCompOrcl=0<yn.DriverUtil.compareDBVersion(o,Ar.Driver.VERSION_LOB_EMPTY_COMP_ORCL),this.sr;var a=!(this.Ft=-1),c=!1;return this.Ot=-1,0<r&&(this.Ft=this.mt.N()),0<e&&(this.Ft===-1?a=!0:c=!0,this.jt=this.mt.pn()),r===2&&(this.Ot=this.mt.N()),this.vs.ot=a,this.vs.ut=c,this},t.hr=Ir.Msg.os,t.nr=t.hr+U.Const.ULINT_SIZE,t._r=t.nr+U.Const.ULINT_SIZE,t.or=t._r+U.Const.BYTE_SIZE,t.cr=t.or+U.Const.BYTE_SIZE,t.ur=t.cr+U.Const.BYTE_SIZE,t.vr=t.ur+U.Const.BYTE_SIZE,t.ar=t.vr+U.Const.BYTE_SIZE,t.dr=t.ar+U.Const.BYTE_SIZE,t.fr=t.dr+U.Const.BYTE_SIZE,t.lr=Ir.Msg.os,t.gr=t.lr+U.Const.ULINT_SIZE,t.mr=t.gr+U.Const.ULINT_SIZE,t.Ur=t.mr+U.Const.ULINT_SIZE,t.Or=t.Ur+U.Const.ULINT_SIZE,t.br=t.Or+U.Const.ULINT_SIZE,t.pr=t.br+U.Const.BYTE_SIZE,t.qr=t.pr+U.Const.BYTE_SIZE,t.xr=t.qr+U.Const.BYTE_SIZE,t.kr=t.xr+U.Const.BYTE_SIZE,t.jr=t.kr+U.Const.BYTE_SIZE,t.wr=t.jr+U.Const.USINT_SIZE,t.MSG_RES_STARTUP_PROTOCOL_VERSION=t.wr+U.Const.BYTE_SIZE,t}(Ir.Msg);Or.Startup=Mc});var Fo=E(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});var Pc=require("crypto"),Uc=require("fs"),Fc=require("constants"),xc=function(){function i(t){try{this.pubKey=Uc.readFileSync(t,"utf8")}catch(e){throw new Error("Init public cipher error: "+e)}}return i.prototype.encrypt=function(t){try{return Pc.publicEncrypt({key:this.pubKey,padding:Fc.RSA_PKCS1_PADDING},t)}catch(e){throw new Error("Cert encrypt error: "+e)}},i}();ti.RSACipher=xc});var qo=E(Lr=>{"use strict";var kc=Lr&&Lr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Lr,"__esModule",{value:!0});var ei=V(),w=D(),xo=ve(),ko=J(),Yo=R(),Yc=Fo(),qc=function(i){function t(e,r){var n=i.call(this,e,ei.Msg.Ms,null,r)||this;return n.ls=!1,n.at=e.at,n}return kc(t,i),t.prototype.te=function(){var e=this.at.getServerEncoding();this.mt.v(t.Hs,this.at.newClientType?w.Const.SESS3_CLT_NODE:w.Const.SESS3_CLT_JDBC),this.mt.v(t.Fs,xo.Connection.node2dbIsoLevel(this.at.isoLevel)),this.mt.v(t.Ss,this.at.conn_prop_locale),this.mt.y(t.gs,this.at.conn_prop_localTimezone),this.mt.l(t.qs,this.at.readOnly?w.Const.TRX_ACCESS_MODE_READ_ONLY:w.Const.TRX_ACCESS_MODE_READ_WRITE),this.mt.v(t.Ds,this.at.conn_prop_sessionTimeout),this.mt.l(t.Os,this.at.conn_prop_mppLocal?1:0),this.mt.l(t.Ys,this.at.conn_prop_rwSeparate?1:0),this.mt.l(t.ms,this.at.newLobFlag?1:0),this.mt.l(t.As,this.at.conn_prop_osAuthType),this.vs.ct;var r,n=ko.BufferUtil.b(this.at.conn_prop_user,e),o=ko.BufferUtil.b(this.at.conn_prop_pwd,e);if(n.length>w.Const.MAX_NAME_LEN)throw Yo.DBError.ECJS_USERNAME_TOO_LONG();if(o.length>w.Const.MAX_NAME_LEN)throw Yo.DBError.ECJS_PASSWORD_TOO_LONG();this.vs.ot&&this.at.conn_prop_loginCertificate?(n=(r=new Yc.RSACipher(this.at.conn_prop_loginCertificate)).encrypt(n),o=r.encrypt(o)):this.vs.ot&&(n=this.vs.bt.encrypt(n,!1),o=this.vs.bt.encrypt(o,!1)),this.mt.Ln(n),this.mt.Ln(o),this.mt.Vn(this.at.conn_prop_appName,e),this.mt.Vn(this.at.conn_prop_osName,e),this.mt.Vn(w.Const.HOST_NAME,e),this.mt.In(this.at.rwStandby?1:0)},t.prototype.ee=function(){var e=this.at.getServerEncoding();this.at.maxRowSize=this.mt.t(t.ws),this.at.ddlAutoCommit=this.mt.e(t.xs)==1,this.at.isoLevel=xo.Connection.db2nodeIsoLevel(this.mt.t(t.Is)),this.at.conn_prop_caseSensitive=this.mt.e(t.Ts)==1,this.mt.e(t.Us),this.at.svrStat=this.mt.r(t.Zs),this.at.svrMode=this.mt.r(t.js),this.at.constParaOpt=this.mt.e(t.Cs)==1,this.at.dbTimezone=this.mt.r(t.Ns),this.at.newLobFlag=this.mt.e(t.Ls)==1,this.at.conn_prop_bufPrefetch===0&&(this.at.conn_prop_bufPrefetch=this.mt.t(t.ks)),this.mt.r(t.zs),this.at.dscControl=this.mt.e(t.Bs)===1,this.mt.Pn(e);var r,n=this.mt.N();return n===0&&0<this.at.msgVersion?this.at.schema=this.at.conn_prop_user.toUpperCase():this.at.schema=this.mt.xn(n,e),this.mt.Pn(e),this.mt.Pn(e),this.mt.N(),this.mt.N(),this.mt.N(),this.at.guid=this.mt.Pn(e),this.mt.Pn(e),this.mt.e(t.Es)===1&&(this.at.standbyHost=this.mt.Pn(e),this.at.standbyPort=this.mt.N(),this.at.standbyCount=this.mt.x()),0<this.mt.Zt()&&(this.at.sessionID=this.mt.Un()),0<this.mt.Zt()&&this.mt.un()==1&&(this.at.formatDate="DD-MON-YY",this.at.formatTime="HH12.MI.SS.FF6 AM",this.at.formatTimestamp="DD-MON-YY HH12.MI.SS.FF6 AM",this.at.formatTimestampTZ="DD-MON-YY HH12.MI.SS.FF6 AM +TZH:TZM",this.at.formatTimeTZ="HH12.MI.SS.FF6 AM +TZH:TZM"),0<this.mt.Zt()&&((r=this.mt.Sn(e))&&(this.at.formatDate=r),(r=this.mt.Sn(e))&&(this.at.formatTime=r),(r=this.mt.Sn(e))&&(this.at.formatTimestamp=r),(r=this.mt.Sn(e))&&(this.at.formatTimestampTZ=r),(r=this.mt.Sn(e))&&(this.at.formatTimeTZ=r)),this.at},t.Hs=ei.Msg.os,t.Fs=t.Hs+w.Const.ULINT_SIZE,t.Ss=t.Fs+w.Const.ULINT_SIZE,t.qs=t.Ss+w.Const.ULINT_SIZE,t.gs=t.qs+w.Const.BYTE_SIZE,t.Ds=t.gs+w.Const.USINT_SIZE,t.Os=t.Ds+w.Const.ULINT_SIZE,t.Ys=t.Os+w.Const.BYTE_SIZE,t.ms=t.Ys+w.Const.BYTE_SIZE,t.As=t.ms+w.Const.BYTE_SIZE,t.Gs=(t.ws=t.os)+w.Const.ULINT_SIZE,t.xs=t.Gs+w.Const.ULINT_SIZE,t.Is=t.xs+w.Const.BYTE_SIZE,t.Ts=t.Is+w.Const.ULINT_SIZE,t.Us=t.Ts+w.Const.BYTE_SIZE,t.js=t.Us+w.Const.BYTE_SIZE,t.Zs=t.js+w.Const.USINT_SIZE,t.Cs=t.Zs+w.Const.USINT_SIZE,t.Ns=t.Cs+w.Const.BYTE_SIZE,t.Es=t.Ns+w.Const.USINT_SIZE,t.Ls=t.Es+w.Const.BYTE_SIZE,t.ks=t.Ls+w.Const.BYTE_SIZE,t.zs=t.ks+w.Const.ULINT_SIZE,t.Bs=t.zs+w.Const.USINT_SIZE,t}(ei.Msg);Lr.Login=qc});var Dt=E(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});var Dr=D(),Vc=function(){function i(){}return i.isComplexType=function(t,e){return t===this.BLOB&&e===this.COMPLEX_SCALE||t===this.ARRAY||t===this.SARRAY||t===this.CLASS||t===this.PLTYPE_RECORD},i.isLocalTimeZone=function(t,e){return t===i.DATETIME&&(e&i.LOCAL_TIME_ZONE_SCALE_MASK)!=0},i.getLocalTimeZoneScale=function(t,e){return e&~i.LOCAL_TIME_ZONE_SCALE_MASK},i.emptyStringToNull=function(t){switch(t){case i.BOOLEAN:case i.BIT:case i.TINYINT:case i.SMALLINT:case i.INT:case i.BIGINT:case i.REAL:case i.DOUBLE:case i.DECIMAL:case i.DATE:case i.TIME:case i.DATETIME:case i.INTERVAL_DT:case i.INTERVAL_YM:case i.TIME_TZ:case i.DATETIME_TZ:return!0;default:return!1}},i.isFloat=function(t,e){return t===i.DECIMAL&&e===i.FLOAT_SCALE_MASK},i.getFloatPrec=function(t){return Math.round(.30103*t)+1},i.getFloatScale=function(t){return t&~i.FLOAT_SCALE_MASK},i.isBFile=function(t,e,r){return t===i.VARCHAR&&e===i.BFILE_PREC&&r===i.BFILE_SCALE},i.checkBFileStr=function(t){var e=t.trim().split(":");return e.length===2&&!(128<e[0].length||256<e[1].length)},i.CHAR=0,i.VARCHAR2=1,i.VARCHAR=2,i.BIT=3,i.TINYINT=5,i.SMALLINT=6,i.INT=7,i.BIGINT=8,i.DECIMAL=9,i.REAL=10,i.DOUBLE=11,i.BLOB=12,i.BOOLEAN=13,i.DATE=14,i.TIME=15,i.DATETIME=16,i.BINARY=17,i.VARBINARY=18,i.CLOB=19,i.INTERVAL_YM=20,i.INTERVAL_DT=21,i.TIME_TZ=22,i.DATETIME_TZ=23,i.NULL=25,i.ANY=31,i.STAR_ALL=32,i.STAR=33,i.RECORD=40,i.TYPE=41,i.TYPE_REF=42,i.UNKNOWN=54,i.ARRAY=117,i.CLASS=119,i.CURSOR=120,i.PLTYPE_RECORD=121,i.SARRAY=122,i.CURSOR_ORACLE=-10,i.BIT_PREC=Dr.Const.BYTE_SIZE,i.INT_PREC=Dr.Const.ULINT_SIZE,i.BIGINT_PREC=Dr.Const.LINT64_SIZE,i.DOUBLE_PREC=8,i.VARCHAR_PREC=8188,i.VARBINARY_PREC=8188,i.BLOB_PREC=Dr.Const.INT32_MAX,i.CLOB_PREC=Dr.Const.INT32_MAX,i.NULL_PREC=0,i.LOCAL_TIME_ZONE_SCALE_MASK=4096,i.BFILE_PREC=512,i.BFILE_SCALE=6,i.COMPLEX_SCALE=5,i.CURRENCY_PREC=19,i.CURRENCY_SCALE=4,i.FLOAT_SCALE_MASK=129,i}();ri.DBType=Vc});var Cr=E(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});var Hc=function(){this.typeName="",this.type=0,this.prec=0,this.scale=0,this.name="",this.tableName="",this.schemaName="",this.nullable=!1,this.identity=!1,this.readonly=!1,this.baseName="",this.lob=!1,this.isBdta=!1};ni.Column=Hc});var ii=E(wr=>{"use strict";var Gc=wr&&wr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(wr,"__esModule",{value:!0});var zc=D(),se=Dt(),Zc=Cr(),Qc=ve(),Jc=require("util"),jc=be(),Wc=function(i){function t(e,r,n){var o=i.call(this)||this;if(o.dtype=se.DBType.DATETIME,o.scale=6,e instanceof Buffer&&r instanceof Zc.Column&&n instanceof Qc.Connection)switch(o.dt=jc.DateUtil.decode(e,r.isBdta,r.type,r.scale,n.conn_prop_localTimezone,n.dbTimezone),o.dtype=r.type,o.scale=se.DBType.isLocalTimeZone(r.type,r.scale)?se.DBType.getLocalTimeZoneScale(r.type,r.scale):r.scale,(o=i.call(this,o.dt[t.OFFSET_YEAR],o.dt[t.OFFSET_MONTH],o.dt[t.OFFSET_DAY],o.dt[t.OFFSET_HOUR],o.dt[t.OFFSET_MINUTE],o.dt[t.OFFSET_SECOND],o.dt[t.OFFSET_MICROSECOND])||this).oracleDateLanguage=n.oracleDateLanguage,r.type){case se.DBType.DATE:o.oracleFormatPattern=n.formatDate;break;case se.DBType.TIME:o.oracleFormatPattern=n.formatTime;break;case se.DBType.TIME_TZ:o.oracleFormatPattern=n.formatTimeTZ;break;case se.DBType.DATETIME:o.oracleFormatPattern=n.formatTimestamp;break;case se.DBType.DATETIME_TZ:o.oracleFormatPattern=n.formatTimestampTZ}else{if(!Jc.isArray(e)||typeof r!="number"||typeof n!="number")throw new Error("Fatal error occured in Timestamp");o.dt=e,o.dtype=r,o.scale=n,o=i.call(this,e[t.OFFSET_YEAR],e[t.OFFSET_MONTH],e[t.OFFSET_DAY],e[t.OFFSET_HOUR],e[t.OFFSET_MINUTE],e[t.OFFSET_SECOND],e[t.OFFSET_MICROSECOND])||this}return o}return Gc(t,i),t.MiSeconds_1900_1970=22090176e5,t.MAX_YEAR=9999,t.MIN_YEAR=-4712,t.OFFSET_YEAR=0,t.OFFSET_MONTH=1,t.OFFSET_DAY=2,t.OFFSET_HOUR=3,t.OFFSET_MINUTE=4,t.OFFSET_SECOND=5,t.OFFSET_MICROSECOND=6,t.OFFSET_TIMEZONE=7,t.DT_LEN=8,t.INVALID_VALUE=zc.Const.INT32_MIN,t}(Date);wr.Timestamp=Wc});var si=E(Ae=>{"use strict";var vt=Ae&&Ae.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),oi=Ae&&Ae.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ae,"__esModule",{value:!0});var S=ii(),z=R(),Ie=D(),ct=Bt(),Xc=be(),Kc=function(){function i(){this.Y=new $c(this),this.HH12=new tu(this),this.HH24=new eu(this),this.MI=new ru(this),this.SS=new nu(this),this.AM=new uu(this),this.Month=new su(this),this.Mon=new au(this),this.MM=new iu(this),this.DD=new ou(this),this.TZH=new Vo(this),this.TZM=new Ho(this),this.F=new cu(this),this.formatElementList=new Array,this.language=Ie.Const.LANGUAGE_CN,this.PM=!1,this.TZNegative=!1}return i.parse=function(t,e,r){var n=new i;return n.setPattern(e),n.language=r,n.parse(t)},i.format=function(t,e,r){var n=new i;return n.setPattern(e),n.language=r,n.format(t)},i.prototype.setPattern=function(t){t!==this.pattern&&(this.pattern=t,this.formatElementList=[],this.analysePattern(t))},i.prototype.parse=function(t){var e,r;this.clearBeforeParse();var n=new Array(S.Timestamp.DT_LEN),o=new Date;n[S.Timestamp.OFFSET_YEAR]=o.getFullYear(),n[S.Timestamp.OFFSET_MONTH]=o.getMonth()+1,n[S.Timestamp.OFFSET_DAY]=o.getDate(),n[S.Timestamp.OFFSET_TIMEZONE]=S.Timestamp.INVALID_VALUE;var a=0;try{t=t.trim();try{for(var c=oi(this.formatElementList),u=c.next();!u.done;u=c.next()){for(var h=u.value;t.charAt(a)===" "&&h.toString()!==" ";)a++;h instanceof dt?a=h.parse(t,a,n):a+=h.toString().length}}catch(s){e={error:s}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(a<t.length)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();this.PM&&(n[S.Timestamp.OFFSET_HOUR]=(n[S.Timestamp.OFFSET_HOUR]+12)%24),this.TZNegative&&(n[S.Timestamp.OFFSET_TIMEZONE]=-n[S.Timestamp.OFFSET_TIMEZONE])}catch(s){throw s instanceof z.DBError&&(s.errCode===z.DBError.ECJS_INVALID_DATETIME_VALUE().errCode||s.errCode===z.DBError.ECJS_INVALID_DATETIME_FORMAT().errCode)?s:z.DBError.ECJS_INVALID_DATETIME_FORMAT(s+"")}if(n[S.Timestamp.OFFSET_DAY]>Xc.DateUtil.getDaysOfMonth(n[S.Timestamp.OFFSET_YEAR],n[S.Timestamp.OFFSET_MONTH])||n[S.Timestamp.OFFSET_DAY]<1||n[S.Timestamp.OFFSET_TIMEZONE]!==S.Timestamp.INVALID_VALUE&&(840<n[S.Timestamp.OFFSET_TIMEZONE]||n[S.Timestamp.OFFSET_TIMEZONE]<=-780))throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n},i.prototype.format=function(t){var e,r,n="",o=!1;try{for(var a=oi(this.formatElementList),c=a.next();!c.done;c=a.next()){var u=c.value;!o&&(u instanceof Vo||u instanceof Ho)&&(o=!0,n+=t[S.Timestamp.OFFSET_TIMEZONE]<0?"-":"+"),n+=u instanceof dt?u.format(t):u.toString()}}catch(h){e={error:h}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return n},i.prototype.clearBeforeParse=function(){this.PM=!1,this.TZNegative=!1},i.prototype.analysePattern=function(t){for(var e,r,n,o=(t=t.trim()).length,a=new Array(0),c=0,u=0;u<o;u++)n=t.charAt(u),/(^[A-Za-z0-9]$)/.test(n)?u===o-1&&a.push(t.substring(c,u+1)):(c<u&&a.push(t.substring(c,u)),a.push(n),c=u+1);try{for(var h=oi(a),s=h.next();!s.done;s=h.next()){var l=s.value;if(l.length!==1||/(^[A-Za-z0-9]$)/.test(l.charAt(0)))for(var _;l!=="";){for(u=l.length;0<u;u--){_=l.substring(0,u);var f,y=this.getFormatElement(_);if(y){y!==this.TZH&&y!==this.TZM||(f=this.formatElementList[this.formatElementList.length-1].toString())!=="+"&&f!=="-"||this.formatElementList.pop(),this.formatElementList.push(y),l=u==l.length?"":l.substring(u,l.length);break}}if(u==0){this.formatElementList.push(l);break}}else this.formatElementList.push(l)}}catch(T){e={error:T}}finally{try{s&&!s.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}return this.formatElementList},i.prototype.getFormatElement=function(t){if(t.toUpperCase()==="HH"||t.toUpperCase()==="HH12")return this.HH12;if(t.toUpperCase()==="HH24")return this.HH24;if(t.toUpperCase()==="MI")return this.MI;if(t.toUpperCase()==="SS")return this.SS;if(t.toUpperCase()==="AM"||t.toUpperCase()==="A.M."||t.toUpperCase()==="PM"||t.toUpperCase()==="P.M.")return this.AM;if(t==="MONTH")return this.Month.upperCase=!0,this.Month.lowerCase=!1,this.Month;if(t==="month")return this.Month.upperCase=!1,this.Month.lowerCase=!0,this.Month;if(ct.StringUtil.equalsIgnoreCase(t,"Month"))return this.Month.upperCase=!1,this.Month.lowerCase=!1,this.Month;if(t==="MON")return this.Mon.upperCase=!0,this.Mon.lowerCase=!1,this.Mon;if(t==="mon")return this.Mon.upperCase=!1,this.Mon.lowerCase=!0,this.Mon;if(ct.StringUtil.equalsIgnoreCase(t,"Mon"))return this.Mon.upperCase=!1,this.Mon.lowerCase=!1,this.Mon;if(t.toUpperCase()==="MM")return this.MM;if(t.toUpperCase()==="DD")return this.DD;if(t.toUpperCase()==="TZH")return this.TZH;if(t.toUpperCase()==="TZM")return this.TZM;if(t.startsWith("Y")||t.startsWith("y"))return this.Y.len=t.length,this.Y;if(t.startsWith("F")||t.startsWith("f"))try{var e=(t=t.toUpperCase()).lastIndexOf("F")+1,r=e<t.length?parseInt(t.substring(e)):9;return this.F.len=r,this.F}catch{}},i}();Ae.OracleDateFormat=Kc;var dt=function(i){this.oraFormat=i},$c=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.len=4,e}return vt(t,i),t.prototype.parse=function(e,r,n){for(var o,a=0,c=r;c<r+this.len&&c<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(c));c++)a++;return e=e.substr(r,a),this.len<4?(o=n[S.Timestamp.OFFSET_YEAR].toString(),n[S.Timestamp.OFFSET_YEAR]=parseInt(o.substring(0,4-this.len)+e)):n[S.Timestamp.OFFSET_YEAR]=parseInt(e),r+a},t.prototype.format=function(e){return Qt(e[S.Timestamp.OFFSET_YEAR],this.len)},t}(dt),tu=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return vt(t,i),t.prototype.parse=function(e,r,n){for(var o=0,a=r;a<r+2&&a<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(a));a++)o++;e=e.substr(r,o);var c=parseInt(e);if(12<c||c<1)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n[S.Timestamp.OFFSET_HOUR]=c,r+o},t.prototype.format=function(e){var r=e[S.Timestamp.OFFSET_HOUR];return Qt(12<r||r==0?Math.abs(r-12):r,2)},t}(dt),eu=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return vt(t,i),t.prototype.parse=function(e,r,n){for(var o=0,a=r;a<r+2&&a<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(a));a++)o++;e=e.substr(r,o);var c=parseInt(e);if(23<c||c<0)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n[S.Timestamp.OFFSET_HOUR]=c,r+o},t.prototype.format=function(e){return Qt(e[S.Timestamp.OFFSET_HOUR],2)},t}(dt),ru=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return vt(t,i),t.prototype.parse=function(e,r,n){for(var o=0,a=r;a<r+2&&a<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(a));a++)o++;e=e.substr(r,o);var c=parseInt(e);if(59<c||c<0)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n[S.Timestamp.OFFSET_MINUTE]=c,r+o},t.prototype.format=function(e){return Qt(e[S.Timestamp.OFFSET_MINUTE],2)},t}(dt),nu=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return vt(t,i),t.prototype.parse=function(e,r,n){for(var o=0,a=r;a<r+2&&a<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(a));a++)o++;e=e.substr(r,o);var c=parseInt(e);if(59<c||c<0)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n[S.Timestamp.OFFSET_SECOND]=c,r+o},t.prototype.format=function(e){return Qt(e[S.Timestamp.OFFSET_SECOND],2)},t}(dt),iu=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return vt(t,i),t.prototype.parse=function(e,r,n){for(var o=0,a=r;a<r+2&&a<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(a));a++)o++;if(e=e.substr(r,o),!ct.StringUtil.isDigit(e))throw z.DBError.ECJS_INVALID_DATETIME_FORMAT();var c=parseInt(e);if(12<c||c<1)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n[S.Timestamp.OFFSET_MONTH]=c,r+o},t.prototype.format=function(e){return Qt(e[S.Timestamp.OFFSET_MONTH],2)},t}(dt),ou=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return vt(t,i),t.prototype.parse=function(e,r,n){for(var o=0,a=r;a<r+2&&a<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(a));a++)o++;e=e.substr(r,o);var c=parseInt(e);if(31<c||c<1)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n[S.Timestamp.OFFSET_DAY]=c,r+o},t.prototype.format=function(e){return Qt(e[S.Timestamp.OFFSET_DAY],2)},t}(dt),su=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.upperCase=!1,e.lowerCase=!1,e.nameList=["","January","February","March","April","May","June","July","August","September","October","November","December"],e}return vt(t,i),t.prototype.parse=function(e,r,n){if(this.oraFormat.language===Ie.Const.LANGUAGE_CN){var o=e.indexOf("\u6708",r);if(o===-1)throw z.DBError.ECJS_INVALID_DATETIME_FORMAT();if(12<(a=parseInt(e.substring(r,o)))||a<1)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n[S.Timestamp.OFFSET_MONTH]=a,o+1}e=e.substring(r).toLowerCase();for(var a=0,c=1;c<this.nameList.length;c++)if(e.toUpperCase().startsWith(this.nameList[c].toUpperCase())){a=c;break}if(a===0)throw z.DBError.ECJS_INVALID_DATETIME_FORMAT();return n[S.Timestamp.OFFSET_MONTH]=a,r+this.nameList[a].length},t.prototype.format=function(e){var r=e[S.Timestamp.OFFSET_MONTH];return this.oraFormat.language===Ie.Const.LANGUAGE_CN?r+"\u6708":this.upperCase?this.nameList[r].toUpperCase():this.lowerCase?this.nameList[r].toLowerCase():this.nameList[r]},t}(dt),au=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.upperCase=!1,e.lowerCase=!1,e.nameList=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e}return vt(t,i),t.prototype.parse=function(e,r,n){if(this.oraFormat.language===Ie.Const.LANGUAGE_CN){var o=e.indexOf("\u6708",r);if(o===-1)throw z.DBError.ECJS_INVALID_DATETIME_FORMAT();if(12<(a=parseInt(e.substring(r,o)))||a<1)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n[S.Timestamp.OFFSET_MONTH]=a,o+1}e=e.substring(r,r+3);for(var a=0,c=1;c<this.nameList.length;c++)if(ct.StringUtil.equalsIgnoreCase(e,this.nameList[c])){a=c;break}if(a===0)throw z.DBError.ECJS_INVALID_DATETIME_FORMAT();return n[S.Timestamp.OFFSET_MONTH]=a,r+3},t.prototype.format=function(e){var r=e[S.Timestamp.OFFSET_MONTH];return this.oraFormat.language===Ie.Const.LANGUAGE_CN?r+"\u6708":this.upperCase?this.nameList[r].toUpperCase():this.lowerCase?this.nameList[r].toLowerCase():this.nameList[r]},t}(dt),cu=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.len=6,e}return vt(t,i),t.prototype.parse=function(e,r,n){for(var o=0,a=r;a<r+this.len&&a<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(a));a++)o++;e=e.substr(r,o);var c=parseInt(e),c=o<6?c*Math.pow(10,6-o):c/Math.pow(10,o-6);return n[S.Timestamp.OFFSET_MICROSECOND]=c,r+o},t.prototype.format=function(e){return hu(e[S.Timestamp.OFFSET_MICROSECOND],this.len)},t}(dt),Vo=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return vt(t,i),t.prototype.parse=function(e,r,n){e.charAt(r)=="+"?r+=1:e.charAt(r)=="-"&&(r+=1,this.oraFormat.TZNegative=!0);for(var o=0,a=r;a<r+2&&a<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(a));a++)o++;e=e.substr(r,o);var c=parseInt(e);if(23<c||c<0)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return c*=60,n[S.Timestamp.OFFSET_TIMEZONE]=n[S.Timestamp.OFFSET_TIMEZONE]===S.Timestamp.INVALID_VALUE?c:n[S.Timestamp.OFFSET_TIMEZONE]+c,r+o},t.prototype.format=function(e){return Qt(e[S.Timestamp.OFFSET_TIMEZONE]!==S.Timestamp.INVALID_VALUE?Math.abs(e[S.Timestamp.OFFSET_TIMEZONE])/60:0,2)},t}(dt),Ho=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return vt(t,i),t.prototype.parse=function(e,r,n){e.charAt(r)=="+"?r+=1:e.charAt(r)=="-"&&(r+=1,this.oraFormat.TZNegative=!0);for(var o=0,a=r;a<r+2&&a<e.length&&ct.StringUtil.isLetterOrDigit(e.charAt(a));a++)o++;e=e.substr(r,o);var c=parseInt(e);if(59<c||c<0)throw z.DBError.ECJS_INVALID_DATETIME_VALUE();return n[S.Timestamp.OFFSET_TIMEZONE]=n[S.Timestamp.OFFSET_TIMEZONE]===S.Timestamp.INVALID_VALUE?c:n[S.Timestamp.OFFSET_TIMEZONE]+c,r+o},t.prototype.format=function(e){return Qt(e[S.Timestamp.OFFSET_TIMEZONE]!=S.Timestamp.INVALID_VALUE?Math.abs(e[S.Timestamp.OFFSET_TIMEZONE])%60:0,2)},t}(dt),uu=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return vt(t,i),t.prototype.parse=function(e,r,n){return e=e.substring(r,r+2),this.oraFormat.PM=this.oraFormat.language===Ie.Const.LANGUAGE_CN?!!ct.StringUtil.equalsIgnoreCase("\u4E0B\u5348",e):!!ct.StringUtil.equalsIgnoreCase("PM",e),r+2},t.prototype.format=function(e){var r=e[S.Timestamp.OFFSET_HOUR];return this.oraFormat.language===Ie.Const.LANGUAGE_CN?12<r?"\u4E0B\u5348":"\u4E0A\u5348":12<r?"PM":"AM"},t}(dt);function Qt(i,t){var e=Math.pow(10,t);return e<=i&&(i%=e),(i+=e).toString().substring(1)}function hu(i,t){var e=null,e=i<10?"00000"+i:i<100?"0000"+i:i<1e3?"000"+i:i<1e4?"00"+i:i<1e5?"0"+i:i.toString();return t<6?e.substring(0,t):e}});var be=E(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});var d=ii(),kt=J(),ut=Dt(),j=R(),lu=si(),fu=function(){function i(){}return i.encode=function(t,e,r,n){if(ut.DBType.isLocalTimeZone(e,r)&&t[d.Timestamp.OFFSET_TIMEZONE]!=d.Timestamp.INVALID_VALUE&&t[d.Timestamp.OFFSET_TIMEZONE]!=n&&i.transformTZ(t,t[d.Timestamp.OFFSET_TIMEZONE],n),t[d.Timestamp.OFFSET_YEAR]<d.Timestamp.MIN_YEAR||t[d.Timestamp.OFFSET_YEAR]>d.Timestamp.MAX_YEAR)throw j.DBError.EC_DATETIME_OVERFLOW();var o=t[d.Timestamp.OFFSET_YEAR],a=t[d.Timestamp.OFFSET_MONTH],c=t[d.Timestamp.OFFSET_DAY],u=t[d.Timestamp.OFFSET_HOUR],h=t[d.Timestamp.OFFSET_MINUTE],s=t[d.Timestamp.OFFSET_SECOND],l=t[d.Timestamp.OFFSET_MICROSECOND],_=t[d.Timestamp.OFFSET_TIMEZONE]==d.Timestamp.INVALID_VALUE?n:t[d.Timestamp.OFFSET_TIMEZONE];if([o,a,c,u,h,s,l,_].includes(NaN))throw j.DBError.EC_DATETIME_OVERFLOW();var f=null;if(e==ut.DBType.DATE)(f=Buffer.alloc(3))[0]=255&o,f[1]=0<=o?o>>8|(1&a)<<7:o>>8&((1&a)<<7|127),f[2]=(14&a)>>1|c<<3;else if(e==ut.DBType.DATETIME)(f=Buffer.alloc(8))[0]=255&o,f[1]=0<=o?o>>8|(1&a)<<7:o>>8&((1&a)<<7|127),f[2]=(14&a)>>1|c<<3,f[3]=u|(7&h)<<5,f[4]=(56&h)>>3|(31&s)<<3,f[5]=(32&s)>>5|(127&l)<<1,f[6]=l>>7&255,f[7]=l>>15&255;else if(e==ut.DBType.DATETIME_TZ)(f=Buffer.alloc(10))[0]=255&o,f[1]=0<=o?o>>8|(1&a)<<7:o>>8&((1&a)<<7|127),f[2]=(14&a)>>1|c<<3,f[3]=u|(7&h)<<5,f[4]=(56&h)>>3|(31&s)<<3,f[5]=(32&s)>>5|(127&l)<<1,f[6]=l>>7&255,f[7]=l>>15&255,kt.BufferUtil.y(f,8,_);else if(e==ut.DBType.TIME)(f=Buffer.alloc(5))[0]=u|(7&h)<<5,f[1]=(56&h)>>3|(31&s)<<3,f[2]=(32&s)>>5|(127&l)<<1,f[3]=l>>7&255,f[4]=l>>15&255;else{if(e!=ut.DBType.TIME_TZ)throw j.DBError.ECJS_INVALID_DATETIME_FORMAT();(f=Buffer.alloc(7))[0]=u|(7&h)<<5,f[1]=(56&h)>>3|(31&s)<<3,f[2]=(32&s)>>5|(127&l)<<1,f[3]=l>>7&255,f[4]=l>>15&255,kt.BufferUtil.y(f,5,_)}return f},i.decode=function(t,e,r,n,o,a){var c,u=e?this.dmdtDecodeBdta(t):this.dmdtDecodeFast(t);return ut.DBType.isLocalTimeZone(r,n)&&(this.transformTZ(u,a,o),n=ut.DBType.getLocalTimeZoneScale(r,n)),0<n&&n<6&&(c=Math.pow(10,6-n),u[d.Timestamp.OFFSET_MICROSECOND]=u[d.Timestamp.OFFSET_MICROSECOND]/c*c),u},i.encodeByString=function(t,e,r,n,o){var a=new Array(d.Timestamp.DT_LEN);return this.toDTFromString(t,a),this.encode(a,e,r,n)},i.encodeByDate=function(t,e,r,n,o){var a=this.toDTFromDate(t);return this.encode(a,e,r,n)},i.encodeByDateNumber=function(t,e,r,n,o){switch(e){case ut.DBType.DATETIME:var a=this.toDTFromUnix(1e3*t-d.Timestamp.MiSeconds_1900_1970);if(a[d.Timestamp.OFFSET_YEAR]<d.Timestamp.MIN_YEAR||a[d.Timestamp.OFFSET_YEAR]>d.Timestamp.MAX_YEAR)throw j.DBError.EC_DATETIME_OVERFLOW();return this.encode(a,e,r,n);case ut.DBType.TIME:return a=this.toDTFromUnix(1e3*t),this.encode(a,e,r,n);case ut.DBType.DATE:if((a=this.toDTFromUnix(24*t*60*60*1e3-d.Timestamp.MiSeconds_1900_1970))[d.Timestamp.OFFSET_YEAR]<d.Timestamp.MIN_YEAR||a[d.Timestamp.OFFSET_YEAR]>d.Timestamp.MAX_YEAR)throw j.DBError.EC_DATETIME_OVERFLOW();return this.encode(a,e,r,n);default:throw j.DBError.ECJS_DATA_CONVERTION_ERROR()}},i.toDTFromString=function(t,e){try{var r,n,o,a=null,c=null,u=null,h=null,s=0,l=0,_=0,f=0,y=0,T=0,m=0,P=void 0,st=void 0,go=0,mr=d.Timestamp.INVALID_VALUE,un=0;(t=t.trim()).startsWith("-",0)&&(t=t.substring(1).trim(),go=1);var Ot=t.split(" ");switch(Ot.length){case 3:a=Ot[0],c=Ot[1],h=Ot[2],un=ut.DBType.DATETIME_TZ;break;case 2:un=0<Ot[0].indexOf(":")?(c=Ot[0],h=Ot[1],ut.DBType.TIME_TZ):(a=Ot[0],c=Ot[1],ut.DBType.DATETIME);break;case 1:un=0<Ot[0].indexOf(":")?(c=Ot[0],ut.DBType.TIME):(a=Ot[0],ut.DBType.DATE);break;default:throw j.DBError.ECJS_INVALID_DATETIME_FORMAT()}if(a!=null&&(P=a.indexOf("-"),st=a.indexOf("-",P+1),(P<0||st<0)&&(P=t.indexOf("."),st=t.indexOf(".",P+1)),(P<0||st<0)&&(P=t.indexOf("/"),st=t.indexOf("/",P+1)),!(0<P&&0<st&&st<a.length-1)||(s=go==1?0-parseInt(a.substring(0,P))-1900:parseInt(a.substring(0,P))-1900,l=parseInt(a.substring(P+1,st))-1,_=parseInt(a.substring(st+1)),!this.checkDate(s+1900,l+1,_))))throw j.DBError.ECJS_INVALID_DATETIME_FORMAT();if(c!=null){if(r=c.indexOf(":"),n=c.indexOf(":",r+1),o=c.indexOf(".",n+1),!(0<r&&0<n&&n<c.length-1))throw j.DBError.ECJS_INVALID_DATETIME_FORMAT();if(f=parseInt(c.substring(0,r)),y=parseInt(c.substring(r+1,n)),0<o&&o<c.length-1){if(T=parseInt(c.substring(n+1,o)),9<(u=c.substring(o+1)).length||u.charAt(0)<"0"||"9"<u.charAt(0))throw j.DBError.ECJS_INVALID_DATETIME_FORMAT();u+="000000000".substring(0,9-u.length),m=parseInt(u.substring(0,6))}else{if(0<o)throw j.DBError.ECJS_INVALID_DATETIME_FORMAT();T=parseInt(c.substring(n+1))}if(24<=f||f<0||60<=y||y<0||60<=T||T<0)throw j.DBError.ECJS_INVALID_DATETIME_FORMAT()}if(h!=null){var vo=!1;h.startsWith("-")&&(vo=!0),(h.startsWith("-")||h.startsWith("+"))&&(h=h.substring(1).trim());var hn=h.split(":"),Bn=0,bo=0;switch(hn.length){case 2:Bn=parseInt(hn[0].trim()),bo=parseInt(hn[1].trim());break;case 1:Bn=parseInt(hn[0].trim());break;default:throw j.DBError.ECJS_INVALID_DATETIME_FORMAT()}if((mr=60*Bn+bo)<0||(vo&&(mr*=-1),mr<=-780||840<mr))throw j.DBError.ECJS_INVALID_DATETIME_FORMAT()}return e[d.Timestamp.OFFSET_YEAR]=s+1900,e[d.Timestamp.OFFSET_MONTH]=l+1,e[d.Timestamp.OFFSET_DAY]=_==0?1:_,e[d.Timestamp.OFFSET_HOUR]=f,e[d.Timestamp.OFFSET_MINUTE]=y,e[d.Timestamp.OFFSET_SECOND]=T,e[d.Timestamp.OFFSET_MICROSECOND]=m,e[d.Timestamp.OFFSET_TIMEZONE]=mr,un}catch{throw j.DBError.ECJS_INVALID_DATETIME_FORMAT()}},i.toDateFromString=function(t,e){var r=new Array(d.Timestamp.DT_LEN);return this.toDTFromString(t,r),this.toDateFromDT(r,e)},i.toDTFromDate=function(t){var e=new Array(d.Timestamp.DT_LEN);return e[d.Timestamp.OFFSET_YEAR]=t.getFullYear(),e[d.Timestamp.OFFSET_MONTH]=t.getMonth()+1,e[d.Timestamp.OFFSET_DAY]=t.getDate(),e[d.Timestamp.OFFSET_HOUR]=t.getHours(),e[d.Timestamp.OFFSET_MINUTE]=t.getMinutes(),e[d.Timestamp.OFFSET_SECOND]=t.getSeconds(),e[d.Timestamp.OFFSET_MICROSECOND]=t.getMilliseconds(),e[d.Timestamp.OFFSET_TIMEZONE]=d.Timestamp.INVALID_VALUE,e},i.toDTFromUnix=function(t){return this.toDTFromDate(new Date(t))},i.toDateFromDT=function(t,e){var r=t[d.Timestamp.OFFSET_YEAR],n=0<t[d.Timestamp.OFFSET_MONTH]?t[d.Timestamp.OFFSET_MONTH]:1,o=0<t[d.Timestamp.OFFSET_DAY]?t[d.Timestamp.OFFSET_DAY]:1,a=t[d.Timestamp.OFFSET_HOUR],c=t[d.Timestamp.OFFSET_MINUTE],u=t[d.Timestamp.OFFSET_SECOND],h=t[d.Timestamp.OFFSET_MICROSECOND],s=t[d.Timestamp.OFFSET_TIMEZONE]===d.Timestamp.INVALID_VALUE?e:t[d.Timestamp.OFFSET_TIMEZONE];return new Date(Date.UTC(r,n-1,o,a,c-s,u,parseInt(h.toString().substr(0,3))))},i.toStringFromDT=function(t,e,r){return lu.OracleDateFormat.format(t,e,r)},i.transformTZ=function(t,e,r){var n=e;t[d.Timestamp.OFFSET_TIMEZONE]!=d.Timestamp.INVALID_VALUE&&(n=t[d.Timestamp.OFFSET_TIMEZONE]),r!=n&&(t=this.addMinute(t,r-n))[d.Timestamp.OFFSET_TIMEZONE]!=d.Timestamp.INVALID_VALUE&&(t[d.Timestamp.OFFSET_TIMEZONE]=r)},i.getDaysOfMonth=function(t,e){switch(e){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;case 4:case 6:case 9:case 11:return 30;case 2:return this.isLeapYear(t)?29:28;default:return 0}},i.formatDate=function(t,e){var r=t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0");return e&&(r+=" "+t.getHours().toString().padStart(2,"0")+":"+t.getMinutes().toString().padStart(2,"0")+":"+t.getSeconds().toString().padStart(2,"0")),r},i.checkDate=function(t,e,r){return!(9999<t||t<-4712||12<e||e<1)&&!(this.getDaysOfMonth(t,e)<r||r<1)},i.isLeapYear=function(t){return t%4==0&&t%100!=0||t%400==0},i.dmdtDecodeBdta=function(t){var e=new Array(d.Timestamp.DT_LEN);return e[d.Timestamp.OFFSET_YEAR]=kt.BufferUtil.r(t,0),e[d.Timestamp.OFFSET_MONTH]=255&t[2],e[d.Timestamp.OFFSET_DAY]=255&t[3],e[d.Timestamp.OFFSET_HOUR]=255&t[4],e[d.Timestamp.OFFSET_MINUTE]=255&t[5],e[d.Timestamp.OFFSET_SECOND]=255&t[6],e[d.Timestamp.OFFSET_MICROSECOND]=(255&t[7])+(t[8]<<8)+(t[9]<<16),e[d.Timestamp.OFFSET_TIMEZONE]=kt.BufferUtil.r(t,10),e},i.dmdtDecodeFast=function(t){var e=new Array(d.Timestamp.DT_LEN).fill(0);return e[d.Timestamp.OFFSET_TIMEZONE]=d.Timestamp.INVALID_VALUE,t.length==3?(e[d.Timestamp.OFFSET_YEAR]=32767&kt.BufferUtil.oi(t,0),9999<e[d.Timestamp.OFFSET_YEAR]&&(e[d.Timestamp.OFFSET_YEAR]=kt.BufferUtil.cn(kt.BufferUtil.Mn(32768|e[d.Timestamp.OFFSET_YEAR]))),e[d.Timestamp.OFFSET_MONTH]=(t[1]>>7&1)+((7&t[2])<<1),e[d.Timestamp.OFFSET_DAY]=(248&t[2])>>3&31):t.length<8?(e[d.Timestamp.OFFSET_HOUR]=31&t[0],e[d.Timestamp.OFFSET_MINUTE]=(t[0]>>5&7)+((7&t[1])<<3),e[d.Timestamp.OFFSET_SECOND]=(t[1]>>3&31)+((1&t[2])<<5),e[d.Timestamp.OFFSET_MICROSECOND]=(t[2]>>1&127)+((255&t[3])<<7)+((31&t[4])<<15),5<t.length&&(e[d.Timestamp.OFFSET_TIMEZONE]=kt.BufferUtil.r(t,5))):(e[d.Timestamp.OFFSET_YEAR]=32767&kt.BufferUtil.r(t,0),9999<e[d.Timestamp.OFFSET_YEAR]&&(e[d.Timestamp.OFFSET_YEAR]=-32768|e[d.Timestamp.OFFSET_YEAR]),e[d.Timestamp.OFFSET_MONTH]=(t[1]>>7&1)+((7&t[2])<<1),e[d.Timestamp.OFFSET_DAY]=(248&t[2])>>3&31,e[d.Timestamp.OFFSET_HOUR]=31&t[3],e[d.Timestamp.OFFSET_MINUTE]=(t[3]>>5&7)+((7&t[4])<<3),e[d.Timestamp.OFFSET_SECOND]=(t[4]>>3&31)+((1&t[5])<<5),e[d.Timestamp.OFFSET_MICROSECOND]=(t[5]>>1&127)+((255&t[6])<<7)+((31&t[7])<<15),8<t.length&&(e[d.Timestamp.OFFSET_TIMEZONE]=kt.BufferUtil.r(t,8))),e},i.addMinute=function(t,e){var r=t[d.Timestamp.OFFSET_MINUTE]+e,n=Math.trunc(r/60);return(r%=60)<0&&(r+=60,n--),t[d.Timestamp.OFFSET_MINUTE]=r,this.addHour(t,n),t},i.addHour=function(t,e){var r=t[d.Timestamp.OFFSET_HOUR]+e,n=Math.trunc(r/24);return(r%=24)<0&&(r+=24,n--),t[d.Timestamp.OFFSET_HOUR]=r,this.addDay(t,n),t},i.addDay=function(t,e){for(var r,n=t[d.Timestamp.OFFSET_DAY]+e;n>(r=this.getDaysOfMonth(t[d.Timestamp.OFFSET_YEAR],t[d.Timestamp.OFFSET_MONTH]))||n<=0;)this.addMonth(t,r<n?1:-1),n=r<n?n-r:n+r;return t[d.Timestamp.OFFSET_DAY]=n,t},i.addMonth=function(t,e){var r=t[d.Timestamp.OFFSET_MONTH]+e,n=Math.trunc(r/12);(r%=12)<1&&(r+=12,n--);var o=this.getDaysOfMonth(t[d.Timestamp.OFFSET_YEAR],r);return t[d.Timestamp.OFFSET_DAY]>o&&(t[d.Timestamp.OFFSET_DAY]=o),t[d.Timestamp.OFFSET_MONTH]=r,this.addYear(t,n),t},i.addYear=function(t,e){return t[d.Timestamp.OFFSET_YEAR]+=e,t},i}();ai.DateUtil=fu});var Rr=E(Oe=>{"use strict";var _u=Oe&&Oe.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},pu=Oe&&Oe.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Oe,"__esModule",{value:!0});var yt=D(),Y=J(),du=R(),Eu=function(){function i(t,e,r,n){this.blobId=BigInt(0),this.inRow=!0,this.groupId=-1,this.fileId=-1,this.pageNo=-1,this.tabId=0,this.colId=0,this.rowId=BigInt(0),this.exGroupId=0,this.exFileId=0,this.exPageNo=0,this.curFileId=0,this.curPageNo=0,this.curPageOffset=0,this.totalOffset=0,this.readOver=!1,this.local=!0,this.updateable=!0,this.length=-1,this.compatibleOracle=!1,this.fetchAll=!1,this.freed=!1,this.modify=!1,this.conn=e,this.lobFlag=t,r&&n&&(this.compatibleOracle=e.compatibleOracle(),this.local=!1,this.updateable=!n.readonly,this.tabId=n.lobTabId,this.colId=n.lobColId,this.inRow=Y.BufferUtil.e(r,i.NBLOB_HEAD_IN_ROW_FLAG)===i.LOB_IN_ROW,this.blobId=Y.BufferUtil.n(r,i.NBLOB_HEAD_BLOBID),this.inRow||(this.groupId=Y.BufferUtil.r(r,i.NBLOB_HEAD_OUTROW_GROUPID),this.fileId=Y.BufferUtil.r(r,i.NBLOB_HEAD_OUTROW_FILEID),this.pageNo=Y.BufferUtil.t(r,i.NBLOB_HEAD_OUTROW_PAGENO)),e.newLobFlag&&(this.tabId=Y.BufferUtil.t(r,i.NBLOB_EX_HEAD_TABLE_ID),this.colId=Y.BufferUtil.r(r,i.NBLOB_EX_HEAD_COL_ID),this.rowId=Y.BufferUtil.n(r,i.NBLOB_EX_HEAD_ROW_ID),this.exGroupId=Y.BufferUtil.r(r,i.NBLOB_EX_HEAD_FPA_GRPID),this.exFileId=Y.BufferUtil.r(r,i.NBLOB_EX_HEAD_FPA_FILEID),this.exPageNo=Y.BufferUtil.t(r,i.NBLOB_EX_HEAD_FPA_PAGENO)),this.resetCurrentInfo())}return i.prototype.resetCurrentInfo=function(){this.curFileId=this.fileId,this.curPageNo=this.pageNo,this.totalOffset=0,this.curPageOffset=0},i.prototype.checkFreed=function(){if(this.freed)throw du.DBError.ECJS_LOB_FREED()},i.prototype.getLengthFromHead=function(t){return Y.BufferUtil.t(t,i.NBLOB_HEAD_BLOB_LEN)},i.prototype.getLength=function(){return _u(this,void 0,void 0,function(){var t;return pu(this,function(e){switch(e.label){case 0:return this.checkFreed(),this.length!==-1?[3,2]:(this.conn.checkClosed(),[4,(t=this).conn.access.h(this)]);case 1:t.length=e.sent(),e.label=2;case 2:return[2,this.length]}})})},i.prototype.canOptimized=function(t){return!(this.inRow||this.fetchAll||this.local||this.modify||t!==this.conn)},i.prototype.buildCtlData=function(){var t=Buffer.alloc(this.conn.newLobFlag?i.NBLOB_EX_HEAD_SIZE:i.NBLOB_OUTROW_HEAD_SIZE);return Y.BufferUtil.l(t,i.NBLOB_HEAD_IN_ROW_FLAG,i.LOB_OFF_ROW),Y.BufferUtil.U(t,i.NBLOB_HEAD_BLOBID,this.blobId),Y.BufferUtil.v(t,i.NBLOB_HEAD_BLOB_LEN,-1),Y.BufferUtil.w(t,i.NBLOB_HEAD_OUTROW_GROUPID,this.groupId),Y.BufferUtil.w(t,i.NBLOB_HEAD_OUTROW_FILEID,this.fileId),Y.BufferUtil.v(t,i.NBLOB_HEAD_OUTROW_PAGENO,this.pageNo),this.conn.newLobFlag&&(Y.BufferUtil.v(t,i.NBLOB_EX_HEAD_TABLE_ID,this.tabId),Y.BufferUtil.y(t,i.NBLOB_EX_HEAD_COL_ID,this.colId),Y.BufferUtil.U(t,i.NBLOB_EX_HEAD_ROW_ID,this.rowId),Y.BufferUtil.y(t,i.NBLOB_EX_HEAD_FPA_GRPID,this.exGroupId),Y.BufferUtil.y(t,i.NBLOB_EX_HEAD_FPA_FILEID,this.exFileId),Y.BufferUtil.v(t,i.NBLOB_EX_HEAD_FPA_PAGENO,this.exPageNo)),t},i.LOB_FLAG_BYTE=0,i.LOB_FLAG_CHAR=1,i.LOB_IN_ROW=1,i.LOB_OFF_ROW=2,i.NBLOB_HEAD_BLOBID=(i.NBLOB_HEAD_IN_ROW_FLAG=0)+yt.Const.BYTE_SIZE,i.NBLOB_HEAD_BLOB_LEN=i.NBLOB_HEAD_BLOBID+yt.Const.DDWORD_SIZE,i.NBLOB_HEAD_OUTROW_GROUPID=i.NBLOB_HEAD_BLOB_LEN+yt.Const.ULINT_SIZE,i.NBLOB_HEAD_OUTROW_FILEID=i.NBLOB_HEAD_OUTROW_GROUPID+yt.Const.USINT_SIZE,i.NBLOB_HEAD_OUTROW_PAGENO=i.NBLOB_HEAD_OUTROW_FILEID+yt.Const.USINT_SIZE,i.NBLOB_EX_HEAD_TABLE_ID=i.NBLOB_HEAD_OUTROW_PAGENO+yt.Const.ULINT_SIZE,i.NBLOB_EX_HEAD_COL_ID=i.NBLOB_EX_HEAD_TABLE_ID+yt.Const.ULINT_SIZE,i.NBLOB_EX_HEAD_ROW_ID=i.NBLOB_EX_HEAD_COL_ID+yt.Const.USINT_SIZE,i.NBLOB_EX_HEAD_FPA_GRPID=i.NBLOB_EX_HEAD_ROW_ID+yt.Const.LINT64_SIZE,i.NBLOB_EX_HEAD_FPA_FILEID=i.NBLOB_EX_HEAD_FPA_GRPID+yt.Const.USINT_SIZE,i.NBLOB_EX_HEAD_FPA_PAGENO=i.NBLOB_EX_HEAD_FPA_FILEID+yt.Const.USINT_SIZE,i.NBLOB_EX_HEAD_SIZE=i.NBLOB_EX_HEAD_FPA_PAGENO+yt.Const.ULINT_SIZE,i.NBLOB_OUTROW_HEAD_SIZE=i.NBLOB_HEAD_OUTROW_PAGENO+yt.Const.ULINT_SIZE,i.NBLOB_INROW_HEAD_SIZE=i.NBLOB_HEAD_BLOB_LEN+yt.Const.ULINT_SIZE,i}();Oe.AbstractLob=Eu});var ui=E(Jt=>{"use strict";var Tu=Jt&&Jt.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ir=Jt&&Jt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},or=Jt&&Jt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Jt,"__esModule",{value:!0});var Nr=Rr(),Le=R(),ci=J(),yu=function(i){function t(e,r,n,o){var a=this;return n!==void 0&&o!==void 0?(a=i.call(this,Nr.AbstractLob.LOB_FLAG_BYTE,r,e,n)||this).length=a.getLengthFromHead(e):((a=i.call(this,Nr.AbstractLob.LOB_FLAG_BYTE,r)||this).data=e,a.length=a.data.length),a}return Tu(t,i),t.newBlobOfLocal=function(e,r){return ir(this,void 0,void 0,function(){return or(this,function(n){return[2,new t(e,r)]})})},t.newBlobFromDB=function(e,r,n,o){return ir(this,void 0,void 0,function(){var a,c;return or(this,function(u){switch(u.label){case 0:return(a=new t(e,r,n,o)).inRow?(c=r.newLobFlag?Nr.AbstractLob.NBLOB_EX_HEAD_SIZE:Nr.AbstractLob.NBLOB_INROW_HEAD_SIZE,a.data=Buffer.alloc(Number(a.length)),ci.BufferUtil.L(a.data,0,e,c,a.data.length),[3,3]):[3,1];case 1:return o?[4,a.loadAllData()]:[3,3];case 2:u.sent(),u.label=3;case 3:return[2,a]}})})},t.prototype.loadAllData=function(){return ir(this,void 0,void 0,function(){var e,r,n;return or(this,function(o){switch(o.label){case 0:return this.checkFreed(),this.local||this.inRow||this.fetchAll?[2]:(r=(e=this).getBytes,n=[1],[4,this.getLength()]);case 1:return[4,r.apply(this,n.concat([o.sent()]))];case 2:return e.data=o.sent(),this.fetchAll=!0,[2]}})})},t.prototype.getBytes=function(e,r){return ir(this,void 0,void 0,function(){var n,o;return or(this,function(a){switch(a.label){case 0:if(this.checkFreed(),e<1||r<0)throw Le.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();return e--,[4,this.getLength()];case 1:if((n=a.sent()-e)<0)throw Le.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();return r=n<r?n:r,this.local||this.inRow||this.fetchAll?(o=Buffer.alloc(r),ci.BufferUtil.L(o,0,this.data,e,o.length),[2,o]):(this.conn.checkClosed(),[2,this.conn.access.B(this,e,r)])}})})},t.prototype.setBytes=function(e,r,n,o){return ir(this,void 0,void 0,function(){var a,c;return or(this,function(u){switch(u.label){case 0:if(this.checkFreed(),e<1||o<0||n<0)throw Le.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();if(!this.updateable)throw Le.DBError.ECJS_RESULTSET_IS_READ_ONLY();if(o=n+o>r.length?r.length-n:o,e--,a=0,!this.local&&!this.fetchAll)return[3,1];if(e>this.length)throw Le.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();return this.setLocalData(e,r,n,o),a=o,[3,3];case 1:return this.conn.checkClosed(),[4,this.conn.access.j(this,e,r,n,o)];case 2:c=u.sent(),this.groupId===-1?this.setLocalData(e,r,n,c):(this.inRow=!1,this.length=-1),a=c,u.label=3;case 3:return this.modify=!0,[2,a]}})})},t.prototype.truncate=function(e){return ir(this,void 0,void 0,function(){var r;return or(this,function(n){switch(n.label){case 0:if(this.checkFreed(),e<0)throw Le.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();if(!this.updateable)throw Le.DBError.ECJS_RESULTSET_IS_READ_ONLY();return this.local||this.fetchAll?e>=this.data.length?[2]:(this.data=this.data.slice(0,e),this.length=e,[3,3]):[3,1];case 1:return this.conn.checkClosed(),[4,(r=this).conn.access.O(this,e)];case 2:r.length=n.sent(),this.groupId===-1&&(this.data=this.data.slice(0,this.length)),n.label=3;case 3:return this.modify=!0,[2]}})})},t.prototype.setLocalData=function(e,r,n,o){e+o>this.length?this.data=Buffer.concat([this.data.subarray(0,e),r.subarray(n,n+o)],e+o):ci.BufferUtil.L(this.data,e,r,n,o),this.length=this.data.length},t}(Nr.AbstractLob);Jt.Blob=yu});var hi=E(jt=>{"use strict";var mu=jt&&jt.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),sr=jt&&jt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},ar=jt&&jt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(jt,"__esModule",{value:!0});var Br=Rr(),Su=J(),ae=R(),gu=function(i){function t(e,r,n,o){var a=this;return e instanceof Buffer&&n!==void 0&&o!==void 0?(a=i.call(this,Br.AbstractLob.LOB_FLAG_CHAR,r,e,n)||this).serverEncoding=r.getServerEncoding():((a=i.call(this,Br.AbstractLob.LOB_FLAG_CHAR,r)||this).serverEncoding=r.getServerEncoding(),a.data=e,a.length=a.data.length),a}return mu(t,i),t.newClobOfLocal=function(e,r){return sr(this,void 0,void 0,function(){return ar(this,function(n){return[2,new t(e,r)]})})},t.newClobFromDB=function(e,r,n,o){return sr(this,void 0,void 0,function(){var a,c;return ar(this,function(u){switch(u.label){case 0:return(a=new t(e,r,n,o)).inRow?(c=r.newLobFlag?Br.AbstractLob.NBLOB_EX_HEAD_SIZE:Br.AbstractLob.NBLOB_INROW_HEAD_SIZE,a.data=Su.BufferUtil.c(e,c,a.getLengthFromHead(e),a.serverEncoding),a.length=a.data.length,[3,3]):[3,1];case 1:return o?[4,a.loadAllData()]:[3,3];case 2:u.sent(),u.label=3;case 3:return[2,a]}})})},t.prototype.loadAllData=function(){return sr(this,void 0,void 0,function(){var e,r,n;return ar(this,function(o){switch(o.label){case 0:return this.checkFreed(),this.local||this.inRow||this.fetchAll?[2]:(r=(e=this).getSubString,n=[1],[4,this.getLength()]);case 1:return[4,r.apply(this,n.concat([o.sent()]))];case 2:return e.data=o.sent(),this.fetchAll=!0,[2]}})})},t.prototype.getSubString=function(e,r){return sr(this,void 0,void 0,function(){var n;return ar(this,function(o){switch(o.label){case 0:if(this.checkFreed(),e<1||r<0)throw ae.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();return e--,[4,this.getLength()];case 1:if((n=o.sent()-e)<0)throw ae.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();if(r=n<r?n:r,this.local||this.inRow||this.fetchAll){if(e>this.length)throw ae.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();return[2,this.data.substr(e,r)]}return this.conn.checkClosed(),[2,this.conn.access.C(this,e,r)]}})})},t.prototype.setString=function(e,r,n,o){return sr(this,void 0,void 0,function(){var a,c;return ar(this,function(u){switch(u.label){case 0:if(this.checkFreed(),e<1||n<0||o<0||n+o>r.length)throw ae.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();if(!this.updateable)throw ae.DBError.ECJS_RESULTSET_IS_READ_ONLY();if(r=r.substr(n,o),e--,a=0,!this.local&&!this.fetchAll)return[3,1];if(e>this.length)throw ae.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();return this.setLocalData(e,r),a=r.length,[3,3];case 1:return this.conn.checkClosed(),[4,this.conn.access.S(this,e,r,this.serverEncoding)];case 2:c=u.sent(),this.groupId===-1?this.setLocalData(e,r):(this.inRow=!1,this.length=-1),a=c,u.label=3;case 3:return this.modify=!0,[2,a]}})})},t.prototype.truncate=function(e){return sr(this,void 0,void 0,function(){var r;return ar(this,function(n){switch(n.label){case 0:if(this.checkFreed(),e<0)throw ae.DBError.ECJS_INVALID_LENGTH_OR_OFFSET();if(!this.updateable)throw ae.DBError.ECJS_RESULTSET_IS_READ_ONLY();return this.local||this.fetchAll?e>=this.data.length?[2]:(this.data=this.data.slice(0,e),this.length=e,[3,3]):[3,1];case 1:return this.conn.checkClosed(),[4,(r=this).conn.access.O(this,e)];case 2:r.length=n.sent(),this.groupId===-1&&(this.data=this.data.slice(0,this.length)),n.label=3;case 3:return this.modify=!0,[2]}})})},t.prototype.setLocalData=function(e,r){e+r.length>this.length?this.data=this.data.substring(0,e)+r:this.data=this.data.substring(0,e)+r+this.data.substring(e+r.length,this.data.length),this.length=this.data.length},t}(Br.AbstractLob);jt.Clob=gu});var cr=E(Wt=>{"use strict";var vu=Wt&&Wt.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),mn=Wt&&Wt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Sn=Wt&&Wt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Wt,"__esModule",{value:!0});var bu=require("stream"),De=Rr(),gn=Yt(),li=R(),Iu=ui(),Au=hi(),Go=J(),Ou=ce(),Lu=nr(),Du=function(i){function t(e,r){var n=i.call(this,r)||this;return n.chunkSize=0,n.pieceSize=0,n.iLob=e,n.type=e.lobFlag===De.AbstractLob.LOB_FLAG_BYTE?gn.dmdb.BLOB:gn.dmdb.CLOB,n.rOffset=1,n.wOffset=1,n.newMiddlewares(),Lu.setUnenumerable(n,["middlewares","nextID"]),n}return vu(t,i),t.prototype.newMiddlewares=function(){this.middlewares=new Ou.Middlewares(this.iLob.conn,null,t.nextID++,this.iLob.conn.middlewares)},t.newLob=function(e,r){return mn(this,void 0,void 0,function(){return Sn(this,function(n){switch(n.label){case 0:return e!==gn.dmdb.BLOB?[3,2]:[4,Iu.Blob.newBlobOfLocal(Buffer.alloc(0),r)];case 1:return[2,new t(n.sent())];case 2:return e!==gn.dmdb.CLOB?[3,4]:[4,Au.Clob.newClobOfLocal("",r)];case 3:return[2,new t(n.sent())];case 4:throw new Error("Invalid Lob Type")}})})},t.prototype.close=function(e){if(e===void 0)return this.middlewares.valid?this.middlewares.reset().lob_close(this):this.do_close();if(typeof e!="function")throw li.DBError.ECJS_INVALID_PARAM();this.close().then(function(){e(null)}).catch(function(r){e(r)})},t.prototype.getData=function(e){if(e===void 0)return this.middlewares.valid?this.middlewares.reset().lob_getData(this):this.do_getData();if(typeof e!="function")throw li.DBError.ECJS_INVALID_PARAM();this.getData().then(function(r){e(null,r)}).catch(function(r){e(r,void 0)})},t.prototype.getLength=function(e){if(e===void 0)return this.middlewares.valid?this.middlewares.reset().lob_getLength(this):this.do_getLength();if(typeof e!="function")throw li.DBError.ECJS_INVALID_PARAM();this.getLength().then(function(r){e(null,r)}).catch(function(r){e(r)})},t.prototype.do_close=function(){return mn(this,void 0,void 0,function(){return Sn(this,function(e){return this.iLob.freed=!0,delete this.iLob.conn,this.iLob.lobFlag,De.AbstractLob.LOB_FLAG_BYTE,delete this.iLob.data,this.emit("close"),[2]})})},t.prototype.do_getData=function(){return mn(this,void 0,void 0,function(){var e;return Sn(this,function(r){switch(r.label){case 0:return[4,this.getLength()];case 1:return e=r.sent(),this.iLob.lobFlag===De.AbstractLob.LOB_FLAG_BYTE?[2,this.iLob.getBytes(1,e)]:[2,this.iLob.getSubString(1,e)]}})})},t.prototype.do_getLength=function(){return mn(this,void 0,void 0,function(){return Sn(this,function(e){return[2,this.iLob.getLength()]})})},t.prototype._read=function(e){var r=this;this.iLob.lobFlag===De.AbstractLob.LOB_FLAG_BYTE?this.iLob.getBytes(this.rOffset,e).then(function(n){n.length!==0?(r.push(n),r.rOffset+=n.length):r.emit("end")}).catch(function(n){r.emit("error",n)}):this.iLob.lobFlag===De.AbstractLob.LOB_FLAG_CHAR?this.iLob.getSubString(this.rOffset,e).then(function(n){n.length!==0?(r.push(n),r.rOffset+=n.length):r.emit("end")}).catch(function(n){r.emit("error",n)}):this.emit("error",new Error("Fatal error occured in Lob"))},t.prototype._write=function(e,r,n){var o,a,c=this;this.iLob.lobFlag===De.AbstractLob.LOB_FLAG_BYTE?(o=typeof e=="string"?Go.BufferUtil.b(e,this.iLob.conn.getServerEncoding()):Buffer.from(e),this.iLob.setBytes(this.wOffset,o,0,o.length).then(function(u){c.wOffset+=u,n(null)}).catch(function(u){c.emit("error",u),n(u)})):this.iLob.lobFlag===De.AbstractLob.LOB_FLAG_CHAR?(a=e instanceof Buffer?Go.BufferUtil.G(e,this.iLob.conn.getServerEncoding()):e.toString(),this.iLob.setString(this.wOffset,a,0,a.length).then(function(u){c.wOffset+=u,n(null)}).catch(function(u){c.emit("error",u),n(u)})):(this.emit("error",new Error("Fatal error occured in Lob")),n(new Error("Fatal error occured in Lob")))},t.nextID=0,t}(bu.Duplex);Wt.Lob=Du});var Zo=E(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});var Cu=function(){function i(){this.ddl=new wu}return i.prototype.unshift=function(t){var e=new zo(t);this.ddl.insertBeginning(e)},i.prototype.shift=function(){var t=this.ddl.head;if(t)return this.ddl.remove(t),t.data},i.prototype.push=function(t){var e=new zo(t);this.ddl.insertEnd(e)},i.prototype.pop=function(){var t=this.ddl.tail;if(t)return this.ddl.remove(t),t.data},i.prototype.includes=function(t){return!!this.ddl.find(t)},i.prototype.delete=function(t){var e=this.ddl.find(t);return!!e&&(this.ddl.remove(e),!0)},Object.defineProperty(i.prototype,"length",{get:function(){return this.ddl.length},enumerable:!0,configurable:!0}),i}();fi.Deque=Cu;var wu=function(){function i(){this.head=null,this.tail=null,this.length=0}return i.prototype.insertBeginning=function(t){this.head?this.insertBefore(this.head,t):(this.head=t,(this.tail=t).prev=null,t.next=null,this.length++)},i.prototype.insertEnd=function(t){this.tail?this.insertAfter(this.tail,t):this.insertBeginning(t)},i.prototype.insertBefore=function(t,e){e.prev=t.prev,(e.next=t).prev?t.prev.next=e:this.head=e,t.prev=e,this.length++},i.prototype.insertAfter=function(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length++},i.prototype.remove=function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=null,t.next=null,this.length--},i.prototype.find=function(t){for(var e=this.head;e;e=e.next)if(e.data===t)return e;return null},i}(),zo=function(i){this.prev=null,this.next=null,this.data=i}});var _i=E(Ne=>{"use strict";var Ce=Ne&&Ne.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},we=Ne&&Ne.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Ne,"__esModule",{value:!0});var Re=R(),Qo=ve(),Ct=Yt(),Ru=ce(),Nu=nr(),Jo=Zo(),Bu=function(){function i(t){this._poolMax=Ct.dmdb.poolMax,this._poolMin=Ct.dmdb.poolMin,this._poolTimeout=Ct.dmdb.poolTimeout,this._testOnBorrow=!1,this._validationQuery="select 1;",this._connectString="dm://SYSDBA:SYSDBA@localhost:5236",this._status=Ct.dmdb.POOL_STATUS_OPEN,this._acquiringConnections=new Jo.Deque,this._freeConnections=new Jo.Deque,this._connectString=t.connectString||t.connectionString||this._connectString,this._poolMax=t.poolMax!==void 0?t.poolMax:this._poolMax,this._poolMin=t.poolMin!==void 0?t.poolMin:this._poolMin,this._poolTimeout=t.poolTimeout!==void 0?t.poolTimeout:this._poolTimeout,this._testOnBorrow=t.testOnBorrow!==void 0?t.testOnBorrow:this._testOnBorrow,this._validationQuery=t.validationQuery||this._validationQuery,this._poolAlias=t.poolAlias}return i.prototype.newMiddlewares=function(){this.middlewares=new Ru.Middlewares(null,this._connectProps,i.nextID++,null)},i.prototype.openPool=function(){return Ce(this,void 0,void 0,function(){var t,e,r,n;return we(this,function(o){switch(o.label){case 0:if(o.trys.push([0,6,,8]),this._poolMin<0||this._poolMax<1||this._poolMin>this._poolMax)throw Re.DBError.ECJS_INVALID_POOL_NUM();return t=this,[4,Ct.dmdb.parseUrl(this._connectString)];case 1:t._connectProps=o.sent(),this.newMiddlewares(),Nu.setUnenumerable(this,["middlewares","nextID"]),e=0,o.label=2;case 2:return e<this._poolMin?[4,Qo.PoolConnection.newInstanceOfPoolConnection(this._connectProps,this).openConnection(this._connectProps.getAny("epGroup"))]:[3,5];case 3:r=o.sent(),this._freeConnections.push(r),o.label=4;case 4:return e++,[3,2];case 5:return[2,this];case 6:return n=o.sent(),[4,this.close()];case 7:throw o.sent(),n;case 8:return[2]}})})},i.prototype.getConnection=function(t){if(t===void 0)return this.middlewares.valid?this.middlewares.reset().pool_getConnection(this):this.do_getConnection();if(typeof t!="function")throw Re.DBError.ECJS_INVALID_PARAM();this.getConnection().then(function(e){t(null,e)}).catch(function(e){t(e,void 0)})},i.prototype.close=function(t,e){if(t===void 0&&e===void 0)return this.middlewares.valid?this.middlewares.reset().pool_close(this):this.do_close();if(typeof t=="function"&&e===void 0)this.close().then(function(){t(null)}).catch(function(r){t(r)});else{if(typeof t=="number"&&e===void 0)return this.middlewares.valid?this.middlewares.reset().pool_close(this,e):this.do_close(e);if(typeof t!="number"||typeof e!="function")throw Re.DBError.ECJS_INVALID_PARAM();this.close(t).then(function(){e(null)}).catch(function(r){e(r)})}},i.prototype.terminate=function(t,e){if(t===void 0&&e===void 0)return this.close();if(typeof t=="function"&&e===void 0)this.close().then(function(){t(null)}).catch(function(r){t(r)});else{if(typeof t=="number"&&e===void 0)return this.close(t);if(typeof t!="number"||typeof e!="function")throw Re.DBError.ECJS_INVALID_PARAM();this.close(t).then(function(){e(null)}).catch(function(r){e(r)})}},i.prototype.do_getConnection=function(){return Ce(this,void 0,void 0,function(){var t,e;return we(this,function(r){switch(r.label){case 0:return this._checkPoolStatus(),[4,this.getFreeConnection()];case 1:return(t=r.sent())?[2,t]:[4,this.makeNewConnection()];case 2:if(e=r.sent())return[2,e];throw Re.DBError.ECJS_POOL_NO_MORE_CONNECTION()}})})},i.prototype.do_close=function(t){return Ce(this,void 0,void 0,function(){var e,r;return we(this,function(n){switch(n.label){case 0:this._checkPoolStatus(),this._status=Ct.dmdb.POOL_STATUS_DRAINING,n.label=1;case 1:n.trys.push([1,7,,8]),e=void 0,n.label=2;case 2:return(e=this._freeConnections.shift())?(e.stopTimer(),[4,e.destroy()]):[3,4];case 3:return n.sent(),[3,2];case 4:return(e=this._acquiringConnections.shift())?(e.stopTimer(),[4,e.destroy()]):[3,6];case 5:return n.sent(),[3,4];case 6:return this._status=Ct.dmdb.POOL_STATUS_CLOSED,this.middlewares.log&&this.middlewares.log.logWriter.end(),this._poolAlias&&Ct.dmdb.pools.delete(this._poolAlias),[3,8];case 7:throw r=n.sent(),this._status=Ct.dmdb.POOL_STATUS_OPEN,r;case 8:return[2]}})})},i.prototype.releaseConnection=function(t){this._status!==Ct.dmdb.POOL_STATUS_CLOSED&&(this._acquiringConnections.delete(t)?(this._freeConnections.push(t),t.closed=!0,t.startTimer()):t.closed=!0)},i.prototype.eliminateConnection=function(t){return Ce(this,void 0,void 0,function(){return we(this,function(e){return this.connectionsOpen<=this._poolMin||this._acquiringConnections.includes(t)?t.refreshTimer():(this._freeConnections.delete(t),t.destroy()),[2]})})},i.prototype.testConnection=function(t){return Ce(this,void 0,void 0,function(){var e,r,n;return we(this,function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),[4,t.do_execute(this._validationQuery,[],{resultSet:!0})];case 1:return(e=o.sent()).resultSet?[4,e.resultSet.do_getRow()]:[3,4];case 2:return r=o.sent(),[4,e.resultSet.do_close()];case 3:return o.sent(),r?[2,!0]:(this.middlewares.logWarn("\u8FDE\u63A5\u6C60\u8FDE\u63A5\u6709\u6548\u6027\u68C0\u67E5\u5931\u8D25:\u6CA1\u6709\u7ED3\u679C\u96C6."),[2,!1]);case 4:return this.middlewares.logWarn("\u8FDE\u63A5\u6C60\u8FDE\u63A5\u6709\u6548\u6027\u68C0\u67E5\u5931\u8D25:\u6CA1\u6709\u7ED3\u679C\u96C6."),[2,!1];case 5:return[3,7];case 6:return n=o.sent(),this.middlewares.logWarn(`\u8FDE\u63A5\u6C60\u8FDE\u63A5\u6709\u6548\u6027\u68C0\u67E5\u5931\u8D25.
`+n),[2,!1];case 7:return[2]}})})},i.prototype.getFreeConnection=function(){return Ce(this,void 0,void 0,function(){var t,e;return we(this,function(r){switch(r.label){case 0:if(!(t=this._freeConnections.shift()))return[3,7];t.stopTimer(),t.closed=!1,this._acquiringConnections.push(t),r.label=1;case 1:return r.trys.push([1,6,,7]),(e=this._testOnBorrow)?[4,this.testConnection(t)]:[3,3];case 2:e=!r.sent(),r.label=3;case 3:return e?(this._acquiringConnections.delete(t),[4,t.destroy()]):[3,5];case 4:return r.sent(),[2,this.getFreeConnection()];case 5:return[3,7];case 6:return r.sent(),this._acquiringConnections.delete(t),[2,void 0];case 7:return[2,t]}})})},i.prototype.makeNewConnection=function(){return Ce(this,void 0,void 0,function(){var t;return we(this,function(e){switch(e.label){case 0:if(!(this.connectionsOpen<this._poolMax))return[3,5];t=null,e.label=1;case 1:return e.trys.push([1,3,,4]),t=Qo.PoolConnection.newInstanceOfPoolConnection(this._connectProps,this),this._acquiringConnections.push(t),[4,t.openConnection(this._connectProps.getAny("epGroup"))];case 2:return e.sent(),[2,t];case 3:return e.sent(),t&&this._acquiringConnections.delete(t),[2,void 0];case 4:return[3,6];case 5:return[2,void 0];case 6:return[2]}})})},i.prototype._checkPoolStatus=function(){if(this._status===Ct.dmdb.POOL_STATUS_CLOSED)throw Re.DBError.ECJS_POOL_CLOSED();if(this._status===Ct.dmdb.POOL_STATUS_DRAINING)throw Re.DBError.ECJS_POOL_DRAINING()},Object.defineProperty(i.prototype,"connectionsInUse",{get:function(){return this._acquiringConnections.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"connectionsOpen",{get:function(){return this._acquiringConnections.length+this._freeConnections.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"poolMax",{get:function(){return this._poolMax},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"poolMin",{get:function(){return this._poolMin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"poolAlias",{get:function(){return this._poolAlias},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"poolTimeout",{get:function(){return this._poolTimeout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"testOnBorrow",{get:function(){return this._testOnBorrow},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"validationQuery",{get:function(){return this._validationQuery},enumerable:!0,configurable:!0}),i.nextID=0,i}();Ne.Pool=Bu});var Pr=E(Mr=>{"use strict";var Mu=Mr&&Mr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Mr,"__esModule",{value:!0});var jo=D(),Pu=Cr(),mt=Dt(),Uu=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.typeFlag=t.TYPE_FLAG_UNKNOWN,e.ioType=t.IO_TYPE_IN,e.outJType=jo.Const.IGNORE_TARGET_TYPE,e.outScale=jo.Const.IGNORE_TARGET_SCALE,e}return Mu(t,i),t.prototype.resetType=function(e){if(this.typeFlag!==t.TYPE_FLAG_EXACT)switch(this.type=e,this.scale=0,e){case mt.DBType.CHAR:case mt.DBType.VARCHAR:case mt.DBType.VARCHAR2:this.prec=mt.DBType.VARCHAR_PREC;break;case mt.DBType.CLOB:this.prec=mt.DBType.CLOB_PREC;break;case mt.DBType.BLOB:this.prec=mt.DBType.BLOB_PREC;break;case mt.DBType.BINARY:case mt.DBType.VARBINARY:this.prec=mt.DBType.VARBINARY_PREC;break;case mt.DBType.BOOLEAN:case mt.DBType.BIT:this.prec=mt.DBType.BIT_PREC}},t.TYPE_FLAG_UNKNOWN=0,t.TYPE_FLAG_EXACT=1,t.TYPE_FLAG_RECOMMEND=2,t.IO_TYPE_IN=0,t.IO_TYPE_OUT=1,t.IO_TYPE_INOUT=2,t}(Pu.Column);Mr.Parameter=Uu});var pi=E(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});var Fu,xu=function(){function i(t,e){this.value=t,this.type=e,this.position=0}return i.prototype.toString=function(){return this.type+": "+this.value},i.MAX_DEC_LEN=38,i}();Ur.LVal=xu,function(i){i[i.NORMAL=0]="NORMAL",i[i.INT=1]="INT",i[i.DOUBLE=2]="DOUBLE",i[i.DECIMAL=3]="DECIMAL",i[i.STRING=4]="STRING",i[i.HEX_INT=5]="HEX_INT",i[i.WHITESPACE_OR_COMMENT=6]="WHITESPACE_OR_COMMENT",i[i.NULL=7]="NULL"}(Fu=Ur.Type||(Ur.Type={}))});var Wo=E(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});var ku=function(){function i(t){this.str=t,this.readed=0}return i.prototype.read=function(t,e,r){var n=this.str.length-this.readed;if(n==0)return-1;var o=Math.min(t.length-e,r);return o<=0?0:n<=o?(t.write(this.str.substr(this.readed,n),e,"utf8"),this.readed+=n,n):(t.write(this.str.substr(this.readed,o),e,"utf8"),this.readed+=o,o)},i}();di.StringReader=ku});var Xo=E(Ei=>{"use strict";Object.defineProperty(Ei,"__esModule",{value:!0});var vn=Bt(),A=pi(),Yu=Wo(),qu=function(){function i(t,e){this.zzState=0,this.zzLexicalState=i.YYINITIAL,this.zzBuffer=Buffer.alloc(i.ZZ_BUFFERSIZE),this.zzMarkedPos=0,this.zzCurrentPos=0,this.zzStartRead=0,this.zzEndRead=0,this.yyline=0,this.yychar=0,this.yycolumn=0,this.zzAtEOF=!1,this.zzFinalHighSurrogate=0,this.ltstr="",this.isDebug=e,this.zzReader=new Yu.StringReader(t)}return i.zzUnpackActionNoParams=function(){var t=new Array(104);return i.zzUnpackAction(i.ZZ_ACTION_PACKED_0,0,t),t},i.zzUnpackAction=function(t,e,r){for(var n=0,o=e,a=t.length;n<a;)for(var c=t[n++],u=t[n++];r[o++]=u,0<--c;);return o},i.zzUnpackRowMapNoParams=function(){var t=new Array(104);return i.zzUnpackRowMap(i.ZZ_ROWMAP_PACKED_0,0,t),t},i.zzUnpackRowMap=function(t,e,r){for(var n=0,o=e,a=t.length;n<a;){var c=t[n++]<<16;r[o++]=c|t[n++]}return o},i.zzUnpackTransNoParams=function(){var t=new Array(2208);return i.zzUnpackTrans(i.ZZ_TRANS_PACKED_0,0,t),t},i.zzUnpackTrans=function(t,e,r){for(var n=0,o=e,a=t.length;n<a;){var c=t[n++],u=t[n++];for(u--;r[o++]=u,0<--c;);}return o},i.zzUnpackAttributeNoParams=function(){var t=new Array(104);return i.zzUnpackAttribute(i.ZZ_ATTRIBUTE_PACKED_0,0,t),t},i.zzUnpackAttribute=function(t,e,r){for(var n=0,o=e,a=t.length;n<a;)for(var c=t[n++],u=t[n++];r[o++]=u,0<--c;);return o},i.prototype.debug=function(t){this.isDebug},i.prototype.yyerror=function(t){var e="(line: "+this.yyline+", column: "+this.yycolumn+", char: "+this.yychar+")";throw new Error("syntex error"+e+(t?": "+t:""))},i.zzUnpackCMap=function(t){for(var e=new Array(1114112),r=0,n=0;r<208;)for(var o=t[r++],a=t[r++];e[n++]=a,0<--o;);return e},i.prototype.zzRefill=function(){var t;0<this.zzStartRead&&(this.zzEndRead+=this.zzFinalHighSurrogate,this.zzFinalHighSurrogate=0,this.zzBuffer.copyWithin(0,this.zzStartRead,this.zzEndRead),this.zzEndRead-=this.zzStartRead,this.zzCurrentPos-=this.zzStartRead,this.zzMarkedPos-=this.zzStartRead,this.zzStartRead=0),this.zzCurrentPos>=this.zzBuffer.length-this.zzFinalHighSurrogate&&(t=Buffer.alloc(2*this.zzBuffer.length),this.zzBuffer.copy(t,0,0,this.zzBuffer.length),this.zzBuffer=t,this.zzEndRead+=this.zzFinalHighSurrogate,this.zzFinalHighSurrogate=0);var e=this.zzBuffer.length-this.zzEndRead,r=this.zzReader.read(this.zzBuffer,this.zzEndRead,e);if(r===0)throw new Error("Reader returned 0 characters. See JFlex examples for workaround.");return!(0<r)||(this.zzEndRead+=r,r===e&&vn.StringUtil.isHighSurrogate(this.zzBuffer[this.zzEndRead-1])&&(--this.zzEndRead,this.zzFinalHighSurrogate=1),!1)},i.prototype.yyclose=function(){this.zzAtEOF=!0,this.zzEndRead=this.zzStartRead},i.prototype.yyreset=function(t){this.zzReader=t,this.zzAtEOF=!1,this.zzEndRead=this.zzStartRead=0,this.zzCurrentPos=this.zzMarkedPos=0,this.zzFinalHighSurrogate=0,this.yyline=this.yychar=this.yycolumn=0,this.zzLexicalState=i.YYINITIAL,this.zzBuffer.length>i.ZZ_BUFFERSIZE&&(this.zzBuffer=new Buffer(i.ZZ_BUFFERSIZE))},i.prototype.yystate=function(){return this.zzLexicalState},i.prototype.yybegin=function(t){this.zzLexicalState=t},i.prototype.yytext=function(){return this.zzBuffer.toString("utf-8",this.zzStartRead,this.zzMarkedPos)},i.prototype.yycharat=function(t){return this.zzBuffer[this.zzStartRead+t]},i.prototype.yylength=function(){return this.zzMarkedPos-this.zzStartRead},i.prototype.zzScanError=function(t){var e=(e=i.ZZ_ERROR_MSG[t])||i.ZZ_ERROR_MSG[i.ZZ_UNKNOWN_ERROR];throw new Error(e)},i.prototype.yypushback=function(t){t>this.yylength()&&this.zzScanError(i.ZZ_PUSHBACK_2BIG),this.zzMarkedPos-=t},i.prototype.yylex=function(){for(var t,e,r=this.zzEndRead,n=this.zzBuffer,o=i.ZZ_CMAP,a=i.ZZ_TRANS,c=i.ZZ_ROWMAP,u=i.ZZ_ATTRIBUTE;;){l=this.zzMarkedPos,this.yychar+=l-this.zzStartRead;var h,s,l,_=!1;for(T=this.zzStartRead;T<l;T+=s)switch(h=n[T],s=vn.StringUtil.charCount(h),h){case 11:case 12:case 133:case 8232:case 8233:this.yyline++,this.yycolumn=0,_=!1;break;case"\r".charCodeAt(0):this.yyline++,_=!(this.yycolumn=0);break;case`
`.charCodeAt(0):_?_=!1:(this.yyline++,this.yycolumn=0);break;default:_=!1,this.yycolumn+=s}_&&(l<r?n[l]==`
`.charCodeAt(0):!this.zzAtEOF&&(y=this.zzRefill(),r=this.zzEndRead,l=this.zzMarkedPos,n=this.zzBuffer,!y&&n[l]==`
`.charCodeAt(0)))&&this.yyline--,e=-1,T=this.zzCurrentPos=this.zzStartRead=l,this.zzState=i.ZZ_LEXSTATE[this.zzLexicalState];var f=u[this.zzState];(1&f)==1&&(e=this.zzState);t:for(;;){if(T<r)t=n[T],T+=vn.StringUtil.charCount(t);else{if(this.zzAtEOF){t=i.YYEOF;break t}this.zzCurrentPos=T,this.zzMarkedPos=l;var y=this.zzRefill(),T=this.zzCurrentPos;if(l=this.zzMarkedPos,n=this.zzBuffer,r=this.zzEndRead,y){t=i.YYEOF;break t}t=n[T],T+=vn.StringUtil.charCount(t)}var m=a[c[this.zzState]+o[t]];if(m==-1||(this.zzState=m,(1&(f=u[this.zzState]))==1&&(e=this.zzState,l=T,(8&f)==8)))break t}if(this.zzMarkedPos=l,t==i.YYEOF&&this.zzStartRead==this.zzCurrentPos)switch(this.zzAtEOF=!0,this.zzLexicalState){case i.xc:this.debug("<xc><<EOF>>"),this.yybegin(i.YYINITIAL),this.yyerror("unterminated /* comment");case 105:break;case i.xq:this.debug("<xq><<EOF>>"),this.yybegin(i.YYINITIAL),this.yyerror("unterminated quoted string");case 106:break;case i.xdq:this.debug("<xdq><<EOF>>"),this.yybegin(i.YYINITIAL),this.yyerror("unterminated quoted identifier");case 107:break;case i.xbin:this.debug("<xbin><<EOF>>"),this.yybegin(i.YYINITIAL),this.yyerror("unterminated binary string literal");case 108:break;case i.xhex:this.debug("<xhex><<EOF>>"),this.yybegin(i.YYINITIAL),this.yyerror("unterminated hexadecimal integer");case 109:break;case i.xq2:this.yybegin(i.YYINITIAL),this.yyerror("unterminated q2 string");case 110:break;case i.xq2_2:this.yybegin(i.YYINITIAL),this.yyerror("unterminated q2 string");case 111:break;default:return null}else switch(e<0?e:i.ZZ_ACTION[e]){case 1:return this.debug("{other}"),new A.LVal(this.yytext(),A.Type.NORMAL);case 44:break;case 2:this.debug("{xq_start}"),this.yybegin(i.xq),this.ltstr="";case 45:break;case 3:this.debug("{xdq_start}"),this.yybegin(i.xdq),this.ltstr="",this.ltstr+=this.yytext();case 46:break;case 4:return this.debug("{self} | {op_chars}"),new A.LVal(this.yytext(),A.Type.NORMAL);case 47:break;case 5:return this.debug("{identifier}"),new A.LVal(this.yytext(),A.Type.NORMAL);case 48:break;case 6:return this.debug("{integer}"),new A.LVal(this.yytext(),A.Type.INT);case 49:break;case 7:return this.debug("{whitespace} | {comment} | {c_line_comment}"),new A.LVal(this.yytext(),A.Type.WHITESPACE_OR_COMMENT);case 50:break;case 8:this.debug("<xc>{xc_inside}"),this.ltstr+=this.yytext();case 51:break;case 9:this.debug("<xc>[\\/] | <xc>[\\*]"),this.ltstr+=this.yytext();case 52:break;case 10:this.debug("<xq>{xq_inside}"),this.ltstr+=this.yytext();case 53:break;case 11:return this.debug("<xq>{xq_stop}"),this.yybegin(i.YYINITIAL),new A.LVal(this.ltstr,A.Type.STRING);case 54:break;case 12:this.debug("<xdq>{xdq_inside}"),this.ltstr+=this.yytext();case 55:break;case 13:return this.debug("<xdq>{xdq_stop}"),this.yybegin(i.YYINITIAL),this.ltstr+=this.yytext(),new A.LVal(this.ltstr,A.Type.NORMAL);case 56:break;case 14:this.debug("<xbin>{xbin_inside}"),this.ltstr+=this.yytext();case 57:break;case 15:return this.debug("<xbin>{xbin_stop}"),this.yybegin(i.YYINITIAL),this.ltstr+=this.yytext(),new A.LVal(this.ltstr,A.Type.NORMAL);case 58:break;case 16:this.debug("<xhex>{xhex_inside}"),this.ltstr+=this.yytext();case 59:break;case 17:return this.debug("<xhex>{xhex_stop}"),this.yybegin(i.YYINITIAL),this.ltstr+=this.yytext(),new A.LVal(this.ltstr,A.Type.NORMAL);case 60:break;case 18:this.ltstr+=this.yytext();case 61:break;case 19:this.yybegin(i.xq2_2);case 62:break;case 20:this.ltstr+="]",this.ltstr+=this.yytext(),this.yybegin(i.xq2);case 63:break;case 21:return this.yybegin(i.YYINITIAL),new A.LVal(this.ltstr,A.Type.STRING);case 64:break;case 22:this.ltstr+="]",this.yybegin(i.xq2_2);case 65:break;case 23:this.debug("{xc_start}"),this.yybegin(i.xc),this.ltstr=this.yytext();case 66:break;case 24:this.debug("{xbin_start}"),this.yybegin(i.xbin),this.ltstr="",this.ltstr+=this.yytext();case 67:break;case 25:this.debug("{xhex_start}"),this.yybegin(i.xhex),this.ltstr="",this.ltstr+=this.yytext();case 68:break;case 26:return this.debug("{decimal}"),new A.LVal(this.yytext(),A.Type.DECIMAL);case 69:break;case 27:return this.debug("{real}"),new A.LVal(this.yytext(),A.Type.DOUBLE);case 70:break;case 28:return this.debug("{assign}"),new A.LVal(this.yytext(),A.Type.NORMAL);case 71:break;case 29:return this.debug("{selstar}"),new A.LVal(this.yytext(),A.Type.NORMAL);case 72:break;case 30:return this.debug("{boundary}"),new A.LVal(this.yytext(),A.Type.NORMAL);case 73:break;case 31:this.debug("<xc>{xc_start}"),this.ltstr+=this.yytext();case 74:break;case 32:return this.debug("<xc>{xc_stop}"),this.yybegin(i.YYINITIAL),this.ltstr+=this.yytext(),new A.LVal(this.ltstr,A.Type.WHITESPACE_OR_COMMENT);case 75:break;case 33:this.debug("<xq>{xq_double}"),this.ltstr+="'";case 76:break;case 34:this.debug("<xdq>{xdq_double}"),this.ltstr+=this.yytext();case 77:break;case 35:this.yybegin(i.xq2),this.ltstr="";case 78:break;case 36:return this.debug("{integer_with_boundary}"),new A.LVal(this.yytext(),A.Type.NORMAL);case 79:break;case 37:return this.debug("{hex_integer}"),new A.LVal(this.yytext(),A.Type.HEX_INT);case 80:break;case 38:this.debug("<xq>{xq_cat}");case 81:break;case 39:this.debug("<xbin>{xbin_cat}");case 82:break;case 40:this.debug("<xhex>{xhex_cat}");case 83:break;case 41:return this.debug("{null}"),new A.LVal("null",A.Type.NULL);case 84:break;case 42:return this.debug("{is_null}"),new A.LVal(this.yytext(),A.Type.NORMAL);case 85:break;case 43:return this.debug("{not_null}"),new A.LVal(this.yytext(),A.Type.NORMAL);case 86:break;default:this.zzScanError(i.ZZ_NO_MATCH)}}},i.YYEOF=-1,i.ZZ_BUFFERSIZE=16384,i.YYINITIAL=0,i.xc=2,i.xq=4,i.xdq=6,i.xsb=8,i.xbin=10,i.xhex=12,i.xhint=14,i.xq2=16,i.xq2_2=18,i.ZZ_LEXSTATE=[0,0,1,1,2,2,3,3,4,4,5,5,6,6,4,4,7,7,8,8],i.ZZ_CMAP=i.zzUnpackCMap(i.ZZ_CMAP_PACKED=[9,0,1,22,1,21,1,24,1,22,1,21,18,0,1,22,1,15,1,2,2,10,2,15,1,1,2,15,1,4,1,19,1,15,1,23,1,14,1,3,1,16,9,11,1,12,1,15,1,15,1,13,3,15,1,17,1,8,1,17,1,20,1,18,1,20,2,10,1,28,2,10,1,27,1,10,1,25,1,30,1,10,1,7,1,10,1,29,1,31,1,26,2,10,1,9,2,10,1,5,1,0,1,6,1,15,1,10,1,0,1,17,1,8,1,17,1,20,1,18,1,20,2,10,1,28,2,10,1,27,1,10,1,25,1,30,1,10,1,7,1,10,1,29,1,31,1,26,2,10,1,9,2,10,1,15,1,15,2,15,1,0,5,10,1,10,122,10,7976,0,1,24,1,24,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,65535,0,57318,0]),i.ZZ_ACTION_PACKED_0=[9,0,1,1,1,2,1,3,2,4,4,5,1,6,2,4,1,6,1,7,1,4,2,5,1,8,2,9,1,10,1,11,1,12,1,13,1,14,1,15,1,16,1,17,1,18,1,19,1,20,1,21,1,22,1,7,1,23,1,0,1,24,1,25,1,26,1,0,1,27,1,28,1,29,1,26,1,30,1,0,3,5,1,31,1,32,1,0,1,33,2,0,1,34,4,0,1,35,1,36,1,27,1,0,1,37,2,5,3,0,1,38,1,39,1,40,1,41,16,0,1,42,1,0,1,43,1,42,1,43],i.ZZ_ACTION=i.zzUnpackActionNoParams(),i.ZZ_ROWMAP_PACKED_0=[0,0,0,32,0,64,0,96,0,128,0,160,0,192,0,224,0,256,0,128,0,128,0,128,0,288,0,128,0,320,0,352,0,384,0,416,0,448,0,480,0,512,0,544,0,128,0,576,0,608,0,640,0,672,0,704,0,736,0,768,0,800,0,832,0,864,0,896,0,928,0,960,0,992,0,1024,0,128,0,128,0,128,0,128,0,1056,0,128,0,1088,0,128,0,128,0,1120,0,1152,0,128,0,128,0,128,0,1184,0,128,0,1216,0,1248,0,1280,0,1312,0,128,0,128,0,736,0,128,0,1344,0,1376,0,128,0,1408,0,928,0,1440,0,992,0,128,0,128,0,1472,0,1472,0,1216,0,1504,0,1536,0,1568,0,1600,0,1632,0,128,0,128,0,128,0,416,0,1664,0,1696,0,1728,0,1760,0,1792,0,1824,0,1856,0,1888,0,1920,0,1952,0,1984,0,2016,0,2048,0,2080,0,2112,0,2144,0,128,0,2176,0,128,0,1760,0,1824],i.ZZ_ROWMAP=i.zzUnpackRowMapNoParams(),i.ZZ_TRANS_PACKED_0=[1,10,1,11,1,12,1,13,3,14,1,15,1,16,1,17,1,18,1,19,1,20,1,14,1,21,1,14,1,22,2,18,1,14,1,18,2,23,1,24,1,0,1,25,2,18,1,26,3,18,3,27,1,28,1,29,27,27,1,30,1,31,30,30,2,32,1,33,29,32,32,0,1,34,1,35,30,34,1,36,1,37,30,36,6,38,1,39,25,38,1,40,1,41,4,40,1,42,25,40,3,0,1,43,1,44,28,0,1,45,5,0,5,18,4,0,3,18,1,0,1,18,4,0,7,18,1,0,1,46,5,0,5,18,4,0,3,18,1,0,1,18,4,0,7,18,1,0,1,47,5,0,5,18,4,0,3,18,1,0,1,18,4,0,7,18,7,0,5,18,4,0,3,18,1,0,1,18,4,0,7,18,11,0,1,19,2,0,1,48,1,0,1,19,1,0,1,49,1,0,1,50,24,0,1,51,22,0,1,52,6,0,1,53,2,0,1,54,1,0,1,53,24,0,1,55,1,0,1,19,2,0,1,48,1,0,1,19,1,0,1,49,1,0,1,50,34,0,1,43,15,0,5,18,4,0,3,18,1,0,1,18,4,0,1,18,1,56,3,18,1,57,1,18,7,0,5,18,4,0,3,18,1,0,1,18,4,0,4,18,1,58,2,18,3,27,2,0,27,27,4,0,1,59,30,0,1,60,1,61,27,0,1,30,1,0,30,30,1,0,1,62,19,0,1,63,1,64,9,0,2,32,1,0,29,32,2,0,1,65,29,0,1,34,1,0,30,34,21,0,1,66,1,67,9,0,1,36,1,0,30,36,21,0,1,68,1,69,9,0,6,38,1,0,25,38,21,43,1,0,10,43,5,0,1,70,37,0,1,53,2,0,1,71,1,0,1,53,1,0,1,49,1,0,1,50,22,0,1,72,4,0,1,72,2,0,1,73,3,0,1,73,19,0,1,53,4,0,1,53,1,0,1,49,1,0,1,50,19,0,1,74,2,0,1,74,4,0,3,74,1,0,1,74,18,0,5,18,4,0,3,18,1,0,1,18,4,0,2,18,1,75,4,18,7,0,5,18,4,0,3,18,1,0,1,18,4,0,6,18,1,76,3,0,1,77,3,0,5,18,4,0,3,18,1,0,1,18,2,78,1,79,1,0,7,18,1,0,1,80,19,0,2,63,30,0,1,63,1,64,10,0,1,81,19,0,2,66,10,0,1,82,19,0,2,68,20,0,1,72,4,0,1,72,22,0,5,18,4,0,3,18,1,0,1,18,4,0,2,18,1,83,4,18,3,0,1,84,3,0,5,18,4,0,3,18,1,0,1,18,2,85,1,86,1,0,7,18,3,0,1,87,31,0,1,77,17,0,2,78,1,79,1,0,1,88,29,0,1,87,11,0,1,89,31,0,1,84,17,0,2,85,1,86,1,0,1,90,29,0,1,89,8,0,21,87,1,78,3,87,1,91,6,87,26,0,1,92,5,0,21,89,1,85,3,89,1,93,6,89,26,0,1,94,5,0,21,87,1,78,3,87,1,91,1,95,5,87,27,0,1,96,4,0,21,89,1,85,3,89,1,93,1,97,5,89,27,0,1,98,4,0,21,87,1,78,3,87,1,91,1,87,1,99,4,87,27,0,1,100,4,0,21,89,1,85,3,89,1,93,1,89,1,101,4,89,27,0,1,102,4,0,21,87,1,78,3,87,1,91,1,87,1,103,4,87,21,89,1,85,3,89,1,93,1,89,1,104,4,89],i.ZZ_TRANS=i.zzUnpackTransNoParams(),i.ZZ_UNKNOWN_ERROR=0,i.ZZ_NO_MATCH=1,i.ZZ_PUSHBACK_2BIG=2,i.ZZ_ERROR_MSG=["Unknown internal scanner error","Error: could not match input","Error: pushback value was too large"],i.ZZ_ATTRIBUTE_PACKED_0=[4,0,1,8,4,0,3,9,1,1,1,9,8,1,1,9,15,1,4,9,1,1,1,9,1,0,2,9,1,1,1,0,3,9,1,1,1,9,1,0,3,1,2,9,1,0,1,9,2,0,1,9,4,0,2,9,1,1,1,0,3,1,3,0,3,9,1,1,16,0,1,9,1,0,1,9,2,1],i.ZZ_ATTRIBUTE=i.zzUnpackAttributeNoParams(),i}();Ei.Lexer=qu});var bn=E(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});var Ti=R(),Vu=J(),Xt=Dt(),Hu=function(){function i(t,e,r){if(this.sign=0,this.weight=0,this.prec=0,this.scale=0,this.digits="",t!==void 0&&e!=null&&r!=null){if(Xt.DBType.isFloat(Xt.DBType.DECIMAL,r)?(this.prec=Xt.DBType.getFloatPrec(e),this.scale=-1):(this.prec=e,this.scale=r),t==null||t.length==0||t.length>i.XDEC_SIZE)throw Ti.DBError.ECJS_FATAL_ERROR();if(t[0]==i.FLAG_ZERO||t.length==1)return;this.sign=(t[0]&i.FLAG_ZERO)!=0?1:-1;for(var n,o=Vu.BufferUtil.M(t,0),a=0<this.sign?o-i.FLAG_POSITIVE:i.FLAG_NEGTIVE-o,c="",u=1;u<t.length&&!((n=0<this.sign?t[u]-i.NUM_POSITIVE:i.NUM_NEGTIVE-t[u])<0||99<n);u++)n<10&&(c+="0"),c+=n;this.digits=c,this.weight=2*a-(this.digits.length-2)}}return i.fromNumber=function(t,e,r){var n=new i;if(Xt.DBType.isFloat(Xt.DBType.DECIMAL,r)?(n.prec=Xt.DBType.getFloatPrec(e),n.scale=-1):(n.prec=e,n.scale=r),n.sign=Math.sign(t),t===0)return n;var o=Math.abs(t).toLocaleString("en-IN",{useGrouping:!1,maximumFractionDigits:20});return o!=="0"&&o!=="-0"||(o=Math.abs(t).toFixed(38))!=="0.00000000000000000000000000000000000000"?this.fromString((n.sign===-1?"-":"")+o,e,r):(n.sign=0,n)},i.fromString=function(t,e,r){if(Number.isNaN(Number(t)))throw Ti.DBError.ECJS_DATA_CONVERTION_ERROR();var n=t,o=new i;Xt.DBType.isFloat(Xt.DBType.DECIMAL,r)?(o.prec=Xt.DBType.getFloatPrec(e),o.scale=-1):(o.prec=e,o.scale=r),o.sign=Math.sign(Number(n)),o.sign===-1&&(n=n.substr(1));var a=n.indexOf("."),c=0,u=0,h=n.length;if(a!==-1)if(n[0]==="0"){for(c=u=2;c<h&&n[c]==="0";c++);n=n.substring(c),o.weight-=c-u+n.length}else n=n.substring(0,a)+n.substring(a+1),o.weight-=h-a-1;for(c=u=(h=n.length)-1;0<c&&n[c]==="0";c--);return n=n.substring(0,c+1)+n.substring(h),o.weight+=u-c,o.weight%2!=0&&(n+="0",o.weight--),n.length%2!=0&&(n="0"+n),o.digits=n,o},i.prototype.encode=function(){if(this.isZero())return Buffer.from([i.FLAG_ZERO]);var t=(this.weight+this.digits.length)/2-1;if(i.EXP_MAX<t||t<i.EXP_MIN)throw Ti.DBError.EC_DATA_OVERFLOW();var e=this.digits.length/2+1,e=this.sign<0&&i.XDEC_SIZE<=e?i.XDEC_SIZE-1:i.XDEC_SIZE<e?i.XDEC_SIZE:e,r=this.sign<0?e+1:e,n=Buffer.alloc(r);n[0]=0<this.sign?t+i.FLAG_POSITIVE:i.FLAG_NEGTIVE-t;for(var o,a=1,c=0;a<e;)o=10*parseInt(this.digits.charAt(c++),10)+parseInt(this.digits.charAt(c++),10),n[a++]=0<this.sign?o+i.NUM_POSITIVE:i.NUM_NEGTIVE-o;return this.sign<0&&a<r&&(n[a++]=102),a<r&&(n[a]=0),n},i.prototype.toNumber=function(){if(this.isZero())return Number(0);var t=(this.sign<0?"-":"")+this.digits,e=Number(t);return 0<this.weight?e*=Number("1"+"0".repeat(this.weight)):this.weight<0&&(e/=Number("1"+"0".repeat(-this.weight))),e},i.prototype.toString=function(){if(this.isZero())return"0";var t=this.digits;return 0<this.weight?t+="0".repeat(this.weight):this.weight<0&&(t=(t=t.padStart(1-this.weight,"0")).substring(0,t.length+this.weight)+"."+t.substring(t.length+this.weight)),t[0]==="0"&&t[1]!=="."&&(t=t.substr(1)),t[t.length-1]==="0"&&0<=t.indexOf(".")&&(t=t.substr(0,t.length-1)),t=(this.sign<0?"-":"")+t},i.prototype.isZero=function(){return this.sign===0},i.XDEC_SIZE=21,i.FLAG_ZERO=128,i.FLAG_POSITIVE=193,i.FLAG_NEGTIVE=62,i.EXP_MAX=254-i.FLAG_POSITIVE,i.EXP_MIN=i.FLAG_NEGTIVE+1-127,i.NUM_POSITIVE=1,i.NUM_NEGTIVE=101,i}();yi.Numeric=Hu});var $o=E(ur=>{"use strict";var Gu=ur&&ur.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ur,"__esModule",{value:!0});var ht=pi(),zu=Xo(),W=Bt(),Mt=Dt(),mi=D(),In=J(),Zu=bn(),Ko=R(),Qu=function(){function i(){}return i.lex=function(t){for(var e,r=new zu.Lexer(t,!1),n=0,o=new Array;(e=r.yylex())!=null;)e.position=n++,o.push(e);return o},i.escape=function(t,e){var r,n;if(e.length===0&&!t.includes("{"))return t;var o=new Map;if(0<e.length)try{for(var a=Gu(e),c=a.next();!c.done;c=a.next()){var u=c.value;o.set(u.toLowerCase(),null)}}catch(P){r={error:P}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}for(var h="",s=new Array,l=this.lex(t),_=0;_<l.length;_++){var f,y,T,m=l[_];m.type==ht.Type.NORMAL?m.value==="{"?(f=this.next(l,_+1))&&f.type==ht.Type.NORMAL?W.StringUtil.equalsIgnoreCase(f.value,"escape")||W.StringUtil.equalsIgnoreCase(f.value,"call")?s.push(!0):W.StringUtil.equalsIgnoreCase(f.value,"oj")?(s.push(!0),f.value="",f.type=ht.Type.WHITESPACE_OR_COMMENT):W.StringUtil.equalsIgnoreCase(f.value,"d")?(s.push(!0),f.value="date"):W.StringUtil.equalsIgnoreCase(f.value,"t")?(s.push(!0),f.value="time"):W.StringUtil.equalsIgnoreCase(f.value,"ts")?(s.push(!0),f.value="datetime"):W.StringUtil.equalsIgnoreCase(f.value,"fn")?(s.push(!0),f.value="",f.type=ht.Type.WHITESPACE_OR_COMMENT,(y=i.next(l,f.position+1))&&y.type==ht.Type.NORMAL&&W.StringUtil.equalsIgnoreCase(y.value,"database")&&(y.value="cur_database")):f.value==="?"&&(y=i.next(l,f.position+1))&&y.type==ht.Type.NORMAL&&W.StringUtil.equalsIgnoreCase(y.value,"=")&&(T=i.next(l,y.position+1))&&T.type==ht.Type.NORMAL&&W.StringUtil.equalsIgnoreCase(T.value,"call")?(s.push(!0),T.value="",T.type=ht.Type.WHITESPACE_OR_COMMENT):(s.push(!1),h+=m.value):(s.push(!1),h+=m.value):m.value==="}"?0<s.length&&s.pop()||(h+=m.value):o&&o.has(m.value.toLowerCase())?h+='"'+W.StringUtil.processDoubleQuoteOfName(m.value.toUpperCase())+'"':h+=m.value:m.type==ht.Type.STRING?h+="'"+W.StringUtil.processSingleQuoteOfName(m.value)+"'":h+=m.value}return h},i.execOpt=function(t,e,r){var n="",o=this.lex(t);if(!o||o.length===0)return t;var a=o[0].value;if(!(W.StringUtil.equalsIgnoreCase(a,"insert")||W.StringUtil.equalsIgnoreCase(a,"select")||W.StringUtil.equalsIgnoreCase(a,"update")||W.StringUtil.equalsIgnoreCase(a,"delete")))return t;for(var c=0;c<o.length;c++){var u=o[c],h=void 0;switch(u.type){case ht.Type.NULL:n+="?",e.push(new Be(null,Mt.DBType.NULL,Mt.DBType.NULL_PREC));break;case ht.Type.INT:n+="?";try{h=BigInt(u.value)}catch(s){throw Ko.DBError.ECJS_DATA_CONVERTION_ERROR(s+"")}h<=mi.Const.INT32_MAX&&h>=mi.Const.INT32_MIN?e.push(new Be(In.BufferUtil.s(Number(h)),Mt.DBType.INT,Mt.DBType.INT_PREC)):e.push(new Be(In.BufferUtil.o(h),Mt.DBType.BIGINT,Mt.DBType.BIGINT_PREC));break;case ht.Type.DOUBLE:if(n+="?",h=parseFloat(u.value),Number.isNaN(h))throw Ko.DBError.ECJS_DATA_CONVERTION_ERROR();e.push(new Be(In.BufferUtil.d(h),Mt.DBType.DOUBLE,Mt.DBType.DOUBLE_PREC));break;case ht.Type.DECIMAL:n+="?",e.push(new Be(Zu.Numeric.fromString(u.value,0,0).encode(),Mt.DBType.DECIMAL,0));break;case ht.Type.STRING:if(u.value.length>mi.Const.INT16_MAX){n+="'"+W.StringUtil.processSingleQuoteOfName(u.value)+"'";break}n+="?",e.push(new Be(In.BufferUtil.b(u.value,r),Mt.DBType.VARCHAR,Mt.DBType.VARCHAR_PREC));break;case ht.Type.HEX_INT:default:n+=u.value}}return n},i.next=function(t,e){for(var r=null,n=e;n<t.length&&(r=t[n]).type===ht.Type.WHITESPACE_OR_COMMENT;n++);return r},i}();ur.SQLProcessor=Qu;var Be=function(){function i(t,e,r){this.ioType=0,this.scale=0,this.bytes=t,this.type=e,this.prec=r}return i.prototype.toString=function(){return this.bytes?this.bytes.toString():"null"},i}();ur.OptParameter=Be});var ts=E(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});var Ju=function(i,t,e){this.handle=i,this.cursorName=t,this.readBaseColName=e};Si.StmtInfo=Ju});var rs=E(Me=>{"use strict";var ju=Me&&Me.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Wu=Me&&Me.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Me,"__esModule",{value:!0});var Xu=Fr(),Ku=An(),$u=function(){function i(){this.a=1}return i.removeLast=function(){if(this.rsKeyList.length===0)return 0;var t=this.rsKeyList.pop();if(!t)return 0;var e=this.rsMap.get(t);return e?(this.rsMap.delete(t),e.getDataLen()):0},i.refreshKeyList=function(t){var e=this.rsKeyList.indexOf(t);e!==-1&&this.rsKeyList.splice(e,1),this.rsKeyList.unshift(t)},i.put=function(t,e,r){for(var n=r?r.rsSizeof:0,o=1024*t.connection.conn_prop_rsCacheSize*1024;this.totalDataLen+n>o;){if(this.totalDataLen===0)return;this.totalDataLen-=this.removeLast()}var a=JSON.stringify(new es(t.connection.guid||"",t.connection.schema||"",e,t));this.refreshKeyList(a);var c=new th(r);this.rsMap.set(a,c),this.totalDataLen+=n},i.get=function(t,e,r,n){var o=JSON.stringify(new es(t,e,r,n)),a=this.rsMap.get(o);if(a){if(!a.refreshed(n.connection))return this.refreshKeyList(o),a;this.rsMap.delete(o);var c=this.rsKeyList.indexOf(o);c!==-1&&this.rsKeyList.splice(c,1)}},i.rsMap=new Map,i.rsKeyList=new Array,i.totalDataLen=0,i}();Me.ResultSetCachePool=$u;var es=function(){function i(t,e,r,n){this.paramCount=0,this.dbGuid=t,this.currentSchema=e,this.sql=r,n instanceof Xu.PreparedStatement&&(this.paramCount=n.paramCount,this.paramObjects=n.curRowObjects)}return i.prototype.equals=function(t){return this.dbGuid===t.dbGuid&&this.currentSchema===t.currentSchema&&this.sql===t.sql&&this.paramCount===t.paramCount},i}(),th=function(){function i(t){this.execInfo=t,this.m_TbIds=t.tbIds.slice(),this.m_TbTss=t.tbTss.slice(),this.m_lastCheckTime=Date.now()}return i.prototype.refreshed=function(t){return ju(this,void 0,void 0,function(){var e,r;return Wu(this,function(n){switch(n.label){case 0:return t.conn_prop_rsRefreshFreq===0?[2,!1]:this.m_lastCheckTime+1e3*t.conn_prop_rsRefreshFreq>Date.now()?[2,!1]:[4,t.access.K(this.m_TbIds)];case 1:if(e=n.sent(),this.m_lastCheckTime=Date.now(),e.length!==this.m_TbTss.length)return[2,!0];for(r=0;r<e.length;r++)if(this.m_TbTss[r]!==e[r])return[2,!0];return[2,!1]}})})},i.prototype.getResultSet=function(t){var e=this.execInfo.rsDatas,r=e?e.length:0;0<t.maxRows&&t.maxRows<r&&(e=e.slice(0,Number(t.maxRows)));var n=new Ku.ResultSet(t,t.columns,t.execInfo,e);return n.id=1,n},i.prototype.getDataLen=function(){return this.execInfo.rsSizeof},i}()});var On=E(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});var eh=function(){function i(){this.bufferArray=new Array,this.length=0}return i.prototype.putBuffer=function(t,e,r){var n;r!==0&&(n=new rh(t,e,r),this.currentNode?this.bufferArray.push(n):this.currentNode=n,this.length+=r)},i.prototype.readDmBuffer=function(t,e){for(var r,n=0;n<e&&this.currentNode;)r=this.currentNode.readDmBuffer(t,e-n),this.currentNode.length===0&&this.next(),n+=r,this.length-=r;return n},i.prototype.readBuffer=function(t,e,r){for(var n,o=0;o<r&&this.currentNode;)n=this.currentNode.readBuffer(t,e,r),this.currentNode.length===0&&this.next(),o+=n,this.length-=n,e+=n;return o},i.prototype.readWritable=function(t,e){for(var r,n=0;n<e&&this.currentNode;)r=this.currentNode.readWritable(t,e-n),this.currentNode.length===0&&this.next(),n+=r,this.length-=r;return n},i.prototype.append=function(t){if(t.length!==0){for(var e;e=t.currentNode;)this.addNode(e),t.next();t.length=0}},i.prototype.next=function(){this.currentNode=this.bufferArray.shift()},i.prototype.addNode=function(t){t.length!==0&&(this.currentNode?this.bufferArray.push(t):this.currentNode=t,this.length+=t.length)},i}();gi.BufferArray=eh;var rh=function(){function i(t,e,r){this.buf=t,this.start=e,this.length=r}return i.prototype.readDmBuffer=function(t,e){return e=this.length>e?e:this.length,t.qt(this.buf.subarray(this.start,this.start+e)),this.start+=e,this.length-=e,e},i.prototype.readBuffer=function(t,e,r){return r=this.length>r?r:this.length,t=t.fill(this.buf.subarray(this.start,this.start+r),e,e+r),this.start+=r,this.length-=r,r},i.prototype.readWritable=function(t,e){return e=this.length>e?e:this.length,t.write(this.buf.subarray(this.start,this.start+e)),this.start+=e,this.length-=e,e},i}()});var Ue=E(Pe=>{"use strict";var nh=Pe&&Pe.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},ih=Pe&&Pe.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Pe,"__esModule",{value:!0});var vi=D(),oh=On(),sh=function(){function i(t,e,r){this.readOver=!1,this.position=0,this.offRow=!1,this.obj=t,this.encoding=e,this.targetLength=r||vi.Const.IGNORE_TARGET_LENGTH,this.buffer=new oh.BufferArray}return i.prototype.init=function(){return nh(this,void 0,void 0,function(){return ih(this,function(t){switch(t.label){case 0:return[4,this.read(this.buffer)];case 1:return t.sent(),this.offRow=this.buffer.length>vi.Const.PUT_LOB_LEN,[2,this]}})})},i.prototype.getBufferLeaveLen=function(){return this.buffer.length},i.prototype.readFromBuffer=function(t){t.append(this.buffer)},i.READ_LEN=vi.Const.MAX_BLOB_LEN_PER_MSG,i}();Pe.OffRowBinder=sh});var os=E(Kt=>{"use strict";var ah=Kt&&Kt.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ns=Kt&&Kt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},is=Kt&&Kt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Kt,"__esModule",{value:!0});var ch=Ue(),uh=function(i){function t(e,r){return i.call(this,e,r)||this}return ah(t,i),t.prototype.read=function(e){return ns(this,void 0,void 0,function(){return is(this,function(r){return 0<this.getBufferLeaveLen()?this.readFromBuffer(e):this.readOver||(e.putBuffer(this.obj,0,this.obj.length),this.readOver=!0),[2]})})},t.prototype.readAll=function(){return ns(this,void 0,void 0,function(){return is(this,function(e){return[2,this.obj]})})},t}(ch.OffRowBinder);Kt.OffRowBufferBinder=uh});var Ii=E(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});var C=J(),b=R(),hh=function(){function i(t,e,r,n,o,a,c,u){if(this.scaleForSvr=0,this.leadScale=2,this.secScale=6,this.negative=!1,this.type=i.QUA_D,this.days=0,this.hours=0,this.minutes=0,this.seconds=0,this.fraction=0,t instanceof Buffer){switch(this.type=t[21],this.scaleForSvr=C.BufferUtil.t(t,20),this.leadScale=this.scaleForSvr>>4&15,this.secScale=15&this.scaleForSvr,this.type){case i.QUA_D:this.days=C.BufferUtil.t(t,0);break;case i.QUA_DH:this.days=C.BufferUtil.t(t,0),this.hours=C.BufferUtil.t(t,4);break;case i.QUA_DHM:this.days=C.BufferUtil.t(t,0),this.hours=C.BufferUtil.t(t,4),this.minutes=C.BufferUtil.t(t,8);break;case i.QUA_DHMS:this.days=C.BufferUtil.t(t,0),this.hours=C.BufferUtil.t(t,4),this.minutes=C.BufferUtil.t(t,8),this.seconds=C.BufferUtil.t(t,12),this.fraction=C.BufferUtil.t(t,16);break;case i.QUA_H:this.hours=C.BufferUtil.t(t,4);break;case i.QUA_HM:this.hours=C.BufferUtil.t(t,4),this.minutes=C.BufferUtil.t(t,8);break;case i.QUA_HMS:this.hours=C.BufferUtil.t(t,4),this.minutes=C.BufferUtil.t(t,8),this.seconds=C.BufferUtil.t(t,12),this.fraction=C.BufferUtil.t(t,16);break;case i.QUA_M:this.minutes=C.BufferUtil.t(t,8);break;case i.QUA_MS:this.minutes=C.BufferUtil.t(t,8),this.seconds=C.BufferUtil.t(t,12),this.fraction=C.BufferUtil.t(t,16);break;case i.QUA_S:this.seconds=C.BufferUtil.t(t,12),this.fraction=C.BufferUtil.t(t,16)}this.days<0&&(this.days=-this.days,this.negative=!0),this.hours<0&&(this.hours=-this.hours,this.negative=!0),this.minutes<0&&(this.minutes=-this.minutes,this.negative=!0),this.seconds<0&&(this.seconds=-this.seconds,this.negative=!0),this.fraction<0&&(this.fraction=-this.fraction,this.negative=!0)}else typeof t=="string"?this.parseIntervalDTString(t):(this.type=t,this.negative=e,this.leadScale=u>>4&15,this.secScale=15&u,this.days=r,this.hours=n,this.minutes=o,this.seconds=a,this.fraction=c,this.scaleForSvr=u)}return i.prototype.encode=function(t){t==0&&(t=this.scaleForSvr);var e,r,n=this.days,o=this.hours,a=this.minutes,c=this.seconds,u=this.fraction;t!=this.scaleForSvr?(n=(e=this.convertTo(t)).days,o=e.hours,a=e.minutes,c=e.seconds,u=e.fraction):(r=t>>4&15,this.checkScale(r));var h=Buffer.alloc(24);return C.BufferUtil.v(h,0,this.negative?-n:n),C.BufferUtil.v(h,4,this.negative?-o:o),C.BufferUtil.v(h,8,this.negative?-a:a),C.BufferUtil.v(h,12,this.negative?-c:c),C.BufferUtil.v(h,16,this.negative?-u:u),C.BufferUtil.v(h,20,t),h},i.prototype.toString=function(){var t,e,r,n,o,a,c,u="INTERVAL ";switch(this.type){case i.QUA_D:if(r=this.days.toString(),this.negative&&(u+="-"),r.length<this.leadScale)for(t=r.length,e=this.leadScale;e-- >t;)r="0"+r;u+="'"+r+"' DAY("+this.leadScale+")";break;case i.QUA_DH:if(r=this.days.toString(),n=this.hours.toString(),this.negative&&(u+="-"),r.length<this.leadScale)for(t=r.length,e=this.leadScale;e-- >t;)r="0"+r;n.length<2&&(n="0"+n),u+="'"+r+" "+n+"' DAY("+this.leadScale+") TO HOUR";break;case i.QUA_DHM:if(r=this.days.toString(),n=this.hours.toString(),o=this.minutes.toString(),this.negative&&(u+="-"),r.length<this.leadScale)for(t=r.length,e=this.leadScale;e-- >t;)r="0"+r;n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),u+="'"+r+" "+n+":"+o+"' DAY("+this.leadScale+") TO MINUTE";break;case i.QUA_DHMS:if(r=this.days.toString(),n=this.hours.toString(),o=this.minutes.toString(),a=this.seconds.toString(),c=this.getMsecString(),this.negative&&(u+="-"),r.length<this.leadScale)for(t=r.length,e=this.leadScale;e-- >t;)r="0"+r;n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),a.length<2&&(a="0"+a),u+="'"+r+" "+n+":"+o+":"+a+(c!==""?"."+c:"")+"' DAY("+ +this.leadScale+") TO SECOND("+this.secScale+")";break;case i.QUA_H:if(n=this.hours.toString(),this.negative&&(u+="-"),n.length<this.leadScale)for(t=n.length,e=this.leadScale;e-- >t;)n="0"+n;u+="'"+n+"' HOUR("+this.leadScale+")";break;case i.QUA_HM:if(n=this.hours.toString(),o=this.minutes.toString(),this.negative&&(u+="-"),n.length<this.leadScale)for(t=n.length,e=this.leadScale;e-- >t;)n="0"+n;o.length<2&&(o="0"+o),u+="'"+n+":"+o+"' HOUR("+this.leadScale+") TO MINUTE";break;case i.QUA_HMS:if(c=this.getMsecString(),n=this.hours.toString(),o=this.minutes.toString(),a=this.seconds.toString(),this.negative&&(u+="-"),n.length<this.leadScale)for(t=n.length,e=this.leadScale;e-- >t;)n="0"+n;o.length<2&&(o="0"+o),a.length<2&&(a="0"+a),u+="'"+n+":"+o+":"+a+(c!==""?"."+c:"")+"' HOUR("+this.leadScale+") TO SECOND("+this.secScale+")";break;case i.QUA_M:if(o=this.minutes.toString(),this.negative&&(u+="-"),o.length<this.leadScale)for(t=o.length,e=this.leadScale;e-- >t;)o="0"+o;u+="'"+o+"' MINUTE("+this.leadScale+")";break;case i.QUA_MS:if(c=this.getMsecString(),o=this.minutes.toString(),a=this.seconds.toString(),this.negative&&(u+="-"),o.length<this.leadScale)for(t=o.length,e=this.leadScale;e-- >t;)o="0"+o;a.length<2&&(a="0"+a),u+="'"+o+":"+a+(c!==""?"."+c:"")+"' MINUTE("+this.leadScale+") TO SECOND("+this.secScale+")";break;case i.QUA_S:if(c=this.getMsecString(),a=this.seconds.toString(),this.negative&&(u+="-"),a.length<this.leadScale)for(t=a.length,e=this.leadScale;e-- >t;)a="0"+a;u+="'"+a+(c!==""?"."+c:"")+"' SECOND("+this.leadScale+", "+this.secScale+")"}return u},i.prototype.convertTo=function(t){var e=(65280&t)>>8,r=t>>4&15,n=15&t,o=new Array(5),a=new Array(5);switch(this.type){case i.QUA_D:o[0]=this.days;break;case i.QUA_DH:o[0]=this.days,o[1]=this.hours;break;case i.QUA_DHM:o[0]=this.days,o[1]=this.hours,o[2]=this.minutes;break;case i.QUA_DHMS:o[0]=this.days,o[1]=this.hours,o[2]=this.minutes,o[3]=this.seconds,o[4]=this.fraction;break;case i.QUA_H:o[0]=Math.trunc(this.hours/24),o[1]=this.hours%24;break;case i.QUA_HM:o[0]=Math.trunc(this.hours/24),o[1]=this.hours%24,o[2]=this.minutes;break;case i.QUA_HMS:o[0]=Math.trunc(this.hours/24),o[1]=this.hours%24,o[2]=this.minutes,o[3]=this.seconds,o[4]=this.fraction;break;case i.QUA_M:o[0]=Math.trunc(this.minutes/1440),o[1]=Math.trunc(this.minutes%1440/60),o[2]=this.minutes%1440%60;break;case i.QUA_MS:o[0]=Math.trunc(this.minutes/1440),o[1]=Math.trunc(this.minutes%1440/60),o[2]=this.minutes%1440%60,o[3]=this.seconds,o[4]=this.fraction;break;case i.QUA_S:o[0]=Math.trunc(this.seconds/86400),o[1]=Math.trunc(this.seconds%86400/3600),o[2]=Math.trunc(this.seconds%86400%3600/60),o[3]=this.seconds%86400%3600%60,o[4]=this.fraction}switch(e){case i.QUA_D:if(a[0]=o[0],12<=o[1]&&this.incrementDay(i.QUA_D,a),r<Math.abs(a[0]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_DH:if(a[0]=o[0],a[1]=o[1],30<=o[2]&&this.incrementHour(i.QUA_DH,a),r<Math.abs(a[0]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_DHM:if(a[0]=o[0],a[1]=o[1],a[2]=o[2],30<=o[3]&&this.incrementMinute(i.QUA_DHM,a),r<Math.abs(a[0]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_DHMS:if(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],this.convertMSecond(i.QUA_DHMS,a,n),r<Math.abs(a[0]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_H:if(a[1]=24*o[0]+o[1],30<=o[2]&&this.incrementHour(i.QUA_H,a),r<Math.abs(a[1]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_HM:if(a[1]=24*o[0]+o[1],a[2]=o[2],30<=o[3]&&this.incrementMinute(i.QUA_HM,a),r<Math.abs(a[1]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_HMS:if(a[1]=24*o[0]+o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],this.convertMSecond(i.QUA_HMS,a,n),r<Math.abs(a[1]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_M:if(a[2]=24*o[0]*60+60*o[1]+o[2],30<=o[3]&&this.incrementMinute(i.QUA_M,a),r<Math.abs(a[2]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_MS:if(a[2]=24*o[0]*60+60*o[1]+o[2],a[3]=o[3],a[4]=o[4],this.convertMSecond(i.QUA_MS,a,n),r<Math.abs(a[2]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_S:if(a[3]=24*o[0]*60*60+60*o[1]*60+60*o[2]+o[3],a[4]=o[4],this.convertMSecond(i.QUA_S,a,n),r<Math.abs(a[3]).toString().length)throw b.DBError.ECJS_INTERVAL_OVERFLOW()}return new i(e,this.negative,a[0],a[1],a[2],a[3],a[4],t)},i.prototype.convertMSecond=function(t,e,r){var n=e[4];if(r===0||r<this.secScale){var o=Math.pow(10,6-r-1),a=Math.trunc(n/o/10);if(5<=n/o%10&&(a=++a*o*10)==1e6)return e[4]=0,void this.incrementSecond(t,e);e[4]=a}},i.prototype.getMsecString=function(){for(var t=""+this.fraction,e=6-t.length;0<e;e--)t="0"+t;return t.length>this.secScale&&(t=t.substring(0,this.secScale)),t},i.prototype.parseIntervalDTString=function(t){if(!t)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();var e=t.trim().toUpperCase();if(!e.startsWith("INTERVAL "))throw b.DBError.ECJS_INVALID_TIME_INTERVAL();try{e=e.substring(e.indexOf(" ")).trim();var r=0,n=null;if(e.charAt(0)==="'"&&(r=e.indexOf("'",1))!==-1&&(n=e.substring(1,r).trim(),n=this.checkSign(n),e=e.substring(r+1).trim()),n===null){if((e=this.checkSign(e)).charAt(0)!=="'"||(r=e.indexOf("'",1))===-1)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();n=e.substring(1,r).trim(),e=e.substring(r+1).trim()}var o="",a="",c=0,u=0,h=0;if((c=e.indexOf("DAY"))!=-1){if((h=e.indexOf("TO",c))==-1)o=e.substring(c).trim(),this.setDay(n);else if(o=e.substring(c,h).trim(),e.indexOf("HOUR",h)!=-1)this.setDayToHour(n);else if(e.indexOf("MINUTE",h)!=-1)this.setDayToMinute(n);else{if((u=e.indexOf("SECOND",h))==-1)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();a=e.substring(u),this.setDayToSecond(n)}return void this.setPrecForSvr(e,o,a)}if((c=e.indexOf("HOUR"))!=-1){if((h=e.indexOf("TO",c))==-1)o=e.substring(c),this.setHour(n);else if(o=e.substring(c,h),e.indexOf("MINUTE",h)!=-1)this.setHourToMinute(n);else{if((u=e.indexOf("SECOND",h))==-1)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();a=e.substring(u),this.setHourToSecond(n)}return void this.setPrecForSvr(e,o,a)}if((c=e.indexOf("MINUTE"))!=-1){if((h=e.indexOf("TO",c))==-1)o=e.substring(c),this.setMinute(n);else{if(o=e.substring(c,h),(u=e.indexOf("SECOND",h))==-1)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();a=e.substring(u),this.setMinuteToSecond(n)}return void this.setPrecForSvr(e,o,a)}if((c=e.indexOf("SECOND"))!=-1){this.setSecond(n);var s=(e=e.substring(c).trim()).indexOf(",");return s!=-1&&(o=e.substring(0,s).trim()+")",a="("+e.substring(s+1).trim()),void this.setPrecForSvr(e,o,a)}}catch(l){throw l instanceof b.DBError?l:b.DBError.ECJS_INVALID_TIME_INTERVAL(l+"")}throw b.DBError.ECJS_INVALID_TIME_INTERVAL()},i.prototype.checkSign=function(t){return t.charAt(0)==="-"?(t=t.substring(1).trim(),this.negative=!0):t.charAt(0)=="+"&&(t=t.substring(1).trim(),this.negative=!1),t},i.prototype.setPrecForSvr=function(t,e,r){var n=this.checkScale(this.parsePrec(e));this.leadScale=n<i.LOADPREC_DEFAULT?i.LOADPREC_DEFAULT:n,n=this.parsePrec(r),this.secScale=0<n&&n<i.SECDPREC_MAX?n:i.SECDPREC_DEFAULT,this.scaleForSvr=(this.type<<8)+(this.leadScale<<4)+this.secScale},i.prototype.checkScale=function(t){switch(this.type){case i.QUA_D:if(t===-1)t=Math.abs(this.days).toString().length;else if(t<Math.abs(this.days).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_DH:if(t===-1)t=Math.abs(this.days).toString().length;else if(t<Math.abs(this.days).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();if(23<Math.abs(this.hours))throw b.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_DHM:if(t===-1)t=Math.abs(this.days).toString().length;else if(t<Math.abs(this.days).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();if(23<Math.abs(this.hours)||59<Math.abs(this.minutes))throw b.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_DHMS:if(t===-1)t=Math.abs(this.days).toString().length;else if(t<Math.abs(this.days).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();if(23<Math.abs(this.hours)||59<Math.abs(this.minutes)||59<Math.abs(this.seconds))throw b.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_H:if(t===-1)t=Math.abs(this.hours).toString().length;else if(t<Math.abs(this.hours).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_HM:if(t===-1)t=Math.abs(this.hours).toString().length;else if(t<Math.abs(this.hours).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();if(59<Math.abs(this.minutes))throw b.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_HMS:if(t===-1)t=Math.abs(this.hours).toString().length;else if(t<Math.abs(this.hours).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();if(59<Math.abs(this.minutes)||59<Math.abs(this.seconds))throw b.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_M:if(t===-1)t=Math.abs(this.minutes).toString().length;else if(t<Math.abs(this.minutes).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_MS:if(t===-1)t=Math.abs(this.minutes).toString().length;else if(t<Math.abs(this.minutes).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();if(59<Math.abs(this.seconds))throw b.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_S:if(t===-1)t=Math.abs(this.seconds).toString().length;else if(t<Math.abs(this.seconds).toString().length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL()}if(i.LOADPREC_MAX<t)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();return t},i.prototype.parsePrec=function(t){var e,r=t.indexOf("("),n=t.indexOf(")"),o=-1;return n!==-1&&r!==-1&&r+1<n&&(e=t.substring(r+1,n).trim(),o=parseInt(e)),o},i.prototype.incrementDay=function(t,e){e[0]++},i.prototype.incrementHour=function(t,e){e[1]++,e[1]==24&&t<i.QUA_H&&(this.incrementDay(t,e),e[1]=0)},i.prototype.incrementMinute=function(t,e){e[2]++,e[2]==60&&t<i.QUA_M&&(this.incrementHour(t,e),e[2]=0)},i.prototype.incrementSecond=function(t,e){e[3]++,e[3]==60&&t<i.QUA_S&&(this.incrementMinute(t,e),e[3]=0)},i.prototype.setDay=function(t){if(1<t.split(/[ :.]+/).length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_D;var e=parseInt(t);this.days=e<0?-e:e,e<0&&(this.negative=!0)},i.prototype.setHour=function(t){if(1<t.split(/[ :.]+/).length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_H;var e=parseInt(t);this.hours=e<0?-e:e,e<0&&(this.negative=!0)},i.prototype.setMinute=function(t){if(1<t.split(/[ :.]+/).length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_M;var e=parseInt(t);this.minutes=e<0?-e:e,e<0&&(this.negative=!0)},i.prototype.setSecond=function(t){var e=t.split(/[ :.]+/);if(2<e.length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_S;var r,n,o,a=parseInt(e[0]),c=0;1<e.length&&(r="0."+e[1],n=parseFloat(r),o=Math.pow(10,this.secScale),c=parseInt((n*o).toFixed(0))),this.seconds=a<0?-a:a,this.fraction=c<0?-c:c,(a<0||c<0)&&(this.negative=!0)},i.prototype.setHourToSecond=function(t){var e=t.split(/[ :.]+/);if(4<e.length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_HMS;var r,n,o,a=parseInt(e[0]),c=parseInt(e[1]),u=parseInt(e[2]),h=0;3<e.length&&(r="0."+e[3],n=parseFloat(r),o=Math.pow(10,this.secScale),h=parseInt((n*o).toFixed(0))),this.hours=a<0?-a:a,this.minutes=c<0?-c:c,this.seconds=u<0?-u:u,this.fraction=h<0?-h:h,(a<0||c<0||u<0||h<0)&&(this.negative=!0)},i.prototype.setHourToMinute=function(t){var e=(t=t.trim()).split(/[ :.]+/);if(2<e.length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_HM;var r=parseInt(e[0]),n=parseInt(e[1]);if(2<e.length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.hours=r<0?-r:r,this.minutes=n<0?-n:n,(r<0||n<0)&&(this.negative=!0)},i.prototype.setMinuteToSecond=function(t){var e=t.split(/[ :.]+/);if(3<e.length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_MS;var r,n,o,a=parseInt(e[0]),c=parseInt(e[1]),u=0;2<e.length&&(r="0."+e[2],n=parseFloat(r),o=Math.pow(10,this.secScale),u=parseInt((n*o).toFixed(0))),this.minutes=a<0?-a:a,this.seconds=c<0?-c:c,this.fraction=u<0?-u:u,(a<0||c<0||u<0)&&(this.negative=!0)},i.prototype.setDayToHour=function(t){var e=t.split(/[ :.]+/);if(2<e.length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_DH;var r=parseInt(e[0]),n=parseInt(e[1]);this.days=r<0?-r:r,this.hours=n<0?-n:n,(r<0||n<0)&&(this.negative=!0)},i.prototype.setDayToMinute=function(t){var e=t.split(/[ :.]+/);if(3<e.length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_DHM;var r=parseInt(e[0]),n=parseInt(e[1]),o=parseInt(e[2]);this.days=r<0?-r:r,this.hours=n<0?-n:n,this.minutes=o<0?-o:o,(r<0||n<0||o<0)&&(this.negative=!0)},i.prototype.setDayToSecond=function(t){var e=t.split(/[ :.]+/);if(5<e.length)throw b.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_DHMS;var r,n,o,a=parseInt(e[0]),c=parseInt(e[1]),u=parseInt(e[2]),h=parseInt(e[3]),s=0;4<e.length&&(r="0."+e[4],n=parseFloat(r),o=Math.pow(10,this.secScale),s=Math.trunc(n*o)),this.days=a<0?-a:a,this.hours=c<0?-c:c,this.minutes=u<0?-u:u,this.seconds=h<0?-h:h,this.fraction=s<0?-s:s,(a<0||c<0||u<0||h<0||s<0)&&(this.negative=!0)},i.LOADPREC_DEFAULT=2,i.LOADPREC_MAX=9,i.SECDPREC_DEFAULT=6,i.SECDPREC_MAX=6,i.QUA_D=3,i.QUA_DH=4,i.QUA_DHM=5,i.QUA_DHMS=6,i.QUA_H=7,i.QUA_HM=8,i.QUA_HMS=9,i.QUA_M=10,i.QUA_MS=11,i.QUA_S=12,i}();bi.IntervalDT=hh});var Oi=E(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});var ue=J(),lt=R(),lh=function(){function i(t,e,r,n){if(this.scaleForSvr=0,this.leadScale=0,this.isLeadScaleSet=!1,this.type=i.QUA_Y,this.years=0,this.months=0,Buffer.isBuffer(t))switch(this.scaleForSvr=ue.BufferUtil.t(t,8),this.leadScale=this.scaleForSvr>>4&15,this.type=t[9],this.type){case i.QUA_Y:this.years=ue.BufferUtil.t(t,0);break;case i.QUA_YM:this.years=ue.BufferUtil.t(t,0),this.months=ue.BufferUtil.t(t,4);break;case i.QUA_MO:this.months=ue.BufferUtil.t(t,4)}else typeof t=="string"?(this.isLeadScaleSet=!1,this.parseIntervalYMString(t)):(this.type=t,this.years=e,this.months=r,this.scaleForSvr=n,this.leadScale=n>>4&15)}return i.prototype.encode=function(t){t==0&&(t=this.scaleForSvr);var e,r=this.years,n=this.months;this.checkScale(this.leadScale),t!=this.scaleForSvr?(r=(e=this.convertTo(t)).years,n=e.months):this.checkScale(this.leadScale);var o=Buffer.alloc(12);return ue.BufferUtil.v(o,0,r),ue.BufferUtil.v(o,4,n),ue.BufferUtil.v(o,8,t),o},i.prototype.toString=function(){var t,e,r,n,o="INTERVAL ";switch(this.type){case i.QUA_Y:if(t=Math.abs(this.years).toString(),this.years<0&&(o+="-"),this.leadScale>t.length)for(r=t.length,n=this.leadScale;n-- >r;)t="0"+t;o+="'"+t+"' YEAR("+this.leadScale+")";break;case i.QUA_YM:if(t=Math.abs(this.years).toString(),e=Math.abs(this.months).toString(),(this.years<0||this.months<0)&&(o+="-"),this.leadScale>t.length)for(r=t.length,n=this.leadScale;n-- >r;)t="0"+t;e.length<2&&(e="0"+e),o+="'"+t+"-"+e+"' YEAR("+this.leadScale+") TO MONTH";break;case i.QUA_MO:if(e=Math.abs(this.months).toString(),this.months<0&&(o+="-"),this.leadScale>e.length)for(r=e.length,n=this.leadScale;n-- >r;)e="0"+e;o+="'"+e+"' MONTH("+this.leadScale+")"}return o},i.prototype.convertTo=function(t){var e=(65280&t)>>8,r=t>>4&15,n=12*this.years+this.months,o=0,a=0;switch(e){case i.QUA_Y:if(o=Math.trunc(n/12),6<=n%12?o++:n%12<=-6&&o--,r<Math.abs(o).toString().length)throw lt.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_YM:if(o=Math.trunc(n/12),a=n%12,r<Math.abs(o).toString().length)throw lt.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_MO:if(a=n,r<Math.abs(a).toString().length)throw lt.DBError.ECJS_INTERVAL_OVERFLOW()}return new i(e,o,a,t)},i.prototype.parseIntervalYMString=function(t){if(!t)throw lt.DBError.ECJS_INVALID_TIME_INTERVAL();var e=(t=t.toUpperCase()).split(" ");if(e.length<3||e[0]!=="INTERVAL"||!e[2].startsWith("YEAR")&&!e[2].startsWith("MONTH"))throw lt.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_YM;var r=t.indexOf("YEAR"),n=t.indexOf("MONTH");if(t.indexOf("TO")==-1)if(r!==-1&&n===-1)this.type=i.QUA_Y,this.leadScale=this.getLeadPrec(t,r);else{if(n===-1||r!==-1)throw lt.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_MO,this.leadScale=this.getLeadPrec(t,n)}else{if(r===-1||n===-1)throw lt.DBError.ECJS_INVALID_TIME_INTERVAL();this.type=i.QUA_YM,this.leadScale=this.getLeadPrec(t,r)}this.scaleForSvr=(this.type<<8)+(this.leadScale<<4);var o=this.getTimeValue(e[1],this.type);this.years=o[0],this.months=o[1],this.checkScale(this.leadScale)},i.prototype.getLeadPrec=function(t,e){if(this.isLeadScaleSet)return this.leadScale;var r=t.indexOf("(",e),n=t.indexOf(")",e),o=0;if(n===-1&&r===-1){var a,c,u=t.indexOf("'"),h=u!==-1?t.indexOf("'",u+1):-1,s=h!==-1?t.substring(u+1,h).trim():"";o=s?((a=s.charAt(0))!=="+"&&a!=="-"||(s=s.substring(1).trim()),(s=(c=s.indexOf("-"))!==-1?s.substring(0,c):s).length):2}else{if(!(n!==-1&&r!==-1&&r+1<n))throw lt.DBError.ECJS_INVALID_TIME_INTERVAL();var l=t.substring(r+1,n).trim();o=parseInt(l)}return o},i.prototype.getTimeValue=function(t,e){var r=!1;t.charAt(0)==="'"&&t.charAt(t.length-1)==="'"&&(r=!0,t=t.substring(1,t.length-1).trim());var n=!1;if(t.startsWith("-")?(n=!0,t=t.substring(1)):t.startsWith("+")&&(n=!1,t=t.substring(1)),t.charAt(0)==="'"&&t.charAt(t.length-1)==="'"&&(r=!0,t=t.substring(1,t.length-1).trim()),!r)throw lt.DBError.ECJS_INVALID_TIME_INTERVAL();var o,a,c=t.lastIndexOf("-"),u=new Array(2);if(c===-1||c===0?(u[0]=t,u[1]=""):(u[0]=t.substring(0,c),u[1]=t.substring(c+1)),e==i.QUA_YM){if(o=parseInt(u[0]),a=u[1]===""?0:parseInt(u[1]),n&&(o*=-1,a*=-1),o>Math.pow(10,this.leadScale)-1||o<1-Math.pow(10,this.leadScale))throw lt.DBError.ECJS_INVALID_TIME_INTERVAL()}else if(e==i.QUA_Y){if(o=parseInt(u[0]),a=0,n&&(o*=-1),o>Math.pow(10,this.leadScale)-1||o<1-Math.pow(10,this.leadScale))throw lt.DBError.ECJS_INVALID_TIME_INTERVAL()}else if(o=0,a=parseInt(u[0]),n&&(a*=-1),a>Math.pow(10,this.leadScale)-1||a<1-Math.pow(10,this.leadScale))throw lt.DBError.ECJS_INVALID_TIME_INTERVAL();return[o,a]},i.prototype.checkScale=function(t){switch(this.type){case i.QUA_Y:if(t<Math.abs(this.years).toString().length)throw lt.DBError.ECJS_INTERVAL_OVERFLOW();break;case i.QUA_YM:if(t<Math.abs(this.years).toString().length)throw lt.DBError.ECJS_INTERVAL_OVERFLOW();if(11<Math.abs(this.months))throw lt.DBError.ECJS_INVALID_TIME_INTERVAL();break;case i.QUA_MO:if(t<Math.abs(this.months).toString().length)throw lt.DBError.ECJS_INTERVAL_OVERFLOW()}},i.QUA_Y=0,i.QUA_YM=1,i.QUA_MO=2,i}();Ai.IntervalYM=lh});var ss=E(Fe=>{"use strict";var fh=Fe&&Fe.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},_h=Fe&&Fe.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Fe,"__esModule",{value:!0});var ph=Yt(),dh=function(){function i(t){this.m_name="",this.m_pkgName="",this.m_schName="",this.m_fullName="",this.m_schId=-1,this.m_pkgId=-1,typeof t=="string"?this.m_fullName=t:this.m_conn=t}return i.prototype.getFullName=function(){return fh(this,void 0,void 0,function(){var t;return _h(this,function(e){switch(e.label){case 0:return 0<this.m_fullName.length?[2,this.m_fullName]:this.m_name?this.m_pkgId==0&&this.m_schId==0?[3,2]:[4,this.m_conn.execute("SELECT NAME FROM SYS.SYSOBJECTS WHERE ID=?",[this.m_pkgId||this.m_schId],{resultSet:!1,outFormat:ph.dmdb.OUT_FORMAT_ARRAY})]:[2,""];case 1:t=e.sent(),this.m_pkgId!=0?(this.m_pkgName=t.rows[0][0],this.m_fullName=this.m_pkgName+"."+this.m_name):(this.m_schName=t.rows[0][0],this.m_fullName=this.m_schName+"."+this.m_name),e.label=2;case 2:return[2,0<this.m_fullName.length?this.m_fullName:this.m_name]}})})},i}();Fe.SQLName=dh});var Ln=E(xe=>{"use strict";var as=xe&&xe.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},cs=xe&&xe.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(xe,"__esModule",{value:!0});var Eh=Cr(),us=ss(),k=Dt(),I=D(),Th=Tn(),ft=J(),Li=R(),yh=function(){function i(t,e){this.column=new Eh.Column,this.m_objId=-1,this.m_objVersion=-1,this.m_outerId=0,this.m_outerVer=0,this.m_subId=0,this.m_cltnType=0,this.m_maxCnt=0,this.m_length=0,this.m_size=0,this.m_sqlName=e?new us.SQLName(e):new us.SQLName(t),this.m_conn=t}return i.prototype.parseDescByName=function(){return as(this,void 0,void 0,function(){var t,e;return cs(this,function(r){switch(r.label){case 0:return[4,this.m_conn.execute("BEGIN ? = SF_DESCRIBE_TYPE(?); END;",["",this.m_sqlName.m_fullName])];case 1:return t=r.sent(),[4,t.outBinds[0].getData()];case 2:return e=r.sent(),this.m_serverEncoding=this.m_conn.getServerEncoding(),this.unpack(new Th.DmBuffer(e)),[2]}})})},i.prototype.getFullName=function(){return as(this,void 0,void 0,function(){return cs(this,function(t){return[2,this.m_sqlName.getFullName()]})})},i.prototype.getDType=function(){return this.column.type},i.prototype.getPrec=function(){return this.column.prec},i.prototype.getScale=function(){return this.column.scale},i.prototype.getServerEncoding=function(){return this.m_serverEncoding||this.m_conn.getServerEncoding()},i.prototype.getObjId=function(){return this.m_objId},i.prototype.getStaticArrayLength=function(){return this.m_length},i.prototype.getStructMemSize=function(){return this.m_size},i.prototype.getOuterId=function(){return this.m_outerId},i.prototype.getCltnType=function(){return this.m_cltnType},i.prototype.getMaxCnt=function(){return this.m_maxCnt},i.getPackSize=function(t){var e=0;switch(t.column.type){case k.DBType.ARRAY:case k.DBType.SARRAY:return this.getPackArraySize(t);case k.DBType.CLASS:return this.getPackClassSize(t);case k.DBType.PLTYPE_RECORD:return this.getPackRecordSize(t)}return e+=I.Const.ULINT_SIZE,e+=I.Const.ULINT_SIZE,e+=I.Const.ULINT_SIZE},i.pack=function(t,e){switch(t.column.type){case k.DBType.ARRAY:case k.DBType.SARRAY:return this.packArray(t,e);case k.DBType.CLASS:return this.packClass(t,e);case k.DBType.PLTYPE_RECORD:return this.packRecord(t,e)}e.q(t.column.type),e.q(t.column.prec),e.q(t.column.scale)},i.getPackArraySize=function(t){var e=0;e+=I.Const.ULINT_SIZE;var r=t.m_sqlName.m_name;return e+=I.Const.USINT_SIZE,e+=ft.BufferUtil.b(r,t.getServerEncoding()).length,e+=I.Const.ULINT_SIZE,e+=I.Const.ULINT_SIZE,e+=I.Const.ULINT_SIZE,e+=this.getPackSize(t.m_arrObj)},i.packArray=function(t,e){e.q(t.column.type),e.k(t.m_sqlName.m_name,t.getServerEncoding()),e.q(t.m_objId),e.q(t.m_objVersion),e.q(t.m_length),this.pack(t.m_arrObj,e)},i.packRecord=function(t,e){e.q(t.column.type),e.k(t.m_sqlName.m_name,t.getServerEncoding()),e.q(t.m_objId),e.q(t.m_objVersion),e.m(t.m_size);for(var r=0;r<t.m_size;r++)this.pack(t.m_fieldsObj[r],e)},i.getPackRecordSize=function(t){var e=0;e+=I.Const.ULINT_SIZE;var r=t.m_sqlName.m_name;e+=I.Const.USINT_SIZE,e+=ft.BufferUtil.b(r,t.getServerEncoding()).length,e+=I.Const.ULINT_SIZE,e+=I.Const.ULINT_SIZE,e+=I.Const.USINT_SIZE;for(var n=0;n<t.m_size;n++)e+=this.getPackSize(t.m_fieldsObj[n]);return e},i.getPackClassSize=function(t){var e=0;e+=I.Const.ULINT_SIZE;var r=t.m_sqlName.m_name;return e+=I.Const.USINT_SIZE,e+=ft.BufferUtil.b(r,t.getServerEncoding()).length,e+=I.Const.ULINT_SIZE,e+=I.Const.ULINT_SIZE,t.m_objId==4&&(e+=I.Const.ULINT_SIZE,e+=I.Const.ULINT_SIZE,e+=I.Const.USINT_SIZE),e},i.packClass=function(t,e){e.q(t.column.type),e.k(t.m_sqlName.m_name,t.getServerEncoding()),e.q(t.m_objId),e.q(t.m_objVersion),t.m_objId==4&&(e.q(t.m_outerId),e.q(t.m_outerVer),e.q(t.m_subId))},i.prototype.unpack=function(t){switch(this.column.type=t.N(),this.column.type){case k.DBType.ARRAY:case k.DBType.SARRAY:return void this.unpackArray(t);case k.DBType.CLASS:return void this.unpackClass(t);case k.DBType.PLTYPE_RECORD:return void this.unpackRecord(t)}this.column.prec=t.N(),this.column.scale=t.N()},i.prototype.unpackArray=function(t){this.m_sqlName.m_name=t.g(this.getServerEncoding()),this.m_sqlName.m_schId=t.N(),this.m_sqlName.m_pkgId=t.N(),this.m_objId=t.N(),this.m_objVersion=t.N(),this.m_length=t.N(),this.column.type==k.DBType.ARRAY&&(this.m_length=0),this.m_arrObj=new i(this.m_conn),this.m_arrObj.unpack(t)},i.prototype.unpackRecord=function(t){this.m_sqlName.m_name=t.g(this.getServerEncoding()),this.m_sqlName.m_schId=t.N(),this.m_sqlName.m_pkgId=t.N(),this.m_objId=t.N(),this.m_objVersion=t.N(),this.m_size=t.x(),this.m_fieldsObj=new Array(this.m_size);for(var e=0;e<this.m_size;e++)this.m_fieldsObj[e]=new i(this.m_conn),this.m_fieldsObj[e].unpack(t)},i.prototype.unpackClnt_nestTab=function(t){this.m_maxCnt=t.N(),this.m_arrObj=new i(this.m_conn),this.m_arrObj.unpack(t)},i.prototype.unpackClnt=function(t){switch(this.m_outerId=t.N(),this.m_outerVer=t.N(),this.m_subId=t.x(),this.m_cltnType=t.x(),this.m_cltnType){case i.CLTN_TYPE_IND_TABLE:throw Li.DBError.ECJS_UNSUPPORTED_TYPE();case i.CLTN_TYPE_NST_TABLE:case i.CLTN_TYPE_VARRAY:this.unpackClnt_nestTab(t)}},i.prototype.unpackClass=function(t){if(this.m_sqlName.m_name=t.g(this.getServerEncoding()),this.m_sqlName.m_schId=t.N(),this.m_sqlName.m_pkgId=t.N(),this.m_objId=t.N(),this.m_objVersion=t.N(),this.m_objId==4)this.unpackClnt(t);else{this.m_size=t.x(),this.m_fieldsObj=new Array(this.m_size);for(var e=0;e<this.m_size;e++)this.m_fieldsObj[e]=new i(this.m_conn),this.m_fieldsObj[e].unpack(t)}},i.prototype.calcChkDescLen_array=function(t){var e=0;return e+=I.Const.USINT_SIZE,e+=I.Const.ULINT_SIZE,e+=this.calcChkDescLen(t)},i.prototype.calcChkDescLen_record=function(t){var e=0;e+=I.Const.USINT_SIZE,e+=I.Const.USINT_SIZE;for(var r=0;r<t.m_size;r++)e+=this.calcChkDescLen(t.m_fieldsObj[r]);return e},i.prototype.calcChkDescLen_class_normal=function(t){var e=0;e+=I.Const.USINT_SIZE;for(var r=0;r<t.m_size;r++)e+=this.calcChkDescLen(t.m_fieldsObj[r]);return e},i.prototype.calcChkDescLen_class_cnlt=function(t){var e=0;switch(e+=I.Const.USINT_SIZE,e+=I.Const.ULINT_SIZE,t.getCltnType()){case i.CLTN_TYPE_IND_TABLE:throw Li.DBError.ECJS_UNSUPPORTED_TYPE();case i.CLTN_TYPE_VARRAY:case i.CLTN_TYPE_NST_TABLE:e+=this.calcChkDescLen(t.m_arrObj)}return e},i.prototype.calcChkDescLen_class=function(t){var e=0;return e+=I.Const.USINT_SIZE,e+=I.Const.BYTE_SIZE,t.m_objId==4?e+=this.calcChkDescLen_class_cnlt(t):e+=this.calcChkDescLen_class_normal(t),e},i.prototype.calcChkDescLen_buildin=function(){var t=0;return t+=I.Const.USINT_SIZE,t+=I.Const.USINT_SIZE,t+=I.Const.USINT_SIZE},i.prototype.calcChkDescLen=function(t){var e=0;switch(t.getDType()){case k.DBType.ARRAY:case k.DBType.SARRAY:e=this.calcChkDescLen_array(t);break;case k.DBType.PLTYPE_RECORD:e=this.calcChkDescLen_record(t);break;case k.DBType.CLASS:e=this.calcChkDescLen_class(t);break;default:e=this.calcChkDescLen_buildin()}return e},i.prototype.makeChkDesc_array=function(t,e){return ft.BufferUtil.y(this.m_descBuf,t,k.DBType.ARRAY),t+=I.Const.USINT_SIZE,ft.BufferUtil.v(this.m_descBuf,t,e.m_length),t+=I.Const.ULINT_SIZE,t=this.makeChkDesc(t,e)},i.prototype.makeChkDesc_record=function(t,e){ft.BufferUtil.y(this.m_descBuf,t,k.DBType.PLTYPE_RECORD),t+=I.Const.USINT_SIZE,ft.BufferUtil.y(this.m_descBuf,t,e.m_size),t+=I.Const.USINT_SIZE;for(var r=0;r<e.m_size;r++)t=this.makeChkDesc(t,e.m_fieldsObj[r]);return t},i.prototype.makeChkDesc_buildin=function(t,e){var r=e.getDType(),n=0,o=0;return r!=k.DBType.BLOB&&(n=e.getPrec(),o=e.getScale()),ft.BufferUtil.y(this.m_descBuf,t,r),t+=I.Const.USINT_SIZE,ft.BufferUtil.y(this.m_descBuf,t,n),t+=I.Const.USINT_SIZE,ft.BufferUtil.y(this.m_descBuf,t,o),t+=I.Const.USINT_SIZE},i.prototype.makeChkDesc_class_normal=function(t,e){ft.BufferUtil.y(this.m_descBuf,t,e.m_size),t+=I.Const.USINT_SIZE;for(var r=0;r<e.m_size;r++)t=this.makeChkDesc(t,e.m_fieldsObj[r]);return t},i.prototype.makeChkDesc_class_clnt=function(t,e){switch(ft.BufferUtil.y(this.m_descBuf,t,e.m_cltnType),t+=I.Const.USINT_SIZE,ft.BufferUtil.v(this.m_descBuf,t,e.getMaxCnt()),t+=I.Const.ULINT_SIZE,e.m_cltnType){case i.CLTN_TYPE_IND_TABLE:throw Li.DBError.ECJS_UNSUPPORTED_TYPE();case i.CLTN_TYPE_NST_TABLE:case i.CLTN_TYPE_VARRAY:t=this.makeChkDesc(t,e.m_arrObj)}return t},i.prototype.makeChkDesc_class=function(t,e){ft.BufferUtil.y(this.m_descBuf,t,k.DBType.CLASS),t+=I.Const.USINT_SIZE;var r=!1;return e.m_objId==4&&(r=!0),r?ft.BufferUtil.l(this.m_descBuf,t,1):ft.BufferUtil.l(this.m_descBuf,t,0),t+=I.Const.BYTE_SIZE,t=r?this.makeChkDesc_class_clnt(t,e):this.makeChkDesc_class_normal(t,e)},i.prototype.makeChkDesc=function(t,e){switch(e.getDType()){case k.DBType.ARRAY:case k.DBType.SARRAY:t=this.makeChkDesc_array(t,e);break;case k.DBType.PLTYPE_RECORD:t=this.makeChkDesc_record(t,e);break;case k.DBType.CLASS:t=this.makeChkDesc_class(t,e);break;default:t=this.makeChkDesc_buildin(t,e)}return t},i.prototype.getClassDescChkInfo=function(){if(this.m_descBuf!=null)return this.m_descBuf;var t=this.calcChkDescLen(this);return this.m_descBuf=Buffer.alloc(t),this.makeChkDesc(0,this),this.m_descBuf},i.OBJ_BLOB_MAGIC=78111999,i.CLTN_TYPE_VARRAY=1,i.CLTN_TYPE_NST_TABLE=2,i.CLTN_TYPE_IND_TABLE=3,i}();xe.TypeDescriptor=yh});var fs=E(Ci=>{"use strict";Object.defineProperty(Ci,"__esModule",{value:!0});var mh=Ln(),Di=J(),hs=D(),ls=R(),Sh=function(){function i(){}return i.objBlobToBuffer=function(t,e){var r=0,n=Di.BufferUtil.t(t,0);if(r+=hs.Const.ULINT_SIZE,mh.TypeDescriptor.OBJ_BLOB_MAGIC!=n)throw ls.DBError.ECJS_INVALID_OBJ_BLOB();var o=Di.BufferUtil.t(t,r);if(r+=hs.Const.ULINT_SIZE,!Di.BufferUtil.p(t,r,o).equals(e.getClassDescChkInfo()))throw ls.DBError.ECJS_INVALID_OBJ_BLOB();r+=o;var a=Buffer.alloc(t.length-r);return t.copy(a,0,r,r+a.length),a},i}();Ci.TypeData=Sh});var ds=E($t=>{"use strict";var gh=$t&&$t.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),_s=$t&&$t.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},ps=$t&&$t.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty($t,"__esModule",{value:!0});var wi=Ue(),vh=function(i){function t(e,r){return i.call(this,e,r)||this}return gh(t,i),t.prototype.read=function(e){return _s(this,void 0,void 0,function(){var r,n,o,a;return ps(this,function(c){switch(c.label){case 0:return 0<this.getBufferLeaveLen()?(this.readFromBuffer(e),[3,4]):[3,1];case 1:return this.readOver?[3,4]:[4,this.obj.getLength()];case 2:return r=c.sent(),n=r-this.position,o=n>wi.OffRowBinder.READ_LEN?wi.OffRowBinder.READ_LEN:n,[4,this.obj.getBytes(this.position+1,o)];case 3:a=c.sent(),this.position+=o,this.position===r&&(this.readOver=!0),e.putBuffer(a,0,a.length),c.label=4;case 4:return[2]}})})},t.prototype.readAll=function(){return _s(this,void 0,void 0,function(){var e,r,n;return ps(this,function(o){switch(o.label){case 0:return r=(e=this.obj).getBytes,n=[1],[4,this.obj.getLength()];case 1:return[2,r.apply(e,n.concat([o.sent()]))]}})})},t}(wi.OffRowBinder);$t.OffRowBlobBinder=vh});var ms=E(te=>{"use strict";var bh=te&&te.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Es=te&&te.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Ts=te&&te.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(te,"__esModule",{value:!0});var Ri=Ue(),ys=J(),Ih=function(i){function t(e,r){return i.call(this,e,r)||this}return bh(t,i),t.prototype.read=function(e){return Es(this,void 0,void 0,function(){var r,n,o,a,c;return Ts(this,function(u){switch(u.label){case 0:return 0<this.getBufferLeaveLen()?(this.readFromBuffer(e),[3,4]):[3,1];case 1:return this.readOver?[3,4]:[4,this.obj.getLength()];case 2:return r=u.sent(),n=r-this.position,o=n>Ri.OffRowBinder.READ_LEN?Ri.OffRowBinder.READ_LEN:n,[4,this.obj.getSubString(this.position+1,o)];case 3:a=u.sent(),c=ys.BufferUtil.b(a,this.encoding),this.position+=o,this.position===r&&(this.readOver=!0),e.putBuffer(c,0,c.length),u.label=4;case 4:return[2]}})})},t.prototype.readAll=function(){return Es(this,void 0,void 0,function(){var e,r,n,o,a;return Ts(this,function(c){switch(c.label){case 0:return r=(e=ys.BufferUtil).b,o=(n=this.obj).getSubString,a=[1],[4,this.obj.getLength()];case 1:return[4,o.apply(n,a.concat([c.sent()]))];case 2:return[2,r.apply(e,[c.sent(),this.encoding])]}})})},t}(Ri.OffRowBinder);te.OffRowClobBinder=Ih});var vs=E(ee=>{"use strict";var Ah=ee&&ee.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ss=ee&&ee.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},gs=ee&&ee.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(ee,"__esModule",{value:!0});var Oh=Ue(),Lh=function(i){function t(e,r){return i.call(this,e,r)||this}return Ah(t,i),t.prototype.read=function(e){return Ss(this,void 0,void 0,function(){var r=this;return gs(this,function(n){if(0<this.getBufferLeaveLen())this.readFromBuffer(e);else if(!this.readOver)return[2,new Promise(function(o,a){r.obj.resume(),r.obj.on("data",function(c){if(!(c instanceof Buffer))try{c=Buffer.from(c)}catch(u){a(u)}e.putBuffer(c,0,c.length)}),r.obj.on("end",function(){r.readOver=!0,o()}),r.obj.on("error",function(c){a(c)})})];return[2]})})},t.prototype.readAll=function(){return Ss(this,void 0,void 0,function(){var e;return gs(this,function(r){return e=Buffer.alloc(this.buffer.length),this.buffer.readBuffer(e,0,this.buffer.length),[2,e]})})},t}(Oh.OffRowBinder);ee.OffRowReadableBinder=Lh});var Cs=E(ke=>{"use strict";var Pt=ke&&ke.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Ut=ke&&ke.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(ke,"__esModule",{value:!0});var p=Dt(),q=J(),H=R(),Ft=D(),Dh=qn(),wt=be(),Ni=bn(),Ch=os(),bs=Bt(),xr=si(),wh=Ii(),Rh=Oi(),Bi=fs(),Nh=ds(),Bh=ms(),Mh=vs(),Ph=function(){function i(){}return i.fromBoolean=function(t,e,r){switch(e.type){case p.DBType.BOOLEAN:case p.DBType.BIT:case p.DBType.TINYINT:case p.DBType.SMALLINT:case p.DBType.INT:case p.DBType.BIGINT:case p.DBType.REAL:case p.DBType.DOUBLE:case p.DBType.DECIMAL:case p.DBType.CHAR:case p.DBType.VARCHAR2:case p.DBType.VARCHAR:case p.DBType.CLOB:return this.fromNumber(t?1:0,e,r);case p.DBType.BINARY:case p.DBType.VARBINARY:case p.DBType.BLOB:return q.BufferUtil.a(t?1:0);default:throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}},i.fromNumber=function(t,e,r){switch(e.type){case p.DBType.BOOLEAN:case p.DBType.BIT:return q.BufferUtil.a(t===0?0:1);case p.DBType.TINYINT:return Is(t),q.BufferUtil.a(t);case p.DBType.SMALLINT:return As(t),q.BufferUtil._(t);case p.DBType.INT:return Os(t),q.BufferUtil.s(t);case p.DBType.BIGINT:return Ls(t),q.BufferUtil.o(BigInt(t));case p.DBType.REAL:return Ds(t),q.BufferUtil.f(t);case p.DBType.DOUBLE:return q.BufferUtil.d(t);case p.DBType.DECIMAL:return Ni.Numeric.fromNumber(t,e.prec,e.scale).encode();case p.DBType.CHAR:case p.DBType.VARCHAR2:case p.DBType.VARCHAR:case p.DBType.CLOB:return q.BufferUtil.b(t.toLocaleString("en-IN",{useGrouping:!1,maximumFractionDigits:20}),r.getServerEncoding());case p.DBType.BINARY:case p.DBType.VARBINARY:case p.DBType.BLOB:if(Number.isSafeInteger(t))return this.toBinary(BigInt(t),e.prec);throw H.DBError.ECJS_DATA_CONVERTION_ERROR();case p.DBType.DATE:case p.DBType.TIME:case p.DBType.DATETIME:if(Number.isSafeInteger(t))return wt.DateUtil.encodeByDateNumber(t,e.type,e.scale,r.conn_prop_localTimezone,r.dbTimezone);throw H.DBError.ECJS_DATA_CONVERTION_ERROR();default:throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}},i.fromBigInt=function(t,e,r){switch(e.type){case p.DBType.BOOLEAN:case p.DBType.BIT:return q.BufferUtil.a(t===BigInt(0)?0:1);case p.DBType.TINYINT:return Is(t),q.BufferUtil.a(Number(t));case p.DBType.SMALLINT:return As(t),q.BufferUtil._(Number(t));case p.DBType.INT:return Os(t),q.BufferUtil.s(Number(t));case p.DBType.BIGINT:return Ls(t),q.BufferUtil.o(t);case p.DBType.REAL:return Ds(t),q.BufferUtil.f(Number(t));case p.DBType.DOUBLE:return q.BufferUtil.d(Number(t));case p.DBType.DECIMAL:return Ni.Numeric.fromString(t.toString(),e.prec,e.scale).encode();case p.DBType.CHAR:case p.DBType.VARCHAR2:case p.DBType.VARCHAR:case p.DBType.CLOB:return q.BufferUtil.b(t.toString(),r.getServerEncoding());default:throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}},i.fromString=function(t,e,r){return Pt(this,void 0,void 0,function(){var n,o;return Ut(this,function(a){switch(e.type){case p.DBType.BOOLEAN:case p.DBType.BIT:return[2,q.BufferUtil.a(Dh.ConvertUtil.toBoolean(t)?1:0)];case p.DBType.TINYINT:case p.DBType.SMALLINT:case p.DBType.INT:case p.DBType.BIGINT:n=void 0;try{n=BigInt(t)}catch{throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}return[2,this.fromBigInt(n,e,r)];case p.DBType.REAL:case p.DBType.DOUBLE:if(o=parseFloat(t),Number.isNaN(o))throw H.DBError.ECJS_DATA_CONVERTION_ERROR();return[2,this.fromNumber(o,e,r)];case p.DBType.DECIMAL:return[2,Ni.Numeric.fromString(t,e.prec,e.scale).encode()];case p.DBType.CHAR:case p.DBType.VARCHAR2:case p.DBType.VARCHAR:if(p.DBType.isBFile(e.type,e.prec,e.scale)&&!p.DBType.checkBFileStr(t))throw H.DBError.ECJS_INVALID_BFILE_STR();return[2,q.BufferUtil.b(t,r.getServerEncoding())];case p.DBType.CLOB:return[2,this.string2clob(t,e,r)];case p.DBType.BINARY:case p.DBType.VARBINARY:return[2,bs.StringUtil.hexStringToBuffer(t)];case p.DBType.BLOB:if(p.DBType.isComplexType(e.type,e.scale))throw H.DBError.ECJS_DATA_CONVERTION_ERROR();return[2,this.buffer2blob(bs.StringUtil.hexStringToBuffer(t),e,r)];case p.DBType.DATE:return r.formatDate&&r.formatDate!==""?[2,wt.DateUtil.encode(xr.OracleDateFormat.parse(t,r.formatDate,r.oracleDateLanguage),e.type,e.scale,r.conn_prop_localTimezone)]:[2,wt.DateUtil.encodeByString(t,e.type,e.scale,r.conn_prop_localTimezone,r.dbTimezone)];case p.DBType.TIME:return r.formatTime&&r.formatTime!==""?[2,wt.DateUtil.encode(xr.OracleDateFormat.parse(t,r.formatTime,r.oracleDateLanguage),e.type,e.scale,r.conn_prop_localTimezone)]:[2,wt.DateUtil.encodeByString(t,e.type,e.scale,r.conn_prop_localTimezone,r.dbTimezone)];case p.DBType.DATETIME:return r.formatTimestamp&&r.formatTimestamp!==""?[2,wt.DateUtil.encode(xr.OracleDateFormat.parse(t,r.formatTimestamp,r.oracleDateLanguage),e.type,e.scale,r.conn_prop_localTimezone)]:[2,wt.DateUtil.encodeByString(t,e.type,e.scale,r.conn_prop_localTimezone,r.dbTimezone)];case p.DBType.TIME_TZ:return r.formatTimeTZ&&r.formatTimeTZ!==""?[2,wt.DateUtil.encode(xr.OracleDateFormat.parse(t,r.formatTimeTZ,r.oracleDateLanguage),e.type,e.scale,r.conn_prop_localTimezone)]:[2,wt.DateUtil.encodeByString(t,e.type,e.scale,r.conn_prop_localTimezone,r.dbTimezone)];case p.DBType.DATETIME_TZ:return r.formatTimestampTZ&&r.formatTimestampTZ!==""?[2,wt.DateUtil.encode(xr.OracleDateFormat.parse(t,r.formatTimestampTZ,r.oracleDateLanguage),e.type,e.scale,r.conn_prop_localTimezone)]:[2,wt.DateUtil.encodeByString(t,e.type,e.scale,r.conn_prop_localTimezone,r.dbTimezone)];case p.DBType.INTERVAL_DT:return[2,new wh.IntervalDT(t).encode(e.scale)];case p.DBType.INTERVAL_YM:return[2,new Rh.IntervalYM(t).encode(e.scale)];default:throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}return[2]})})},i.fromBlob=function(t,e,r){return Pt(this,void 0,void 0,function(){var n,o,a,c,u,h;return Ut(this,function(s){switch(s.label){case 0:switch(e.type){case p.DBType.BINARY:case p.DBType.VARBINARY:return[3,1];case p.DBType.BLOB:return[3,3];case p.DBType.ARRAY:case p.DBType.CLASS:case p.DBType.PLTYPE_RECORD:case p.DBType.SARRAY:return[3,4]}return[3,8];case 1:return[4,t.getLength()];case 2:return n=s.sent(),[2,t.getBytes(1,n)];case 3:return[2,i.blob2blob(t,e,r)];case 4:return(o=e.typeDescriptor)?(u=(c=t).getBytes,h=[1],[4,t.getLength()]):[3,7];case 5:return[4,u.apply(c,h.concat([s.sent()]))];case 6:return a=s.sent(),[2,Bi.TypeData.objBlobToBuffer(a,o)];case 7:case 8:throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}})})},i.fromClob=function(t,e,r){return Pt(this,void 0,void 0,function(){var n,o,a,c;return Ut(this,function(u){switch(u.label){case 0:switch(e.type){case p.DBType.CHAR:case p.DBType.VARCHAR:case p.DBType.VARCHAR2:return[3,1];case p.DBType.CLOB:return[3,4]}return[3,5];case 1:return a=(o=t).getSubString,c=[1],[4,t.getLength()];case 2:return[4,a.apply(o,c.concat([u.sent()]))];case 3:return n=u.sent(),[2,q.BufferUtil.b(n,r.getServerEncoding())];case 4:return[2,i.clob2clob(t,e,r)];case 5:throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}})})},i.fromDate=function(t,e,r){switch(e.type){case p.DBType.CHAR:case p.DBType.VARCHAR2:case p.DBType.VARCHAR:case p.DBType.CLOB:return q.BufferUtil.b(t.toISOString(),r.getServerEncoding());case p.DBType.DATE:case p.DBType.TIME:case p.DBType.TIME_TZ:case p.DBType.DATETIME:case p.DBType.DATETIME_TZ:return wt.DateUtil.encodeByDate(t,e.type,e.scale,r.conn_prop_localTimezone,r.dbTimezone);default:throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}},i.fromBuffer=function(t,e,r){return Pt(this,void 0,void 0,function(){return Ut(this,function(n){switch(e.type){case p.DBType.CHAR:case p.DBType.VARCHAR2:case p.DBType.VARCHAR:return[2,this.toVarchar(t)];case p.DBType.CLOB:return[2,this.buffer2clob(t,e,r)];case p.DBType.BINARY:case p.DBType.VARBINARY:return[2,t];case p.DBType.BLOB:return[2,this.buffer2blob(t,e,r)];case p.DBType.ARRAY:case p.DBType.CLASS:case p.DBType.PLTYPE_RECORD:case p.DBType.SARRAY:if(e.typeDescriptor)return[2,Bi.TypeData.objBlobToBuffer(t,e.typeDescriptor)];throw H.DBError.ECJS_DATA_CONVERTION_ERROR();default:throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}return[2]})})},i.fromReadable=function(t,e,r){return Pt(this,void 0,void 0,function(){var n,o;return Ut(this,function(a){switch(a.label){case 0:switch(e.type){case p.DBType.CHAR:case p.DBType.VARCHAR:case p.DBType.VARCHAR2:case p.DBType.BINARY:case p.DBType.VARBINARY:return[3,1];case p.DBType.BLOB:case p.DBType.CLOB:return[3,2];case p.DBType.ARRAY:case p.DBType.CLASS:case p.DBType.PLTYPE_RECORD:case p.DBType.SARRAY:return[3,4]}return[3,5];case 1:return[2,new Promise(function(c,u){t.setEncoding("binary");var h=Buffer.alloc(0);t.on("data",function(s){h=Buffer.concat([h,s],h.length+s.length)}),t.once("error",function(s){u(s)}),t.once("end",function(){c(h)})})];case 2:return[4,new Mh.OffRowReadableBinder(t,r.getServerEncoding()).init()];case 3:return[2,(n=a.sent()).offRow?n:n.readAll()];case 4:if(o=e.typeDescriptor)return[2,new Promise(function(c,u){t.setEncoding("binary");var h=Buffer.alloc(0);t.on("data",function(s){h=Buffer.concat([h,s],h.length+s.length)}),t.once("error",function(s){u(s)}),t.once("end",function(){c(Bi.TypeData.objBlobToBuffer(h,o))})})];throw H.DBError.ECJS_DATA_CONVERTION_ERROR();case 5:throw H.DBError.ECJS_DATA_CONVERTION_ERROR()}})})},i.blob2blob=function(t,e,r){return Pt(this,void 0,void 0,function(){var n,o,a,c,u;return Ut(this,function(h){switch(h.label){case 0:return n=this.isOffRow,o=[e.type],[4,t.getLength()];case 1:return n.apply(this,o.concat([h.sent()]))?[2,new Nh.OffRowBlobBinder(t,r.getServerEncoding()).init()]:(c=(a=t).getBytes,u=[1],[4,t.getLength()]);case 2:return[2,c.apply(a,u.concat([h.sent()]))]}})})},i.clob2clob=function(t,e,r){return Pt(this,void 0,void 0,function(){var n,o,a,c,u,h;return Ut(this,function(s){switch(s.label){case 0:return n=this.isOffRow,o=[e.type],[4,t.getLength()];case 1:return n.apply(this,o.concat([s.sent()]))?[2,new Bh.OffRowClobBinder(t,r.getServerEncoding()).init()]:(u=(c=t).getSubString,h=[1],[4,t.getLength()]);case 2:return[4,u.apply(c,h.concat([s.sent()]))];case 3:return a=s.sent(),[2,q.BufferUtil.b(a,r.getServerEncoding())]}})})},i.buffer2blob=function(t,e,r){return Pt(this,void 0,void 0,function(){return Ut(this,function(n){return[2,this.changeOffRowData(e,t,r.getServerEncoding())]})})},i.string2clob=function(t,e,r){return Pt(this,void 0,void 0,function(){return Ut(this,function(n){return[2,this.changeOffRowData(e,q.BufferUtil.b(t,r.getServerEncoding()),r.getServerEncoding())]})})},i.buffer2clob=function(t,e,r){return Pt(this,void 0,void 0,function(){return Ut(this,function(n){return[2,this.changeOffRowData(e,this.toVarchar(t),r.getServerEncoding())]})})},i.changeOffRowData=function(t,e,r){return Pt(this,void 0,void 0,function(){return Ut(this,function(n){return[2,this.isOffRow(t.type,e.length)?new Ch.OffRowBufferBinder(e,r).init():e]})})},i.isOffRow=function(t,e){return(t===p.DBType.BLOB||t===p.DBType.CLOB)&&e>Ft.Const.PUT_LOB_LEN},i.toVarchar=function(t){if(!t||t.length===0)return Buffer.alloc(0);for(var e,r=Buffer.alloc(2*t.length),n=0;n<t.length;n++)e=this.toChar(t[n]),r[2*n]=e[0],r[2*n+1]=e[1];return r},i.toBinary=function(t,e){var r=q.BufferUtil.o(t);return 0<e&&e<r.length?r.slice(r.length-e):r},i.toChar=function(t){var e=Buffer.alloc(2);return e[0]=this.getCharByNumVal(t>>4&15),e[1]=this.getCharByNumVal(15&t),e},i.getCharByNumVal=function(t){if(0<=t&&t<=9)return t+48;if(10<=t&&t<=15)return t+65-10;throw H.DBError.ECJS_INVALID_HEX()},i}();function Is(i){if(i<Ft.Const.INT8_MIN||i>Ft.Const.INT8_MAX)throw H.DBError.EC_DATA_OVERFLOW()}function As(i){if(i<Ft.Const.INT16_MIN||i>Ft.Const.INT16_MAX)throw H.DBError.EC_DATA_OVERFLOW()}function Os(i){if(i<Ft.Const.INT32_MIN||i>Ft.Const.INT32_MAX)throw H.DBError.EC_DATA_OVERFLOW()}function Ls(i){if(i<Ft.Const.INT64_MIN||i>Ft.Const.INT64_MAX)throw H.DBError.EC_DATA_OVERFLOW()}function Ds(i){if(i<Ft.Const.REAL_MIN||i>Ft.Const.REAL_MAX)throw H.DBError.EC_DATA_OVERFLOW()}ke.J2DB=Ph});var Dn=E(kr=>{"use strict";var Uh;Object.defineProperty(kr,"__esModule",{value:!0}),function(i){i[i.NULL=0]="NULL",i[i.OFF_ROW=1]="OFF_ROW"}(Uh=kr.ParamDataEnum||(kr.ParamDataEnum={}));var Fh=function(i){this.value=i};kr.LobCtl=Fh});var Mi=E(Ve=>{"use strict";var Ye=Ve&&Ve.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},qe=Ve&&Ve.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Ve,"__esModule",{value:!0});var ws=ui(),L=Dt(),Rs=hi(),Ns=R(),hr=be(),xt=J(),xh=Bt(),kh=Ii(),Yh=Oi(),qh=bn(),Bs=cr(),Et=Yt(),Vh=function(){function i(){}return i.toNaturalJS=function(t,e,r,n){return Ye(this,void 0,void 0,function(){var o,a;return qe(this,function(c){switch(c.label){case 0:if(t==null)return[2,null];switch(e.type){case L.DBType.BOOLEAN:return[3,1];case L.DBType.BIT:return[3,2];case L.DBType.TINYINT:return[3,3];case L.DBType.SMALLINT:return[3,4];case L.DBType.INT:return[3,5];case L.DBType.BIGINT:return[3,6];case L.DBType.REAL:return[3,7];case L.DBType.DOUBLE:return[3,8];case L.DBType.DATE:case L.DBType.TIME:case L.DBType.DATETIME:case L.DBType.TIME_TZ:case L.DBType.DATETIME_TZ:return[3,9];case L.DBType.INTERVAL_DT:return[3,11];case L.DBType.INTERVAL_YM:return[3,12];case L.DBType.DECIMAL:return[3,13];case L.DBType.BINARY:case L.DBType.VARBINARY:return[3,14];case L.DBType.BLOB:return[3,15];case L.DBType.CLOB:return[3,17];case L.DBType.CHAR:case L.DBType.VARCHAR:case L.DBType.VARCHAR2:return[3,19]}return[3,20];case 1:return[2,xt.BufferUtil.e(t,0)!=0];case 2:return xh.StringUtil.equalsIgnoreCase(e.typeName,"boolean")?[2,xt.BufferUtil.e(t,0)!=0]:[2,xt.BufferUtil.e(t,0)];case 3:return o=xt.BufferUtil.e(t,0),[2,i.fetchNumberAsString(o,n)];case 4:return o=xt.BufferUtil.r(t,0),[2,i.fetchNumberAsString(o,n)];case 5:return o=xt.BufferUtil.t(t,0),[2,i.fetchNumberAsString(o,n)];case 6:return o=xt.BufferUtil.n(t,0),[2,i.fetchNumberAsString(o,n)];case 7:return o=xt.BufferUtil.u(t,0),[2,i.fetchNumberAsString(o,n)];case 8:return o=xt.BufferUtil.i(t,0),[2,i.fetchNumberAsString(o,n)];case 9:return a=hr.DateUtil.decode(t,e.isBdta,e.type,e.scale,r.conn_prop_localTimezone,r.dbTimezone),[4,i.toDate(t,e,r,a)];case 10:return o=c.sent(),[2,i.fetchDateAsString(o,a,i.getFormatString(e,r),r.oracleDateLanguage,n)];case 11:return[2,new kh.IntervalDT(t).toString()];case 12:return[2,new Yh.IntervalYM(t).toString()];case 13:return[2,new qh.Numeric(t,e.prec,e.scale).toString()];case 14:return[2,i.fetchBinaryAsString(t,n)];case 15:return[4,i.toBlob(t,e,r)];case 16:return o=c.sent(),[2,i.fetchBlobAsBuffer(o,n)];case 17:return[4,i.toClob(t,e,r)];case 18:return o=c.sent(),[2,i.fetchClobAsString(o,n)];case 19:return[2,xt.BufferUtil.c(t,0,t.length,r.getServerEncoding())];case 20:return[2,null]}})})},i.toBlob=function(t,e,r){return Ye(this,void 0,void 0,function(){return qe(this,function(n){switch(e.type){case L.DBType.BLOB:return[2,ws.Blob.newBlobFromDB(t,r,e,r.lobFetchAll())];default:return[2,ws.Blob.newBlobOfLocal(t,r)]}return[2]})})},i.toClob=function(t,e,r){return Ye(this,void 0,void 0,function(){return qe(this,function(n){switch(e.type){case L.DBType.CLOB:return[2,Rs.Clob.newClobFromDB(t,r,e,r.lobFetchAll())];default:throw Ns.DBError.ECJS_INVALID_COLUMN_TYPE()}return[2]})})},i.toDate=function(t,e,r,n){return Ye(this,void 0,void 0,function(){var o,a;return qe(this,function(c){switch(c.label){case 0:switch(e.type){case L.DBType.DATE:case L.DBType.TIME:case L.DBType.TIME_TZ:case L.DBType.DATETIME:case L.DBType.DATETIME_TZ:return[3,1];case L.DBType.CHAR:case L.DBType.VARCHAR:case L.DBType.VARCHAR2:case L.DBType.CLOB:return[3,2]}return[3,4];case 1:return n=n||hr.DateUtil.decode(t,e.isBdta,e.type,e.scale,r.conn_prop_localTimezone,r.dbTimezone),[2,hr.DateUtil.toDateFromDT(n,r.conn_prop_localTimezone)];case 2:return a=(o=hr.DateUtil).toDateFromString,[4,this.charToString(t,e,r)];case 3:return[2,a.apply(o,[c.sent(),r.conn_prop_localTimezone])];case 4:throw Ns.DBError.ECJS_DATA_CONVERTION_ERROR()}})})},i.charToString=function(t,e,r){return Ye(this,void 0,void 0,function(){var n,o,a,c;return qe(this,function(u){switch(u.label){case 0:return e.type!==L.DBType.VARCHAR2?[3,1]:(t=this.processVarchar2(t,e.prec),[3,4]);case 1:return e.type!==L.DBType.CLOB?[3,4]:[4,Rs.Clob.newClobFromDB(t,r,e,!0)];case 2:return n=u.sent(),a=(o=n).getSubString,c=[1],[4,n.getLength()];case 3:return[2,a.apply(o,c.concat([u.sent()]))];case 4:return[2,xt.BufferUtil.c(t,0,t.length,r.getServerEncoding())]}})})},i.processVarchar2=function(t,e){var r=Buffer.alloc(e);r.copy(t,0,0,t.length);for(var n=t.length;n<r.length;n++)r[n]=32;return r},i.fetchNumberAsString=function(t,e){if(e!==void 0){if(e===Et.dmdb.STRING)return t.toString()}else if(Et.dmdb.fetchAsString.includes(Et.dmdb.NUMBER))return t.toString();return t},i.getFormatString=function(t,e){switch(t.type){case L.DBType.DATE:return e.formatDate||"";case L.DBType.TIME:return e.formatTime||"";case L.DBType.DATETIME:return e.formatTimestamp||"";case L.DBType.TIME_TZ:return e.formatTimeTZ||"";case L.DBType.DATETIME_TZ:return e.formatTimestampTZ||"";default:return""}},i.fetchDateAsString=function(t,e,r,n,o){if(o!==void 0){if(o===Et.dmdb.STRING)return r?hr.DateUtil.toStringFromDT(e,r,n):t.toUTCString()}else if(Et.dmdb.fetchAsString.includes(Et.dmdb.DATE))return r?hr.DateUtil.toStringFromDT(e,r,n):t.toUTCString();return t},i.fetchBinaryAsString=function(t,e){if(e!==void 0){if(e===Et.dmdb.STRING)return t.toString("hex")}else if(Et.dmdb.fetchAsString.includes(Et.dmdb.BUFFER))return t.toString("hex");return t},i.fetchClobAsString=function(t,e){return Ye(this,void 0,void 0,function(){var r,n,o,a,c,u;return qe(this,function(h){switch(h.label){case 0:return e===void 0?[3,3]:e!==Et.dmdb.STRING?[3,2]:(n=(r=t).getSubString,o=[1],[4,t.getLength()]);case 1:return[2,n.apply(r,o.concat([h.sent()]))];case 2:return[3,5];case 3:return Et.dmdb.fetchAsString.includes(Et.dmdb.CLOB)?(c=(a=t).getSubString,u=[1],[4,t.getLength()]):[3,5];case 4:return[2,c.apply(a,u.concat([h.sent()]))];case 5:return[2,new Bs.Lob(t)]}})})},i.fetchBlobAsBuffer=function(t,e){return Ye(this,void 0,void 0,function(){var r,n,o,a,c,u;return qe(this,function(h){switch(h.label){case 0:return e===void 0?[3,3]:e!==Et.dmdb.BUFFER?[3,2]:(n=(r=t).getBytes,o=[1],[4,t.getLength()]);case 1:return[2,n.apply(r,o.concat([h.sent()]))];case 2:return[3,5];case 3:return Et.dmdb.fetchAsBuffer.includes(Et.dmdb.BLOB)?(c=(a=t).getBytes,u=[1],[4,t.getLength()]):[3,5];case 4:return[2,c.apply(a,u.concat([h.sent()]))];case 5:return[2,new Bs.Lob(t)]}})})},i}();Ve.DB2J=Vh});var Fr=E(Vt=>{"use strict";var Hh=Vt&&Vt.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),bt=Vt&&Vt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},It=Vt&&Vt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Vt,"__esModule",{value:!0});var Yr=le(),he=R(),Ms=Pr(),Fi=$o(),Gh=An(),zh=Yt(),Zh=ts(),Ps=rs(),qt=Dt(),re=Cs(),Qh=cr(),Pi=Dn(),Jh=Mi(),jh=require("stream"),lr=D(),Ui=function(){function i(t,e,r){this.handle=0,this.cursorUpdateRow=0,this.closeOnCompletion=!1,this.closed=!0,this.poolable=!0,this.columns=new Array(0),this.running=!1,this.isExecuteMany=!1,this.type=i.STATEMENT,this.connection=t,this.escapeProcessing=t.conn_prop_escapeProcess,this.maxRows=BigInt(t.conn_prop_maxRows),this.queryTimeout=t.conn_prop_sessionTimeout,this.execOpts=e,this.innerExec=!r&&e.innerExec||!1,this.isExecuteMany=r}return i.prototype.execute=function(t,e){return bt(this,void 0,void 0,function(){return It(this,function(r){return[2,this.executeInner(t,0)]})})},i.prototype.allocateHandle=function(){return bt(this,void 0,void 0,function(){var t;return It(this,function(e){switch(e.label){case 0:return(t=this.connection.stmtPool&&0<this.connection.stmtPool.size()?this.connection.stmtPool.get():void 0)?(this.handle=t.handle,this.cursorName=t.cursorName,this.readBaseColName=t.readBaseColName,[3,3]):[3,1];case 1:return[4,this.connection.access.J(this)];case 2:e.sent(),e.label=3;case 3:return this.closed=!1,[2]}})})},i.prototype.close=function(){return bt(this,void 0,void 0,function(){return It(this,function(t){return!this.closed&&this.poolable&&0<this.connection.conn_prop_stmtPoolSize?[2,this.connection.stmtPool.put(new Zh.StmtInfo(this.handle,this.cursorName,this.readBaseColName))]:[2,this.free()]})})},i.prototype.free=function(){return bt(this,void 0,void 0,function(){return It(this,function(t){switch(t.label){case 0:if(this.closed||!this.connection||!this.connection.access||this.connection.closed)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.connection.access.A(this.handle)];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return this.closed=!0,[2]}})})},i.prototype.getMetaData=function(t){var e=this,r=new Array(this.columns.length);return this.columns.forEach(function(n,o){r[o]={name:e.columnNameCaseCvt(e.connection.conn_prop_columnNameCase,n.name)},t&&(r[o].dbType=n.type,r[o].dbTypeName=n.typeName,r[o].precision=n.prec,r[o].scale=n.scale,r[o].nullable=n.nullable)}),r},i.prototype.executeInner=function(t,e){return bt(this,void 0,void 0,function(){var r,n,o,a,c,u;return It(this,function(h){switch(h.label){case 0:if(!t)throw he.DBError.ECJS_SQL_IS_EMPTY();if(this.nativeSql=t,this.escapeProcessing)try{this.nativeSql=Fi.SQLProcessor.escape(t,this.connection.conn_prop_keyWords)}catch{}if(r=null,this.connection.constParaOpt){r=new Array;try{this.nativeSql=Fi.SQLProcessor.execOpt(this.nativeSql,r,this.connection.getServerEncoding())}catch{}}return this.connection.conn_prop_enRsCache?(n=Ps.ResultSetCachePool.get(this.connection.guid||"",this.connection.schema||"",this.nativeSql,this))?(this.execInfo=n.execInfo,this.connection.lastExecInfo=n.execInfo,[4,this.genResult(n.getResultSet(this))]):[3,2]:[3,2];case 1:return h.sent(),[2,this.execInfo.result];case 2:if(!(r&&0<r.length))return[3,8];h.label=3;case 3:return h.trys.push([3,5,,7]),[4,(o=this).connection.access.Q(this,r)];case 4:return o.execInfo=h.sent(),[3,7];case 5:if((a=h.sent())instanceof he.DBError&&(a.errCode===he.DBError.ECJS_COMMUNICATION_ERROR().errCode||a.errCode===he.DBError.EC_RN_OPERATION_CANCELED().errCode||a.errCode===he.DBError.EC_EXCEED_SESSION_REQUEST_LIMIT().errCode))throw a;return this.nativeSql=t,[4,(c=this).connection.access.V(this,e)];case 6:return c.execInfo=h.sent(),[3,7];case 7:return[3,10];case 8:return[4,(u=this).connection.access.V(this,e)];case 9:u.execInfo=h.sent(),h.label=10;case 10:return this.connection.lastExecInfo=this.execInfo,this.execInfo.hasResultSet?[4,this.genResult()]:[3,12];case 11:return h.sent(),[3,13];case 12:this.execInfo.result=new Yr.Result(this.connection),this.execInfo.result.rowsAffected=Number(this.execInfo.updateCount),h.label=13;case 13:return[2,this.execInfo.result]}})})},i.prototype.genResult=function(t){return bt(this,void 0,void 0,function(){return It(this,function(e){switch(e.label){case 0:return this.isExecuteMany?[3,3]:[4,this.loadResult(this.execInfo,t)];case 1:return e.sent(),[4,this.loadMoreResult(this.execInfo)];case 2:e.sent(),!t&&this.connection.conn_prop_enRsCache&&0<this.execInfo.rsCacheOffset&&this.execInfo.rsDatas&&this.execInfo.rsDatas.length===Number(this.execInfo.updateCount)&&Ps.ResultSetCachePool.put(this,this.nativeSql,this.execInfo),e.label=3;case 3:return[2]}})})},i.prototype.loadResult=function(t,e){return bt(this,void 0,void 0,function(){var r,n;return It(this,function(o){switch(o.label){case 0:return t.result=new Yr.Result(this.connection),t.result.metaData=this.getMetaData(this.execOpts.extendedMetaData),r=e||new Gh.ResultSet(1,this,t),this.execOpts.resultSet?(delete t.result.rows,t.result.resultSet=r,[3,6]):[3,1];case 1:return delete t.result.resultSet,t.result.rows=new Array,[4,r.getRow()];case 2:n=o.sent(),o.label=3;case 3:if(n===void 0)return[3,6];t.result.rows.push(n),o.label=4;case 4:return[4,r.getRow()];case 5:return n=o.sent(),[3,3];case 6:return[2]}})})},i.prototype.loadMoreResult=function(t){var e;return bt(this,void 0,void 0,function(){var r,n,o;return It(this,function(a){switch(a.label){case 0:return n=r=void 0,[4,this.connection.access.W(this,0)];case 1:o=a.sent(),a.label=2;case 2:return o.hasResultSet?[4,this.loadResult(o)]:[3,5];case 3:return a.sent(),r===void 0&&(r=[]),n===void 0&&(n=[]),r.push(o.result.rows||o.result.resultSet),n.push(o.result.metaData),[4,this.connection.access.W(this,0)];case 4:return o=a.sent(),[3,2];case 5:return r!==void 0&&n!==void 0&&(r.unshift(t.result.rows||((e=t.result)===null||e===void 0?void 0:e.resultSet)),n.unshift(t.result.metaData),delete t.result.rows,delete t.result.resultSet,delete t.result.metaData,t.result.implicitResults=r,t.result.metaData=n),[2]}})})},i.prototype.columnNameCaseCvt=function(t,e){return t===lr.Const.COLUMN_NAME_NATURAL_CASE?e:t===lr.Const.COLUMN_NAME_UPPER_CASE?e.toUpperCase():t===lr.Const.COLUMN_NAME_LOWER_CASE?e.toLowerCase():e},i.STATEMENT=1,i.PREPARED_STATEMENT=2,i.CALLABLE_STATEMENT=3,i}(),Wh=function(i){function t(e,r,n){var o=i.call(this,e,r,n)||this;return o.params=new Array(0),o.paramCount=0,o.rowIndex=0,o.preExec=!1,o.type=Ui.PREPARED_STATEMENT,o.paramObjectsList=new Array,o.curRowObjects=new Array(o.paramCount),o.curRowBindIndicator=Buffer.alloc(o.paramCount),o}return Hh(t,i),t.prototype.prepareSql=function(e){return bt(this,void 0,void 0,function(){var r;return It(this,function(n){switch(n.label){case 0:if(!e)throw he.DBError.ECJS_SQL_IS_EMPTY();if(this.nativeSql=e,this.escapeProcessing)try{this.nativeSql=Fi.SQLProcessor.escape(e,this.connection.conn_prop_keyWords)}catch{}return[4,this.connection.access.X(this)];case 1:return r=n.sent(),this.execInfo=r,[2]}})})},t.prototype.executePstmt=function(e){return bt(this,void 0,void 0,function(){var r,n,o;return It(this,function(a){switch(a.label){case 0:return[4,this._encodeArgs(e)];case 1:return r=a.sent(),[4,(n=this).connection.access.Y(this,r,!1)];case 2:return n.execInfo=a.sent(),this.connection.lastExecInfo=this.execInfo,this.execInfo.hasResultSet?[4,this.genResult()]:[3,4];case 3:return a.sent(),[3,5];case 4:this.execInfo.result=new Yr.Result(this.connection),this.execInfo.result.rowsAffected=Number(this.execInfo.updateCount),a.label=5;case 5:return this.execInfo.outParamDatas&&0<this.execInfo.outParamDatas.length?(this.execInfo.result||(this.execInfo.result=new Yr.Result(this.connection)),o=this.execInfo.result,[4,this.genOutParamDatas()]):[3,7];case 6:o.outBinds=a.sent(),a.label=7;case 7:return[2]}})})},t.prototype.executeManyPstmt=function(e){return bt(this,void 0,void 0,function(){var r,n,o,a,c,u,h,s;return It(this,function(l){switch(l.label){case 0:if(r=new Array(e.length),!(0<this.paramCount))return[3,4];n=0,l.label=1;case 1:return n<e.length?(o=e[n],a=r,c=n,[4,this._encodeArgs(o)]):[3,4];case 2:a[c]=l.sent(),l.label=3;case 3:return n++,[3,1];case 4:if(this.execInfo.retSqlType===lr.Const.SQL_TYPE_DML_SELECT||this.execInfo.retSqlType===lr.Const.SQL_TYPE_DML_CURSOR_OPEN)throw he.DBError.ECJS_INVALID_SQL_TYPE();return r.length!==0?[3,6]:[4,(u=this).connection.access.Z(this,[])];case 5:return u.execInfo=l.sent(),[3,10];case 6:return r.length===1||this.connection.conn_prop_batchType===2||this.connection.conn_prop_batchNotOnCall&&this.execInfo.retSqlType===lr.Const.SQL_TYPE_DML_CALL?[4,(h=this).connection.access.$(this,r,this.preExec)]:[3,8];case 7:return h.execInfo=l.sent(),[3,10];case 8:return[4,(s=this).connection.access.tt(this,r,this.preExec)];case 9:s.execInfo=l.sent(),l.label=10;case 10:return this.execInfo.results=new Yr.Results(this.connection),this.execInfo.results.batchErrors=this.execInfo.batchErrors,this.execOpts.dmlRowCounts&&(this.execInfo.results.dmlRowCounts=this.execInfo.updateCounts),this.execInfo.updateCounts&&this.execInfo.updateCounts.length!=0?this.execInfo.results.rowsAffected=this.execInfo.updateCounts.reduce(function(_,f){return(_<0?0:_)+(f<0?0:f)}):this.execInfo.results.rowsAffected=0,this.execInfo.results.outBinds=[],[2]}})})},t.prototype._encodeArgs=function(e){return bt(this,void 0,void 0,function(){var r,n,o,a,c,u,h,s,l,_,f,y,T;return It(this,function(m){switch(m.label){case 0:r=new Array(e.length),n=0,m.label=1;case 1:return n<this.params.length?(o=e[n],this.params[n].type!==qt.DBType.CURSOR?[3,4]:this.params[n].cursorStmt?[3,3]:(this.params[n].cursorStmt=new Ui(this.connection,this.execOpts,!1),[4,this.params[n].cursorStmt.allocateHandle()])):[3,24];case 2:m.sent(),m.label=3;case 3:return this.curRowBindIndicator[n]|=t.BIND_IN,[3,23];case 4:return o!=null&&o.val!==void 0&&o.val!==null?[3,5]:(r[n]=Pi.ParamDataEnum.NULL,[3,23]);case 5:return typeof o.val!="number"?[3,6]:(Number.isNaN(o.val)||!Number.isFinite(o.val)?r[n]=Pi.ParamDataEnum.NULL:(this.params[n].resetType(qt.DBType.DOUBLE),r[n]=re.J2DB.fromNumber(o.val,this.params[n],this.connection)),[3,23]);case 6:return typeof o.val!="bigint"?[3,7]:(this.params[n].resetType(qt.DBType.BIGINT),r[n]=re.J2DB.fromBigInt(o.val,this.params[n],this.connection),[3,23]);case 7:return typeof o.val!="string"?[3,11]:o.val===""&&qt.DBType.emptyStringToNull(this.params[n].type)?(r[n]=Pi.ParamDataEnum.NULL,[3,10]):[3,8];case 8:return this.params[n].resetType(qt.DBType.VARCHAR),a=r,c=n,[4,re.J2DB.fromString(o.val,this.params[n],this.connection)];case 9:a[c]=m.sent(),m.label=10;case 10:return[3,23];case 11:return typeof o.val!="boolean"?[3,12]:(this.params[n].resetType(qt.DBType.BIT),r[n]=re.J2DB.fromBoolean(o.val,this.params[n],this.connection),[3,23]);case 12:return o.val instanceof Buffer?(this.params[n].resetType(qt.DBType.VARBINARY),u=r,h=n,[4,re.J2DB.fromBuffer(o.val,this.params[n],this.connection)]):[3,14];case 13:return u[h]=m.sent(),[3,23];case 14:return o.val instanceof Qh.Lob?o.val.type!==zh.dmdb.BLOB?[3,16]:(this.params[n].resetType(qt.DBType.BLOB),s=r,l=n,[4,re.J2DB.fromBlob(o.val.iLob,this.params[n],this.connection)]):[3,19];case 15:return s[l]=m.sent(),[3,18];case 16:return this.params[n].resetType(qt.DBType.CLOB),_=r,f=n,[4,re.J2DB.fromClob(o.val.iLob,this.params[n],this.connection)];case 17:_[f]=m.sent(),m.label=18;case 18:return[3,23];case 19:return o.val instanceof Date?(this.params[n].resetType(qt.DBType.DATETIME_TZ),r[n]=re.J2DB.fromDate(o.val,this.params[n],this.connection),[3,23]):[3,20];case 20:return o.val instanceof jh.Readable?(y=r,T=n,[4,re.J2DB.fromReadable(o.val,this.params[n],this.connection)]):[3,22];case 21:return y[T]=m.sent(),[3,23];case 22:throw he.DBError.ECJS_UNSUPPORTED_TYPE();case 23:return n++,[3,1];case 24:return[2,r]}})})},t.prototype.genOutParamDatas=function(){return bt(this,void 0,void 0,function(){var e,r,n,o,a;return It(this,function(c){switch(c.label){case 0:e=new Array(0),r=0,c.label=1;case 1:return r<this.execInfo.outParamDatas.length?(n=this.execInfo.outParamDatas[r],this.params[r].ioType!==Ms.Parameter.IO_TYPE_OUT&&this.params[r].ioType!==Ms.Parameter.IO_TYPE_INOUT?[3,3]:(a=(o=e).push,[4,Jh.DB2J.toNaturalJS(n,this.params[r],this.connection)])):[3,4];case 2:a.apply(o,[c.sent()]),c.label=3;case 3:return r++,[3,1];case 4:return[2,e]}})})},t.BIND_IN=1,t.BIND_OUT=16,t}(Vt.Statement=Ui);Vt.PreparedStatement=Wh});var An=E(He=>{"use strict";var fe=He&&He.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},_e=He&&He.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(He,"__esModule",{value:!0});var Us=Fr(),fr=R(),Xh=Mi(),Kh=ce(),$h=nr(),tl=D(),el=Yt(),rl=function(){function i(t,e,r,n){var o;this.datas=new Array(0),this.datasOffset=-1,this.datasStartPos=0,this.currentPos=-1,this.totalRowCount=BigInt(0),this.updatable=!1,this.bdta=!1,this.wasNull=!1,this.closed=!1,this.fetchSize=0,this.metaData=r.result.metaData,typeof t=="number"&&e instanceof Us.Statement?(this.constructor_inner(e,e.columns,r.rsDatas||new Array(0)),this.id=t,this.totalRowCount=r.updateCount,this.updatable=r.rsUpdatable,this.bdta=r.rsBdta,o=this.datas.length,this.sizeOfRow=0<o?r.rsSizeof/o:0,this.updatable):t instanceof Us.Statement&&e instanceof Array&&(n instanceof Array||n===void 0)&&this.constructor_inner(t,e,n)}return i.prototype.newMiddlewares=function(){this.middlewares=new Kh.Middlewares(this.stmt.connection,null,i.nextID++,this.stmt.connection.middlewares)},i.prototype.close=function(t){if(t===void 0)return this.middlewares.valid?this.middlewares.reset().resultSet_close(this):this.do_close();if(typeof t!="function")throw fr.DBError.ECJS_INVALID_PARAM();this.close().then(function(){t(null)}).catch(function(e){t(e)})},i.prototype.getRow=function(t){if(t===void 0)return this.middlewares.valid?this.middlewares.reset().resultSet_getRow(this):this.do_getRow();if(typeof t!="function")throw fr.DBError.ECJS_INVALID_PARAM();this.getRow().then(function(e){t(null,e)}).catch(function(e){t(e,void 0)})},i.prototype.getRows=function(t,e){if(e===void 0)return this.middlewares.valid?this.middlewares.reset().resultSet_getRows(this,t):this.do_getRows(t);if(typeof e!="function")throw fr.DBError.ECJS_INVALID_PARAM();this.getRows(t).then(function(r){e(null,r)}).catch(function(r){e(r,void 0)})},i.prototype.getRowCount=function(t){if(t===void 0)return this.middlewares.valid?this.middlewares.reset().resultSet_getRowCount(this):this.do_getRowCount();if(typeof t!="function")throw fr.DBError.ECJS_INVALID_PARAM();this.getRowCount().then(function(e){t(null,e)}).catch(function(e){t(e,-1)})},i.prototype.do_close=function(){return fe(this,void 0,void 0,function(){return _e(this,function(t){return delete this.conn,delete this.stmt,delete this.columns,delete this.datas,this.closed=!0,[2]})})},i.prototype.do_getRow=function(){return fe(this,void 0,void 0,function(){return _e(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent()?this.getRowData():void 0]}})})},i.prototype.do_getRows=function(t){return fe(this,void 0,void 0,function(){var e,r,n,o;return _e(this,function(a){switch(a.label){case 0:if(!Number.isSafeInteger(t))throw fr.DBError.ECJS_INVALID_PARAM();e=new Array(0),a.label=1;case 1:return(r=0<t--)?[4,this.next()]:[3,3];case 2:r=a.sent(),a.label=3;case 3:return r?(o=(n=e).push,[4,this.getRowData()]):[3,5];case 4:return o.apply(n,[a.sent()]),[3,1];case 5:return[2,e]}})})},i.prototype.do_getRowCount=function(){return fe(this,void 0,void 0,function(){var t;return _e(this,function(e){switch(e.label){case 0:return this.checkClosed(),this.totalRowCount!==tl.Const.INT64_MAX?[3,2]:[4,(t=this).conn.access.z(this)];case 1:t.totalRowCount=e.sent(),e.label=2;case 2:return[2,Number(this.totalRowCount)]}})})},i.prototype.checkClosed=function(){if(this.closed)throw fr.DBError.ECJS_RESULTSET_CLOSED()},i.prototype.constructor_inner=function(t,e,r){this.id=0,this.stmt=t,this.conn=t.connection,this.columns=e||new Array(0),this.fetchInfo=t.execOpts.fetchInfo,this.datas=r||new Array(0),this.totalRowCount=BigInt(r===void 0?0:r.length),this.updatable=!1,this.bdta=!1,this.newMiddlewares(),$h.setUnenumerable(this,["middlewares","nextID"])},i.prototype.next=function(){return fe(this,void 0,void 0,function(){return _e(this,function(t){switch(t.label){case 0:return this.checkClosed(),this.totalRowCount===BigInt(0)||BigInt(this.currentPos)>=this.totalRowCount?[2,!1]:BigInt(this.currentPos)===this.totalRowCount-BigInt(1)?(this.currentPos++,this.datasOffset++,[2,!1]):this.currentPos+1<this.datasStartPos||this.currentPos+1>=this.datasStartPos+this.datas.length?[4,this.fetchData(this.currentPos+1)]:[3,2];case 1:return t.sent()?(this.currentPos++,[2,!0]):(this.currentPos++,this.datasOffset++,[2,!1]);case 2:return this.datasOffset++,this.currentPos++,[2,!0];case 3:return[2]}})})},i.prototype.fetchData=function(t){return fe(this,void 0,void 0,function(){var e;return _e(this,function(r){switch(r.label){case 0:return[4,this.conn.access.H(this,t)];case 1:return e=r.sent(),this.totalRowCount=e.updateCount,e.rsDatas?(this.datas=e.rsDatas,this.datasStartPos=t,[2,!(this.datasOffset=0)]):[2,!1]}})})},i.prototype.getRowData=function(){return fe(this,void 0,void 0,function(){var t,e,r,n,o,a;return _e(this,function(c){switch(c.label){case 0:if(this.stmt.execOpts.outFormat!==el.dmdb.OUT_FORMAT_OBJECT)return[3,5];r=new Object,n=0,c.label=1;case 1:return n<this.columns.length?(t=r,e=this.metaData[n].name,[4,this.getColumnData(n)]):[3,4];case 2:t[e]=c.sent(),c.label=3;case 3:return n++,[3,1];case 4:return[2,r];case 5:r=new Array(this.columns.length),n=0,c.label=6;case 6:return n<this.columns.length?(o=r,a=n,[4,this.getColumnData(n)]):[3,9];case 7:o[a]=c.sent(),c.label=8;case 8:return n++,[3,6];case 9:return[2,r]}})})},i.prototype.getColumnData=function(t){return fe(this,void 0,void 0,function(){var e,r,n;return _e(this,function(o){return e=this.datas[this.datasOffset][t+1],r=this.columns[t],n=this.fetchInfo&&this.fetchInfo[r.name]?this.fetchInfo[r.name].type:void 0,[2,Xh.DB2J.toNaturalJS(e,r,this.conn,n)]})})},i.nextID=0,i}();He.ResultSet=rl});var ki=E(xi=>{"use strict";Object.defineProperty(xi,"__esModule",{value:!0});var Fs=ve(),nl=Yi(),qr=D(),il=be(),xs=le(),ks=cr(),ol=_i(),sl=An(),al=function(){function i(t,e){this.svcConf=t,this.logWriter=e}return i.prototype.isDebugEnabled=function(){return this.svcConf.logLevel>=qr.Const.LOG_DEBUG},i.prototype.isErrorEnabled=function(){return this.svcConf.logLevel>=qr.Const.LOG_ERROR},i.prototype.isInfoEnabled=function(){return this.svcConf.logLevel>=qr.Const.LOG_INFO},i.prototype.isWarnEnabled=function(){return this.svcConf.logLevel>=qr.Const.LOG_WARN},i.prototype.isSqlEnabled=function(){return this.svcConf.logLevel>=qr.Const.LOG_SQL},i.prototype.info=function(t){this.isInfoEnabled()&&this.println(this.formatHead("INFO ")+t)},i.prototype.sql=function(t){this.isSqlEnabled()&&this.println(this.formatHead("SQL  ")+t)},i.prototype.debug=function(t,e,r){this.isDebugEnabled()&&this.println(this.formatHead("DEBUG")+i.formatTrace(t,e,void 0)+r)},i.prototype.warn=function(t){this.isWarnEnabled()&&this.println(this.formatHead("WARN ")+t)},i.prototype.error=function(t,e){this.isErrorEnabled()&&this.println(this.formatHead("ERROR")+t+(e?`
`+e.stack:""))},i.prototype.println=function(t){this.logWriter.writeLine(t.trim())},i.prototype.formatHead=function(t){return"["+t+" - "+il.DateUtil.formatDate(new Date,!0)+"]"},i.formatSource=function(t){return t?typeof t=="string"?t:t instanceof Fs.Connection?this.formatConn(t):t instanceof ks.Lob?this.formatLob(t):t instanceof ol.Pool?this.formatPool(t):t instanceof sl.ResultSet?this.formatResultSet(t):"unknown_source":""},i.formatConn=function(t){return t&&t.middlewares.logInfo?"conn-"+t.middlewares.getID():"conn-null"},i.formatRs=function(t){return t&&t.middlewares.logInfo?"rs-"+t.middlewares.getID():"rs-null"},i.formatRss=function(t){return t&&t.middlewares.logInfo?"rss-"+t.middlewares.getID():"rss-null"},i.formatLob=function(t){return t&&t.middlewares.logInfo?"lob-"+t.middlewares.getID():"lob-null"},i.formatPool=function(t){return t&&t.middlewares.logInfo?"pool-"+t.middlewares.getID():"pool-null"},i.formatResultSet=function(t){return t&&t.middlewares.logInfo?"resultSet-"+t.middlewares.getID():"resultSet-null"},i.formatReturn=function(t){var e="";return t instanceof Fs.Connection?(e=this.formatConn(t),t.sessionID!==BigInt(-1)&&(e+=", sessionID-0x"+t.sessionID.toString(16))):e=t instanceof xs.Result?this.formatRs(t):t instanceof xs.Results?this.formatRss(t):t instanceof ks.Lob?this.formatLob(t):t instanceof nl.NullData?"null":t instanceof Buffer?t.toString("hex"):t instanceof Array?"["+t+"]":typeof t=="string"?'"'+t+'"':t.toString(),e},i.formatTrace=function(t,e,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var a="";if(t&&(a+="{ "+this.formatSource(t)+" } "),a+=e+"(",n&&0<n.length)for(var c=0;c<n.length;c++)c!==0&&(a+=", "),a+=typeof n[c];if(a+=")",r!==void 0&&(a+=": "+this.formatReturn(r)),a+=";  ",n&&0<n.length){for(a+="[PARAMS]: ",c=0;c<n.length;c++)c!==0&&(a+=", "),n[c]===void 0?a+="undefined":n[c]===null?a+="null":a+='"'+n[c].toString()+'"';a+="; "}return a},i}();xi.Logger=al});var Yi=E(pe=>{"use strict";var cl=pe&&pe.__read||function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r,n,o=e.call(i),a=[];try{for(;(t===void 0||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(c){n={error:c}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(n)throw n.error}}return a},ul=pe&&pe.__spread||function(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(cl(arguments[t]));return i};Object.defineProperty(pe,"__esModule",{value:!0});var qi=ki(),Ys=function(){};pe.NullData=Ys;var hl=function(){function i(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];this.source=qi.Logger.formatSource(t),this.method=e,this.params=r,this.usedTime=0}return i.prototype.toString=function(){var t=qi.Logger.formatTrace.apply(qi.Logger,ul([this.source,this.method,this.returnValue],this.params));return 0<this.usedTime&&(t+=this.formatUsedTime(this.usedTime)),t},i.prototype.formatUsedTime=function(t){return"[USED TIME]: "+t+"ms;"},i.prototype.setError=function(t){this.e=t},i.prototype.getError=function(){return this.e},i.prototype.setReturnValue=function(t){this.returnValue=t===null?i.NULL:t},i.prototype.getReturnValue=function(){return this.returnValue},i.prototype.setUsedTime=function(t){this.usedTime=t},i.prototype.getUsedTime=function(){return this.usedTime},i.prototype.setSql=function(t){this.sql=t},i.prototype.getSql=function(){return this.sql},i.NULL=new Ys,i}();pe.LogRecord=hl});var qs=E(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});var _r=require("fs"),Vi=be(),ll=On(),fl=function(){function i(t,e,r){this.date=Vi.DateUtil.formatDate(new Date,!1),this.buffer=new ll.BufferArray,this.filePath=t,this.filePrefix=e,this.flushFreq=r}return i.prototype.doFlush=function(t){this.fd&&!this.needCreateNewFile()||(this.closeCurrentFile(),this.createNewFile()),this.writeStream||(this.writeStream=_r.createWriteStream("",{fd:this.fd})),this.writeStream&&t.readWritable(this.writeStream,t.length)},i.prototype.createNewFile=function(){this.date=Vi.DateUtil.formatDate(new Date,!1);var t=this.filePrefix+"_"+this.date+"_"+Date.now()+".log";_r.existsSync(this.filePath)||_r.mkdirSync(this.filePath),this.fd=_r.openSync(this.filePath+t,"a"),this.writeStream=_r.createWriteStream("",{fd:this.fd})},i.prototype.closeCurrentFile=function(){this.writeStream&&(this.writeStream.emit("close"),this.writeStream=void 0)},i.prototype.needCreateNewFile=function(){return Vi.DateUtil.formatDate(new Date,!1)!==this.date||!this.fd||_r.fstatSync(this.fd).size>i.MAX_FILE_SIZE},i.MAX_FILE_SIZE=104857600,i.FLUSH_SIZE=32768,i}();Hi.Writer=fl});var Vs=E(Vr=>{"use strict";var _l=Vr&&Vr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Vr,"__esModule",{value:!0});var pl=qs(),dl=function(i){function t(e,r){var n=i.call(this,e,"dm_js",r)||this;return n.start(),n}return _l(t,i),t.prototype.start=function(){var e=this;0<this.flushFreq&&(this.intervalId=setInterval(function(){e.doFlush(e.buffer)},1e3*this.flushFreq))},t.prototype.end=function(){this.intervalId&&(clearInterval(this.intervalId),0<this.buffer.length&&this.doFlush(this.buffer),this.closeCurrentFile())},t.prototype.write=function(e){var r=Buffer.from(e);this.buffer.putBuffer(r,0,r.length)},t.prototype.writeLine=function(e){this.write(e+`
`)},t}(pl.Writer);Vr.LogWriter=dl});var Hs=E(Ge=>{"use strict";var X=Ge&&Ge.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},K=Ge&&Ge.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Ge,"__esModule",{value:!0});var $=Yi(),El=ki(),Tl=rr(),yl=Vs(),ml=function(){function i(t){var e=new Tl.SvcConf;e.setAttributes(t);var r=new yl.LogWriter(e.logDir,e.logFlushFreq);this.log=new El.Logger(e,r)}return i.prototype.connection_openConnection=function(t,e,r){return X(this,void 0,void 0,function(){var n;return K(this,function(o){n=new $.LogRecord(e,"openConn");try{return[2,t.connection_openConnection(e,r)]}catch(a){throw n.setError(a),a}finally{this.doLog(n)}return[2]})})},i.prototype.connection_execute=function(t,e,r,n,o){return X(this,void 0,void 0,function(){var a,c,u;return K(this,function(h){switch(h.label){case 0:(a=new $.LogRecord(e,"execute",r,n,o)).setSql(r),h.label=1;case 1:return h.trys.push([1,3,4,5]),this.executeBefore(e.middlewares.logInfo),[4,t.connection_execute(e,r,n,o)];case 2:return c=h.sent(),a.setReturnValue(c),[2,c];case 3:throw u=h.sent(),a.setError(u),u;case 4:return this.executeAfter(e.middlewares.logInfo,a),this.doLog(a),[7];case 5:return[2]}})})},i.prototype.connection_executeMany=function(t,e,r,n,o){return X(this,void 0,void 0,function(){var a,c,u;return K(this,function(h){switch(h.label){case 0:(a=new $.LogRecord(e,"executeMany",r,n,o)).setSql(r),h.label=1;case 1:return h.trys.push([1,3,4,5]),this.executeBefore(e.middlewares.logInfo),[4,t.connection_executeMany(e,r,n,o)];case 2:return c=h.sent(),a.setReturnValue(c),[2,c];case 3:throw u=h.sent(),a.setError(u),u;case 4:return this.executeAfter(e.middlewares.logInfo,a),this.doLog(a),[7];case 5:return[2]}})})},i.prototype.connection_createLob=function(t,e,r){return X(this,void 0,void 0,function(){var n,o,a;return K(this,function(c){switch(c.label){case 0:n=new $.LogRecord(e,"createLob",r),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,t.connection_createLob(e,r)];case 2:return o=c.sent(),n.setReturnValue(o),[2,o];case 3:throw a=c.sent(),n.setError(a),a;case 4:return this.doLog(n),[7];case 5:return[2]}})})},i.prototype.connection_close=function(t,e){return X(this,void 0,void 0,function(){var r;return K(this,function(n){r=new $.LogRecord(e,"close");try{return[2,t.connection_close(e)]}catch(o){throw r.setError(o),o}finally{this.doLog(r)}return[2]})})},i.prototype.connection_commit=function(t,e){return X(this,void 0,void 0,function(){var r;return K(this,function(n){r=new $.LogRecord(e,"commit");try{return[2,t.connection_commit(e)]}catch(o){throw r.setError(o),o}finally{this.doLog(r)}return[2]})})},i.prototype.connection_getStatementInfo=function(t,e,r){return X(this,void 0,void 0,function(){var n,o,a;return K(this,function(c){switch(c.label){case 0:n=new $.LogRecord(e,"getStatementInfo",r),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,t.connection_getStatementInfo(e,r)];case 2:return o=c.sent(),n.setReturnValue(o),[2,o];case 3:throw a=c.sent(),n.setError(a),a;case 4:return this.doLog(n),[7];case 5:return[2]}})})},i.prototype.connection_rollback=function(t,e){return X(this,void 0,void 0,function(){var r;return K(this,function(n){r=new $.LogRecord(e,"rollback");try{return[2,t.connection_rollback(e)]}catch(o){throw r.setError(o),o}finally{this.doLog(r)}return[2]})})},i.prototype.lob_close=function(t,e){return X(this,void 0,void 0,function(){var r;return K(this,function(n){r=new $.LogRecord(e,"close");try{return[2,t.lob_close(e)]}catch(o){throw r.setError(o),o}finally{this.doLog(r)}return[2]})})},i.prototype.lob_getData=function(t,e){return X(this,void 0,void 0,function(){var r,n,o;return K(this,function(a){switch(a.label){case 0:r=new $.LogRecord(e,"getData"),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,t.lob_getData(e)];case 2:return n=a.sent(),r.setReturnValue(n),[2,n];case 3:throw o=a.sent(),r.setError(o),o;case 4:return this.doLog(r),[7];case 5:return[2]}})})},i.prototype.lob_getLength=function(t,e){return X(this,void 0,void 0,function(){var r,n,o;return K(this,function(a){switch(a.label){case 0:r=new $.LogRecord(e,"getLength"),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,t.lob_getLength(e)];case 2:return n=a.sent(),r.setReturnValue(n),[2,n];case 3:throw o=a.sent(),r.setError(o),o;case 4:return this.doLog(r),[7];case 5:return[2]}})})},i.prototype.pool_getConnection=function(t,e){return X(this,void 0,void 0,function(){var r,n,o;return K(this,function(a){switch(a.label){case 0:r=new $.LogRecord(e,"getConnection"),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,t.pool_getConnection(e)];case 2:return n=a.sent(),r.setReturnValue(n),[2,n];case 3:throw o=a.sent(),r.setError(o),o;case 4:return this.doLog(r),[7];case 5:return[2]}})})},i.prototype.pool_close=function(t,e,r){return X(this,void 0,void 0,function(){var n;return K(this,function(o){n=new $.LogRecord(e,"close",r);try{return[2,t.pool_close(e,r)]}catch(a){throw n.setError(a),a}finally{this.doLog(n)}return[2]})})},i.prototype.resultSet_close=function(t,e){return X(this,void 0,void 0,function(){var r;return K(this,function(n){r=new $.LogRecord(e,"close");try{return[2,t.resultSet_close(e)]}catch(o){throw r.setError(o),o}finally{this.doLog(r)}return[2]})})},i.prototype.resultSet_getRow=function(t,e){return X(this,void 0,void 0,function(){var r,n,o;return K(this,function(a){switch(a.label){case 0:r=new $.LogRecord(e,"getRow"),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,t.resultSet_getRow(e)];case 2:return n=a.sent(),r.setReturnValue(n),[2,n];case 3:throw o=a.sent(),r.setError(o),o;case 4:return this.doLog(r),[7];case 5:return[2]}})})},i.prototype.resultSet_getRows=function(t,e,r){return X(this,void 0,void 0,function(){var n,o,a;return K(this,function(c){switch(c.label){case 0:n=new $.LogRecord(e,"getRows"),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,t.resultSet_getRows(e,r)];case 2:return o=c.sent(),n.setReturnValue(o),[2,o];case 3:throw a=c.sent(),n.setError(a),a;case 4:return this.doLog(n),[7];case 5:return[2]}})})},i.prototype.resultSet_getRowCount=function(t,e){return X(this,void 0,void 0,function(){var r,n,o;return K(this,function(a){switch(a.label){case 0:r=new $.LogRecord(e,"getRowCount"),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,t.resultSet_getRowCount(e)];case 2:return n=a.sent(),r.setReturnValue(n),[2,n];case 3:throw o=a.sent(),r.setError(o),o;case 4:return this.doLog(r),[7];case 5:return[2]}})})},i.prototype.executeBefore=function(t){this.log.isSqlEnabled()&&(t.lastExecuteStartMsec=new Date().getTime())},i.prototype.executeAfter=function(t,e){var r;this.log.isSqlEnabled()&&(r=new Date().getTime()-t.lastExecuteStartMsec,e.setUsedTime(r))},i.prototype.doLog=function(t){try{t.getError()?this.log.error(t.toString(),t.getError()):t.getSql()&&this.log.isSqlEnabled()?this.log.sql(t.toString()):this.log.info(t.toString())}catch(e){this.log.error("Log failed!",e)}},i}();Ge.LogMiddleware=ml});var zi=E(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});var pr=ce(),Sl=D(),gl=function(){function i(t,e){this.ntrx_primary=0,this.ntrx_total=0,this.primaryPercent=0,this.standbyPercent=0,this.standbyNTrxMap=new Map,this.standbyIdMap=new Map,this.standbyCount=0,this.flag=new Array,this.increments=new Array,this.reset(t,e)}return i.prototype.reset=function(t,e){this.ntrx_primary=0,this.ntrx_total=0,this.standbyCount=e,this.increments=new Array(e+1);var r=this.gcd(t*e,100-t);this.increments[0]=t*e/r,this.increments.fill((100-t)/r,1,this.increments.length),this.flag=this.increments.slice(),0<e?(this.primaryPercent=t/100,this.standbyPercent=(100-t)/100/e):(this.primaryPercent=1,this.standbyPercent=0)},i.getInstance=function(t,e){var r=t.conn_prop_host+"_"+t.conn_prop_port+"_"+t.conn_prop_rwPercent,n=this.rwMap.get(r);return n?n.standbyCount!==e&&n.reset(t.conn_prop_rwPercent,e):(n=new i(t.conn_prop_rwPercent,e),this.rwMap.set(r,n)),n},i.prototype.countPrimary=function(){return this.adjustNtrx(),this.increasePrimaryNtrx(),pr.RWSiteEnum.PRIMARY},i.prototype.count=function(t,e){switch(this.adjustNtrx(),t){case pr.RWSiteEnum.ANY:t=this.primaryPercent===1||this.flag[0]>this.getStandbyFlag(e)&&this.flag[0]>this.flag.reduce(function(r,n,o){return(o===1?0:r)+n})?(this.increasePrimaryNtrx(),pr.RWSiteEnum.PRIMARY):(this.increaseStandbyNtrx(e),pr.RWSiteEnum.STANDBY);break;case pr.RWSiteEnum.STANDBY:this.increaseStandbyNtrx(e);break;case pr.RWSiteEnum.PRIMARY:this.increasePrimaryNtrx();break;default:throw new Error("Invalid RWSite!")}return t},i.prototype.adjustNtrx=function(){var t,e=this;this.ntrx_total>=Sl.Const.INT64_MAX&&(this.standbyNTrxMap.forEach(function(r){(t===void 0||r<t)&&(t=r)}),t=t<this.ntrx_primary?t:this.ntrx_primary,this.ntrx_primary/=t,this.ntrx_total/=t,this.standbyNTrxMap.forEach(function(r,n,o){o.set(n,r/t)})),this.flag[0]<=0&&this.flag.reduce(function(r,n,o){return(o===1?0:r)+n})<=0&&this.flag.map(function(r,n,o){return o[n]+=e.increments[n]})},i.prototype.increasePrimaryNtrx=function(){this.ntrx_primary++,this.flag[0]--,this.ntrx_total++},i.prototype.getStandbyId=function(t){var e=t.conn_prop_host+":"+t.conn_prop_port;if(this.standbyIdMap.has(e))return this.standbyIdMap.get(e);var r=this.standbyIdMap.size+1;return r>this.standbyCount?-1:(this.standbyIdMap.set(e,r),r)},i.prototype.getStandbyFlag=function(t){var e=this.getStandbyId(t);return 0<e&&e<this.flag.length?this.flag[e]:0},i.prototype.increaseStandbyNtrx=function(t){var e=t.conn_prop_host+":"+t.conn_prop_port,r=(r=this.standbyNTrxMap.get(e))!==void 0?r+1:1;this.standbyNTrxMap.set(e,r);var n=this.standbyIdMap.get(e);n===void 0&&(n=this.standbyIdMap.size+1,this.standbyIdMap.set(e,n)),this.flag[n]--,this.ntrx_total++},i.prototype.random=function(t){return Math.floor(Math.random()*Math.min(t,this.standbyCount))},i.prototype.toString=function(){return"PERCENT(P/S) : "+this.primaryPercent+"/"+this.standbyPercent+`
NTRX_PRIMARY : `+this.ntrx_primary+`
NTRX_TOTAL : `+this.ntrx_total+`
NTRX_STANDBY : `+JSON.stringify(this.standbyNTrxMap)},i.prototype.gcd=function(t,e){if(!Number.isSafeInteger(t)||!Number.isSafeInteger(e))throw new Error(t+" or "+e+" is not safe integer number: ");if(t===0||e===0)return 1;var r=t%e;return t=e,(e=r)==0?t:this.gcd(t,e)},i.rwMap=new Map,i}();Gi.RWCounter=gl});var Ji=E(Ze=>{"use strict";var de=Ze&&Ze.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Ee=Ze&&Ze.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Ze,"__esModule",{value:!0});var vl=ve(),Zi=zi(),bl=gr(),Il=ln(),St=D(),Gs=R(),Qi=ce(),ze=Bt(),Al=function(){function i(){}return i.connect=function(t,e){return de(this,void 0,void 0,function(){return Ee(this,function(r){switch(r.label){case 0:return t.props.set("loginMode",St.Const.LOGIN_MODE_PRIMARY_ONLY+""),t.conn_prop_loginMode=St.Const.LOGIN_MODE_PRIMARY_ONLY,[4,t.do_openConnection(e)];case 1:return(t=r.sent()).middlewares.rwInfo.rwCounter=Zi.RWCounter.getInstance(t,t.standbyCount),[4,this.connectStandby(t)];case 2:return r.sent(),[2,t]}})})},i.reconnect=function(t){return de(this,void 0,void 0,function(){return Ee(this,function(e){switch(e.label){case 0:return t.middlewares.rwInfo?[4,this.removeStandby(t)]:[2];case 1:return e.sent(),[4,t.do_reconnect()];case 2:return e.sent(),t.middlewares.rwInfo.cleanup(),t.middlewares.rwInfo.rwCounter=Zi.RWCounter.getInstance(t,t.standbyCount),[4,this.connectStandby(t)];case 3:return e.sent(),[2]}})})},i.recoverStandby=function(t){return de(this,void 0,void 0,function(){var e,r;return Ee(this,function(n){switch(n.label){case 0:return t.closed||this.isStandbyAlive(t)?[2]:(e=Date.now(),(r=t.conn_prop_rwStandbyRecoverTime)<=0||e-t.middlewares.rwInfo.tryRecoverTs<r?[2]:[4,this.connectStandby(t)]);case 1:return n.sent(),t.middlewares.rwInfo.tryRecoverTs=e,[2]}})})},i.connectStandby=function(t){return de(this,void 0,void 0,function(){var e,r,n;return Ee(this,function(o){switch(o.label){case 0:return[4,this.chooseValidStandby(t)];case 1:if(!(e=o.sent()))return[2];o.label=2;case 2:return o.trys.push([2,4,,5]),(r=new Il.Properties(t.props)).set("host",e.host),r.set("port",e.port.toString()),r.set("rwStandby","true"),r.setAny("epGroup",void 0),r.set("loginMode",St.Const.LOGIN_MODE_STANDBY_ONLY.toString()),r.set("switchTimes","0"),n=t.middlewares.rwInfo,[4,vl.Connection.newInstanceOfConnection(r).do_openConnection()];case 3:return n.connStandby=o.sent(),t.middlewares.rwInfo.connStandby.svrMode===St.Const.SERVER_MODE_STANDBY&&t.middlewares.rwInfo.connStandby.svrStat===St.Const.SERVER_STATUS_OPEN||this.removeStandby(t),[3,5];case 4:return o.sent(),[3,5];case 5:return[2]}})})},i.afterExceptionOnStandby=function(t,e){return de(this,void 0,void 0,function(){return Ee(this,function(r){switch(r.label){case 0:return e instanceof Gs.DBError&&e.errCode===Gs.DBError.ECJS_COMMUNICATION_ERROR().errCode?[4,this.removeStandby(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},i.execute=function(t,e,r,n){return de(this,void 0,void 0,function(){var o,a,c,u,h,s,l;return Ee(this,function(_){switch(_.label){case 0:return[4,i.recoverStandby(t)];case 1:_.sent(),i.distributeSql(t,e),a=!1,_.label=2;case 2:return _.trys.push([2,17,,21]),[4,r()];case 3:switch(o=_.sent(),c=t.middlewares.rwInfo.connCurrent,c.lastExecInfo.retSqlType){case St.Const.SQL_TYPE_COMMIT:case St.Const.SQL_TYPE_ROLLBACK:case St.Const.SQL_TYPE_SET_CURSCH:case St.Const.SQL_TYPE_SET_SESS_TRAN:case St.Const.SQL_TYPE_SET_TIME_ZONE:case St.Const.SQL_TYPE_SAVEPNT:return[3,4];case St.Const.SQL_TYPE_DML_CALL:return[3,9];case St.Const.SQL_TYPE_DML_SELECT:return[3,14]}return[3,15];case 4:if(!(u=c!==t?t:t.middlewares.rwInfo.connStandby))return[3,8];_.label=5;case 5:return _.trys.push([5,7,,8]),[4,n(u)];case 6:return _.sent(),[3,8];case 7:return _.sent(),[3,8];case 8:return[3,16];case 9:if((h=e.trim().split(/[ (]/,2)[0]).toUpperCase()!=="SP_SET_PARA_VALUE"&&h.toUpperCase()!=="SP_SET_SESSION_READONLY")return[3,13];if(!(s=c!==t?t:t.middlewares.rwInfo.connStandby))return[3,13];_.label=10;case 10:return _.trys.push([10,12,,13]),[4,n(s)];case 11:return _.sent(),[3,13];case 12:return _.sent(),[3,13];case 13:return[3,16];case 14:return!t.conn_prop_rwHA||c!==t.middlewares.rwInfo.connStandby||t.lastExecInfo.rsDatas&&t.lastExecInfo.rsDatas.length!==0||(a=!0),[3,16];case 15:return[3,16];case 16:return[3,21];case 17:return l=_.sent(),t.middlewares.rwInfo.connCurrent!==t.middlewares.rwInfo.connStandby?[3,19]:[4,i.afterExceptionOnStandby(t,l)];case 18:return _.sent(),a=!0,[3,20];case 19:throw l;case 20:return[3,21];case 21:return a?(t.middlewares.rwInfo.toPrimary(),t.middlewares.rwInfo.connCurrent=t,[2,n(t)]):[2,o]}})})},i.checkReadonly=function(t,e){var r,n=!0;return e&&!t.conn_prop_rwIgnoreSql&&(r=e.trim().split(" ",2)[0],n=!(ze.StringUtil.equalsIgnoreCase(r,"insert")||ze.StringUtil.equalsIgnoreCase(r,"update")||ze.StringUtil.equalsIgnoreCase(r,"delete")||ze.StringUtil.equalsIgnoreCase(r,"create")||ze.StringUtil.equalsIgnoreCase(r,"truncate")||ze.StringUtil.equalsIgnoreCase(r,"drop")||ze.StringUtil.equalsIgnoreCase(r,"alter"))),n},i.distributeSql=function(t,e){var r=this.isStandbyAlive(t)&&this.checkReadonly(t,e)?t.middlewares.rwInfo.distribute===Qi.RWSiteEnum.PRIMARY&&!t.trxFinish||t.middlewares.rwInfo.distribute===Qi.RWSiteEnum.STANDBY&&!t.middlewares.rwInfo.connStandby.trxFinish?t.middlewares.rwInfo.distribute:t.isoLevel!==St.Const.CLI_SERIALIZABLE?t.middlewares.rwInfo.toAny():t.middlewares.rwInfo.toPrimary():t.middlewares.rwInfo.toPrimary();return t.middlewares.rwInfo.connCurrent=r===Qi.RWSiteEnum.PRIMARY?t:t.middlewares.rwInfo.connStandby,r},i.isStandbyAlive=function(t){return t.middlewares.rwInfo.connStandby!==void 0&&!t.middlewares.rwInfo.connStandby.closed},i.removeStandby=function(t){return de(this,void 0,void 0,function(){return Ee(this,function(e){switch(e.label){case 0:if(!t.middlewares.rwInfo.connStandby)return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.middlewares.rwInfo.connStandby.do_close()];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:t.middlewares.rwInfo.connStandby=void 0,e.label=5;case 5:return[2]}})})},i.chooseValidStandby=function(t){return de(this,void 0,void 0,function(){var e,r,n,o,a,c,u,h,s;return Ee(this,function(l){switch(l.label){case 0:r=e=null,l.label=1;case 1:return l.trys.push([1,3,,8]),[4,t.do_executeInner(t.malini2?this.SQL_SELECT_STANDBY2:this.SQL_SELECT_STANDBY)];case 2:return e=l.sent(),[3,8];case 3:l.sent(),l.label=4;case 4:return l.trys.push([4,6,,7]),[4,t.do_executeInner(t.malini2?this.SQL_SELECT_STANDBY:this.SQL_SELECT_STANDBY2)];case 5:return e=l.sent(),[3,7];case 6:return n=l.sent(),r=n,[3,7];case 7:return[3,8];case 8:return l.trys.push([8,17,18,20]),e?[4,e.resultSet.do_getRowCount()]:[3,10];case 9:return a=l.sent(),[3,11];case 10:a=0,l.label=11;case 11:if(!(0<(o=a)))return[3,16];t.middlewares.rwInfo.rwCounter=Zi.RWCounter.getInstance(t,o),c=0,u=t.middlewares.rwInfo.rwCounter.random(o),l.label=12;case 12:return[4,e.resultSet.next()];case 13:return l.sent()?c!==u?[3,15]:[4,e.resultSet.getRowData()]:[3,16];case 14:return h=l.sent(),[2,new bl.EP(h[1],h[2])];case 15:return c++,[3,12];case 16:return[3,20];case 17:return s=l.sent(),r=s,[3,20];case 18:return[4,e.resultSet.do_close()];case 19:return l.sent(),[7];case 20:if(r)throw new Error("choose valid standby error!"+r.message);return[2,void 0]}})})},i.SQL_SELECT_STANDBY="select distinct mailIni.inst_name, mailIni.INST_IP, mailIni.INST_PORT, archIni.arch_status from  v$arch_status archIni left join (select * from V$DM_MAL_INI) mailIni on archIni.arch_dest = mailIni.inst_name left join V$MAL_LINK_STATUS on CTL_LINK_STATUS  = 'CONNECTED' AND DATA_LINK_STATUS = 'CONNECTED' where archIni.arch_type in ('TIMELY', 'REALTIME') AND  archIni.arch_status = 'VALID'",i.SQL_SELECT_STANDBY2="select distinct mailIni.mal_inst_name, mailIni.mal_INST_HOST, mailIni.mal_INST_PORT, archIni.arch_status from v$arch_status archIni left join (select * from V$DM_MAL_INI) mailIni on archIni.arch_dest = mailIni.mal_inst_name left join V$MAL_LINK_STATUS on CTL_LINK_STATUS  = 'CONNECTED' AND DATA_LINK_STATUS = 'CONNECTED' where archIni.arch_type in ('TIMELY', 'REALTIME') AND  archIni.arch_status = 'VALID'",i}();Ze.RWUtil=Al});var zs=E(Qe=>{"use strict";var tt=Qe&&Qe.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},et=Qe&&Qe.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Qe,"__esModule",{value:!0});var Te=Ji(),Ol=zi(),Ll=function(){function i(){}return i.getInstance=function(){return this.instance},i.prototype.connection_openConnection=function(t,e,r){return tt(this,void 0,void 0,function(){return et(this,function(n){return[2,Te.RWUtil.connect(e,r)]})})},i.prototype.connection_execute=function(t,e,r,n,o){return tt(this,void 0,void 0,function(){return et(this,function(a){return[2,Te.RWUtil.execute(e,r,function(){return e.middlewares.rwInfo.connCurrent.do_execute(r,n,o)},function(c){return c.do_execute(r,n,o)})]})})},i.prototype.connection_executeMany=function(t,e,r,n,o){return tt(this,void 0,void 0,function(){return et(this,function(a){return[2,Te.RWUtil.execute(e,r,function(){return e.middlewares.rwInfo.connCurrent.do_executeMany(r,n,o)},function(c){return c.do_executeMany(r,n,o)})]})})},i.prototype.connection_createLob=function(t,e,r){return tt(this,void 0,void 0,function(){return et(this,function(n){return[2,t.connection_createLob(e,r)]})})},i.prototype.connection_close=function(t,e){return tt(this,void 0,void 0,function(){return et(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),Te.RWUtil.isStandbyAlive(e)?[4,e.middlewares.rwInfo.connStandby.do_close()]:[3,2];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return r.sent(),[3,4];case 4:return[2,t.connection_close(e)]}})})},i.prototype.connection_commit=function(t,e){return tt(this,void 0,void 0,function(){var r;return et(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,5]),Te.RWUtil.isStandbyAlive(e)?[4,e.middlewares.rwInfo.connStandby.do_commit()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[3,5];case 3:return r=n.sent(),[4,Te.RWUtil.afterExceptionOnStandby(e,r)];case 4:return n.sent(),[3,5];case 5:return[2,t.connection_commit(e)]}})})},i.prototype.connection_getStatementInfo=function(t,e,r){return tt(this,void 0,void 0,function(){return et(this,function(n){return[2,t.connection_getStatementInfo(e,r)]})})},i.prototype.connection_rollback=function(t,e){return tt(this,void 0,void 0,function(){var r;return et(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,5]),Te.RWUtil.isStandbyAlive(e)?[4,e.middlewares.rwInfo.connStandby.do_rollback()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[3,5];case 3:return r=n.sent(),[4,Te.RWUtil.afterExceptionOnStandby(e,r)];case 4:return n.sent(),[3,5];case 5:return[2,t.connection_rollback(e)]}})})},i.prototype.lob_close=function(t,e){return tt(this,void 0,void 0,function(){return et(this,function(r){return[2,t.lob_close(e)]})})},i.prototype.lob_getData=function(t,e){return tt(this,void 0,void 0,function(){return et(this,function(r){return[2,t.lob_getData(e)]})})},i.prototype.lob_getLength=function(t,e){return tt(this,void 0,void 0,function(){return et(this,function(r){return[2,t.lob_getLength(e)]})})},i.prototype.pool_getConnection=function(t,e){return tt(this,void 0,void 0,function(){var r;return et(this,function(n){switch(n.label){case 0:return[4,t.pool_getConnection(e)];case 1:return r=n.sent(),t.rwInfo.rwCounter=Ol.RWCounter.getInstance(r,r.standbyCount),[2,r]}})})},i.prototype.pool_close=function(t,e,r){return tt(this,void 0,void 0,function(){return et(this,function(n){return[2,t.pool_close(e,r)]})})},i.prototype.resultSet_close=function(t,e){return tt(this,void 0,void 0,function(){return et(this,function(r){return[2,t.resultSet_close(e)]})})},i.prototype.resultSet_getRow=function(t,e){return tt(this,void 0,void 0,function(){return et(this,function(r){return[2,t.resultSet_getRow(e)]})})},i.prototype.resultSet_getRows=function(t,e,r){return tt(this,void 0,void 0,function(){return et(this,function(n){return[2,t.resultSet_getRows(e,r)]})})},i.prototype.resultSet_getRowCount=function(t,e){return tt(this,void 0,void 0,function(){return et(this,function(r){return[2,t.resultSet_getRowCount(e)]})})},i.instance=new i,i}();Qe.RWMiddleware=Ll});var Zs=E(ne=>{"use strict";var Z=ne&&ne.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Q=ne&&ne.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}},Dl=ne&&ne.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ne,"__esModule",{value:!0});var Cl=Ji(),Cn=R(),Hr=D(),wl=gr(),Rl=Bt(),Nl=function(){function i(){}return i.getInstance=function(){return this.instance},i.reconnect=function(t,e){return Z(this,void 0,void 0,function(){return Q(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),t.conn_prop_rwSeparate?[4,Cl.RWUtil.reconnect(t)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,t.do_reconnect()];case 3:r.sent(),r.label=4;case 4:return[3,6];case 5:return r.sent(),Cn.DBError.ECJS_CONNECTION_SWITCH_FAILED(e),[3,6];case 6:return Cn.DBError.ECJS_CONNECTION_SWITCHED(e),[2]}})})},i.prototype.autoReconnect=function(t,e){return Z(this,void 0,void 0,function(){return Q(this,function(r){if(e instanceof Cn.DBError&&e.errCode===Cn.DBError.ECJS_COMMUNICATION_ERROR().errCode)return[2,i.reconnect(t,e.message)];throw e})})},i.prototype.checkAndRecover=function(t){return Z(this,void 0,void 0,function(){var e,r,n,o,a,c,u,h,s,l,_;return Q(this,function(f){switch(f.label){case 0:return t.conn_prop_doSwitch!==Hr.Const.DO_SWITCH_WHEN_EP_RECOVER?[2]:(e=0,!t.trxFinish||(e=t.getIndexOnEPGroup())===0||Date.now()-t.middlewares.recoverInfo.checkEpRecoverTs<t.conn_prop_switchInterval?[2]:t.conn_prop_cluster!==Hr.Const.CLUSTER_TYPE_DSC?[3,2]:[4,this.loadDscEpSites(t)]);case 1:return n=f.sent(),[3,3];case 2:n=null,f.label=3;case 3:if(!(r=n)||r.length===0)return[2];o=!1;try{for(a=Dl(r),c=a.next();!c.done;c=a.next())if((u=c.value).epStatus===Hr.Const.EP_STATUS_OK){for(h=0;h<e;h++)if(s=t.epGroup.epList[h],u.host===s.host&&u.port===s.port){o=!0;break}if(o)break}}catch(y){l={error:y}}finally{try{c&&!c.done&&(_=a.return)&&_.call(a)}finally{if(l)throw l.error}}return t.middlewares.recoverInfo.checkEpRecoverTs=Date.now(),o?[2,t.do_reconnect()]:[2]}})})},i.prototype.loadDscEpSites=function(t){return Z(this,void 0,void 0,function(){var e,r,n,o;return Q(this,function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),[4,t.do_executeInner(i.SQL_GET_DSC_EP_SITE)];case 1:e=a.sent(),r=[],n=void 0,a.label=2;case 2:return[4,e.resultSet.do_getRow()];case 3:return(n=a.sent())?((o=new wl.EP(n[1],n[2])).epSeqno=n[0],o.epStatus=Rl.StringUtil.equalsIgnoreCase(n[3],"ok")?Hr.Const.EP_STATUS_OK:Hr.Const.EP_STATUS_ERROR,r.push(o),[3,2]):[3,4];case 4:return[4,e.resultSet.do_close()];case 5:return a.sent(),[2,r];case 6:return a.sent(),[3,7];case 7:return[2,null]}})})},i.prototype.connection_openConnection=function(t,e,r){return Z(this,void 0,void 0,function(){return Q(this,function(n){return[2,t.connection_openConnection(e,r)]})})},i.prototype.connection_execute=function(t,e,r,n,o){return Z(this,void 0,void 0,function(){var a;return Q(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,4]),[4,this.checkAndRecover(e)];case 1:return c.sent(),[2,t.connection_execute(e,r,n,o)];case 2:return a=c.sent(),[4,this.autoReconnect(e,a)];case 3:return c.sent(),[2,null];case 4:return[2]}})})},i.prototype.connection_executeMany=function(t,e,r,n,o){return Z(this,void 0,void 0,function(){var a;return Q(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,4]),[4,this.checkAndRecover(e)];case 1:return c.sent(),[2,t.connection_executeMany(e,r,n,o)];case 2:return a=c.sent(),[4,this.autoReconnect(e,a)];case 3:return c.sent(),[2,null];case 4:return[2]}})})},i.prototype.connection_createLob=function(t,e,r){return Z(this,void 0,void 0,function(){return Q(this,function(n){return[2,t.connection_createLob(e,r)]})})},i.prototype.connection_close=function(t,e){return Z(this,void 0,void 0,function(){return Q(this,function(r){try{return[2,t.connection_close(e)]}catch(n){return[2,this.autoReconnect(e,n)]}return[2]})})},i.prototype.connection_commit=function(t,e){return Z(this,void 0,void 0,function(){var r;return Q(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t.connection_commit(e)];case 1:return n.sent(),[2,this.checkAndRecover(e)];case 2:return r=n.sent(),[2,this.autoReconnect(e,r)];case 3:return[2]}})})},i.prototype.connection_getStatementInfo=function(t,e,r){return Z(this,void 0,void 0,function(){var n;return Q(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,4]),[4,this.checkAndRecover(e)];case 1:return o.sent(),[2,t.connection_getStatementInfo(e,r)];case 2:return n=o.sent(),[4,this.autoReconnect(e,n)];case 3:return o.sent(),[2,null];case 4:return[2]}})})},i.prototype.connection_rollback=function(t,e){return Z(this,void 0,void 0,function(){return Q(this,function(r){try{return[2,t.connection_rollback(e)]}catch(n){return[2,this.autoReconnect(e,n)]}return[2]})})},i.prototype.lob_close=function(t,e){return Z(this,void 0,void 0,function(){return Q(this,function(r){return[2,t.lob_close(e)]})})},i.prototype.lob_getData=function(t,e){return Z(this,void 0,void 0,function(){var r;return Q(this,function(n){switch(n.label){case 0:return n.trys.push([0,1,,3]),[2,t.lob_getData(e)];case 1:return r=n.sent(),[4,this.autoReconnect(e.iLob.conn,r)];case 2:return n.sent(),[2,null];case 3:return[2]}})})},i.prototype.lob_getLength=function(t,e){return Z(this,void 0,void 0,function(){var r;return Q(this,function(n){switch(n.label){case 0:return n.trys.push([0,1,,3]),[2,t.lob_getLength(e)];case 1:return r=n.sent(),[4,this.autoReconnect(e.iLob.conn,r)];case 2:return n.sent(),[2,0];case 3:return[2]}})})},i.prototype.pool_getConnection=function(t,e){return Z(this,void 0,void 0,function(){return Q(this,function(r){return[2,t.pool_getConnection(e)]})})},i.prototype.pool_close=function(t,e,r){return Z(this,void 0,void 0,function(){return Q(this,function(n){return[2,t.pool_close(e,r)]})})},i.prototype.resultSet_close=function(t,e){return Z(this,void 0,void 0,function(){return Q(this,function(r){return[2,t.resultSet_close(e)]})})},i.prototype.resultSet_getRow=function(t,e){return Z(this,void 0,void 0,function(){return Q(this,function(r){try{return[2,t.resultSet_getRow(e)]}catch(n){return[2,this.autoReconnect(e.conn,n)]}return[2]})})},i.prototype.resultSet_getRows=function(t,e,r){return Z(this,void 0,void 0,function(){var n;return Q(this,function(o){switch(o.label){case 0:return o.trys.push([0,1,,3]),[2,t.resultSet_getRows(e,r)];case 1:return n=o.sent(),[4,this.autoReconnect(e.conn,n)];case 2:return o.sent(),[2,[]];case 3:return[2]}})})},i.prototype.resultSet_getRowCount=function(t,e){return Z(this,void 0,void 0,function(){var r;return Q(this,function(n){switch(n.label){case 0:return n.trys.push([0,1,,3]),[2,t.resultSet_getRowCount(e)];case 1:return r=n.sent(),[4,this.autoReconnect(e.conn,r)];case 2:return n.sent(),[2,0];case 3:return[2]}})})},i.SQL_GET_DSC_EP_SITE=`SELECT dsc.ep_seqno, (CASE mal.MAL_INST_HOST WHEN '' THEN mal.MAL_HOST ELSE mal.MAL_INST_HOST END) as ep_host, dcr.EP_PORT, dsc.EP_STATUS FROM V$DSC_EP_INFO dsc LEFT join V$DM_MAL_INI mal on dsc.EP_NAME = mal.MAL_INST_NAME LEFT join (SELECT grp.GROUP_TYPE GROUP_TYPE, ep.* FROM SYS."V$DCR_GROUP" grp, SYS."V$DCR_EP" ep where grp.GROUP_NAME = ep.GROUP_NAME) dcr on dsc.EP_NAME = dcr.EP_NAME and GROUP_TYPE = 'DB' order by  dsc.ep_seqno asc;`,i.instance=new i,i}();ne.ReconnectMiddleware=Nl});var ce=E(Rt=>{"use strict";var rt=Rt&&Rt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},nt=Rt&&Rt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Rt,"__esModule",{value:!0});var Gr=D(),Qs=Hs(),Bl=rr(),Js=zs(),js=Zs(),Ml=function(){function i(t,e,r,n){n?(this.middlewares=n.middlewares.slice(),this.rwInfo=n.rwInfo,this.logInfo=n.logInfo,this.recoverInfo=n.recoverInfo):this.middlewares=this.createMiddleWares(t,e),this.pos=0,this.valid=0<this.middlewares.length,this.id=r}return i.prototype.createMiddleWares=function(t,e){var r,n=new Array;return t?(t.conn_prop_logLevel!==Gr.Const.LOG_OFF&&(r=new Qs.LogMiddleware(t.props),n.push(r),this.logInfo=new ji,this.log=r.log),t.conn_prop_doSwitch!==Gr.Const.DO_SWITCH_OFF&&(n.push(js.ReconnectMiddleware.getInstance()),this.recoverInfo=new Xi),t.conn_prop_rwSeparate&&(n.push(Js.RWMiddleware.getInstance()),this.rwInfo=new Wi(t))):e&&(Bl.SvcConf.parseLogLevel(e)!==Gr.Const.LOG_OFF&&(r=new Qs.LogMiddleware(e),n.push(r),this.logInfo=new ji,this.log=r.log),e.getNumber("doSwitch",Gr.Const.DO_SWITCH_OFF,0,2)!==Gr.Const.DO_SWITCH_OFF&&(n.push(js.ReconnectMiddleware.getInstance()),this.recoverInfo=new Xi),e.getBoolean("rwSeparate",!1)&&(n.push(Js.RWMiddleware.getInstance()),this.rwInfo=new Wi)),n},i.prototype.reset=function(){return this.pos=0,this},i.prototype.getID=function(){return this.id},i.prototype.connection_openConnection=function(t,e){return rt(this,void 0,void 0,function(){return nt(this,function(r){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].connection_openConnection(this,t,e)]:[2,t.do_openConnection(e)]})})},i.prototype.connection_execute=function(t,e,r,n){return rt(this,void 0,void 0,function(){return nt(this,function(o){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].connection_execute(this,t,e,r,n)]:[2,t.do_execute(e,r,n)]})})},i.prototype.connection_executeMany=function(t,e,r,n){return rt(this,void 0,void 0,function(){return nt(this,function(o){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].connection_executeMany(this,t,e,r,n)]:[2,t.do_executeMany(e,r,n)]})})},i.prototype.connection_createLob=function(t,e){return rt(this,void 0,void 0,function(){return nt(this,function(r){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].connection_createLob(this,t,e)]:[2,t.do_createLob(e)]})})},i.prototype.connection_close=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].connection_close(this,t)]:[2,t.do_close()]})})},i.prototype.connection_commit=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].connection_commit(this,t)]:[2,t.do_commit()]})})},i.prototype.connection_getStatementInfo=function(t,e){return rt(this,void 0,void 0,function(){return nt(this,function(r){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].connection_getStatementInfo(this,t,e)]:[2,t.do_getStatementInfo(e)]})})},i.prototype.connection_rollback=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].connection_rollback(this,t)]:[2,t.do_rollback()]})})},i.prototype.lob_close=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].lob_close(this,t)]:[2,t.do_close()]})})},i.prototype.lob_getData=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].lob_getData(this,t)]:[2,t.do_getData()]})})},i.prototype.lob_getLength=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].lob_getLength(this,t)]:[2,t.do_getLength()]})})},i.prototype.pool_getConnection=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].pool_getConnection(this,t)]:[2,t.do_getConnection()]})})},i.prototype.pool_close=function(t,e){return rt(this,void 0,void 0,function(){return nt(this,function(r){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].pool_close(this,t,e)]:[2,t.do_close(e)]})})},i.prototype.resultSet_close=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].resultSet_close(this,t)]:[2,t.do_close()]})})},i.prototype.resultSet_getRow=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].resultSet_getRow(this,t)]:[2,t.do_getRow()]})})},i.prototype.resultSet_getRows=function(t,e){return rt(this,void 0,void 0,function(){return nt(this,function(r){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].resultSet_getRows(this,t,e)]:[2,t.do_getRows(e)]})})},i.prototype.resultSet_getRowCount=function(t){return rt(this,void 0,void 0,function(){return nt(this,function(e){return this.pos<this.middlewares.length?[2,this.middlewares[this.pos++].resultSet_getRowCount(this,t)]:[2,t.do_getRowCount()]})})},i.prototype.logWarn=function(t){this.log&&this.log.warn(t)},i}();Rt.Middlewares=Ml;var dr,ji=function(){this.lastExecuteStartMsec=0};Rt.LogInfo=ji,function(i){i[i.PRIMARY=0]="PRIMARY",i[i.STANDBY=1]="STANDBY",i[i.ANY=2]="ANY"}(dr=Rt.RWSiteEnum||(Rt.RWSiteEnum={}));var Wi=function(){function i(t){this.distribute=dr.PRIMARY,this.tryRecoverTs=0}return i.prototype.cleanup=function(){this.distribute=dr.PRIMARY,this.rwCounter=void 0,this.connStandby=void 0},i.prototype.toPrimary=function(){return this.distribute!==dr.PRIMARY&&this.rwCounter.countPrimary(),this.distribute=dr.PRIMARY,this.distribute},i.prototype.toAny=function(){return this.distribute=this.rwCounter.count(dr.ANY,this.connStandby),this.distribute},i}();Rt.RWInfo=Wi;var Xi=function(){this.checkEpRecoverTs=0};Rt.RecoverInfo=Xi});var le=E(ie=>{"use strict";var Pl=ie&&ie.__read||function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r,n,o=e.call(i),a=[];try{for(;(t===void 0||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(c){n={error:c}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(n)throw n.error}}return a},Ws=ie&&ie.__spread||function(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(Pl(arguments[t]));return i};Object.defineProperty(ie,"__esModule",{value:!0});var Xs=ce(),Ks=nr(),Ul=function(){function i(){this.outParamDatas=new Array(0),this.hasResultSet=!1,this.rsSizeof=0,this.rsCacheOffset=0,this.rsBdta=!1,this.rsUpdatable=!1,this.updateCount=BigInt(0),this.rowid=BigInt(-1),this.retSqlType=-1}return i.prototype.union=function(t,e,r){var n,o;if(r===1)this.updateCounts[e]=Number(t.updateCount);else if(t.updateCounts)for(var a=e;a<e+r;a++)this.updateCounts[a]=t.updateCounts[a-e];t.outParamDatas&&(n=this.outParamDatas).push.apply(n,Ws(t.outParamDatas)),t.batchErrors&&(this.batchErrors||(this.batchErrors=[]),(o=this.batchErrors).push.apply(o,Ws(t.batchErrors)))},i}();ie.ExecuteRetInfo=Ul;var Fl=function(){function i(t){this.middlewares=new Xs.Middlewares(t,null,i.nextID,t.middlewares),i.nextID++,Ks.setUnenumerable(this,["middlewares","nextID"])}return i.nextID=0,i}();ie.Result=Fl;var xl=function(){function i(t){this.middlewares=new Xs.Middlewares(t,null,i.nextID,t.middlewares),i.nextID++,Ks.setUnenumerable(this,["middlewares","nextID"])}return i.nextID=0,i}();ie.Results=xl});var $s=E(Zr=>{"use strict";var kl=Zr&&Zr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Zr,"__esModule",{value:!0});var zr=V(),Yl=function(i){function t(e,r,n){return i.call(this,e,zr.Msg.wi,r,n)||this}return kl(t,i),t.prototype.te=function(){var e=zr.Msg.os;this.mt.l(e,1)},t.prototype.ee=function(){this.ir.handle=this.mt.t(zr.Msg.Js);var e=zr.Msg.os;this.ir.readBaseColName=this.mt.e(e)==1},t}(zr.Msg);Zr.StmtAllocate=Yl});var We=E(je=>{"use strict";var ql=je&&je.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Vl=je&&je.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(je,"__esModule",{value:!0});var Qr=V(),Hl=le(),ta=Fr(),Jr=Pr(),O=D(),At=Dt(),Je=Ln(),ea=R(),Ki=Dn(),Gl=J(),zl=Cr(),Zl=Yt(),Ql=Ue(),Jl=function(i){function t(e,r,n,o){var a=this;return typeof r=="number"&&n instanceof ta.Statement?a=i.call(this,e,r,n,o)||this:r instanceof ta.PreparedStatement&&n instanceof Array&&((a=i.call(this,e,e.at.execute2?Qr.Msg.ss:Qr.Msg.es,r,o)||this).ts=r.params,a.rs=n),a}return ql(t,i),t.prototype.te=function(){var e,r,n=this.ts===void 0?0:this.ts.length;if(this.er(n,this.rs===void 0?0:this.rs.length),0<n&&(this.ns(this.ts),this.rs!==void 0&&0<this.rs.length))try{for(var o=Vl(this.rs),a=o.next();!a.done;a=o.next()){var c=a.value;this.hs(this.ts,c)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},t.prototype.ee=function(){var e=new Hl.ExecuteRetInfo,r=this.ir,n=r.connection,o=Qr.Msg.os;e.retSqlType=this.mt.r(o),o+=O.Const.USINT_SIZE;var a=this.mt.r(o);o+=O.Const.USINT_SIZE,e.updateCount=this.mt.n(o),o+=O.Const.DDWORD_SIZE;var c=this.mt.oi(o);o+=O.Const.USINT_SIZE,e.rsUpdatable=this.mt.e(o)!=0,o+=O.Const.BYTE_SIZE;var u=this.mt.t(o);o+=O.Const.ULINT_SIZE,e.printLen=this.mt.t(o),o+=O.Const.ULINT_SIZE;var h=-1;e.retSqlType===O.Const.SQL_TYPE_DML_SELECT||e.retSqlType===O.Const.SQL_TYPE_DML_CALL?(e.rowid=BigInt(0),e.rsBdta=this.mt.e(o)===O.Const.RS_BDTA,o+=O.Const.BYTE_SIZE,h=this.mt.r(o),o+=O.Const.USINT_SIZE,o+=5):(e.rowid=this.mt.n(o),o+=O.Const.DDWORD_SIZE),e.execId=this.mt.t(o),o+=O.Const.ULINT_SIZE,e.rsCacheOffset=this.mt.t(o),o+=O.Const.ULINT_SIZE;var s=this.mt.e(o);o+=O.Const.BYTE_SIZE;var l,_,f=(1&s)==1,y=(2&s)==2;switch(n.trxStatus=this.mt.t(o),n.setTrxFinish(n.trxStatus),o+=O.Const.ULINT_SIZE,0<e.printLen&&(l=this.mt.en(e.printLen),e.printMsg=Gl.BufferUtil.c(l,0,l.length,n.getServerEncoding())),0<c&&(e.outParamDatas=this.as(c)),e.retSqlType){case O.Const.SQL_TYPE_SET_TIME_ZONE:n.conn_prop_localTimezone=this.mt.hn();break;case O.Const.SQL_TYPE_DML_SELECT:e.hasResultSet=!0,0<a&&(r.columns=this.cs(a,e.rsBdta)),this._s(e,r.columns.length,u,h);break;case O.Const.SQL_TYPE_DML_CALL:(0<a||0<u)&&(e.hasResultSet=!0),0<a&&(r.columns=this.cs(a,e.rsBdta)),this._s(e,r.columns.length,u,h);break;case O.Const.SQL_TYPE_SET_SESS_TRAN:n.isoLevel=this.mt.hn(),n.readOnly=this.mt.un()==1;break;case O.Const.SQL_TYPE_SET_CURSCH:n.schema=this.mt.Pn(n.getServerEncoding());break;case O.Const.SQL_TYPE_EXPLAIN:e.explain=this.mt.Pn(n.getServerEncoding());break;case O.Const.SQL_TYPE_DML_INSERT:case O.Const.SQL_TYPE_DML_UPDATE:case O.Const.SQL_TYPE_DML_DELETE:if(f){for(var T=this.mt.N(),m=new Array(T),P=0;P<T;P++)m[P]=Number(this.mt.Un());e.updateCounts=m}if(y)for(var st=this.mt.N(),P=0;P<st;P++)this.mt.Un();else e.updateCount,BigInt(1);this.fs==ea.DBError.EC_BP_WITH_ERROR().errCode&&(e.batchErrors=this.us(e.updateCounts));break;case O.Const.SQL_TYPE_DDL_ALTSESS_DATEFMT:_=this.mt.sn(),n.formatDate=this.mt.xn(_,n.getServerEncoding());break;case O.Const.SQL_TYPE_DDL_ALTSESS_DTFMT:_=this.mt.sn(),n.formatTimestamp=this.mt.xn(_,n.getServerEncoding());break;case O.Const.SQL_TYPE_DDL_ALTSESS_DTTZFMT:_=this.mt.sn(),n.formatTimestampTZ=this.mt.xn(_,n.getServerEncoding());break;case O.Const.SQL_TYPE_DDL_ALTSESS_TIMEFMT:_=this.mt.sn(),n.formatTime=this.mt.xn(_,n.getServerEncoding());break;case O.Const.SQL_TYPE_DDL_ALTSESS_TIMETZFMT:_=this.mt.sn(),n.formatTimeTZ=this.mt.xn(_,n.getServerEncoding());break;case O.Const.SQL_TYPE_DDL_ALTSESS_DATE_LANGUAGE:n.oracleDateLanguage=this.mt.sn()}return e},t.prototype.er=function(e,r){var n=this.ir,o=Qr.Msg.os;o+=this.mt.l(o,this.vs.at.conn_prop_autoCommit?1:0),o+=this.mt.w(o,e),o+=this.mt.l(o,1),o+=this.mt.U(o,BigInt(r)),o+=this.mt.U(o,BigInt(n.cursorUpdateRow)),o+=this.mt.U(o,n.maxRows<=0||n.connection.conn_prop_enRsCache?BigInt(O.Const.INT64_MAX):BigInt(n.maxRows)),o+=this.mt.l(o,1);var a=this.vs.at.conn_prop_continueBatchOnError?1:0;try{this.ir.execOpts.batchErrors&&(a=1)}catch{}o+=this.mt.l(o,a),o+=this.mt.l(o,0),o+=this.mt.l(o,0),o+=this.mt.v(o,n.queryTimeout===0?-1:n.queryTimeout),o+=this.mt.v(o,n.connection.conn_prop_batchAllowMaxErrors),this.mt.l(o,n.innerExec?1:0)},t.prototype.ns=function(e){var r=this;e.forEach(function(n){n.type===At.DBType.CURSOR&&n.ioType===Jr.Parameter.IO_TYPE_OUT?r.mt.In(Jr.Parameter.IO_TYPE_INOUT):r.mt.In(n.ioType),r.mt.q(n.type);var o=n.prec,a=n.scale,c=n.typeDescriptor;switch(n.type){case At.DBType.ARRAY:case At.DBType.SARRAY:o=Je.TypeDescriptor.getPackArraySize(c);break;case At.DBType.PLTYPE_RECORD:o=Je.TypeDescriptor.getPackRecordSize(c);break;case At.DBType.CLASS:o=Je.TypeDescriptor.getPackClassSize(c);break;case At.DBType.BLOB:At.DBType.isComplexType(n.type,n.scale)&&(o=c.getObjId())==4&&(o=c.getOuterId())}switch(r.mt.q(o),r.mt.q(a),n.type){case At.DBType.ARRAY:case At.DBType.SARRAY:Je.TypeDescriptor.packArray(c,r.mt);break;case At.DBType.PLTYPE_RECORD:Je.TypeDescriptor.packRecord(c,r.mt);break;case At.DBType.CLASS:Je.TypeDescriptor.packClass(c,r.mt)}})},t.prototype.hs=function(e,r){for(var n=0;n<e.length;n++){var o=e[n],a=r[n];if(o.type!==At.DBType.CURSOR){if(o.ioType!==Jr.Parameter.IO_TYPE_OUT)if(a instanceof Buffer){if(a.length>O.Const.MAX_PARAM_DATA_LEN)throw ea.DBError.ECJS_DATA_TOO_LONG();this.mt.Qn(a)}else if(a===Ki.ParamDataEnum.NULL)this.mt.Gn(O.Const.DATA_NULL_LEN);else if(a===Ki.ParamDataEnum.OFF_ROW)this.mt.m(0);else if(a instanceof Ql.OffRowBinder)this.mt.m(0);else{if(!(a instanceof Ki.LobCtl))throw new Error("Bind param data failed by invalid param data type");this.mt.Gn(O.Const.DATA_LOB_CTL_LEN),this.mt.qt(a.value)}}else this.mt.m(O.Const.ULINT_SIZE),this.mt.q(o.cursorStmt.handle)}},t.prototype.as=function(e){for(var r=new Array(e),n=0,o=this.ts,a=0;a<o.length;a++)o[a].ioType!==Jr.Parameter.IO_TYPE_INOUT&&o[a].ioType!==Jr.Parameter.IO_TYPE_OUT||(r[n]=a,n++);for(var c,u,h,s=new Array(o.length),a=0;a<e;a++)u=!1,(c=this.mt.x())===O.Const.DATA_NULL_LEN?u=!(c=0):c===O.Const.DATA_FULL_LEN&&(c=this.mt.N()),u?s[r[a]]=null:(h=this.mt.en(c),s[r[a]]=h);return s},t.prototype.cs=function(e,r){for(var n,o,a,c,u=this.vs.at.getServerEncoding(),h=new Array(e),s=0;s<e;s++){var l=new zl.Column;l.type=this.mt.N(),l.prec=this.mt.N(),l.scale=this.mt.N(),l.nullable=this.mt.N()!=0;var _=this.mt.hn();l.lob=(_&t.ps)!=0,l.identity=(_&t.ys)!=0,l.readonly=(_&t.bs)!=0,this.mt.$t(4,!1,!0),this.mt.$t(2,!1,!0),n=this.mt.hn(),o=this.mt.hn(),a=this.mt.hn(),c=this.mt.hn(),l.name=this.mt.xn(n,u),l.typeName=this.mt.xn(o,u),l.tableName=this.mt.xn(a,u),l.schemaName=this.mt.xn(c,u),this.ir.readBaseColName&&(l.baseName=this.mt.g(u)),l.lob&&(l.lobTabId=this.mt.N(),l.lobColId=this.mt.hn()),h[s]=l}for(var f,s=0;s<e;s++)At.DBType.isComplexType(h[s].type,h[s].scale)&&((f=new Je.TypeDescriptor(this.vs.at)).unpack(this.mt),h[s].typeDescriptor=f);return h},t.prototype._s=function(e,r,n,o){if(0<n){var a=this.mt.Yt;if(!e.rsBdta){for(var c=new Array(n),u=0;u<n;u++){c[u]=new Array(r+1),this.mt.$t(2,!1,!0),c[u][0]=this.mt.en(O.Const.LINT64_SIZE),this.mt.$t(2*r,!1,!0);for(var h=1;h<r+1;++h){var s=this.mt.x();s==O.Const.REC4_SQL_NULL?c[u][h]=null:s!=O.Const.REC4_SQL_FULL?c[u][h]=this.mt.en(s):c[u][h]=this.mt.pn()}}e.rsDatas=c}e.rsSizeof=this.mt.Yt-a}if(0<e.rsCacheOffset){for(var l=this.mt.hn(),_=new Array(l),f=new Array(l),u=0;u<l;u++)_[u]=BigInt(this.mt.N()),f[u]=this.mt.Un();e.tbIds=_,e.tbTss=f}},t.prototype.us=function(e){this.mt.$t(4,!1,!0);for(var r=this.mt.N(),n=new Array,o=0;o<r;o++){var a=this.mt.N();e[a]=Zl.dmdb.EXEC_MANY_FAIL;var c=this.mt.N(),u=this.mt.g(this.vs.at.getServerEncoding());n.push("row["+a+"]:"+c+", "+u)}return n},t.ys=1,t.ps=2,t.bs=4,t.ds=8,t}(Qr.Msg);je.Execute=Jl});var ra=E(jr=>{"use strict";var jl=jr&&jr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(jr,"__esModule",{value:!0});var Wl=We(),$i=V(),Ht=D(),Xl=le(),Kl=function(i){function t(e,r,n,o,a){var c=i.call(this,e,$i.Msg.se,r.stmt,a)||this;return c.ie=r,c.ce=n,c.re=o,c}return jl(t,i),t.prototype.te=function(){this.mt.U(t.oe,this.ce),this.mt.U(t.ue,this.re),this.mt.y(t._e,this.ie.id);var e,r=this.ie.conn.conn_prop_bufPrefetch;this.ie.sizeOfRow!=0&&this.ie.fetchSize!=0&&((e=this.ie.sizeOfRow*this.ie.fetchSize)>Ht.Const.INT32_MAX&&(e=Ht.Const.INT32_MAX),r=e<Ht.Const.MIN_BUF_PREFETCH?Ht.Const.MIN_BUF_PREFETCH:e>Ht.Const.MAX_BUF_PREFETCH?Ht.Const.MAX_BUF_PREFETCH:e),this.mt.v(t.he,r)},t.prototype.ee=function(){var e=new Xl.ExecuteRetInfo;e.rsBdta=this.ie.bdta,e.updateCount=this.mt.n(t.fe);var r=this.mt.t(t.ae);return this._s(e,this.ie.columns.length,r,-1),e},t.oe=$i.Msg.os,t.ue=t.oe+Ht.Const.DDWORD_SIZE,t._e=t.ue+Ht.Const.LINT64_SIZE,t.he=t._e+Ht.Const.USINT_SIZE,t.fe=$i.Msg.os,t.ae=t.fe+Ht.Const.DDWORD_SIZE,t}(Wl.Execute);jr.Fetch=Kl});var ia=E(Wr=>{"use strict";var $l=Wr&&Wr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Wr,"__esModule",{value:!0});var na=V(),tf=function(i){function t(e,r){return i.call(this,e,na.Msg.ne,null,r)||this}return $l(t,i),t.prototype.te=function(){},t.prototype.ee=function(){},t}(na.Msg);Wr.Commit=tf});var sa=E(Xr=>{"use strict";var ef=Xr&&Xr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Xr,"__esModule",{value:!0});var oa=V(),rf=function(i){function t(e,r){return i.call(this,e,oa.Msg.Bi,null,r)||this}return ef(t,i),t.prototype.te=function(){},t.prototype.ee=function(){},t}(oa.Msg);Xr.Rollback=rf});var aa=E(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});var wn=V(),nf=function(){function i(t){this._paused=!1,this._nextBuffers=new of,this._packetHeader=null,this._packetOffset=null,this._buffer=Buffer.alloc(0),this._offset=0,this._packetEnd=null,this._onReceive=t.onReceive||function(){}}return i.prototype.write=function(t){for(this._nextBuffers.push(t);!this._paused&&(this._packetHeader=this._tryReadHeader(),this._packetHeader);){var e=this._packetHeader.readInt32LE(wn.Msg.in);if(!this._combineNextBuffers(e))break;var r=this._buffer.slice(this._offset,this._offset+e);this._offset+=e,this._packetEnd=this._offset+e,this._packetOffset=this._offset;var n=Buffer.concat([this._packetHeader,r]);this._onReceive(n),this._packetHeader=null}},i.prototype._tryReadHeader=function(){if(this._packetHeader)return this._packetHeader;if(!this._combineNextBuffers(wn.Msg.lt))return null;var t=this._buffer.slice(this._offset,this._offset+wn.Msg.lt);return this._offset+=wn.Msg.lt,t},i.prototype._combineNextBuffers=function(t){var e=this._buffer.length-this._offset;if(t<=e)return!0;if(e+this._nextBuffers.size<t)return!1;for(var r=Array(0),n=t-e;0<n;){var o=this._nextBuffers.shift();r.push(o),n-=o.length}return this.append(r),!0},i.prototype.append=function(t){if(t&&t.length!==0){for(var e=this._buffer.length,r=this._packetOffset===null?this._offset:this._packetOffset,n=e-r,o=null,a=t instanceof Array||Array.isArray(t)?t:[t],c=0,u=0,h=0;h<a.length;h++)c+=a[h].length;if(n!=0)for(o=Buffer.alloc(n+c),u=0,u+=this._buffer.copy(o,0,r,e),h=0;h<a.length;h++)u+=a[h].copy(o,u);else if(1<a.length)for(o=Buffer.alloc(c),h=u=0;h<a.length;h++)u+=a[h].copy(o,u);else o=a[0];this._buffer=o,this._offset=this._offset-r,this._packetEnd=this._packetEnd!==null?this._packetEnd-r:null,this._packetOffset=this._packetOffset!==null?this._packetOffset-r:null}},i}();to.MsgParser=nf;var of=function(){function i(){this.bufs=new Array,this.size=0}return i.prototype.shift=function(){var t=this.bufs.shift();return t&&(this.size-=t.length),t},i.prototype.push=function(t){t&&t.length&&(this.bufs.push(t),this.size+=t.length)},i}()});var ca=E(Kr=>{"use strict";var sf=Kr&&Kr.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Kr,"__esModule",{value:!0});var eo=We(),ro=V(),ye=D(),af=le(),no=Pr(),cf=Dt(),uf=Ln(),hf=function(i){function t(e,r,n,o,a){var c=i.call(this,e,ro.Msg.Ni,r,a)||this;return c.pe=n,c.ye=o,c}return sf(t,i),t.prototype.te=function(){var e=this.vs.at,r=this.ir,n=ro.Msg.os;n+=this.mt.l(n,e.conn_prop_autoCommit?1:0),n+=this.mt.l(n,this.pe?1:0),n+=this.mt.l(n,0),n+=this.mt.l(n,1),n+=this.mt.l(n,e.compatibleOracle()?0:1),n+=this.mt.y(n,this.ye),n+=this.mt.U(n,r.maxRows<=0||e.conn_prop_enRsCache?ye.Const.INT64_MAX:r.maxRows),n+=this.mt.l(n,e.conn_prop_isBdtaRS?ye.Const.RS_BDTA:ye.Const.RS_ROW),n+=this.mt.y(n,0),n+=this.mt.l(n,1),n+=this.mt.l(n,0),n+=this.mt.l(n,0),n+=this.mt.v(n,r.queryTimeout),this.mt.l(n,r.innerExec?1:0),this.mt.Xn(r.nativeSql,e.getServerEncoding())},t.prototype.ee=function(){if(this.pe)return i.prototype.ee.call(this);var e=new af.ExecuteRetInfo,r=this.vs.at,n=ro.Msg.os;e.retSqlType=this.mt.r(n),n+=ye.Const.USINT_SIZE;var o=this.mt.oi(n);n+=ye.Const.USINT_SIZE;var a=this.mt.r(n);return n+=ye.Const.USINT_SIZE,this.mt.n(n),n+=ye.Const.DDWORD_SIZE,r.trxStatus=this.mt.t(n),ye.Const.ULINT_SIZE,0<o?(this.ir.params=this.qe(o),this.ir.paramCount=o):(this.ir.params=new Array(0),this.ir.paramCount=0),this.ir.columns=0<a?this.cs(a,e.rsBdta):new Array(0),e},t.prototype.qe=function(e){for(var r,n,o,a,c=new Array(e),u=0;u<e;u++){var h=new no.Parameter;h.type=this.mt.N(),h.prec=this.mt.N(),h.scale=this.mt.N(),h.nullable=this.mt.N()!=0;var s=this.mt.hn();h.typeFlag=(s&eo.Execute.ds)!=0?no.Parameter.TYPE_FLAG_RECOMMEND:no.Parameter.TYPE_FLAG_EXACT,h.lob=(s&eo.Execute.ps)!=0,this.mt.N(),h.ioType=this.mt.hn(),r=this.mt.hn(),n=this.mt.hn(),o=this.mt.hn(),a=this.mt.hn(),h.name=this.mt.xn(r,this.vs.at.getServerEncoding()),h.typeName=this.mt.xn(n,this.vs.at.getServerEncoding()),h.tableName=this.mt.xn(o,this.vs.at.getServerEncoding()),h.schemaName=this.mt.xn(a,this.vs.at.getServerEncoding()),h.lob&&(h.lobTabId=this.mt.N(),h.lobColId=this.mt.hn()),c[u]=h}for(var l,u=0;u<e;u++)cf.DBType.isComplexType(c[u].type,c[u].scale)&&((l=new uf.TypeDescriptor(this.vs.at)).unpack(this.mt),c[u].typeDescriptor=l);return c},t}(eo.Execute);Kr.Prepare=hf});var ha=E($r=>{"use strict";var lf=$r&&$r.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty($r,"__esModule",{value:!0});var ua=V(),ff=function(i){function t(e,r,n,o,a){var c=i.call(this,e,ua.Msg.xi,null,a)||this;return c.di=r,c.ji=n,c.St=o,c}return lf(t,i),t.prototype.te=function(){this.mt.In(this.di.lobFlag),this.mt.q(this.di.tabId),this.mt.m(this.di.colId),this.mt.Cn(this.di.blobId),this.mt.Gn(this.di.groupId),this.mt.Gn(this.di.fileId),this.mt.q(this.di.pageNo),this.mt.Gn(this.di.curFileId),this.mt.q(this.di.curPageNo),this.mt.q(this.di.totalOffset),this.mt.q(this.ji),this.mt.q(this.St),this.vs.at.newLobFlag&&(this.mt.Cn(this.di.rowId),this.mt.m(this.di.exGroupId),this.mt.m(this.di.exFileId),this.mt.q(this.di.exPageNo))},t.prototype.ee=function(){this.di.readOver=this.mt.un()===1;var e=this.mt.bn();return e<=0?null:(this.di.curFileId=this.mt.hn(),this.di.curPageNo=this.mt.N(),this.di.totalOffset=this.mt.N(),this.mt.en(e))},t}(ua.Msg);$r.GetLobData=ff});var fa=E(tn=>{"use strict";var _f=tn&&tn.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(tn,"__esModule",{value:!0});var la=V(),pf=function(i){function t(e,r,n,o,a,c,u,h){var s=i.call(this,e,la.Msg.Fi,null,h)||this;return s.di=r,s.$i=n,s.th=o,s.ih=a,s.sh=c,s.St=u,s}return _f(t,i),t.prototype.te=function(){this.mt.In(this.di.lobFlag),this.mt.In(this.$i),this.mt.Cn(this.di.blobId),this.mt.Gn(this.di.groupId),this.mt.Gn(this.di.fileId),this.mt.q(this.di.pageNo),this.mt.Gn(this.di.curFileId),this.mt.q(this.di.curPageNo),this.mt.q(this.di.totalOffset),this.mt.q(this.di.tabId),this.mt.m(this.di.colId),this.mt.Cn(this.di.rowId),this.mt.q(this.th),this.mt.q(this.St),this.mt.qt(this.ih.subarray(this.sh,this.sh+this.St)),this.vs.at.newLobFlag&&(this.mt.m(this.di.exGroupId),this.mt.m(this.di.exFileId),this.mt.q(this.di.exPageNo))},t.prototype.ee=function(){var e=this.mt.N();return this.di.blobId=this.mt.Un(),this.di.groupId=this.mt.hn(),this.di.fileId=this.mt.hn(),this.di.pageNo=this.mt.N(),this.di.curFileId=this.mt.hn(),this.di.curPageNo=this.mt.N(),this.di.totalOffset=this.mt.N(),e},t}(la.Msg);tn.SetLobData=pf});var pa=E(en=>{"use strict";var df=en&&en.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(en,"__esModule",{value:!0});var _a=V(),Ef=function(i){function t(e,r,n){var o=i.call(this,e,_a.Msg.Li,null,n)||this;return o.di=r,o}return df(t,i),t.prototype.te=function(){this.mt.In(this.di.lobFlag),this.mt.Cn(this.di.blobId),this.mt.Gn(this.di.groupId),this.mt.Gn(this.di.fileId),this.mt.q(this.di.pageNo),this.vs.at.newLobFlag&&(this.mt.q(this.di.tabId),this.mt.m(this.di.colId),this.mt.Cn(this.di.rowId),this.mt.m(this.di.exGroupId),this.mt.m(this.di.exFileId),this.mt.q(this.di.exPageNo))},t.prototype.ee=function(){return this.mt.Zt()===8?Number(this.mt.mn()):this.mt.bn()},t}(_a.Msg);en.GetLobLen=Ef});var Ea=E(rn=>{"use strict";var Tf=rn&&rn.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(rn,"__esModule",{value:!0});var da=V(),yf=function(i){function t(e,r,n,o){var a=i.call(this,e,da.Msg.pi,null,o)||this;return a.di=r,a.Oi=n,a}return Tf(t,i),t.prototype.te=function(){this.mt.In(this.di.lobFlag),this.mt.Cn(this.di.blobId),this.mt.Gn(this.di.groupId),this.mt.Gn(this.di.fileId),this.mt.q(this.di.pageNo),this.mt.q(this.di.tabId),this.mt.m(this.di.colId),this.mt.Cn(this.di.rowId),this.mt.zn(this.Oi),this.vs.at.newLobFlag&&(this.mt.m(this.di.exGroupId),this.mt.m(this.di.exFileId),this.mt.q(this.di.exPageNo))},t.prototype.ee=function(){var e=this.mt.bn();return this.di.blobId=this.mt.Un(),this.di.resetCurrentInfo(),e},t}(da.Msg);rn.LobTruncate=yf});var ya=E(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});var c1=D(),Ta=require("zlib"),mf=function(){function i(){}return i.compress=function(t,e){try{return Ta.deflateSync(t)}catch(r){throw new Error("compress error!"+r)}},i.uncompress=function(t,e){try{return Ta.inflateSync(t)}catch(r){throw new Error("uncompress error!"+r)}},i}();io.CompressUtil=mf});var Sa=E(nn=>{"use strict";var Sf=nn&&nn.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(nn,"__esModule",{value:!0});var gf=We(),ma=V(),vf=le(),bf=D(),If=function(i){function t(e,r,n,o){var a=i.call(this,e,ma.Msg.Ji,r,o)||this;return a.de=n,a}return Sf(t,i),t.prototype.te=function(){this.mt.y(t.ge,this.de.length),this.mt.l(t.me,0),this.ns(this.de)},t.prototype.ee=function(){return new vf.ExecuteRetInfo},t.ge=ma.Msg.os,t.me=t.ge+bf.Const.USINT_SIZE,t}(gf.Execute);nn.PreExec=If});var ga=E(on=>{"use strict";var Af=on&&on.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(on,"__esModule",{value:!0});var oo=V(),Of=function(i){function t(e,r,n,o,a,c){var u=i.call(this,e,oo.Msg.Gi,r,c)||this;return u.Vi=0,u.Vi=n,u.Wi=o,u.Yi=a,u}return Af(t,i),t.prototype.te=function(){this.mt.y(t.Zi,this.Vi),this.mt.zn(this.Yi),this.vs.at.newLobFlag&&this.mt.q(-1),this.Wi.readDmBuffer(this.mt,this.Yi)},t.prototype.ee=function(){},t.Zi=oo.Msg.os,t}(oo.Msg);on.PutData=Of});var ao=E(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:!0});var Lf=require("crypto"),Df=function(){function i(){}return i.newClientKeyPair=function(){var t=Lf.createDiffieHellman(i.DHParaP,"hex",i.DHParaG);return t.generateKeys(),t},i.getIV=function(t){if(t===-1)return Buffer.alloc(0);var e=Buffer.alloc(t);return this.DEFAULT_IV.copy(e,0,0,t),e},i.getPublicKey=function(t){var e=t.getPublicKey();return e.length<i.DH_KEY_LENGTH&&(e=Buffer.concat([Buffer.alloc(i.DH_KEY_LENGTH-e.length),e],i.DH_KEY_LENGTH)),e},i.computeSessionKey=function(t,e){var r=t.computeSecret(e);return r[0]===0?r.slice(1):r},i.DH_KEY_LENGTH=64,i.WORK_MODE_MASK=127,i.ECB_MODE=1,i.CBC_MODE=2,i.CFB_MODE=4,i.OFB_MODE=8,i.ALGO_MASK=65408,i.DES=128,i.DES3=256,i.AES128=512,i.AES192=1024,i.AES256=2048,i.RC4=4096,i.MD5=4352,i.DES_CFB=132,i.MD5_DIGEST_SIZE=16,i.MIN_EXTERNAL_CIPHER_ID=5e3,i.DEFAULT_IV=Buffer.from([32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,32]),i.DHParaP="C009D877BAF5FAF416B7F778E6115DCB90D65217DCC2F08A9DFCB5A192C593EBAB02929266B8DBFC2021039FDBD4B7FDE2B996E00008F57AE6EFB4ED3F17B6D3",i.DHParaG=5,i}();so.MsgSecurity=Df});var va=E(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});var Cf=function(){};co.AbstractCipher=Cf});var ba=E(sn=>{"use strict";var wf=sn&&sn.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(sn,"__esModule",{value:!0});var Rf=va(),it=ao(),uo=require("crypto"),Rn=R(),Nf=function(i){function t(e,r){var n=i.call(this)||this;n.hashType=it.MsgSecurity.MD5,n.hashSize=it.MsgSecurity.MD5_DIGEST_SIZE,n.cipherDesc=new Bf(e);var o=n.cipherDesc.keyLength;return n.cipherDesc.algorithmType===it.MsgSecurity.DES3?(n.sessionKey=Buffer.alloc(o+8),r.copy(n.sessionKey,0,0,o),r.copy(n.sessionKey,o,0,8)):(n.sessionKey=Buffer.alloc(o),r.copy(n.sessionKey,0,0,o)),n.iv=it.MsgSecurity.getIV(n.cipherDesc.ivLength),n}return wf(t,i),t.prototype.encrypt=function(e,r){try{var n=uo.createCipheriv(this.cipherDesc.algorithmName,this.sessionKey,this.iv);n.setAutoPadding(this.cipherDesc.needPadding);var o,a=Buffer.concat([n.update(e),n.final()]);return r&&(o=this.genMessageDigest(this.hashType,e),a=Buffer.concat([a,o],a.length+o.length)),a}catch(c){throw Rn.DBError.ECJS_MESSAGE_ENCRYPT_FAIL(c+"")}},t.prototype.decrypt=function(e,r){try{var n=uo.createDecipheriv(this.cipherDesc.algorithmName,this.sessionKey,this.iv);n.setAutoPadding(this.cipherDesc.needPadding);var o=void 0;if(r){var a=e.slice(e.length-this.hashSize),o=e.slice(0,e.length-this.hashSize);if(o=Buffer.concat([n.update(o),n.final()]),!a.equals(this.genMessageDigest(this.hashType,o)))throw new Error("digest check failed")}else o=Buffer.concat([n.update(e),n.final()]);return o}catch(c){throw Rn.DBError.ECJS_MESSAGE_DECRYPT_FAIL(c+"")}},t.prototype.genMessageDigest=function(e,r){switch(e){case it.MsgSecurity.MD5:try{var n=uo.createHash("MD5");return n.update(r),n.digest()}catch(o){throw new Error("invalid digest type."+o.message)}default:throw new Error("invalid digest type")}},t}(Rf.AbstractCipher);sn.SymmCipher=Nf;var Bf=function(){function i(t){switch(this.algorithmType=-1,this.workMode=-1,this.algorithmName="",this.keyLength=-1,this.ivLength=-1,this.needPadding=!1,this.algorithmType=t&it.MsgSecurity.ALGO_MASK,this.workMode=t&it.MsgSecurity.WORK_MODE_MASK,this.algorithmType){case it.MsgSecurity.AES128:this.algorithmName+="AES-128",this.keyLength=16,this.ivLength=16;break;case it.MsgSecurity.AES192:this.algorithmName+="AES-192",this.keyLength=24,this.ivLength=16;break;case it.MsgSecurity.AES256:this.algorithmName+="AES-256",this.keyLength=32,this.ivLength=16;break;case it.MsgSecurity.DES:this.algorithmName+="DES",this.keyLength=8,this.ivLength=8;break;case it.MsgSecurity.DES3:this.algorithmName+="DES-EDE3",this.keyLength=16,this.ivLength=8;break;case it.MsgSecurity.RC4:return this.algorithmName+="RC4",void(this.keyLength=16);default:throw Rn.DBError.ECJS_INVALID_CIPHER()}switch(this.workMode){case it.MsgSecurity.ECB_MODE:this.algorithmName+="-ECB",this.needPadding=!0,this.ivLength=-1;break;case it.MsgSecurity.CBC_MODE:this.algorithmName+="-CBC",this.needPadding=!0;break;case it.MsgSecurity.CFB_MODE:this.algorithmName+="-CFB",this.needPadding=!1;break;case it.MsgSecurity.OFB_MODE:this.algorithmName+="-OFB",this.needPadding=!1;break;default:throw Rn.DBError.ECJS_INVALID_CIPHER()}}return i.DEFAULT_PADDING_TYPE="PKCS5Padding",i.NO_PADDING_TYPE="NoPadding",i}()});var Aa=E(Xe=>{"use strict";var Mf=Xe&&Xe.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ia=Xe&&Xe.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Xe,"__esModule",{value:!0});var Pf=We(),Uf=V(),Ff=D(),xf=function(i){function t(e,r,n,o){var a=i.call(this,e,Uf.Msg.tr,r,o)||this;return a.rr=n,a}return Mf(t,i),t.prototype.te=function(){var e,r,n,o,a=this.rr.length;this.er(a,1),this.mt.Xn(this.ir.nativeSql,this.ir.connection.getServerEncoding());try{for(var c=Ia(this.rr),u=c.next();!u.done;u=c.next()){var h=u.value;this.mt.In(h.ioType),this.mt.q(h.type),this.mt.q(h.prec),this.mt.q(h.scale)}}catch(_){e={error:_}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}try{for(var s=Ia(this.rr),l=s.next();!l.done;l=s.next())(h=l.value).bytes===null?this.mt.Gn(Ff.Const.DATA_NULL_LEN):this.mt.Qn(h.bytes)}catch(_){n={error:_}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},t.prototype.ee=function(){return i.prototype.ee.call(this)},t}(Pf.Execute);Xe.ExecDirect=xf});var Oa=E(an=>{"use strict";var kf=an&&an.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(an,"__esModule",{value:!0});var ho=V(),Yf=function(i){function t(e,r,n){var o=i.call(this,e,ho.Msg.yi,null,n)||this;return o.be=r,o}return kf(t,i),t.prototype.te=function(){},t.prototype.Ks=function(){i.prototype.Ks.call(this),this.mt.v(ho.Msg.Js,this.be)},t.prototype.ee=function(){},t}(ho.Msg);an.StmtFree=Yf});var La=E(Ke=>{"use strict";var qf=Ke&&Ke.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Vf=Ke&&Ke.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ke,"__esModule",{value:!0});var Nn=V(),Hf=function(i){function t(e,r,n){var o=i.call(this,e,Nn.Msg.zi,null,n)||this;return o.yr=r,o}return qf(t,i),t.prototype.te=function(){var e,r;this.mt.w(Nn.Msg.os,this.yr.length);try{for(var n=Vf(this.yr),o=n.next();!o.done;o=n.next()){var a=o.value;this.mt.zn(Number(a))}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.ee=function(){var e=this.mt.oi(Nn.Msg.os);if(e<=0)return[];for(var r=new Array(e),n=0;n<e;n++)r[n]=this.mt.Un();return r},t}(Nn.Msg);Ke.TableTS=Hf});var Ca=E(cn=>{"use strict";var Gf=cn&&cn.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(cn,"__esModule",{value:!0});var Da=V(),zf=We(),Zf=function(i){function t(e,r,n,o){var a=i.call(this,e,Da.Msg.xe,r,o)||this;return a.le=n,a}return Gf(t,i),t.prototype.te=function(){this.mt.y(t.ve,this.le)},t.prototype.ee=function(){return i.prototype.ee.call(this)},t.ve=Da.Msg.os,t}(zf.Execute);cn.MoreResult=Zf});var Pa=E(oe=>{"use strict";var Qf=oe&&oe.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),B=oe&&oe.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},M=oe&&oe.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(oe,"__esModule",{value:!0});var Jf=require("os"),jf=Tn(),gt=V(),Wf=Uo(),Er=R(),F=D(),Xf=qo(),wa=le(),Ra=Pr(),Kf=$s(),Na=ra(),$f=Rr(),lo=Dn(),t_=Ue(),e_=ia(),r_=sa(),n_=require("events"),i_=aa(),Ba=ca(),o_=We(),s_=ha(),fo=J(),a_=fa(),c_=pa(),u_=Ea(),Ma=ya(),h_=Sa(),l_=On(),f_=ga(),$e=ao(),__=ba(),p_=Aa(),d_=Oa(),E_=La(),T_=Ca(),y_=function(i){function t(e){var r=i.call(this)||this;return r.rt=new Array,r.nt=new i_.MsgParser({onReceive:r.et.bind(r)}),r.it=null,r.ot=!1,r.ut=!1,r.st=!1,r.ct="",r.at=e,r._t=r.at.socket,r}return Qf(t,i),t.prototype.ft=function(e){var r=this;this.rt.push(e),this.emit("enqueue",e),e.once("error",function(n){}).once("packet",function(n){e._timer.refresh(),r.emit("data",n)}).once("timeout",function(){var n=Er.DBError.ECJS_SOCKET_TIMEOUT();n.fatal=!0,r.ht(n,e)}),e.once("end",function(){e.removeAllListeners(),r.vt(e)}),this.rt.length===1&&this.wt(e)},t.prototype.I=function(){},t.prototype.R=function(e){return this.nt.write(e),!0},t.prototype.et=function(e){var r,n,o,a,c,u=this.rt[0];u&&(u._timer.stop(),u.mt=new jf.DmBuffer(e),u.gt(),0<(r=u.dt())&&(this.ut&&(n=u.mt.p(gt.Msg.lt,r),o=this.bt.decrypt(n,!0),u.mt.pt(gt.Msg.lt),u.mt.qt(o),u.yt(o.length)),this.Pt(u)&&(r=u.dt(),a=u.mt.p(gt.Msg.lt+F.Const.ULINT_SIZE,r-F.Const.ULINT_SIZE),c=Ma.CompressUtil.uncompress(a,this.at.conn_prop_compressID),u.mt.pt(gt.Msg.lt),u.mt.qt(c),u.yt(c.length))),u.I())},t.prototype.vt=function(e){this.rt.shift();var r=this.rt[0];r?this.wt(r):this.emit("drain")},t.prototype.wt=function(e){try{this.at.middlewares.log&&this.at.middlewares.log.debug(this.at,this.at.rwStandby?"accessStandby":"access",e.xt()),e.At();var r,n,o=e.dt();if(0<o&&(this.Lt(e)&&(r=Ma.CompressUtil.compress(e.mt.p(gt.Msg.lt,o),this.at.conn_prop_compressID),e.mt.pt(gt.Msg.lt),e.mt.q(o),e.mt.qt(r),e.yt(F.Const.ULINT_SIZE+r.length),e.mt.l(gt.Msg.Dt,1)),this.ut&&(o=e.dt(),n=this.bt.encrypt(e.mt.p(gt.Msg.lt,o),!0),e.mt.pt(gt.Msg.lt),e.mt.qt(n),e.yt(n.length))),e.mt.St>gt.Msg.Rt)throw Er.DBError.ECJS_MSG_TOO_LONG();e.kt(),e.mt.Ut(0),0<e._timeout&&e._timer.start(e._timeout),e.Tt()}catch(a){throw this.rt.shift(),a}},t.prototype.Bt=function(e){this.emit("data",e)},t.prototype.P=function(){return B(this,void 0,void 0,function(){var e,r;return M(this,function(n){switch(n.label){case 0:return[4,this.It()];case 1:return e=n.sent(),this.at.sslEncrypt!==2?[3,3]:[4,this.at.startTLS(!1)];case 2:return n.sent(),[3,5];case 3:return this.at.sslEncrypt!==1?[3,5]:[4,this.at.startTLS(!0)];case 4:n.sent(),n.label=5;case 5:return(this.ut||this.ot)&&(r=$e.MsgSecurity.computeSessionKey(this.Et,e.jt),this.Ct(e.Ft===-1?$e.MsgSecurity.DES_CFB:e.Ft,r,this.at.conn_prop_cipherPath,e.Ot===-1?$e.MsgSecurity.MD5:e.Ot)),[2,this.Gt()]}})})},t.prototype.It=function(){return B(this,void 0,void 0,function(){var e=this;return M(this,function(r){return[2,new Promise(function(n,o){e.ft(new Wf.Startup(e,function(a,c){a?o(a):n(c)}))})]})})},t.prototype.Gt=function(){return B(this,void 0,void 0,function(){var e=this;return M(this,function(r){return[2,new Promise(function(n,o){e.ft(new Xf.Login(e,function(a,c){a?o(a):n(c)}))})]})})},t.prototype.J=function(e){return B(this,void 0,void 0,function(){var r=this;return M(this,function(n){return[2,new Promise(function(o,a){r.ft(new Kf.StmtAllocate(r,e,function(c){c?a(c):o()}))})]})})},t.prototype.A=function(e){return B(this,void 0,void 0,function(){var r=this;return M(this,function(n){return[2,new Promise(function(o,a){r.ft(new d_.StmtFree(r,e,function(c){c?a(c):o()}))})]})})},t.prototype.X=function(e){return B(this,void 0,void 0,function(){var r=this;return M(this,function(n){return[2,new Promise(function(o,a){r.ft(new Ba.Prepare(r,e,!1,F.Const.EXECUTE_TYPE_ANY,function(c,u){c?a(c):o(u)}))})]})})},t.prototype.Z=function(e,r){return B(this,void 0,void 0,function(){var n=this;return M(this,function(o){return[2,new Promise(function(a,c){n.ft(new o_.Execute(n,e,r,function(u,h){u?c(u):a(h)}))})]})})},t.prototype.V=function(e,r){return B(this,void 0,void 0,function(){var n=this;return M(this,function(o){return[2,new Promise(function(a,c){n.ft(new Ba.Prepare(n,e,!0,r,function(u,h){u?c(u):a(h)}))})]})})},t.prototype.Q=function(e,r){return B(this,void 0,void 0,function(){var n=this;return M(this,function(o){return[2,new Promise(function(a,c){n.ft(new p_.ExecDirect(n,e,r,function(u,h){u?c(u):a(h)}))})]})})},t.prototype.Mt=function(e){return B(this,void 0,void 0,function(){var r=this;return M(this,function(n){return[2,new Promise(function(o,a){r.ft(new h_.PreExec(r,e,e.params,function(c){c?a(c):o()}))})]})})},t.prototype.zt=function(e,r,n,o){return B(this,void 0,void 0,function(){var a=this;return M(this,function(c){return[2,new Promise(function(u,h){a.ft(new f_.PutData(a,e,r,n,o,function(s){s?h(s):u()}))})]})})},t.prototype.Y=function(e,r,n){return B(this,void 0,void 0,function(){var o,a,c,u,h;return M(this,function(s){switch(s.label){case 0:o=new Array(e.paramCount),a=0,s.label=1;case 1:return a<e.paramCount?e.params[a].ioType!==Ra.Parameter.IO_TYPE_OUT&&this.Ht(o,r,a)?n?[3,3]:[4,this.Mt(e)]:[3,10]:[3,11];case 2:s.sent(),n=!0,s.label=3;case 3:return c=r[a],u=new l_.BufferArray,[4,c.read(u)];case 4:s.sent(),h=0,s.label=5;case 5:return!c.readOver||0<u.length?!c.readOver&&u.length<F.Const.MAX_BLOB_LEN_PER_MSG?[4,c.read(u)]:[3,7]:[3,9];case 6:s.sent(),s.label=7;case 7:return h=u.length>F.Const.MAX_BLOB_LEN_PER_MSG?F.Const.MAX_BLOB_LEN_PER_MSG:u.length,[4,this.zt(e,a,u,h)];case 8:return s.sent(),[3,5];case 9:o[a]=r[a],s.label=10;case 10:return a++,[3,1];case 11:return[2,this.Z(e,[o])]}})})},t.prototype.tt=function(e,r,n){return B(this,void 0,void 0,function(){var o,a,c,u,h,s,l,_,f,y;return M(this,function(T){switch(T.label){case 0:a=o=0,c=!1,u=r.length,(h=new wa.ExecuteRetInfo).updateCounts=new Array(u).fill(0),s=new Array,T.label=1;case 1:if(!(o<u))return[3,6];for(a=o;a<u;a++){for(l=r[a],_=new Array(e.paramCount),c=!1,f=0;f<e.paramCount;f++)if(e.params[f].ioType!==Ra.Parameter.IO_TYPE_OUT&&this.Ht(_,l,f)){c=!0;break}if(c)break;s.push(_)}return a===o?[3,3]:[4,this.Z(e,s)];case 2:y=T.sent(),s.splice(0),h.union(y,o,a-o),T.label=3;case 3:return a<u?[4,this.Y(e,r[a],n)]:[3,5];case 4:y=T.sent(),n=!0,h.union(y,a,1),T.label=5;case 5:return o=a+1,[3,1];case 6:return[2,h]}})})},t.prototype.$=function(e,r,n){return B(this,void 0,void 0,function(){var o,a,c,u,h,s;return M(this,function(l){switch(l.label){case 0:o=r.length,(a=new wa.ExecuteRetInfo).updateCounts=new Array(o),c="",u=0,l.label=1;case 1:if(!(u<o))return[3,6];l.label=2;case 2:return l.trys.push([2,4,,5]),[4,this.Y(e,r[u],n||u!==0)];case 3:return h=l.sent(),a.union(h,u,1),[3,5];case 4:if(s=l.sent(),a.updateCounts[u]=0,!e.connection.conn_prop_continueBatchOnError)throw Er.DBError.ECJS_BATCH_ERROR(s);return c+="row["+u+"]:"+s+Jf.EOL,[3,5];case 5:return u++,[3,1];case 6:if(c)throw Er.DBError.ECJS_BATCH_ERROR(c);return[2,a]}})})},t.prototype.H=function(e,r){return B(this,void 0,void 0,function(){var n=this;return M(this,function(o){return[2,new Promise(function(a,c){n.ft(new Na.Fetch(n,e,BigInt(r),F.Const.INT64_MAX,function(u,h){u?c(u):a(h)}))})]})})},t.prototype.T=function(){return B(this,void 0,void 0,function(){var e=this;return M(this,function(r){return[2,new Promise(function(n,o){e.ft(new e_.Commit(e,function(a){a?o(a):n()}))})]})})},t.prototype.D=function(){return B(this,void 0,void 0,function(){var e=this;return M(this,function(r){return[2,new Promise(function(n,o){e.ft(new r_.Rollback(e,function(a){a?o(a):n()}))})]})})},t.prototype.B=function(e,r,n){return B(this,void 0,void 0,function(){var o,a,c,u;return M(this,function(h){switch(h.label){case 0:o=Buffer.alloc(n),c=a=0,h.label=1;case 1:return a<n?((c=n-a)>F.Const.MAX_BLOB_GET_LEN_PER_MSG&&(c=F.Const.MAX_BLOB_GET_LEN_PER_MSG),[4,this.Jt(e,r,c)]):[3,3];case 2:return(u=h.sent())&&u.length!==0?(fo.BufferUtil.L(o,a,u),a+=u.length,r+=u.length,e.readOver?[3,3]:[3,1]):[3,3];case 3:return[2,o]}})})},t.prototype.C=function(e,r,n){return B(this,void 0,void 0,function(){var o,a,c,u,h;return M(this,function(s){switch(s.label){case 0:o="",c=a=0,s.label=1;case 1:return a<n?((c=n-a)>F.Const.MAX_BLOB_GET_LEN_PER_MSG/2&&(c=F.Const.MAX_BLOB_GET_LEN_PER_MSG/2),[4,this.Jt(e,r,c)]):[3,3];case 2:return(u=s.sent())&&u.length!==0?(h=fo.BufferUtil.c(u,0,u.length,e.serverEncoding),o+=h,a+=h.length,r+=h.length,e.readOver?[3,3]:[3,1]):[3,3];case 3:return[2,o]}})})},t.prototype.j=function(e,r,n,o,a){return B(this,void 0,void 0,function(){var c,u,h,s,l,_,f,y,T;return M(this,function(m){switch(m.label){case 0:h=u=c=0,s=a/F.Const.MAX_BLOB_LEN_PER_MSG+1,_=1,f=2,y=l=0,m.label=1;case 1:return y<s?((l=0)===y&&(l|=_),y===s-1&&(l|=f),(h=a-u)>F.Const.MAX_BLOB_LEN_PER_MSG&&(h=F.Const.MAX_BLOB_LEN_PER_MSG),[4,this.Kt(e,l,r,n,o,h)]):[3,4];case 2:if((T=m.sent())<=0)return[3,4];r+=T,c+=T,u+=h,o+=h,m.label=3;case 3:return y++,[3,1];case 4:return[2,c]}})})},t.prototype.S=function(e,r,n,o){return B(this,void 0,void 0,function(){var a,c,u,h,s,l,_,f,y,T,m,P;return M(this,function(st){switch(st.label){case 0:a=fo.BufferUtil.b(n,o),c=0,u=a.length,l=s=h=0,_=u/F.Const.MAX_BLOB_LEN_PER_MSG+1,y=1,T=2,m=f=0,st.label=1;case 1:return m<_?((f=0)==m&&(f|=y),m==_-1&&(f|=T),(l=u-s)>F.Const.MAX_BLOB_LEN_PER_MSG&&(l=F.Const.MAX_BLOB_LEN_PER_MSG),[4,this.Kt(e,f,r,a,c,l)]):[3,4];case 2:if((P=st.sent())<=0)return[3,4];r+=P,h+=P,s+=l,c+=l,st.label=3;case 3:return m++,[3,1];case 4:return[2,h]}})})},t.prototype.Jt=function(e,r,n){return B(this,void 0,void 0,function(){var o=this;return M(this,function(a){return[2,new Promise(function(c,u){o.ft(new s_.GetLobData(o,e,r,n,function(h,s){h?u(h):c(s)}))})]})})},t.prototype.Kt=function(e,r,n,o,a,c){return B(this,void 0,void 0,function(){var u=this;return M(this,function(h){return[2,new Promise(function(s,l){u.ft(new a_.SetLobData(u,e,r,n,o,a,c,function(_,f){_?l(_):s(f)}))})]})})},t.prototype.h=function(e){return B(this,void 0,void 0,function(){var r=this;return M(this,function(n){return[2,new Promise(function(o,a){r.ft(new c_.GetLobLen(r,e,function(c,u){c?a(c):o(u)}))})]})})},t.prototype.O=function(e,r){return B(this,void 0,void 0,function(){var n=this;return M(this,function(o){return[2,new Promise(function(a,c){n.ft(new u_.LobTruncate(n,e,r,function(u,h){u?c(u):a(h)}))})]})})},t.prototype.K=function(e){return B(this,void 0,void 0,function(){var r=this;return M(this,function(n){return[2,new Promise(function(o,a){r.ft(new E_.TableTS(r,e,function(c,u){c?a(c):o(u)}))})]})})},t.prototype.W=function(e,r){return B(this,void 0,void 0,function(){var n=this;return M(this,function(o){return[2,new Promise(function(a,c){n.ft(new T_.MoreResult(n,e,r,function(u,h){u?c(u):a(h)}))})]})})},t.prototype.z=function(e){return B(this,void 0,void 0,function(){var r=this;return M(this,function(n){return[2,new Promise(function(o,a){r.ft(new Na.Fetch(r,e,F.Const.INT64_MAX,BigInt(1),function(c,u){c?a(c):o(u.updateCount)}))})]})})},t.prototype.Nt=function(){return this.Et||(this.Et=$e.MsgSecurity.newClientKeyPair()),$e.MsgSecurity.getPublicKey(this.Et)},t.prototype.Ct=function(e,r,n,o){if(0<e&&e<$e.MsgSecurity.MIN_EXTERNAL_CIPHER_ID&&r)this.bt=new __.SymmCipher(e,r);else if(e>=$e.MsgSecurity.MIN_EXTERNAL_CIPHER_ID)throw new Error("not supported")},t.prototype.Lt=function(e){return e.Qt!==gt.Msg.Vt&&this.at.conn_prop_compress!==F.Const.MSG_COMPRESS_NO&&(this.at.conn_prop_compress===F.Const.MSG_COMPRESS_SIMPLE||this.at.conn_prop_compress===F.Const.MSG_COMPRESS_AUTO&&!this.at.local&&e.dt()>F.Const.MSG_COMPRESS_THRESHOLD)},t.prototype.Pt=function(e){return e.Qt!==gt.Msg.Vt&&this.at.conn_prop_compress!==F.Const.MSG_COMPRESS_NO&&(this.at.conn_prop_compress===F.Const.MSG_COMPRESS_SIMPLE||this.at.conn_prop_compress===F.Const.MSG_COMPRESS_AUTO&&e.mt.e(gt.Msg.Dt)===1)},t.prototype.Wt=function(e){return e.Qt!==gt.Msg.Vt&&this.at.sslEncrypt==1},t.prototype.Ht=function(e,r,n){var o,a,c,u=!1;return r[n]===null||r[n]===void 0?e[n]=lo.ParamDataEnum.NULL:r[n]instanceof t_.OffRowBinder?(u=!0,e[n]=lo.ParamDataEnum.OFF_ROW,(o=r[n].obj)instanceof $f.AbstractLob&&(a=o).canOptimized(this.at)&&(c=a.buildCtlData(),e[n]=new lo.LobCtl(c),u=!1)):e[n]=r[n],u},t.prototype.F=function(e){e instanceof Er.DBError&&(e.fatal=!0);var r=this.rt[0];r?r.I(e):this.ht(e)},t.prototype.ht=function(e,r){var n=this;this.it||e instanceof Er.DBError&&!e.fatal||(this.it=e,process.nextTick(function(){n.rt.forEach(function(o){o.I(e)}),n.rt.length=0}),this.emit("end",e))},t}(n_.EventEmitter);oe.Access=y_});var xa=E(tr=>{"use strict";var Ua=tr&&tr.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},Fa=tr&&tr.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(tr,"__esModule",{value:!0});var m_=function(){function i(t,e){this.queue=new Array(0),this.maxSize=t,this.enableLRU=e===void 0||e}return i.prototype.get=function(){return this.queue.shift()},i.prototype.put=function(t){return Ua(this,void 0,void 0,function(){var e;return Fa(this,function(r){switch(r.label){case 0:return this.queue.includes(t)?[2]:this.queue.length<this.maxSize?(this.queue.push(t),[3,5]):[3,1];case 1:return this.enableLRU?(e=this.get(),[4,this.beforeRemove(e)]):[3,3];case 2:return r.sent(),this.queue.push(t),[3,5];case 3:return[4,this.beforeRemove(t)];case 4:r.sent(),r.label=5;case 5:return[2]}})})},i.prototype.size=function(){return this.queue.length},i.prototype.clear=function(){this.queue.splice(0)},i.prototype.beforeRemove=function(t){return Ua(this,void 0,void 0,function(){return Fa(this,function(e){return[2]})})},i}();tr.CacheQueue=m_});var ve=E(Gt=>{"use strict";var Ya=Gt&&Gt.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),_t=Gt&&Gt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},pt=Gt&&Gt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}};Object.defineProperty(Gt,"__esModule",{value:!0});var er=require("path"),S_=Pa(),x=R(),v=D(),ka=fn(),Tt=Bt(),ot=Yt(),g_=cr(),v_=require("events"),b_=require("net"),Tr=Fr(),_o=require("tls"),po=require("fs"),I_=require("os"),Eo=rr(),qa=ce(),A_=xa(),O_=Kn(),L_=V(),D_=function(i){function t(e){var r=i.call(this)||this;return r.serverEncoding=v.Const.ENCODING_GB18030,r.dbTimezone=0,r.sslEncrypt=0,r.malini2=!0,r.execute2=!0,r.lobEmptyCompOrcl=!1,r.isoLevel=-1,r.newLobFlag=!0,r.constParaOpt=!1,r.standbyCount=0,r.sessionID=BigInt(-1),r.trxStatus=v.Const.TRX_STATUS_NOT_START,r.trxFinish=!0,r.dscControl=!1,r.newClientType=!1,r.msgVersion=L_.Msg.VERSION,r.conn_prop_locale=0,r.conn_prop_compress=v.Const.MSG_COMPRESS_NO,r.conn_prop_compressID=v.Const.MSG_CPR_FUN_ID_ZIP,r.conn_prop_loginEncrypt=!0,r.conn_prop_isBdtaRS=!1,r.conn_prop_loginCertificate="",r.conn_prop_sessEncode="",r.conn_prop_uKeyName="",r.conn_prop_uKeyPin="",r.conn_prop_columnNameCase=v.Const.COLUMN_NAME_NATURAL_CASE,r.conn_prop_localTimezone=-new Date().getTimezoneOffset(),r.conn_prop_socketTimeout=0,r.conn_prop_connectTimeout=5e3,r.conn_prop_sessionTimeout=0,r.conn_prop_mppLocal=!1,r.conn_prop_rwSeparate=!1,r.conn_prop_rwPercent=25,r.conn_prop_rwHA=!1,r.conn_prop_rwStandbyRecoverTime=1e3,r.conn_prop_rwIgnoreSql=!1,r.conn_prop_doSwitch=v.Const.DO_SWITCH_OFF,r.conn_prop_cluster=v.Const.CLUSTER_TYPE_NORMAL,r.conn_prop_cipherPath="",r.conn_prop_keyWords=new Array,r.conn_prop_osAuthType=v.Const.OSAUTH_DEFAULT,r.conn_prop_url="",r.conn_prop_host="localhost",r.conn_prop_port=v.Const.PORT_DEFAULT,r.conn_prop_user="SYSDBA",r.conn_prop_pwd="SYSDBA",r.conn_prop_appName="",r.conn_prop_osName=I_.type(),r.conn_prop_caseSensitive=!0,r.conn_prop_bufPrefetch=0,r.conn_prop_escapeProcess=!1,r.conn_prop_maxRows=0,r.conn_prop_autoCommit=!0,r.conn_prop_enRsCache=!1,r.conn_prop_epSelector=0,r.conn_prop_rsCacheSize=20,r.conn_prop_rsRefreshFreq=10,r.conn_prop_loginMode=v.Const.LOGIN_MODE_NORMAL_FIRST,r.conn_prop_loginStatus=0,r.conn_prop_loginDscCtrl=!1,r.conn_prop_switchTimes=1,r.conn_prop_switchInterval=1e3,r.conn_prop_continueBatchOnError=!1,r.conn_prop_batchAllowMaxErrors=0,r.conn_prop_batchType=1,r.conn_prop_batchNotOnCall=!1,r.conn_prop_compatibleMode=0,r.conn_prop_lobMode=1,r.conn_prop_stmtPoolSize=15,r.conn_prop_alwaysAllowCommit=!0,r.conn_prop_sslPath="",r.conn_prop_logLevel=v.Const.LOG_OFF,r.conn_prop_logDir=process.cwd(),r.conn_prop_logFlushFreq=30,r.closed=!0,r.readOnly=!1,r.local=!1,r.rwStandby=!1,r.props=e,r.setAttributes(e),0<r.conn_prop_stmtPoolSize&&(r.stmtPool=new A_.CacheQueue(r.conn_prop_stmtPoolSize,!1),r.stmtPool.beforeRemove=function(n){return _t(r,void 0,void 0,function(){return pt(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.access.A(n.handle)];case 1:return o.sent(),[3,3];case 2:return o.sent(),[3,3];case 3:return[2]}})})}),r}return Ya(t,i),t.newInstanceOfConnection=function(e){var r=new t(e);return r.newMiddlewares(),r},t.prototype.newMiddlewares=function(){this.middlewares=new qa.Middlewares(this,this.props,t.nextID++,null)},t.prototype.setAttributes=function(e){var r,n;e.size()!==0&&(this.conn_prop_url=e.getTrimString("url",this.conn_prop_url),this.conn_prop_host=e.getTrimString("host",this.conn_prop_host),this.conn_prop_port=e.getNumber("port",this.conn_prop_port),this.conn_prop_user=e.getTrimString("user",this.conn_prop_user),this.conn_prop_pwd=e.getTrimString("password",this.conn_prop_pwd),this.rwStandby=e.getBoolean("rwStandby",this.rwStandby),this.conn_prop_compress=e.getBoolean("isCompress",!1)?v.Const.MSG_COMPRESS_AUTO:this.conn_prop_compress,this.conn_prop_compress=e.getNumber("compress",this.conn_prop_compress,0,2),this.conn_prop_compressID=e.getNumber("compressID",this.conn_prop_compressID,0,1),this.parseLanguage(e),(r=e.getTrimString("sessEncode",this.conn_prop_sessEncode))&&!ka.DriverUtil.isSupportedCharset(r)?this.conn_prop_sessEncode="":this.conn_prop_sessEncode=r,this.conn_prop_enRsCache=e.getBoolean("enRsCache",this.conn_prop_enRsCache),this.conn_prop_epSelector=e.getNumber("epSelector",this.conn_prop_epSelector,0,1),this.conn_prop_localTimezone=e.getNumber("localTimezone",this.conn_prop_localTimezone,-720,720),this.conn_prop_rsCacheSize=e.getNumber("rsCacheSize",this.conn_prop_rsCacheSize,0),this.conn_prop_rsRefreshFreq=e.getNumber("rsRefreshFreq",this.conn_prop_rsRefreshFreq,0),this.conn_prop_loginMode=e.getNumber("loginMode",this.conn_prop_loginMode,0,4),this.conn_prop_loginStatus=e.getNumber("loginStatus",this.conn_prop_loginStatus,0),[0,3,4,5].includes(this.conn_prop_loginStatus)||(this.conn_prop_loginStatus=0),this.conn_prop_loginDscCtrl=e.getBoolean("loginDscCtrl",this.conn_prop_loginDscCtrl),this.conn_prop_switchTimes=e.getNumber("switchTimes",this.conn_prop_switchTimes,0),this.conn_prop_switchInterval=e.getNumber("switchInterval",this.conn_prop_switchInterval,0),this.conn_prop_loginEncrypt=e.getBoolean("loginEncrypt",this.conn_prop_loginEncrypt),this.conn_prop_loginCertificate=e.getTrimString("loginCertificate",this.conn_prop_loginCertificate),this.conn_prop_rwSeparate=e.getBoolean("rwSeparate",this.conn_prop_rwSeparate),this.conn_prop_rwPercent=e.getNumber("rwPercent",this.conn_prop_rwPercent,0,100),this.conn_prop_rwHA=e.getBoolean("rwHA",this.conn_prop_rwHA),this.conn_prop_rwStandbyRecoverTime=e.getNumber("rwStandbyRecoverTime",this.conn_prop_rwStandbyRecoverTime,0),this.conn_prop_rwIgnoreSql=e.getBoolean("rwIgnoreSql",this.conn_prop_rwIgnoreSql),this.conn_prop_doSwitch=e.getNumber("doSwitch",this.conn_prop_doSwitch,0,2),this.conn_prop_cluster=this.parseCluster(e),this.conn_prop_cipherPath=e.getTrimString("cipherPath",this.conn_prop_cipherPath),e.getBoolean("comOra",!1)&&(this.conn_prop_compatibleMode=v.Const.COMPATIBLE_MODE_ORACLE),this.conn_prop_compatibleMode=Eo.SvcConf.parseCompatibleMode(e),this.conn_prop_keyWords=e.getStringArray("keyWords",this.conn_prop_keyWords),this.conn_prop_appName=e.getTrimString("appName",this.conn_prop_appName),this.conn_prop_osName=e.getTrimString("osName",this.conn_prop_osName),this.conn_prop_mppLocal=e.getBoolean("mppLocal",this.conn_prop_mppLocal),this.conn_prop_socketTimeout=e.getNumber("socketTimeout",this.conn_prop_socketTimeout,0),this.conn_prop_connectTimeout=e.getNumber("connectTimeout",this.conn_prop_connectTimeout,0),this.conn_prop_sessionTimeout=e.getNumber("sessionTimeout",this.conn_prop_sessionTimeout,0),this.parseOsAuthType(e),this.conn_prop_continueBatchOnError=e.getBoolean("continueBatchOnError",this.conn_prop_continueBatchOnError),this.conn_prop_batchAllowMaxErrors=e.getNumber("batchAllowMaxErrors",this.conn_prop_batchAllowMaxErrors,0),this.conn_prop_escapeProcess=e.getBoolean("escapeProcess",this.conn_prop_escapeProcess),this.conn_prop_autoCommit=e.getBoolean("autoCommit",ot.dmdb.autoCommit),this.conn_prop_maxRows=e.getNumber("maxRows",this.conn_prop_maxRows,0),this.conn_prop_bufPrefetch=e.getNumber("bufPrefetch",this.conn_prop_bufPrefetch,v.Const.MIN_BUF_PREFETCH,v.Const.MAX_BUF_PREFETCH),this.conn_prop_lobMode=e.getNumber("LobMode",this.conn_prop_lobMode,1,2),this.conn_prop_stmtPoolSize=e.getNumber("StmtPoolSize",this.conn_prop_stmtPoolSize,0),this.conn_prop_alwaysAllowCommit=e.getBoolean("alwaysAllowCommit",this.conn_prop_alwaysAllowCommit),this.conn_prop_batchType=e.getNumber("batchType",this.conn_prop_batchType,1,2),this.conn_prop_batchNotOnCall=e.getBoolean("batchNotOnCall",this.conn_prop_batchNotOnCall),this.conn_prop_isBdtaRS=e.getBoolean("isBdtaRS",this.conn_prop_isBdtaRS),this.conn_prop_sslPath=e.getTrimString("sslPath",this.conn_prop_sslPath),this.conn_prop_uKeyName=e.getTrimString("uKeyName",this.conn_prop_uKeyName),this.conn_prop_uKeyPin=e.getTrimString("uKeyPin",this.conn_prop_uKeyPin),e.getBoolean("columnNameUpperCase",!1)&&(this.conn_prop_columnNameCase=v.Const.COLUMN_NAME_UPPER_CASE),(n=e.getTrimString("columnNameCase","")).toLowerCase()==="upper"?this.conn_prop_columnNameCase=v.Const.COLUMN_NAME_UPPER_CASE:n.toLowerCase()==="lower"&&(this.conn_prop_columnNameCase=v.Const.COLUMN_NAME_LOWER_CASE),this.epGroup=e.getAny("epGroup"),this.conn_prop_logLevel=Eo.SvcConf.parseLogLevel(e),this.conn_prop_logDir=ka.DriverUtil.formatDir(e.getTrimString("logDir",this.conn_prop_logDir)),this.conn_prop_logFlushFreq=e.getNumber("logFlushFreq",this.conn_prop_logFlushFreq,0))},t.prototype.parseOsAuthType=function(e){var r=e.getTrimString("osAuthType","");if(r&&!Tt.StringUtil.isDigit(r)?Tt.StringUtil.equalsIgnoreCase(r,"ON")?this.conn_prop_osAuthType=v.Const.OSAUTH_DEFAULT:Tt.StringUtil.equalsIgnoreCase(r,"SYSDBA")?this.conn_prop_osAuthType=v.Const.OSAUTH_DBA:Tt.StringUtil.equalsIgnoreCase(r,"SYSAUDITOR")?this.conn_prop_osAuthType=v.Const.OSAUTH_AUDITOR:Tt.StringUtil.equalsIgnoreCase(r,"SYSSSO")?this.conn_prop_osAuthType=v.Const.OSAUTH_SSO:Tt.StringUtil.equalsIgnoreCase(r,"AUTO")?this.conn_prop_osAuthType=v.Const.OSAUTH_AUTOMATCH:Tt.StringUtil.equalsIgnoreCase(r,"OFF")&&(this.conn_prop_osAuthType=v.Const.OSAUTH_OFF):this.conn_prop_osAuthType=e.getNumber("osAuthType",this.conn_prop_osAuthType,0,4),this.conn_prop_user||this.conn_prop_osAuthType!==v.Const.OSAUTH_OFF){if(this.conn_prop_osAuthType!==v.Const.OSAUTH_OFF&&this.conn_prop_user)throw x.DBError.ECJS_OSAUTH_ERROR();this.conn_prop_osAuthType!==v.Const.OSAUTH_OFF&&(this.conn_prop_user=process.env["user.name"]||"",this.conn_prop_pwd="")}else this.conn_prop_user="SYSDBA"},t.prototype.parseLanguage=function(e){var r=e.getTrimString("language","cn");Tt.StringUtil.equalsIgnoreCase(r,"cn")?this.conn_prop_locale=v.Const.LANGUAGE_CN:Tt.StringUtil.equalsIgnoreCase(r,"en")&&(this.conn_prop_locale=v.Const.LANGUAGE_EN),Eo.SvcConf.LOCALE=this.conn_prop_locale,this.oracleDateLanguage=this.conn_prop_locale},t.prototype.parseCluster=function(e){var r=e.getTrimString("cluster","");return Tt.StringUtil.equalsIgnoreCase(r,"dsc")?v.Const.CLUSTER_TYPE_DSC:Tt.StringUtil.equalsIgnoreCase(r,"rw")?v.Const.CLUSTER_TYPE_RW:Tt.StringUtil.equalsIgnoreCase(r,"dw")?v.Const.CLUSTER_TYPE_DW:Tt.StringUtil.equalsIgnoreCase(r,"mpp")?v.Const.CLUSTER_TYPE_MPP:v.Const.CLUSTER_TYPE_NORMAL},t.prototype.setTrxFinish=function(e){switch(e&v.Const.TRX_STATUS_STATE_MASK){case v.Const.TRX_STATUS_NOT_START:case v.Const.TRX_STATUS_COMMITTED:case v.Const.TRX_STATUS_ROLLBACKED:this.trxFinish=!0;break;default:this.trxFinish=!1}},t.node2dbIsoLevel=function(e){switch(e){case v.Const.CLI_READ_UNCOMMITTED:return v.Const.ISO_LEVEL_READ_UNCOMMITTED;case v.Const.CLI_READ_COMMITTED:return v.Const.ISO_LEVEL_READ_COMMITTED;case v.Const.CLI_REPEATABLE_READ:return v.Const.ISO_LEVEL_REPEATABLE_READ;case v.Const.CLI_SERIALIZABLE:return v.Const.ISO_LEVEL_SERIALIZABLE;default:return-1}},t.db2nodeIsoLevel=function(e){switch(e){case v.Const.ISO_LEVEL_READ_UNCOMMITTED:return v.Const.CLI_READ_UNCOMMITTED;case v.Const.ISO_LEVEL_READ_COMMITTED:return v.Const.CLI_READ_COMMITTED;case v.Const.ISO_LEVEL_REPEATABLE_READ:return v.Const.CLI_REPEATABLE_READ;case v.Const.ISO_LEVEL_SERIALIZABLE:return v.Const.CLI_SERIALIZABLE;default:return-1}},t.prototype.compatibleOracle=function(){return this.conn_prop_compatibleMode===v.Const.COMPATIBLE_MODE_ORACLE},t.prototype.checkClosed=function(){if(this.closed)throw x.DBError.ECJS_CONNECTION_CLOSED()},t.prototype.getIndexOnEPGroup=function(){if(!this.epGroup||!this.epGroup.epList)return-1;for(var e=0;e<this.epGroup.epList.length;e++){var r=this.epGroup.epList[e];if(r.host===this.conn_prop_host&&r.port===this.conn_prop_port)return e}return-1},t.prototype.openConnection=function(e){return _t(this,void 0,void 0,function(){return pt(this,function(r){return[2,this.middlewares.valid?this.middlewares.reset().connection_openConnection(this,e):this.do_openConnection(e)]})})},t.prototype.execute=function(e,r,n,o){if(r===void 0&&n===void 0&&o===void 0)return this.middlewares.valid?this.middlewares.reset().connection_execute(this,e):this.do_execute(e);if(typeof r=="function"&&n===void 0&&o===void 0)this.execute(e).then(function(a){r(null,a)}).catch(function(a){r(a,void 0)});else{if(typeof r!="function"&&n===void 0&&o===void 0)return this.middlewares.valid?this.middlewares.reset().connection_execute(this,e,r):this.do_execute(e,r);if(typeof r!="function"&&typeof n=="function"&&o===void 0)this.execute(e,r).then(function(a){n(null,a)}).catch(function(a){n(a,void 0)});else{if(typeof r!="function"&&typeof n!="function"&&o===void 0)return this.middlewares.valid?this.middlewares.reset().connection_execute(this,e,r,n):this.do_execute(e,r,n);if(typeof r=="function"||typeof n=="function"||typeof o!="function")throw x.DBError.ECJS_INVALID_PARAM();this.execute(e,r,n).then(function(a){o(null,a)}).catch(function(a){o(a,void 0)})}}},t.prototype.executeMany=function(e,r,n,o){if(typeof r=="number"&&n===void 0&&o===void 0)return this.middlewares.valid?this.middlewares.reset().connection_executeMany(this,e,r):this.do_executeMany(e,r);if(typeof r=="number"&&typeof n=="function"&&o===void 0)this.executeMany(e,r).then(function(a){n(null,a)}).catch(function(a){n(a,void 0)});else{if(typeof r=="number"&&typeof n!="function"&&o===void 0)return this.middlewares.valid?this.middlewares.reset().connection_executeMany(this,e,r,n):this.do_executeMany(e,r,n);if(typeof r=="number"&&typeof n!="function"&&typeof o=="function")this.executeMany(e,r,n).then(function(a){o(null,a)}).catch(function(a){o(a,void 0)});else{if(Array.isArray(r)&&n===void 0&&o===void 0)return this.middlewares.valid?this.middlewares.reset().connection_executeMany(this,e,r):this.do_executeMany(e,r);if(Array.isArray(r)&&typeof n=="function"&&o===void 0)this.executeMany(e,r).then(function(a){n(null,a)}).catch(function(a){n(a,void 0)});else{if(Array.isArray(r)&&typeof n!="function"&&o===void 0)return this.middlewares.valid?this.middlewares.reset().connection_executeMany(this,e,r,n):this.do_executeMany(e,r,n);if(!Array.isArray(r)||typeof n=="function"||typeof o!="function")throw x.DBError.ECJS_INVALID_PARAM();this.executeMany(e,r,n).then(function(a){o(null,a)}).catch(function(a){o(a,void 0)})}}}},t.prototype.createLob=function(e,r){if(r===void 0)return this.middlewares.valid?this.middlewares.reset().connection_createLob(this,e):this.do_createLob(e);if(typeof r!="function")throw x.DBError.ECJS_INVALID_PARAM();this.createLob(e).then(function(n){r(null,n)}).catch(function(n){r(n,void 0)})},t.prototype.close=function(e){if(e===void 0)return this.middlewares.valid?this.middlewares.reset().connection_close(this):this.do_close();if(typeof e!="function")throw x.DBError.ECJS_INVALID_PARAM();this.close().then(function(){e(null)}).catch(function(r){e(r)})},t.prototype.commit=function(e){if(e===void 0)return this.middlewares.valid?this.middlewares.reset().connection_commit(this):this.do_commit();if(typeof e!="function")throw x.DBError.ECJS_INVALID_PARAM();this.commit().then(function(){e(null)}).catch(function(r){e(r)})},t.prototype.getStatementInfo=function(e,r){if(r===void 0)return this.middlewares.valid?this.middlewares.reset().connection_getStatementInfo(this,e):this.do_getStatementInfo(e);if(typeof r!="function")throw x.DBError.ECJS_INVALID_PARAM();this.getStatementInfo(e).then(function(n){r(null,n)}).catch(function(n){r(n,void 0)})},t.prototype.ping=function(e){if(e===void 0)return this.execute("select 1").then(function(){});if(typeof e!="function")throw x.DBError.ECJS_INVALID_PARAM();this.ping().then(function(){e(null)}).catch(function(r){e(r)})},t.prototype.release=function(e){if(e===void 0)return this.close();if(typeof e!="function")throw x.DBError.ECJS_INVALID_PARAM();this.release().then(function(){e(null)}).catch(function(r){e(r)})},t.prototype.rollback=function(e){if(e===void 0)return this.middlewares.valid?this.middlewares.reset().connection_rollback(this):this.do_rollback();if(typeof e=="function")return this.rollback().then(function(){e(null)}).catch(function(r){e(r)});throw x.DBError.ECJS_INVALID_PARAM()},t.prototype.changePassword=function(e,r,n,o){if(o===void 0){if(typeof e!="string"||typeof r!="string"||typeof n!="string")throw x.DBError.ECJS_INVALID_PARAM();return this.execute('alter user "'+e+'" identified by "'+n+'"').then(function(){})}if(typeof o!="function")throw x.DBError.ECJS_INVALID_PARAM();this.changePassword(e,r,n).then(function(){o(null)}).catch(function(a){o(a)})},t.prototype.free=function(){return _t(this,void 0,void 0,function(){var e,r=this;return pt(this,function(n){return this.stmtPool&&this.stmtPool.clear(),(e=this.middlewares.log)&&e.logWriter.end(),[2,new Promise(function(o,a){process.nextTick(function(){r.socket?(r.doUnbinds(r.socket),r.socket.end(function(){r.closed=!0,o()}),r.socket.once("error",function(c){a(c)})):(r.closed=!0,o())})})]})})},t.prototype.do_close=function(){return _t(this,void 0,void 0,function(){return pt(this,function(e){switch(e.label){case 0:if(this.closed)return[3,6];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.compatibleOracle()?this.commit():this.rollback()];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[4,this.free()];case 5:e.sent(),e.label=6;case 6:return[2]}})})},t.prototype.getServerEncoding=function(){return this.conn_prop_sessEncode||this.serverEncoding},t.prototype.lobFetchAll=function(){return this.conn_prop_lobMode===2},t.prototype.do_openConnection=function(e){return _t(this,void 0,void 0,function(){var r,n=this;return pt(this,function(o){switch(o.label){case 0:if(e&&0<e.epList.length)return[2,e.connect(this)];o.label=1;case 1:return o.trys.push([1,4,5,11]),this.access=new S_.Access(this),[4,new Promise(function(a,c){var u=setTimeout(function(){n.socket&&(n.socket.removeAllListeners(),n.socket.destroy()),c(x.DBError.ECJS_CONNECT_TIMEOUT())},n.conn_prop_connectTimeout);n.socket=b_.createConnection({host:n.conn_prop_host,port:n.conn_prop_port}),n.socket.once("connect",function(){clearTimeout(u),n.socket.removeAllListeners("error"),n.doBinds(n.socket),n.emit("connect"),a()}),n.socket.on("error",function(h){clearTimeout(u),c(h)})})];case 2:return o.sent(),[4,this.access.P()];case 3:return o.sent(),this.closed=!1,[2,this];case 4:throw(r=o.sent())instanceof x.DBError?r:x.DBError.ECJS_COMMUNICATION_ERROR(r+"");case 5:return this.closed?this instanceof To?[4,this.destroy()]:[3,7]:[3,10];case 6:return o.sent(),[3,9];case 7:return[4,this.free()];case 8:o.sent(),o.label=9;case 9:o.label=10;case 10:return[7];case 11:return[2]}})})},t.prototype.do_execute=function(e,r,n){return _t(this,void 0,void 0,function(){var o,a,c,u,h;return pt(this,function(s){switch(s.label){case 0:if(typeof e!="string")throw x.DBError.ECJS_INVALID_PARAM();if(this.checkClosed(),(n={extendedMetaData:(n=n||{}).extendedMetaData!==void 0?n.extendedMetaData:ot.dmdb.extendedMetaData,fetchInfo:n.fetchInfo,outFormat:n.outFormat!==void 0?n.outFormat:ot.dmdb.outFormat,resultSet:n.resultSet!==void 0&&n.resultSet,innerExec:n.innerExec!==void 0&&n.innerExec}).outFormat!==ot.dmdb.OUT_FORMAT_ARRAY&&n.outFormat!==ot.dmdb.OUT_FORMAT_OBJECT)throw x.DBError.ECJS_INVALID_OUTFORMAT();return Array.isArray(r)&&0<r.length?[4,(o=new Tr.PreparedStatement(this,n,!1)).allocateHandle()]:[3,5];case 1:return s.sent(),[4,o.prepareSql(e)];case 2:for(s.sent(),c=0;c<r.length;c++)ot.dmdb.isBindParameter(r[c])||(r[c]={dir:ot.dmdb.BIND_IN,val:r[c]});return[4,o.executePstmt(r)];case 3:return s.sent(),[4,o.close()];case 4:return s.sent(),[2,o.execInfo.result];case 5:return typeof r!="object"||Array.isArray(r)?[3,10]:[4,(o=new Tr.PreparedStatement(this,n,!1)).allocateHandle()];case 6:return s.sent(),[4,o.prepareSql(e)];case 7:for(s.sent(),a=new Array(o.params.length),c=0;c<o.params.length;c++)for(h in u=o.params[c],r)if(r.hasOwnProperty(h)&&Tt.StringUtil.equalsIgnoreCase(h,u.name)){a[c]=ot.dmdb.isBindParameter(r[h])?r[h]:{dir:ot.dmdb.BIND_IN,val:r[h]};break}return[4,o.executePstmt(a)];case 8:return s.sent(),[4,o.close()];case 9:return s.sent(),[2,o.execInfo.result];case 10:return[2,this._executeInner(e,n)]}})})},t.prototype.do_executeMany=function(e,r,n){return _t(this,void 0,void 0,function(){var o,a,c,u,h,s,l,_;return pt(this,function(f){switch(f.label){case 0:if(typeof e!="string")throw x.DBError.ECJS_INVALID_PARAM();if(this.checkClosed(),n={batchErrors:(n=n||{}).batchErrors!==void 0?n.batchErrors:this.conn_prop_continueBatchOnError,dmlRowCounts:n.dmlRowCounts!==void 0&&n.dmlRowCounts},typeof r!="number")return[3,7];if(!Number.isSafeInteger(r)||r<1)throw x.DBError.ECJS_INVALID_PARAM("iterations must in 1~Number.MAX_SAFE_INTEGER");return[4,(o=new Tr.PreparedStatement(this,n,!0)).allocateHandle()];case 1:return f.sent(),[4,o.prepareSql("BEGIN FOR i IN 1.."+r+" LOOP "+e+(e.trimRight().endsWith(";")?"":";")+" END LOOP; END;")];case 2:return f.sent(),0<o.paramCount?[4,o.close()]:[3,4];case 3:throw f.sent(),x.DBError.ECJS_INVALID_SQL();case 4:return[4,o.executeManyPstmt([])];case 5:return f.sent(),[4,o.close()];case 6:return f.sent(),delete o.execInfo.results.dmlRowCounts,delete o.execInfo.results.rowsAffected,[2,o.execInfo.results];case 7:return Array.isArray(r)?[4,(o=new Tr.PreparedStatement(this,n,!0)).allocateHandle()]:[3,12];case 8:return f.sent(),[4,o.prepareSql(e)];case 9:for(f.sent(),a=0;a<r.length;a++)if(c=r[a],Array.isArray(c)){for(u=0;u<c.length;u++)ot.dmdb.isBindParameter(c[u])||(c[u]={dir:ot.dmdb.BIND_IN,val:c[u]});r[a]=c}else if(typeof c=="object"){for(h=new Array(o.params.length),s=0;s<o.params.length;s++)for(_ in l=o.params[s],c)if(c.hasOwnProperty(_)&&Tt.StringUtil.equalsIgnoreCase(_,l.name)){h[s]=ot.dmdb.isBindParameter(c[_])?c[_]:{dir:ot.dmdb.BIND_IN,val:c[_]};break}r[a]=h}return[4,o.executeManyPstmt(r)];case 10:return f.sent(),[4,o.close()];case 11:return f.sent(),[2,o.execInfo.results];case 12:throw new Error("Function is called with invalid params!")}})})},t.prototype.do_createLob=function(e){return _t(this,void 0,void 0,function(){return pt(this,function(r){return this.checkClosed(),[2,g_.Lob.newLob(e,this)]})})},t.prototype.do_commit=function(){return _t(this,void 0,void 0,function(){return pt(this,function(e){switch(e.label){case 0:return this.checkClosed(),this.conn_prop_autoCommit?[3,2]:[4,this.access.T()];case 1:return e.sent(),this.trxFinish=!0,[3,3];case 2:if(!this.conn_prop_alwaysAllowCommit)throw x.DBError.ECJS_COMMIT_IN_AUTOCOMMIT_MODE();e.label=3;case 3:return[2]}})})},t.prototype.do_getStatementInfo=function(e){return _t(this,void 0,void 0,function(){var r,n;return pt(this,function(o){switch(o.label){case 0:if(typeof e!="string")throw x.DBError.ECJS_INVALID_PARAM();return this.checkClosed(),[4,(r=new Tr.PreparedStatement(this,{extendedMetaData:ot.dmdb.extendedMetaData,outFormat:ot.dmdb.outFormat,resultSet:!1},!1)).allocateHandle()];case 1:return o.sent(),[4,r.prepareSql(e)];case 2:return o.sent(),n={},0<r.params.length&&(n.bindNames=[],r.params.forEach(function(a){n.bindNames.push(a.name)})),0<r.columns.length&&(n.metaData=r.getMetaData(ot.dmdb.extendedMetaData)),n.statementType=r.execInfo.retSqlType,[2,n]}})})},t.prototype.do_rollback=function(){return _t(this,void 0,void 0,function(){return pt(this,function(e){switch(e.label){case 0:return this.checkClosed(),this.conn_prop_autoCommit?[3,2]:[4,this.access.D()];case 1:return e.sent(),this.trxFinish=!0,[3,3];case 2:if(!this.conn_prop_alwaysAllowCommit)throw x.DBError.ECJS_ROLLBACK_IN_AUTOCOMMIT_MODE();e.label=3;case 3:return[2]}})})},t.prototype.do_reconnect=function(){return _t(this,void 0,void 0,function(){return pt(this,function(e){switch(e.label){case 0:return this instanceof To?[4,this.destroy()]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,this.free()];case 3:e.sent(),e.label=4;case 4:return this.epGroup?[4,this.epGroup.connect(this)]:[3,6];case 5:return e.sent(),[3,8];case 6:return[4,this.do_openConnection()];case 7:e.sent(),e.label=8;case 8:return[2]}})})},t.prototype.do_executeInner=function(e,r){return _t(this,void 0,void 0,function(){var n;return pt(this,function(o){return n={extendedMetaData:!1,outFormat:ot.dmdb.OUT_FORMAT_ARRAY,resultSet:!0,innerExec:!0},[2,this.do_execute(e,r,n)]})})},t.prototype._executeInner=function(e,r){return _t(this,void 0,void 0,function(){var n,o;return pt(this,function(a){switch(a.label){case 0:return[4,(n=new Tr.Statement(this,r,!1)).allocateHandle()];case 1:return a.sent(),[4,n.execute(e)];case 2:return o=a.sent(),[4,n.close()];case 3:return a.sent(),[2,o]}})})},t.prototype._handleNetWorkError=function(e){this.access.F(e)},t.prototype._handleConnectTimeout=function(){this.socket&&(this.socket.setTimeout(0),this.socket.destroy()),this._handleNetWorkError(x.DBError.ECJS_CONNECT_TIMEOUT())},t.prototype.doBinds=function(e){var r=this;return _o.TLSSocket,e.setNoDelay(!0),e.setKeepAlive(!0),e.on("error",function(n){r._handleNetWorkError(n)}),e.on("end",function(){r.access.I()}),e.on("close",function(){}),e.on("data",function(n){r.access.R(n)}),this.access.on("data",function(n){e.write(n)}),this.access.on("end",function(){e.end()}),e},t.prototype.doUnbinds=function(e){e.removeAllListeners(),this.access.removeAllListeners()},t.prototype.startTLS=function(e){var r=this;return new Promise(function(n,o){var a=r._createSecureContext();e?(r.tlsSocket=_o.connect({secureContext:a,checkServerIdentity:function(){},socket:r.socket,rejectUnauthorized:!1,requestCert:!0}),r.tlsSocket.on("secureConnect",function(){n()}),r.tlsSocket.on("error",function(c){o(c)}),r.doUnbinds(r.socket),r.socket=r.doBinds(r.tlsSocket)):o(new Error("SSL Authentication not support"))})},t.prototype._createSecureContext=function(){try{if(!this.conn_prop_sslPath){var e=process.env.DM_HOME;if(!e)throw new Error("sslPath can not be empty.");this.conn_prop_sslPath=""+e+er.sep+"bin"+er.sep+"client_ssl"+er.sep+this.conn_prop_user+er.sep}return _o.createSecureContext({cert:po.readFileSync(er.join(this.conn_prop_sslPath,"client-cert.pem")),key:po.readFileSync(er.join(this.conn_prop_sslPath,"client-key.pem")),ca:[po.readFileSync(er.join(this.conn_prop_sslPath,"ca-cert.pem"))],honorCipherOrder:!0,minVersion:"TLSv1",maxVersion:"TLSv1.3"})}catch(r){throw x.DBError.ECJS_INIT_SSL_FAILED(r+"")}},t.nextID=0,t}(v_.EventEmitter),To=function(i){function t(e,r){var n=i.call(this,e)||this;return n.pool=r,n.on("close",function(o){var a=void 0;try{n.pool.releaseConnection(n)}catch(c){a=c}finally{return void process.nextTick(o,a)}}),n}return Ya(t,i),t.newInstanceOfPoolConnection=function(e,r){var n=new t(e,r);return n.newMiddlewares(),n.idleCloseTimer=new O_.Timer(function(){n.pool.eliminateConnection(n)}),n},t.prototype.newMiddlewares=function(){this.middlewares=new qa.Middlewares(this,this.props,t.nextID++,this.pool.middlewares)},t.prototype.free=function(){return _t(this,void 0,void 0,function(){var e=this;return pt(this,function(r){return[2,new Promise(function(n,o){e.emit("close",function(a){a?o(a):n()})})]})})},t.prototype.destroy=function(){return _t(this,void 0,void 0,function(){return pt(this,function(e){return[2,i.prototype.free.call(this)]})})},t.prototype.startTimer=function(){0<this.pool.poolTimeout&&this.idleCloseTimer&&this.idleCloseTimer.start(1e3*this.pool.poolTimeout)},t.prototype.refreshTimer=function(){this.idleCloseTimer&&this.idleCloseTimer.refresh()},t.prototype.stopTimer=function(){this.idleCloseTimer&&this.idleCloseTimer.stop()},t}(Gt.Connection=D_);Gt.PoolConnection=To});var Yt=E(Nt=>{"use strict";var yo=Nt&&Nt.__awaiter||function(i,t,e,r){return new(e=e||Promise)(function(n,o){function a(h){try{u(r.next(h))}catch(s){o(s)}}function c(h){try{u(r.throw(h))}catch(s){o(s)}}function u(h){var s;h.done?n(h.value):((s=h.value)instanceof e?s:new e(function(l){l(s)})).then(a,c)}u((r=r.apply(i,t||[])).next())})},mo=Nt&&Nt.__generator||function(i,t){var e,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a={next:c(0),throw:c(1),return:c(2)};return typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(h){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=0<(n=o.trys).length&&n[n.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(s[0]===6&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(i,o)}catch(l){s=[6,l],r=0}finally{e=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([u,h])}}},za=Nt&&Nt.__read||function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r,n,o=e.call(i),a=[];try{for(;(t===void 0||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(c){n={error:c}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(n)throw n.error}}return a},C_=Nt&&Nt.__spread||function(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(za(arguments[t]));return i};Object.defineProperty(Nt,"__esModule",{value:!0});var w_,Va=ve(),yr=R(),Ha=ln(),R_=require("url"),N_=rr(),So=D(),B_=cr(),Ga=_i(),M_=Jn(),P_=gr();(function(i){function t(o){return yo(this,void 0,void 0,function(){var a,c,u,h;return mo(this,function(s){if(!o.startsWith("dm://"))return[2,Promise.reject(new Error("URL must start with 'dm://'"))];for(u in a=R_.parse(o.trim(),!0),(c=new Ha.Properties).set("url",o),a.auth&&a.auth.split(":")[0]&&(c.set("user",a.auth.split(":")[0]),a.auth.split(":")[1]&&c.set("password",a.auth.split(":")[1])),a.query)h=a.query[u],c.set(u,h instanceof Array?h[h.length-1]:h);return[2,r(c,a.host)]})})}function e(o){return yo(this,void 0,void 0,function(){var a,c,u;return mo(this,function(h){for(u in o=o||{},a=new Ha.Properties,c=o.connectString||o.connectionString||"",a.setAny("url",c),o)a.setAny(u,o[u]);return[2,r(a,c)]})})}function r(o,a){return yo(this,void 0,void 0,function(){var c,u,h,s,l,_,f,y,T;return mo(this,function(m){switch(m.label){case 0:return u=o.getTrimString("svcConfPath",""),[4,N_.SvcConf.load(u,!1)];case 1:return c=m.sent(),h=o.getTrimString("addressRemap","")||c.globalProperties.getTrimString("addressRemap",""),a=n(a,h),s=za(["",""],2),l=s[0],_=s[1],f=a.lastIndexOf(":"),_=f!==-1?(l=a.substring(0,f),a.substring(f+1)):(l=a,So.Const.PORT_DEFAULT.toString()),o.set("host",l),o.set("port",_),y=o.getTrimString("userRemap","")||c.globalProperties.getTrimString("userRemap",""),o.set("user",n(o.getTrimString("user",""),y)),T=(T=c.serverGroupMap.get(a))||new M_.EPGroup(l+":"+_,[new P_.EP(l,Number.parseInt(_))]),o.setDiffProps(T.props),o.getBoolean("rwSeparate",!1)&&(o.setIfNotExist("loginMode",So.Const.LOGIN_MODE_PRIMARY_ONLY.toString()),o.setIfNotExist("loginStatus",So.Const.SERVER_STATUS_OPEN.toString()),o.setIfNotExist("doSwitch","true")),o.setAny("epGroup",T),o.setDiffProps(c.globalProperties),[2,o]}})})}function n(o,a){if(!o||!a)return o;for(var c=/\(.*?,.*?\)/g,u=null;u=c.exec(a);){var h=u[0].substring(1,u[0].length-1).split(",");if(h[0].trim()===o)return h[1].trim()}return o}i.EXEC_MANY_FAIL=-1,i.OUT_FORMAT_ARRAY=4001,i.OUT_FORMAT_OBJECT=4002,i.BLOB=2019,i.BUFFER=2006,i.CLOB=2017,i.CURSOR=2021,i.DATE=2014,i.DEFAULT=0,i.NUMBER=2010,i.STRING=2001,i.BIND_IN=3001,i.BIND_INOUT=3002,i.BIND_OUT=3003,i.POOL_STATUS_OPEN=6e3,i.POOL_STATUS_DRAINING=6001,i.POOL_STATUS_CLOSED=6002,i.STMT_TYPE_UNKNOWN=0,i.STMT_TYPE_SELECT=1,i.STMT_TYPE_UPDATE=2,i.STMT_TYPE_DELETE=3,i.STMT_TYPE_INSERT=4,i.STMT_TYPE_CREATE=5,i.STMT_TYPE_DROP=6,i.STMT_TYPE_ALTER=7,i.STMT_TYPE_BEGIN=8,i.STMT_TYPE_DECLARE=9,i.STMT_TYPE_CALL=10,i.STMT_TYPE_EXPLAIN_PLAN=15,i.STMT_TYPE_MERGE=16,i.STMT_TYPE_ROLLBACK=17,i.STMT_TYPE_COMMIT=21,i.autoCommit=!0,i.extendedMetaData=!1,i.outFormat=i.OUT_FORMAT_ARRAY,i.poolMax=4,i.poolMin=0,i.poolTimeout=60,i.fetchAsBuffer=[],i.fetchAsString=[],i.allowDebug=!1,i.pools=new Map,i.getConnection=function(o,a){if(a===void 0){var c;if(o instanceof Object)return e(o).then(function(u){return c=u,Va.Connection.newInstanceOfConnection(c).openConnection(c.getAny("epGroup"))}).then(function(u){var h=c.getTrimString("schema","");return h!==""?u.execute("set schema "+h).then(function(){return u}):u});if(typeof o!="string")throw yr.DBError.ECJS_INVALID_URL_OR_ALIAS_OR_ATTR();if(o.startsWith("dm://"))return t(o).then(function(u){return c=u,Va.Connection.newInstanceOfConnection(c).openConnection(c.getAny("epGroup"))}).then(function(u){var h=c.getTrimString("schema","");return h!==""?u.execute("set schema "+h).then(function(){return u}):u});if(!i.pools.has(o))throw yr.DBError.ECJS_INVALID_URL_OR_ALIAS_OR_ATTR();return i.pools.get(o).getConnection()}if(typeof a!="function")throw yr.DBError.ECJS_INVALID_PARAM();i.getConnection(o).then(function(u){a(null,u)}).catch(function(u){a(u,void 0)})},i.createPool=function(o,a){if(o&&a===void 0)return new Ga.Pool(o).openPool().then(function(c){if(o.poolAlias){if(i.pools.has(o.poolAlias))throw yr.DBError.ECJS_POOL_ALIAS_CONFLICT();i.pools.set(o.poolAlias,c)}return c});if(!o||typeof a!="function")throw yr.DBError.ECJS_INVALID_PARAM();new Ga.Pool(o).openPool().then(function(c){if(o.poolAlias){if(i.pools.has(o.poolAlias))throw yr.DBError.ECJS_POOL_ALIAS_CONFLICT();i.pools.set(o.poolAlias,c)}a(null,c)}).catch(function(c){a(c,void 0)})},i.getPool=function(o){if(i.pools.has(o))return i.pools.get(o)},i.isBindParameter=function(o){return o!=null&&!(typeof o=="string"||typeof o=="number"||o instanceof B_.Lob||o instanceof Date||o instanceof BigInt)&&(o.dir!==void 0||o.maxArraySize!==void 0||o.maxSize!==void 0||o.type!==void 0||o.val!==void 0)},i.parseUrl=t,i.parseConnectionAttr=e,i.debug=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];i.allowDebug&&console.log.apply(console,C_(o))}})(w_=Nt.dmdb||(Nt.dmdb={}))});module.exports=Yt().dmdb;
