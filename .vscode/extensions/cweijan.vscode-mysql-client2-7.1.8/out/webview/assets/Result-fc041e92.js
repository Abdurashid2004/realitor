import{d as fe,q as xe,s as me,m as T,n as F,i as ee,v as ge,_ as ve,r as Te,a as $e,u as De,c as Ie,o as Oe,h as Le,w as Ee,j as Re,g as Me,p as oe,V as Ae,x as Fe,y as Y,b as Ve}from"./app-aaf1260a.js";import{e as O,n as ce,s as Ne}from"./notify-d9afd13e.js";/* empty css              */import{u as ue}from"./umy-table.common-748bdcd1.js";import{i as Q,w as Pe,a as je}from"./wrapper-101fa27b.js";import{s as X,b as ye,_ as qe,D as be,g as He,a as Ue,c as Be,d as Qe,e as ze,t as Ke,f as We}from"./DetailDialog-9c806848.js";import{g as _e,a as Xe,c as de,t as Ge,C as Je}from"./codeMirror-3cc33dcd.js";import{r as R}from"./resultStore-5e9bef73.js";import{r as A}from"./resultUIStore-81e22dea.js";import{D as te,i as Ye}from"./DatabaseType-0c502678.js";import{_ as G}from"./switch-6bf42133.js";import{_ as ie}from"./dialog-dd4b0ce4.js";import{_ as Ze,a as et}from"./select-85394007.js";import{f as tt}from"./viewUtil-064e524b.js";import{r as it,_ as he}from"./date-picker-f3524a38.js";import{b as st,a as nt}from"./scrollbar-b60f2172.js";import{A as K}from"./arrayUtil-2fb3ed04.js";import{_ as rt,r as at}from"./storeUtil-d5120b85.js";import{_ as pe}from"./checkbox-b9c3a5b6.js";import"./index-72d37e73.js";import"./index-f37b6d04.js";import"./index-3e66c890.js";import"./checkbox-group-7fc9dfe8.js";import"./checkbox-4f03e503.js";function Z(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/ /g,"&nbsp;").replace(/\u0000/g," "):null}const se=fe("data",{state:()=>({filterData:[]}),getters:{},actions:{}}),lt=xe(),j=fe("edit",{state:()=>({dialog:{loading:!1,visible:!1,model:null},editModel:null,originModel:null,update:{oldData:[],previousUpdateList:{},editList:{},hasEdit:!1,updateCounter:0,lock:!1}}),getters:{hasEdit(t){return t.update.hasEdit}},actions:{editCell(t,e,i,s){var a;(a=se().filterData[0])!=null&&a.isFilter||t++;const n=Object.assign(this.update.editList,{});n[t]||(n[t]={_isNewPush:e._isNewPush},delete n[t]._XID),n[t][i]=s,this.$patch(c=>{c.update.hasEdit=!0,c.update.editList=n})},reqOpenInsertDialog(){const t=R();if(!t.noTable){if(t.readonly)return O(this.$t("common.readonly"));if(!t.columnList.length&&(t.columnList=t.fields,!t.columnList))return O("Not columns found!");this.editModel={},this.dialog.model="insert",this.dialog.loading=!1,this.dialog.visible=!0,lt.emit("telemetry","InsertDialog")}},reqOpenEditOrCopyDialog(t,e){const i=R();if(i.readonly)return O(this.$t("common.readonly"));if(!i.columnList.length&&(i.columnList=i.fields,!i.columnList))return O("Not columns found!");this.originModel=t,this.editModel={...t},this.dialog.loading=!1,this.dialog.visible=!0,this.dialog.model=e?"copy":"update",e&&(this.editModel[i.primaryKey]=null)}}});const ot={props:["scope","editList","filterObj","index","fields"],data(){return{columnFocus:!1,isNull:!0,nullText:"(NULL)"}},computed:{...me(j),...T(A,{rowHeight:t=>t.config.resultRowHeight,rightAlignNumericData:t=>t.config.rightAlignNumericData}),...T(R,["columnList"]),...T(R,{result:t=>t}),...T(j,["update"]),editable(){if(this.scope.row._isNewPush)return!0;const t=this.result;return!t.readonly&&t.tableCount==1&&t.dbType!="ClickHouse"},isDbNumberType(){var i;if(!this.rightAlignNumericData)return!1;const t=this.fields[this.index],e=this.getTypeByColumn((i=this.scope.column)==null?void 0:i.title)??_e(this.result.dbType,t);return Q(e)}},watch:{scope(){this.checkIsNull()}},methods:{checkIsNull(){const t=this.scope.row[this.scope.column.title]??this.scope.row[this.scope.column.property];this.isNull=t==null},dataToHtml(){const{row:t,column:e}=this.scope,i=t[e.title]??t[e.property];return i==null?this.checkIsNull():this.dataformat(i)},dataformat(t){var i;const e=(i=t==null?void 0:t.constructor)==null?void 0:i.name;if(t.hasOwnProperty("type"))return String.fromCharCode.apply(null,new Uint16Array(t.data));if(e=="String")return Z(t);if(["PostgreSQL","Redshift"].includes(this.result.dbType)){const s=this.getTypeByColumn(this.scope.column.title);if(s!=null&&s.includes("[]")){const n=X(t).replace(/\[/g,"{").replace(/\]/g,"}");return this.scope.row[this.scope.column.title]=n,Z(n)}}else if(typeof t=="object"&&(t.x||t.y))return X(t);return t},onPaste(t){let e="";t.preventDefault(),e=(t.originalEvent||t).clipboardData.getData("text/plain"),t.clipboardData.setData("text/plain",""),setTimeout(()=>{window.document.execCommand("insertHTML",!1,Z(e.replace("/\r/g","\\n")))},1)},focus(t){this.columnFocus=!0;const e=window.getSelection(),i=document.createRange();i.setStart(t.target,0),i.setEnd(t.target,0),e.removeAllRanges(),e.addRange(i)},syncRow(t,e){let i=t.target.textContent;if(!this.isNull||i){this.trimChild(t.target);const{column:s}=e;e.row[s.title]!==""&&i===""&&(i=null),e.row[s.title]=i}else this.nullText="(NULL)";this.checkIsNull(),this.columnFocus=!1},trimChild(t){var e,i;((e=t.firstChild)==null?void 0:e.nodeType)===Node.TEXT_NODE&&t.removeChild(t.firstChild);for(let s=0;s<t.children.length;s++){const n=t.children[s];(i=n==null?void 0:n.classList)!=null&&i.contains("row-content")||t.removeChild(n)}},editListen(t,e){const{row:i,column:s,rowIndex:n}=e;this.editStore.editCell(n,i,s.title,t.target.textContent)},getTypeByColumn(t){if(this.result.columnList){for(const e of this.result.columnList)if(e.name===t)return e.simpleType||e.type}},doFilter(){var i;if(Object.keys(this.filterObj).length==0)return;let t=this.result.sql;const e={};for(const s in this.filterObj){const n=this.filterObj[s];switch(this.result.dbType){case"ElasticSearch":case"MongoDB":if(n==null||n==="")continue;e[s]=n;break;default:const a=this.getTypeByColumn(s),c=Q(a),v=n&&n.toLowerCase()==="null",g=v?"is":c?"=":"like",_=v||!n||c?n:((i=a==null?void 0:a.toLowerCase)==null?void 0:i.call(a))=="nvarchar"?`N'%${n}%'`:`'%${n}%'`;t=ye(t,s,a,g,_,this.result.dbType)}}switch(this.result.dbType){case"ElasticSearch":const s=Object.keys(e).length>0?{match:e}:{match_all:{}};this.$emit("sendToVscode","esFilter",s);break;case"MongoDB":t=this.result.sql.replace(/find\(.+?\)/,`find(${X(e)})`),this.$emit("execute",t);break;default:this.$emit("execute",t)}}}};var ct=function(){var e=this,i=e._self._c;return i("div",[e.isDbNumberType?e._e():i("div",{staticClass:"row-util"},[i("i",{staticClass:"codicon-zoom-in",attrs:{title:"View On Dialog"},on:{click:function(s){return e.$emit("viewOnDialog",e.scope)}}})]),e.scope.row.isFilter?[i("vsc-input",{staticClass:"edit-filter",attrs:{clearable:!0,placeholder:"Filter"},on:{clear:e.doFilter},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.doFilter.apply(null,arguments)}},model:{value:e.filterObj[e.scope.column.title],callback:function(s){e.$set(e.filterObj,e.scope.column.title,s)},expression:"filterObj[scope.column.title]"}})]:[i("div",{staticClass:"edit-column",class:{right:e.isDbNumberType},style:{lineHeight:e.rowHeight,height:e.rowHeight},attrs:{contenteditable:e.editable},on:{input:function(s){return e.editListen(s,e.scope)},paste:e.onPaste,focus:e.focus,blur:function(s){return e.syncRow(s,e.scope)}}},[e.isNull?[e.columnFocus?e._e():i("span",{staticClass:"null-column row-content"},[e._v(e._s(e.nullText))])]:[i("div",{staticClass:"row-content",style:{lineHeight:e.rowHeight,height:e.rowHeight},domProps:{innerHTML:e._s(e.dataToHtml())}})]],2)]],2)},ut=[],dt=F(ot,ct,ut,!1,null,null,null,null);const ht=dt.exports;const pt={props:["scope","index","fields"],computed:{...T(R,["primaryKeyList"]),...T(R,{result:t=>t}),...T(A,["config"]),isPk(){const t=this.primaryKeyList;if(Array.isArray(t)){const e=this.fields[this.index];for(const i of t)if(i.name==e.name)return!0}return!1},columnHover(){return this.comment&&!this.showComment?this.comment:this.columnType},columnType(){const t=this.fields[this.index];return this.result.dbType==te.ES&&t.name=="_id"?"text":Xe(this.result.columnTypeMap[this.scope.column.title])??_e(this.result.dbType,t)},comment(){return this.getTip(this.scope.column)},showComment(){if(!this.comment)return!1;switch(this.config.showComments){case"Never":return!1;case"Chinese Only":return this.comment.match(/[\u4e00-\u9fa5]+/g)!=null}return!0}},methods:{getTip(t){var e;return(e=this.result.columnTypeMap[t.title])==null?void 0:e.comment},isNotNull(t){const e=this.result.columnTypeMap[t];return(e==null?void 0:e.isNotNull)||["_id","_score"].includes(t)}}};var ft=function(){var e=this,i=e._self._c;return i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.columnHover,placement:"bottom-end"}},[i("div",[i("span",[!e.isPk&&e.isNotNull(e.scope.column.title)?i("RedMark"):e._e(),e.isPk?i("i",{staticClass:"codicon-key",staticStyle:{color:"var(--vscode-terminal-ansiYellow)",position:"relative",top:"2px","font-size":"13px"}}):e._e(),i("span",[e._v("Â ")]),i("span",{staticClass:"column-name"},[e._v(e._s(e.scope.column.title)+" ")])],1),i("br"),i("span",{staticClass:"column-type"},[e.showComment?i("span",[e._v(e._s(e.comment)+"/")]):e._e(),e._v(e._s(e.columnType)+" ")])])])},mt=[],gt=F(pt,ft,mt,!1,null,null,null,null);const vt=gt.exports;const yt={mixins:[ee],data(){return{loading:!1,exportOption:{exportSQL:!1,withOutLimit:!1,exportSQLByDump:!0,type:"XLSX"}}},computed:{...T(A,["isPay","dialog"]),...T(R,["dbType"]),supportDump(){return this.exportOption.type=="SQL"&&["MySQL","MariaDB"].includes(this.dbType)},supportExportEditor(){return this.supportDump&&this.exportOption.exportSQLByDump?!1:["CSV","JSON","SQL","Markdown"].includes(this.exportOption.type)}},watch:{"dialog.exportVisible"(){this.loading=!1},dbType(){this.exportOption.withOutLimit=this.dbType!=te.ES}},mounted(){this.on("state",({state:t})=>{t&&(this.exportOption.exportSQL=t.exportSQL??!1,this.exportOption.withOutLimit=t.withOutLimit??!1,this.exportOption.exportSQLByDump=t.exportSQLByDump??!0)}).on("export_done",({success:t,exportToEditor:e})=>{console.log(t,e),this.done(),t&&(this.loading=!1,e||(this.dialog.exportVisible=!1))})},methods:{done(){this.loading=!1},upState(t,e){this.emit("upState",{key:t,value:e})},tryExport(t){if(!this.isPay){O("Free account not support export data!");return}this.loading=!0,this.$emit("exportHandle",{...this.exportOption,exportToEditor:t})}}};var bt=function(){var e=this,i=e._self._c;return i(ie,{class:{"is-es":e.dbType=="ElasticSearch"},attrs:{title:e.$t("result.exportOption"),"custom-class":"export-dialog",visible:e.dialog.exportVisible,width:"30%",top:"3vh",center:"",closeOnClickModal:!1},on:{close:function(s){e.dialog.exportVisible=!1}},scopedSlots:e._u([{key:"footer",fn:function(){return[i("vsc-button",{attrs:{type:"secondary"},on:{click:function(s){e.dialog.exportVisible=!1}}},[e._v(e._s(e.$t("common.close")))]),i("vsc-button",{attrs:{disabled:!e.supportExportEditor,type:"primary",loading:e.supportExportEditor&&e.loading},on:{click:function(s){return e.tryExport(!0)}}},[e._v(e._s(e.$t("result.exportToEditor")))]),i("vsc-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.tryExport(!1)}}},[e._v(e._s(e.$t("result.export")))])]},proxy:!0}])},[i("div",{staticClass:"flex flex-col gap-y-5"},[i("div",{staticClass:"flex gap-x-3"},[i("span",{staticClass:"shrink-0"},[e._v(" "+e._s(e.$t("result.exportType"))+" ")]),i("vsc-radio-group",{attrs:{size:"mini",type:"relax"},model:{value:e.exportOption.type,callback:function(s){e.$set(e.exportOption,"type",s)},expression:"exportOption.type"}},[i("vsc-radio-button",{attrs:{value:"XLSX",label:"XLSX"}}),i("vsc-radio-button",{attrs:{value:"CSV",label:"CSV"}}),i("vsc-radio-button",{attrs:{value:"JSON",label:"JSON"}}),i("vsc-radio-button",{attrs:{value:"SQL",label:"SQL"}}),i("vsc-radio-button",{attrs:{value:"Markdown",label:"Markdown"}}),["ElasticSearch"].includes(e.dbType)?i("vsc-radio-button",{attrs:{value:"Dump",label:"Dump"}}):e._e()],1)],1),e.supportDump?i("div",{staticClass:"flex gap-x-3"},[e._v(" Dump "),i(G,{on:{change:function(s){return e.upState("exportSQLByDump",s)}},model:{value:e.exportOption.exportSQLByDump,callback:function(s){e.$set(e.exportOption,"exportSQLByDump",s)},expression:"exportOption.exportSQLByDump"}})],1):e._e(),i("div",{staticClass:"flex gap-x-3"},[e._v(" "+e._s(e.$t("result.removeLimit"))+" "),i(G,{on:{change:function(s){return e.upState("withOutLimit",s)}},model:{value:e.exportOption.withOutLimit,callback:function(s){e.$set(e.exportOption,"withOutLimit",s)},expression:"exportOption.withOutLimit"}})],1),e.exportOption.type=="XLSX"?i("div",{staticClass:"flex gap-x-3 mb-2"},[e._v(" "+e._s(e.$t("result.exportSQL"))+" "),i(G,{on:{change:function(s){return e.upState("exportSQL",s)}},model:{value:e.exportOption.exportSQL,callback:function(s){e.$set(e.exportOption,"exportSQL",s)},expression:"exportOption.exportSQL"}})],1):e._e()])])},_t=[],wt=F(yt,bt,_t,!1,null,null,null,null);const Ct=wt.exports;const St={data(){return{loading:!1,importOption:{}}},computed:{...T(A,["dialog"]),...T(R,["dbType"])},watch:{"dialog.importVisible"(){this.loading=!1}},methods:{reqImport(){this.loading=!0,this.$emit("importHandle",this.importOption)}}};var kt=function(){var e=this,i=e._self._c;return i(ie,{attrs:{title:e.$t("result.importExternal"),"custom-class":"import-dialog",visible:e.dialog.importVisible,width:"30%",top:"3vh",center:"",closeOnClickModal:!1},on:{close:function(s){e.dialog.importVisible=!1}},scopedSlots:e._u([{key:"footer",fn:function(){return[i("vsc-button",{attrs:{type:"secondary"},on:{click:function(s){e.dialog.importVisible=!1}}},[e._v(e._s(e.$t("common.close")))]),i("vsc-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.reqImport}},[e._v(e._s(e.$t("common.choose")))])]},proxy:!0}])},[i("div",{staticClass:"flex flex-col items-center gap-y-2 mb-4"},[i("div",{staticClass:"flex items-center gap-x-1"},[i("div",{staticClass:"mr-3"},[e._v(" Support types ")]),["ElasticSearch","MongoDB"].includes(e.dbType)?e._e():i("vsc-tag",{staticClass:"mr-1"},[e._v("SQL")]),i("vsc-tag",{staticClass:"mr-1"},[e._v("XLSX")]),i("vsc-tag",{staticClass:"mr-1"},[e._v("JSON")]),i("vsc-tag",{staticClass:"mr-1"},[e._v("CSV")])],1)])])},xt=[],Tt=F(St,kt,xt,!1,null,null,null,null);const $t=Tt.exports;const Dt={mixins:[ee],props:["lock","showFilter"],data(){return{myShowFilter:!1,myShowReverse:!1,searchInput:null,deleteSQL:"",deleteConfirmVisible:!1,cmOptions:{readOnly:!0},viewTypes:[{value:"JSON"},{value:"Default"},{value:"Reverse"}]}},computed:{...T(A,["userInit","user","isPay","viewType","isSplitView","reverseData","page"]),...T(A,{UI:t=>t,err:t=>t.info.message,executing:t=>t.table.loading,search:t=>t.table.search,saveLoading:t=>t.toolbar.saveLoading,showSaveBtn:t=>t.toolbar.showSaveBtn,selectedRows:t=>t.toolbar.selectedRows}),...T(R,{noTable:"noTable",result:t=>t}),deleteConfirm(){return this.result.primaryKey?"Are you sure to delete selected data?":"Are you sure to delete selected data? No primary key found, this change might affect more records than expected!"},costTime(){return tt(this.result.costTime)}},watch:{searchInput(){this.UI.table.search=this.searchInput},showFilter(t){this.myShowFilter=t}},mounted(){this.myShowFilter=this.showFilter,this.myShowReverse=this.showReverse},methods:{...ge(j,{reqOpenInsertDialog:"reqOpenInsertDialog"}),changeViewType(t){this.UI.viewType=t,this.emit("changeViewType",t)},opt(t){this.noTable||this.$emit(t)},reqDelete(){if(this.result.readonly)return O(this.$t("common.readonly"));if(!(this.reverseData||this.noTable)){if(!this.selectedRows)return O(this.$t("result.deleteNotice"));this.deleteConfirmVisible=!0,this.$emit("deleteConfirm",!0)}},setDeleteSQL(t){this.deleteSQL=t},clear(){this.deleteSQL="",this.deleteConfirmVisible=!1},changeShowFiltervalue(t){this.$emit("update:showFilter",t),this.emit("upState",{key:"showFilter",value:t})},openConsole(){this.emit("openConsole")},openFreeTier(){this.emit("githubLogin")},openPayNotice(){this.emit("payNotice")}}};var It=function(){var s;var e=this,i=e._self._c;return i("div",{staticClass:"toolbar"},[e.isSplitView?i("i",{staticClass:"el-icon-rank ml-1",attrs:{title:"Full Result View",size:"mini",circle:""},on:{click:()=>e.emit("full")}}):e._e(),e.lock?e._e():i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Lock This Panel.",placement:"bottom-start"}},[i("i",{staticClass:"el-icon-unlock",on:{click:()=>e.emit("lock")}})]),e.lock?i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Unlock This Panel.",placement:"bottom-start"}},[i("i",{staticClass:"el-icon-lock",on:{click:()=>e.emit("unLock")}})]):e._e(),i("vsc-input",{staticClass:"ml-1",staticStyle:{width:"145px"},attrs:{theme:"base","prefix-icon":"el-icon-search",size:"mini",placeholder:e.$t("result.searchNotice"),clearable:!0},model:{value:e.searchInput,callback:function(n){e.searchInput=n},expression:"searchInput"}}),!e.noTable&&e.selectedRows?i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Copy to clipboard",placement:"bottom-start"}},[i("i",{staticClass:"el-icon-document-copy ml-1",staticStyle:{color:"var(--second-color)"},on:{click:function(n){return e.$emit("copySelection")}}})]):e._e(),i("div",{staticStyle:{display:"inline"},on:{click:e.openConsole}},[i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"console",placement:"bottom-start"}},[i("i",{staticClass:"el-icon-s-tools ml-1 relative",staticStyle:{color:"var(--second-color)"}})])],1),e.isPay?e._e():i("div",{staticStyle:{display:"inline"},on:{click:e.openPayNotice}},[i("vsc-badge",{staticClass:"message-badge",attrs:{value:1,type:"primary"}},[i("i",{staticClass:"el-icon-message",staticStyle:{color:"rgb(91 187 255)"}})])],1),!e.isPay&&!e.user?i("div",{staticStyle:{display:"inline"},on:{click:e.openFreeTier}},[i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Login by github oauth.",placement:"bottom-start"}},[i("i",{staticClass:"icon-github"})])],1):e._e(),i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Insert new row",placement:"bottom-start",disabled:e.noTable}},[i("i",{staticClass:"codicon-add !text-cyan",class:{disable:e.reverseData||e.noTable},staticStyle:{position:"relative",top:"2px","font-size":"18px"},on:{click:function(n){return e.opt("insert")}}})]),i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Insert new row by dialog",placement:"bottom-start",disabled:e.noTable}},[i("i",{staticClass:"codicon-add !text-yellow",class:{disable:e.noTable},staticStyle:{position:"relative",top:"2px","font-size":"18px"},on:{click:e.reqOpenInsertDialog}})]),i(ve,{attrs:{placement:"top",width:"160",value:e.deleteConfirmVisible,trigger:"manual","popper-class":"toolbar-popper"},scopedSlots:e._u([{key:"reference",fn:function(){return[i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Delete select rows",placement:"bottom-start"}},[i("i",{staticClass:"el-icon-delete",class:{disable:e.reverseData||e.noTable||!e.selectedRows},staticStyle:{color:"#f56c6c"},on:{click:function(n){return e.reqDelete()}}})])]},proxy:!0}])},[[i("p",{staticStyle:{"word-break":"normal","line-height":"22px"}},[e.result.primaryKey?e._e():i("i",{staticClass:"el-icon-error",staticStyle:{color:"#f56c6c"}}),e._v(" "+e._s(e.deleteConfirm)+" ")]),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("vsc-button",{attrs:{type:"secondary"},on:{click:function(n){e.deleteConfirmVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),i("vsc-button",{on:{click:function(n){e.deleteConfirmVisible=!1,e.$emit("deleteConfirm")}}},[e._v(" "+e._s(e.$t("result.confirm"))+" ")])],1),i("codemirror",{directives:[{name:"show",rawName:"v-show",value:e.deleteSQL,expression:"deleteSQL"}],ref:"cmEditor",style:"max-height:350px; overflow-y: scroll;border:1px solid var(--vscode-quickInputTitle-background);",attrs:{options:e.cmOptions,dbType:(s=e.result)==null?void 0:s.dbType},model:{value:e.deleteSQL,callback:function(n){e.deleteSQL=n},expression:"deleteSQL"}})]],2),i("vsc-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.showSaveBtn,expression:"showSaveBtn"}],staticClass:"item",attrs:{effect:"dark",content:"Save",placement:"bottom-start"}},[i("i",{directives:[{name:"loading",rawName:"v-loading",value:e.saveLoading,expression:"saveLoading"}],staticClass:"el-icon-check",staticStyle:{color:"var(--vscode-charts-green)"},on:{click:function(n){return e.$emit("save")}}})]),i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Show filter",placement:"bottom-start"}},[i(G,{staticStyle:{top:"-3px",left:"4px"},on:{change:e.changeShowFiltervalue},model:{value:e.myShowFilter,callback:function(n){e.myShowFilter=n},expression:"myShowFilter"}})],1),e.isPay?e._e():i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("toolbar.reportIssue"),placement:"bottom-start"}},[i("i",{staticClass:"el-icon-s-comment ml-2",on:{click:()=>e.emit("openGithub")}})]),i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Import data",placement:"bottom-start"}},[i("i",{staticClass:"el-icon-top ml-1",class:{disable:e.noTable},staticStyle:{color:"var(--vscode-charts-yellow)"},on:{click:function(n){return e.opt("import")}}})]),i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Export data",placement:"bottom-start"}},[i("i",{staticClass:"el-icon-bottom",class:{disable:e.err},staticStyle:{color:"var(--vscode-charts-blue)"},on:{click:function(n){e.UI.dialog.exportVisible=!0}}})]),i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Execute SQL(Cmd+Enter)",placement:"bottom-start"}},[i("i",{directives:[{name:"show",rawName:"v-show",value:!e.executing,expression:"!executing"}],staticClass:"icon-run",staticStyle:{color:"var(--vscode-terminal-ansiBrightGreen)"},on:{click:function(n){return e.$emit("run")}}})]),i("vsc-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Stop Execute",placement:"bottom-start"}},[i("i",{directives:[{name:"show",rawName:"v-show",value:e.executing,expression:"executing"}],staticClass:"el-icon-switch-button",staticStyle:{color:"#f56c6c"},on:{click:function(n){return e.$emit("stopExecute")}}})]),i(Ze,{staticClass:"view-type-select",staticStyle:{width:"30px"},attrs:{value:e.viewType,placeholder:"è¯·éæ©"},on:{change:e.changeViewType},scopedSlots:e._u([{key:"prefix",fn:function(){return[i("i",{staticClass:"el-icon-view"})]},proxy:!0}])},e._l(e.viewTypes,function(n){return i(et,{key:n.value,attrs:{value:n.value}},[i("div",{staticStyle:{width:"14px",display:"inline-block"}},[e.viewType==n.value?i("i",{staticClass:"el-icon-check"}):e._e()]),e._v(" "+e._s(n.value)+" ")])}),1),i("div",{staticClass:"el-pagination__total",staticStyle:{display:"inline-block","padding-left":"8px"}},[e._v(" "+e._s(e.$t("result.cost"))+": "+e._s(e.costTime)+" ")]),i("div",{staticStyle:{display:"inline-block"}},[i(qe,{attrs:{loading:e.page.total==null,"current-page":e.page.pageNum,small:!0,"page-size":e.page.pageSize,"pager-count":5,layout:e.page.total!=null?"prev,pager, next, total":"prev, next",total:e.page.total},on:{"update:currentPage":function(n){return e.$set(e.page,"pageNum",n)},"update:current-page":function(n){return e.$set(e.page,"pageNum",n)},"current-change":n=>e.$emit("changePage",n,!0),"next-click":()=>e.$emit("changePage",1),"prev-click":()=>e.$emit("changePage",-1)}})],1)],1)},Ot=[],Lt=F(Dt,It,Ot,!1,null,"907e0b9b",null,null);const Et=Lt.exports;var we={exports:{}};(function(t){t.exports=function(e){var i={};function s(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=e,s.c=i,s.d=function(n,a,c){s.o(n,a)||Object.defineProperty(n,a,{enumerable:!0,get:c})},s.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},s.t=function(n,a){if(a&1&&(n=s(n)),a&8||a&4&&typeof n=="object"&&n&&n.__esModule)return n;var c=Object.create(null);if(s.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:n}),a&2&&typeof n!="string")for(var v in n)s.d(c,v,(function(g){return n[g]}).bind(null,v));return c},s.n=function(n){var a=n&&n.__esModule?function(){return n.default}:function(){return n};return s.d(a,"a",a),a},s.o=function(n,a){return Object.prototype.hasOwnProperty.call(n,a)},s.p="/dist/",s(s.s=77)}({0:function(e,i,s){s.d(i,"a",function(){return n});function n(a,c,v,g,_,C,x,k){var S=typeof a=="function"?a.options:a;c&&(S.render=c,S.staticRenderFns=v,S._compiled=!0),g&&(S.functional=!0),C&&(S._scopeId="data-v-"+C);var o;if(x?(o=function(f){f=f||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!f&&typeof __VUE_SSR_CONTEXT__<"u"&&(f=__VUE_SSR_CONTEXT__),_&&_.call(this,f),f&&f._registeredComponents&&f._registeredComponents.add(x)},S._ssrRegister=o):_&&(o=k?function(){_.call(this,this.$root.$options.shadowRoot)}:_),o)if(S.functional){S._injectStyles=o;var u=S.render;S.render=function(y,D){return o.call(D),u(y,D)}}else{var h=S.beforeCreate;S.beforeCreate=h?[].concat(h,o):[o]}return{exports:a,options:S}}},1:function(e,i){e.exports=it()},10:function(e,i){e.exports=Te()},12:function(e,i){e.exports=st()},15:function(e,i){e.exports=nt()},2:function(e,i){e.exports=$e()},27:function(e,i,s){var n=function(){var o=this,u=o.$createElement,h=o._self._c||u;return h("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":function(f){o.$emit("dodestroy")}}},[h("div",{directives:[{name:"show",rawName:"v-show",value:o.visible,expression:"visible"}],staticClass:"el-time-panel el-popper",class:o.popperClass},[h("div",{staticClass:"el-time-panel__content",class:{"has-seconds":o.showSeconds}},[h("time-spinner",{ref:"spinner",attrs:{"arrow-control":o.useArrow,"show-seconds":o.showSeconds,"am-pm-mode":o.amPmMode,date:o.date},on:{change:o.handleChange,"select-range":o.setSelectionRange}})],1),h("div",{staticClass:"el-time-panel__footer"},[h("button",{staticClass:"el-time-panel__btn cancel",attrs:{type:"button"},on:{click:o.handleCancel}},[o._v(o._s(o.t("el.datepicker.cancel")))]),h("button",{staticClass:"el-time-panel__btn",class:{confirm:!o.disabled},attrs:{type:"button"},on:{click:function(f){o.handleConfirm()}}},[o._v(o._s(o.t("el.datepicker.confirm")))])])])])},a=[];n._withStripped=!0;var c=s(1),v=s(6),g=s.n(v),_=s(34),C={mixins:[g.a],components:{TimeSpinner:_.a},props:{visible:Boolean,timeArrowControl:Boolean},watch:{visible:function(u){var h=this;u?(this.oldValue=this.value,this.$nextTick(function(){return h.$refs.spinner.emitSelectRange("hours")})):this.needInitAdjust=!0},value:function(u){var h=this,f=void 0;u instanceof Date?f=Object(c.limitTimeRange)(u,this.selectableRange,this.format):u||(f=this.defaultValue?new Date(this.defaultValue):new Date),this.date=f,this.visible&&this.needInitAdjust&&(this.$nextTick(function(y){return h.adjustSpinners()}),this.needInitAdjust=!1)},selectableRange:function(u){this.$refs.spinner.selectableRange=u},defaultValue:function(u){Object(c.isDate)(this.value)||(this.date=u?new Date(u):new Date)}},data:function(){return{popperClass:"",format:"HH:mm:ss",value:"",defaultValue:null,date:new Date,oldValue:new Date,selectableRange:[],selectionRange:[0,2],disabled:!1,arrowControl:!1,needInitAdjust:!0}},computed:{showSeconds:function(){return(this.format||"").indexOf("ss")!==-1},useArrow:function(){return this.arrowControl||this.timeArrowControl||!1},amPmMode:function(){return(this.format||"").indexOf("A")!==-1?"A":(this.format||"").indexOf("a")!==-1?"a":""}},methods:{handleCancel:function(){this.$emit("pick",this.oldValue,!1)},handleChange:function(u){this.visible&&(this.date=Object(c.clearMilliseconds)(u),this.isValidValue(this.date)&&this.$emit("pick",this.date,!0))},setSelectionRange:function(u,h){this.$emit("select-range",u,h),this.selectionRange=[u,h]},handleConfirm:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,h=arguments[1];if(!h){var f=Object(c.clearMilliseconds)(Object(c.limitTimeRange)(this.date,this.selectableRange,this.format));this.$emit("pick",f,u,h)}},handleKeydown:function(u){var h=u.keyCode,f={38:-1,40:1,37:-1,39:1};if(h===37||h===39){var y=f[h];this.changeSelectionRange(y),u.preventDefault();return}if(h===38||h===40){var D=f[h];this.$refs.spinner.scrollDown(D),u.preventDefault();return}},isValidValue:function(u){return Object(c.timeWithinRange)(u,this.selectableRange,this.format)},adjustSpinners:function(){return this.$refs.spinner.adjustSpinners()},changeSelectionRange:function(u){var h=[0,3].concat(this.showSeconds?[6]:[]),f=["hours","minutes"].concat(this.showSeconds?["seconds"]:[]),y=h.indexOf(this.selectionRange[0]),D=(y+u+h.length)%h.length;this.$refs.spinner.emitSelectRange(f[D])}},mounted:function(){var u=this;this.$nextTick(function(){return u.handleConfirm(!0,!0)}),this.$emit("mounted")}},x=C,k=s(0),S=Object(k.a)(x,n,a,!1,null,null,null);S.options.__file="packages/date-picker/src/panel/time.vue",i.a=S.exports},3:function(e,i){e.exports=De},30:function(e,i,s){var n=s(2),a=s(3);i.a={bind:function(v,g,_){var C=null,x=void 0,k=Object(a.isMac)()?100:200,S=function(){return _.context[g.expression].apply()},o=function(){Date.now()-x<k&&S(),clearInterval(C),C=null};Object(n.on)(v,"mousedown",function(u){u.button===0&&(x=Date.now(),Object(n.once)(document,"mouseup",o),clearInterval(C),C=setInterval(S,k))})}}},32:function(e,i,s){var n=function(){var l=this,r=l.$createElement,d=l._self._c||r;return l.ranged?d("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:l.handleClose,expression:"handleClose"}],ref:"reference",staticClass:"el-date-editor el-range-editor el-input__inner",class:["el-date-editor--"+l.type,l.pickerSize?"el-range-editor--"+l.pickerSize:"",l.pickerDisabled?"is-disabled":"",l.pickerVisible?"is-active":""],on:{click:l.handleRangeClick,mouseenter:l.handleMouseEnter,mouseleave:function(m){l.showClose=!1},keydown:l.handleKeydown}},[d("i",{class:["el-input__icon","el-range__icon",l.triggerClass]}),d("input",l._b({staticClass:"el-range-input",attrs:{autocomplete:"off",placeholder:l.startPlaceholder,disabled:l.pickerDisabled,readonly:!l.editable||l.readonly,name:l.name&&l.name[0]},domProps:{value:l.displayValue&&l.displayValue[0]},on:{input:l.handleStartInput,change:l.handleStartChange,focus:l.handleFocus}},"input",l.firstInputId,!1)),l._t("range-separator",[d("span",{staticClass:"el-range-separator"},[l._v(l._s(l.rangeSeparator))])]),d("input",l._b({staticClass:"el-range-input",attrs:{autocomplete:"off",placeholder:l.endPlaceholder,disabled:l.pickerDisabled,readonly:!l.editable||l.readonly,name:l.name&&l.name[1]},domProps:{value:l.displayValue&&l.displayValue[1]},on:{input:l.handleEndInput,change:l.handleEndChange,focus:l.handleFocus}},"input",l.secondInputId,!1)),l.haveTrigger?d("i",{staticClass:"el-input__icon el-range__close-icon",class:[l.showClose?""+l.clearIcon:""],on:{click:l.handleClickIcon}}):l._e()],2):d("el-input",l._b({directives:[{name:"clickoutside",rawName:"v-clickoutside",value:l.handleClose,expression:"handleClose"}],ref:"reference",staticClass:"el-date-editor",class:"el-date-editor--"+l.type,attrs:{readonly:!l.editable||l.readonly||l.type==="dates"||l.type==="week"||l.type==="years"||l.type==="months",disabled:l.pickerDisabled,size:l.pickerSize,name:l.name,placeholder:l.placeholder,value:l.displayValue,validateEvent:!1},on:{focus:l.handleFocus,input:function(m){return l.userInput=m},change:l.handleChange},nativeOn:{keydown:function(m){return l.handleKeydown(m)},mouseenter:function(m){return l.handleMouseEnter(m)},mouseleave:function(m){l.showClose=!1}}},"el-input",l.firstInputId,!1),[d("i",{staticClass:"el-input__icon",class:l.triggerClass,attrs:{slot:"prefix"},on:{click:l.handleFocus},slot:"prefix"}),l.haveTrigger?d("i",{staticClass:"el-input__icon",class:[l.showClose?""+l.clearIcon:""],attrs:{slot:"suffix"},on:{click:l.handleClickIcon},slot:"suffix"}):l._e()])},a=[];n._withStripped=!0;var c=s(7),v=s.n(c),g=s(12),_=s.n(g),C=s(1),x=s(5),k=s.n(x),S=s(4),o=s.n(S),u=s(10),h=s.n(u),f=s(9),y=s.n(f),D={props:{appendToBody:k.a.props.appendToBody,offset:k.a.props.offset,boundariesPadding:k.a.props.boundariesPadding,arrowOffset:k.a.props.arrowOffset,transformOrigin:k.a.props.transformOrigin},methods:k.a.methods,data:function(){return y()({visibleArrow:!0},k.a.data)},beforeDestroy:k.a.beforeDestroy},N={date:"yyyy-MM-dd",month:"yyyy-MM",months:"yyyy-MM",datetime:"yyyy-MM-dd HH:mm:ss",time:"HH:mm:ss",week:"yyyywWW",timerange:"HH:mm:ss",daterange:"yyyy-MM-dd",monthrange:"yyyy-MM",datetimerange:"yyyy-MM-dd HH:mm:ss",year:"yyyy",years:"yyyy"},P=["date","datetime","time","time-select","week","month","year","daterange","monthrange","timerange","datetimerange","dates","months","years"],E=function(r,d){return d==="timestamp"?r.getTime():Object(C.formatDate)(r,d)},p=function(r,d){return d==="timestamp"?new Date(Number(r)):Object(C.parseDate)(r,d)},b=function(r,d){if(Array.isArray(r)&&r.length===2){var m=r[0],$=r[1];if(m&&$)return[E(m,d),E($,d)]}return""},w=function(r,d,m){if(Array.isArray(r)||(r=r.split(m)),r.length===2){var $=r[0],I=r[1];return[p($,d),p(I,d)]}return[]},L={default:{formatter:function(r){return r?""+r:""},parser:function(r){return r===void 0||r===""?null:r}},week:{formatter:function(r,d){var m=Object(C.getWeekNumber)(r),$=r.getMonth(),I=new Date(r);m===1&&$===11&&(I.setHours(0,0,0,0),I.setDate(I.getDate()+3-(I.getDay()+6)%7));var M=Object(C.formatDate)(I,d);return M=/WW/.test(M)?M.replace(/WW/,m<10?"0"+m:m):M.replace(/W/,m),M},parser:function(r,d){return L.date.parser(r,d)}},date:{formatter:E,parser:p},datetime:{formatter:E,parser:p},daterange:{formatter:b,parser:w},monthrange:{formatter:b,parser:w},datetimerange:{formatter:b,parser:w},timerange:{formatter:b,parser:w},time:{formatter:E,parser:p},month:{formatter:E,parser:p},year:{formatter:E,parser:p},number:{formatter:function(r){return r?""+r:""},parser:function(r){var d=Number(r);return isNaN(r)?null:d}},dates:{formatter:function(r,d){return r.map(function(m){return E(m,d)})},parser:function(r,d){return(typeof r=="string"?r.split(", "):r).map(function(m){return m instanceof Date?m:p(m,d)})}},months:{formatter:function(r,d){return r.map(function(m){return E(m,d)})},parser:function(r,d){return(typeof r=="string"?r.split(", "):r).map(function(m){return m instanceof Date?m:p(m,d)})}},years:{formatter:function(r,d){return r.map(function(m){return E(m,d)})},parser:function(r,d){return(typeof r=="string"?r.split(", "):r).map(function(m){return m instanceof Date?m:p(m,d)})}}},U={left:"bottom-start",center:"bottom",right:"bottom-end"},V=function(r,d,m){var $=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"-";if(!r)return null;var I=(L[m]||L.default).parser,M=d||N[m];return I(r,M,$)},B=function(r,d,m){if(!r)return null;var $=(L[m]||L.default).formatter,I=d||N[m];return $(r,I)},J=function(r,d){var m=function(H,q){var z=H instanceof Date,le=q instanceof Date;return z&&le?H.getTime()===q.getTime():!z&&!le?H===q:!1},$=r instanceof Array,I=d instanceof Array;return $&&I?r.length!==d.length?!1:r.every(function(M,H){return m(M,d[H])}):!$&&!I?m(r,d):!1},ne=function(r){return typeof r=="string"||r instanceof String},re=function(r){return r==null||ne(r)||Array.isArray(r)&&r.length===2&&r.every(ne)},Ce={mixins:[o.a,D],inject:{elForm:{default:""},elFormItem:{default:""}},props:{size:String,format:String,valueFormat:String,readonly:Boolean,placeholder:String,startPlaceholder:String,endPlaceholder:String,prefixIcon:String,clearIcon:{type:String,default:"el-icon-circle-close"},name:{default:"",validator:re},disabled:Boolean,clearable:{type:Boolean,default:!0},id:{default:"",validator:re},popperClass:String,editable:{type:Boolean,default:!0},align:{type:String,default:"left"},value:{},defaultValue:{},defaultTime:{},rangeSeparator:{default:"-"},pickerOptions:{},unlinkPanels:Boolean,validateEvent:{type:Boolean,default:!0}},components:{ElInput:h.a},directives:{Clickoutside:_.a},data:function(){return{pickerVisible:!1,showClose:!1,userInput:null,valueOnOpen:null,unwatchPickerOptions:null}},watch:{pickerVisible:function(r){this.readonly||this.pickerDisabled||(r?(this.showPicker(),this.valueOnOpen=Array.isArray(this.value)?[].concat(this.value):this.value):(this.hidePicker(),this.emitChange(this.value),this.userInput=null,this.validateEvent&&this.dispatch("ElFormItem","el.form.blur"),this.$emit("blur",this),this.blur()))},parsedValue:{immediate:!0,handler:function(r){this.picker&&(this.picker.value=r)}},defaultValue:function(r){this.picker&&(this.picker.defaultValue=r)},value:function(r,d){!J(r,d)&&!this.pickerVisible&&this.validateEvent&&this.dispatch("ElFormItem","el.form.change",r)}},computed:{ranged:function(){return this.type.indexOf("range")>-1},reference:function(){var r=this.$refs.reference;return r.$el||r},refInput:function(){return this.reference?[].slice.call(this.reference.querySelectorAll("input")):[]},valueIsEmpty:function(){var r=this.value;if(Array.isArray(r)){for(var d=0,m=r.length;d<m;d++)if(r[d])return!1}else if(r)return!1;return!0},triggerClass:function(){return this.prefixIcon||(this.type.indexOf("time")!==-1?"el-icon-time":"el-icon-date")},selectionMode:function(){return this.type==="week"?"week":this.type==="month"?"month":this.type==="year"?"year":this.type==="dates"?"dates":this.type==="months"?"months":this.type==="years"?"years":"day"},haveTrigger:function(){return typeof this.showTrigger<"u"?this.showTrigger:P.indexOf(this.type)!==-1},displayValue:function(){var r=B(this.parsedValue,this.format,this.type,this.rangeSeparator);return Array.isArray(this.userInput)?[this.userInput[0]||r&&r[0]||"",this.userInput[1]||r&&r[1]||""]:this.userInput!==null?this.userInput:r?this.type==="dates"||this.type==="years"||this.type==="months"?r.join(", "):r:""},parsedValue:function(){if(!this.value)return this.value;if(this.type==="time-select")return this.value;var r=Object(C.isDateObject)(this.value)||Array.isArray(this.value)&&this.value.every(C.isDateObject);return r?this.value:this.valueFormat?V(this.value,this.valueFormat,this.type,this.rangeSeparator)||this.value:Array.isArray(this.value)?this.value.map(function(d){return new Date(d)}):new Date(this.value)},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},pickerSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},pickerDisabled:function(){return this.disabled||(this.elForm||{}).disabled},firstInputId:function(){var r={},d=void 0;return this.ranged?d=this.id&&this.id[0]:d=this.id,d&&(r.id=d),r},secondInputId:function(){var r={},d=void 0;return this.ranged&&(d=this.id&&this.id[1]),d&&(r.id=d),r}},created:function(){this.popperOptions={boundariesPadding:0,gpuAcceleration:!1},this.placement=U[this.align]||U.left,this.$on("fieldReset",this.handleFieldReset)},methods:{focus:function(){this.ranged?this.handleFocus():this.$refs.reference.focus()},blur:function(){this.refInput.forEach(function(r){return r.blur()})},parseValue:function(r){var d=Object(C.isDateObject)(r)||Array.isArray(r)&&r.every(C.isDateObject);return this.valueFormat&&!d&&V(r,this.valueFormat,this.type,this.rangeSeparator)||r},formatToValue:function(r){var d=Object(C.isDateObject)(r)||Array.isArray(r)&&r.every(C.isDateObject);return this.valueFormat&&d?B(r,this.valueFormat,this.type,this.rangeSeparator):r},parseString:function(r){var d=Array.isArray(r)?this.type:this.type.replace("range","");return V(r,this.format,d)},formatToString:function(r){var d=Array.isArray(r)?this.type:this.type.replace("range","");return B(r,this.format,d)},handleMouseEnter:function(){this.readonly||this.pickerDisabled||!this.valueIsEmpty&&this.clearable&&(this.showClose=!0)},handleChange:function(){if(this.userInput){var r=this.parseString(this.displayValue);r&&(this.picker.value=r,this.isValidValue(r)&&(this.emitInput(r),this.userInput=null))}this.userInput===""&&(this.emitInput(null),this.emitChange(null),this.userInput=null)},handleStartInput:function(r){this.userInput?this.userInput=[r.target.value,this.userInput[1]]:this.userInput=[r.target.value,null]},handleEndInput:function(r){this.userInput?this.userInput=[this.userInput[0],r.target.value]:this.userInput=[null,r.target.value]},handleStartChange:function(r){var d=this.parseString(this.userInput&&this.userInput[0]);if(d){this.userInput=[this.formatToString(d),this.displayValue[1]];var m=[d,this.picker.value&&this.picker.value[1]];this.picker.value=m,this.isValidValue(m)&&(this.emitInput(m),this.userInput=null)}},handleEndChange:function(r){var d=this.parseString(this.userInput&&this.userInput[1]);if(d){this.userInput=[this.displayValue[0],this.formatToString(d)];var m=[this.picker.value&&this.picker.value[0],d];this.picker.value=m,this.isValidValue(m)&&(this.emitInput(m),this.userInput=null)}},handleClickIcon:function(r){this.readonly||this.pickerDisabled||(this.showClose?(this.valueOnOpen=this.value,r.stopPropagation(),this.emitInput(null),this.emitChange(null),this.showClose=!1,this.picker&&typeof this.picker.handleClear=="function"&&this.picker.handleClear()):this.pickerVisible=!this.pickerVisible)},handleClose:function(){if(this.pickerVisible&&(this.pickerVisible=!1,this.type==="dates"||this.type==="years"||this.type==="months")){var r=V(this.valueOnOpen,this.valueFormat,this.type,this.rangeSeparator)||this.valueOnOpen;this.emitInput(r)}},handleFieldReset:function(r){this.userInput=r===""?null:r},handleFocus:function(){var r=this.type;P.indexOf(r)!==-1&&!this.pickerVisible&&(this.pickerVisible=!0),this.$emit("focus",this)},handleKeydown:function(r){var d=this,m=r.keyCode;if(m===27){this.pickerVisible=!1,r.stopPropagation();return}if(m===9){this.ranged?setTimeout(function(){d.refInput.indexOf(document.activeElement)===-1&&(d.pickerVisible=!1,d.blur(),r.stopPropagation())},0):(this.handleChange(),this.pickerVisible=this.picker.visible=!1,this.blur(),r.stopPropagation());return}if(m===13){(this.userInput===""||this.isValidValue(this.parseString(this.displayValue)))&&(this.handleChange(),this.pickerVisible=this.picker.visible=!1,this.blur()),r.stopPropagation();return}if(this.userInput){r.stopPropagation();return}this.picker&&this.picker.handleKeydown&&this.picker.handleKeydown(r)},handleRangeClick:function(){var r=this.type;P.indexOf(r)!==-1&&!this.pickerVisible&&(this.pickerVisible=!0),this.$emit("focus",this)},hidePicker:function(){this.picker&&(this.picker.resetView&&this.picker.resetView(),this.pickerVisible=this.picker.visible=!1,this.destroyPopper())},showPicker:function(){var r=this;this.$isServer||(this.picker||this.mountPicker(),this.pickerVisible=this.picker.visible=!0,this.updatePopper(),this.picker.value=this.parsedValue,this.picker.resetView&&this.picker.resetView(),this.$nextTick(function(){r.picker.adjustSpinners&&r.picker.adjustSpinners()}))},mountPicker:function(){var r=this;this.picker=new v.a(this.panel).$mount(),this.picker.defaultValue=this.defaultValue,this.picker.defaultTime=this.defaultTime,this.picker.popperClass=this.popperClass,this.popperElm=this.picker.$el,this.picker.width=this.reference.getBoundingClientRect().width,this.picker.showTime=this.type==="datetime"||this.type==="datetimerange",this.picker.selectionMode=this.selectionMode,this.picker.unlinkPanels=this.unlinkPanels,this.picker.arrowControl=this.arrowControl||this.timeArrowControl||!1,this.$watch("format",function(m){r.picker.format=m});var d=function(){var $=r.pickerOptions;if($&&$.selectableRange){var I=$.selectableRange,M=L.datetimerange.parser,H=N.timerange;I=Array.isArray(I)?I:[I],r.picker.selectableRange=I.map(function(z){return M(z,H,r.rangeSeparator)})}for(var q in $)$.hasOwnProperty(q)&&q!=="selectableRange"&&(r.picker[q]=$[q]);r.format&&(r.picker.format=r.format)};d(),this.unwatchPickerOptions=this.$watch("pickerOptions",function(){return d()},{deep:!0}),this.$el.appendChild(this.picker.$el),this.picker.resetView&&this.picker.resetView(),this.picker.$on("dodestroy",this.doDestroy),this.picker.$on("pick",function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r.userInput=null,r.pickerVisible=r.picker.visible=$,r.emitInput(m),r.picker.resetView&&r.picker.resetView()}),this.picker.$on("select-range",function(m,$,I){r.refInput.length!==0&&(!I||I==="min"?(r.refInput[0].setSelectionRange(m,$),r.refInput[0].focus()):I==="max"&&(r.refInput[1].setSelectionRange(m,$),r.refInput[1].focus()))})},unmountPicker:function(){this.picker&&(this.picker.$destroy(),this.picker.$off(),typeof this.unwatchPickerOptions=="function"&&this.unwatchPickerOptions(),this.picker.$el.parentNode.removeChild(this.picker.$el))},emitChange:function(r){J(r,this.valueOnOpen)||(this.$emit("change",r),this.valueOnOpen=r,this.validateEvent&&this.dispatch("ElFormItem","el.form.change",r))},emitInput:function(r){var d=this.formatToValue(r);J(this.value,d)||this.$emit("input",d)},isValidValue:function(r){return this.picker||this.mountPicker(),this.picker.isValidValue?r&&this.picker.isValidValue(r):!0}}},Se=Ce,ke=s(0),ae=Object(ke.a)(Se,n,a,!1,null,null,null);ae.options.__file="packages/date-picker/src/picker.vue",i.a=ae.exports},34:function(e,i,s){var n=function(){var o=this,u=o.$createElement,h=o._self._c||u;return h("div",{staticClass:"el-time-spinner",class:{"has-seconds":o.showSeconds}},[o.arrowControl?o._e():[h("el-scrollbar",{ref:"hours",staticClass:"el-time-spinner__wrapper",attrs:{"wrap-style":"max-height: inherit;","view-class":"el-time-spinner__list",noresize:"",tag:"ul"},nativeOn:{mouseenter:function(f){o.emitSelectRange("hours")},mousemove:function(f){o.adjustCurrentSpinner("hours")}}},o._l(o.hoursList,function(f,y){return h("li",{key:y,staticClass:"el-time-spinner__item",class:{active:y===o.hours,disabled:f},on:{click:function(D){o.handleClick("hours",{value:y,disabled:f})}}},[o._v(o._s(("0"+(o.amPmMode?y%12||12:y)).slice(-2))+o._s(o.amPm(y)))])}),0),h("el-scrollbar",{ref:"minutes",staticClass:"el-time-spinner__wrapper",attrs:{"wrap-style":"max-height: inherit;","view-class":"el-time-spinner__list",noresize:"",tag:"ul"},nativeOn:{mouseenter:function(f){o.emitSelectRange("minutes")},mousemove:function(f){o.adjustCurrentSpinner("minutes")}}},o._l(o.minutesList,function(f,y){return h("li",{key:y,staticClass:"el-time-spinner__item",class:{active:y===o.minutes,disabled:!f},on:{click:function(D){o.handleClick("minutes",{value:y,disabled:!1})}}},[o._v(o._s(("0"+y).slice(-2)))])}),0),h("el-scrollbar",{directives:[{name:"show",rawName:"v-show",value:o.showSeconds,expression:"showSeconds"}],ref:"seconds",staticClass:"el-time-spinner__wrapper",attrs:{"wrap-style":"max-height: inherit;","view-class":"el-time-spinner__list",noresize:"",tag:"ul"},nativeOn:{mouseenter:function(f){o.emitSelectRange("seconds")},mousemove:function(f){o.adjustCurrentSpinner("seconds")}}},o._l(60,function(f,y){return h("li",{key:y,staticClass:"el-time-spinner__item",class:{active:y===o.seconds},on:{click:function(D){o.handleClick("seconds",{value:y,disabled:!1})}}},[o._v(o._s(("0"+y).slice(-2)))])}),0)],o.arrowControl?[h("div",{staticClass:"el-time-spinner__wrapper is-arrow",on:{mouseenter:function(f){o.emitSelectRange("hours")}}},[h("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:o.decrease,expression:"decrease"}],staticClass:"el-time-spinner__arrow el-icon-arrow-up"}),h("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:o.increase,expression:"increase"}],staticClass:"el-time-spinner__arrow el-icon-arrow-down"}),h("ul",{ref:"hours",staticClass:"el-time-spinner__list"},o._l(o.arrowHourList,function(f,y){return h("li",{key:y,staticClass:"el-time-spinner__item",class:{active:f===o.hours,disabled:o.hoursList[f]}},[o._v(o._s(f===void 0?"":("0"+(o.amPmMode?f%12||12:f)).slice(-2)+o.amPm(f)))])}),0)]),h("div",{staticClass:"el-time-spinner__wrapper is-arrow",on:{mouseenter:function(f){o.emitSelectRange("minutes")}}},[h("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:o.decrease,expression:"decrease"}],staticClass:"el-time-spinner__arrow el-icon-arrow-up"}),h("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:o.increase,expression:"increase"}],staticClass:"el-time-spinner__arrow el-icon-arrow-down"}),h("ul",{ref:"minutes",staticClass:"el-time-spinner__list"},o._l(o.arrowMinuteList,function(f,y){return h("li",{key:y,staticClass:"el-time-spinner__item",class:{active:f===o.minutes}},[o._v(`
          `+o._s(f===void 0?"":("0"+f).slice(-2))+`
        `)])}),0)]),o.showSeconds?h("div",{staticClass:"el-time-spinner__wrapper is-arrow",on:{mouseenter:function(f){o.emitSelectRange("seconds")}}},[h("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:o.decrease,expression:"decrease"}],staticClass:"el-time-spinner__arrow el-icon-arrow-up"}),h("i",{directives:[{name:"repeat-click",rawName:"v-repeat-click",value:o.increase,expression:"increase"}],staticClass:"el-time-spinner__arrow el-icon-arrow-down"}),h("ul",{ref:"seconds",staticClass:"el-time-spinner__list"},o._l(o.arrowSecondList,function(f,y){return h("li",{key:y,staticClass:"el-time-spinner__item",class:{active:f===o.seconds}},[o._v(`
          `+o._s(f===void 0?"":("0"+f).slice(-2))+`
        `)])}),0)]):o._e()]:o._e()],2)},a=[];n._withStripped=!0;var c=s(1),v=s(15),g=s.n(v),_=s(30),C={components:{ElScrollbar:g.a},directives:{repeatClick:_.a},props:{date:{},defaultValue:{},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:String,default:""}},computed:{hours:function(){return this.date.getHours()},minutes:function(){return this.date.getMinutes()},seconds:function(){return this.date.getSeconds()},hoursList:function(){return Object(c.getRangeHours)(this.selectableRange)},minutesList:function(){return Object(c.getRangeMinutes)(this.selectableRange,this.hours)},arrowHourList:function(){var u=this.hours;return[u>0?u-1:void 0,u,u<23?u+1:void 0]},arrowMinuteList:function(){var u=this.minutes;return[u>0?u-1:void 0,u,u<59?u+1:void 0]},arrowSecondList:function(){var u=this.seconds;return[u>0?u-1:void 0,u,u<59?u+1:void 0]}},data:function(){return{selectableRange:[],currentScrollbar:null}},mounted:function(){var u=this;this.$nextTick(function(){!u.arrowControl&&u.bindScrollEvent()})},methods:{increase:function(){this.scrollDown(1)},decrease:function(){this.scrollDown(-1)},modifyDateField:function(u,h){switch(u){case"hours":this.$emit("change",Object(c.modifyTime)(this.date,h,this.minutes,this.seconds));break;case"minutes":this.$emit("change",Object(c.modifyTime)(this.date,this.hours,h,this.seconds));break;case"seconds":this.$emit("change",Object(c.modifyTime)(this.date,this.hours,this.minutes,h));break}},handleClick:function(u,h){var f=h.value,y=h.disabled;y||(this.modifyDateField(u,f),this.emitSelectRange(u),this.adjustSpinner(u,f))},emitSelectRange:function(u){u==="hours"?this.$emit("select-range",0,2):u==="minutes"?this.$emit("select-range",3,5):u==="seconds"&&this.$emit("select-range",6,8),this.currentScrollbar=u},bindScrollEvent:function(){var u=this,h=function(y){u.$refs[y].wrap.onscroll=function(D){u.handleScroll(y,D)}};h("hours"),h("minutes"),h("seconds")},handleScroll:function(u){var h=Math.min(Math.round((this.$refs[u].wrap.scrollTop-(this.scrollBarHeight(u)*.5-10)/this.typeItemHeight(u)+3)/this.typeItemHeight(u)),u==="hours"?23:59);this.modifyDateField(u,h)},adjustSpinners:function(){this.adjustSpinner("hours",this.hours),this.adjustSpinner("minutes",this.minutes),this.adjustSpinner("seconds",this.seconds)},adjustCurrentSpinner:function(u){this.adjustSpinner(u,this[u])},adjustSpinner:function(u,h){if(!this.arrowControl){var f=this.$refs[u].wrap;f&&(f.scrollTop=Math.max(0,h*this.typeItemHeight(u)))}},scrollDown:function(u){var h=this;this.currentScrollbar||this.emitSelectRange("hours");var f=this.currentScrollbar,y=this.hoursList,D=this[f];if(this.currentScrollbar==="hours"){var N=Math.abs(u);u=u>0?1:-1;for(var P=y.length;P--&&N;)D=(D+u+y.length)%y.length,!y[D]&&N--;if(y[D])return}else D=(D+u+60)%60;this.modifyDateField(f,D),this.adjustSpinner(f,D),this.$nextTick(function(){return h.emitSelectRange(h.currentScrollbar)})},amPm:function(u){var h=this.amPmMode.toLowerCase()==="a";if(!h)return"";var f=this.amPmMode==="A",y=u<12?" am":" pm";return f&&(y=y.toUpperCase()),y},typeItemHeight:function(u){return this.$refs[u].$el.querySelector("li").offsetHeight},scrollBarHeight:function(u){return this.$refs[u].$el.offsetHeight}}},x=C,k=s(0),S=Object(k.a)(x,n,a,!1,null,null,null);S.options.__file="packages/date-picker/src/basic/time-spinner.vue",i.a=S.exports},4:function(e,i){e.exports=Ie()},5:function(e,i){e.exports=Oe()},6:function(e,i){e.exports=Le()},7:function(e,i){e.exports=Ee},77:function(e,i,s){s.r(i);var n=s(32),a=s(27),c=function(){var p=this,b=p.$createElement,w=p._self._c||b;return w("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":function(L){p.$emit("dodestroy")}}},[w("div",{directives:[{name:"show",rawName:"v-show",value:p.visible,expression:"visible"}],staticClass:"el-time-range-picker el-picker-panel el-popper",class:p.popperClass},[w("div",{staticClass:"el-time-range-picker__content"},[w("div",{staticClass:"el-time-range-picker__cell"},[w("div",{staticClass:"el-time-range-picker__header"},[p._v(p._s(p.t("el.datepicker.startTime")))]),w("div",{staticClass:"el-time-range-picker__body el-time-panel__content",class:{"has-seconds":p.showSeconds,"is-arrow":p.arrowControl}},[w("time-spinner",{ref:"minSpinner",attrs:{"show-seconds":p.showSeconds,"am-pm-mode":p.amPmMode,"arrow-control":p.arrowControl,date:p.minDate},on:{change:p.handleMinChange,"select-range":p.setMinSelectionRange}})],1)]),w("div",{staticClass:"el-time-range-picker__cell"},[w("div",{staticClass:"el-time-range-picker__header"},[p._v(p._s(p.t("el.datepicker.endTime")))]),w("div",{staticClass:"el-time-range-picker__body el-time-panel__content",class:{"has-seconds":p.showSeconds,"is-arrow":p.arrowControl}},[w("time-spinner",{ref:"maxSpinner",attrs:{"show-seconds":p.showSeconds,"am-pm-mode":p.amPmMode,"arrow-control":p.arrowControl,date:p.maxDate},on:{change:p.handleMaxChange,"select-range":p.setMaxSelectionRange}})],1)])]),w("div",{staticClass:"el-time-panel__footer"},[w("button",{staticClass:"el-time-panel__btn cancel",attrs:{type:"button"},on:{click:function(L){p.handleCancel()}}},[p._v(p._s(p.t("el.datepicker.cancel")))]),w("button",{staticClass:"el-time-panel__btn confirm",attrs:{type:"button",disabled:p.btnDisabled},on:{click:function(L){p.handleConfirm()}}},[p._v(p._s(p.t("el.datepicker.confirm")))])])])])},v=[];c._withStripped=!0;var g=s(1),_=s(6),C=s.n(_),x=s(34),k=Object(g.parseDate)("00:00:00","HH:mm:ss"),S=Object(g.parseDate)("23:59:59","HH:mm:ss"),o=function(b){return Object(g.modifyDate)(k,b.getFullYear(),b.getMonth(),b.getDate())},u=function(b){return Object(g.modifyDate)(S,b.getFullYear(),b.getMonth(),b.getDate())},h=function(b,w){return new Date(Math.min(b.getTime()+w,u(b).getTime()))},f={mixins:[C.a],components:{TimeSpinner:x.a},computed:{showSeconds:function(){return(this.format||"").indexOf("ss")!==-1},offset:function(){return this.showSeconds?11:8},spinner:function(){return this.selectionRange[0]<this.offset?this.$refs.minSpinner:this.$refs.maxSpinner},btnDisabled:function(){return this.minDate.getTime()>this.maxDate.getTime()},amPmMode:function(){return(this.format||"").indexOf("A")!==-1?"A":(this.format||"").indexOf("a")!==-1?"a":""}},data:function(){return{popperClass:"",minDate:new Date,maxDate:new Date,value:[],oldValue:[new Date,new Date],defaultValue:null,format:"HH:mm:ss",visible:!1,selectionRange:[0,2],arrowControl:!1}},watch:{value:function(b){Array.isArray(b)?(this.minDate=new Date(b[0]),this.maxDate=new Date(b[1])):Array.isArray(this.defaultValue)?(this.minDate=new Date(this.defaultValue[0]),this.maxDate=new Date(this.defaultValue[1])):this.defaultValue?(this.minDate=new Date(this.defaultValue),this.maxDate=h(new Date(this.defaultValue),60*60*1e3)):(this.minDate=new Date,this.maxDate=h(new Date,60*60*1e3))},visible:function(b){var w=this;b&&(this.oldValue=this.value,this.$nextTick(function(){return w.$refs.minSpinner.emitSelectRange("hours")}))}},methods:{handleClear:function(){this.$emit("pick",null)},handleCancel:function(){this.$emit("pick",this.oldValue)},handleMinChange:function(b){this.minDate=Object(g.clearMilliseconds)(b),this.handleChange()},handleMaxChange:function(b){this.maxDate=Object(g.clearMilliseconds)(b),this.handleChange()},handleChange:function(){this.isValidValue([this.minDate,this.maxDate])&&(this.$refs.minSpinner.selectableRange=[[o(this.minDate),this.maxDate]],this.$refs.maxSpinner.selectableRange=[[this.minDate,u(this.maxDate)]],this.$emit("pick",[this.minDate,this.maxDate],!0))},setMinSelectionRange:function(b,w){this.$emit("select-range",b,w,"min"),this.selectionRange=[b,w]},setMaxSelectionRange:function(b,w){this.$emit("select-range",b,w,"max"),this.selectionRange=[b+this.offset,w+this.offset]},handleConfirm:function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=this.$refs.minSpinner.selectableRange,L=this.$refs.maxSpinner.selectableRange;this.minDate=Object(g.limitTimeRange)(this.minDate,w,this.format),this.maxDate=Object(g.limitTimeRange)(this.maxDate,L,this.format),this.$emit("pick",[this.minDate,this.maxDate],b)},adjustSpinners:function(){this.$refs.minSpinner.adjustSpinners(),this.$refs.maxSpinner.adjustSpinners()},changeSelectionRange:function(b){var w=this.showSeconds?[0,3,6,11,14,17]:[0,3,8,11],L=["hours","minutes"].concat(this.showSeconds?["seconds"]:[]),U=w.indexOf(this.selectionRange[0]),V=(U+b+w.length)%w.length,B=w.length/2;V<B?this.$refs.minSpinner.emitSelectRange(L[V]):this.$refs.maxSpinner.emitSelectRange(L[V-B])},isValidValue:function(b){return Array.isArray(b)&&Object(g.timeWithinRange)(this.minDate,this.$refs.minSpinner.selectableRange)&&Object(g.timeWithinRange)(this.maxDate,this.$refs.maxSpinner.selectableRange)},handleKeydown:function(b){var w=b.keyCode,L={38:-1,40:1,37:-1,39:1};if(w===37||w===39){var U=L[w];this.changeSelectionRange(U),b.preventDefault();return}if(w===38||w===40){var V=L[w];this.spinner.scrollDown(V),b.preventDefault();return}}}},y=f,D=s(0),N=Object(D.a)(y,c,v,!1,null,null,null);N.options.__file="packages/date-picker/src/panel/time-range.vue";var P=N.exports,E={mixins:[n.a],name:"ElTimePicker",props:{isRange:Boolean,arrowControl:Boolean},data:function(){return{type:""}},watch:{isRange:function(b){this.picker?(this.unmountPicker(),this.type=b?"timerange":"time",this.panel=b?P:a.a,this.mountPicker()):(this.type=b?"timerange":"time",this.panel=b?P:a.a)}},created:function(){this.type=this.isRange?"timerange":"time",this.panel=this.isRange?P:a.a}};E.install=function(p){p.component(E.name,E)},i.default=E},9:function(e,i){e.exports=Re()}})})(we);var Rt=we.exports;const Mt=Me(Rt),At=(t,e)=>{e!=null&&e.options&&(de.props.globalOptions.default=()=>e.options),t.component("codemirror",de)},Ft={install:At};const Vt=["object","nested","join","flattened","integer_range","date_range","rank_features","dense_vector","geo_point","point","shape"],Nt=["json","jsonb",...Vt],Pt={components:{DetailDialog:be},props:["type","value","placeholder","column","dbType"],data(){return{dialogVisible:!1}},computed:{isRequired(){const t=this.column;return t?t.isNotNull||t.isPrimary:!1},maxlength(){var t,e;return(t=this.column)!=null&&t.maxLength?parseInt((e=this.column)==null?void 0:e.maxLength):void 0}},mounted(){},methods:{isDbNumber:Q,isMultiline(t){return typeof t!="string"?!1:(t=t.toLowerCase(),Nt.includes(t)||t.includes("text"))},isDateTime(t){if(typeof t!="string"||[te.MONGO_DB].includes(this.dbType))return!1;t=t.toUpperCase();const e=t.includes("DATE")||t=="TIMESTAMP"||t=="TIMESTAMP WITHOUT TIME ZONE"||t=="TIMESTAMP WITH TIME ZONE";return e&&typeof this.value=="string"&&this.$emit("input",this.value.replace("Â "," ")),e},sync(t){this.$emit("input",t)}}};var jt=function(){var e=this,i=e._self._c;return i("div",{staticClass:"relative"},[e.type=="date"?i(he,{attrs:{"value-format":"yyyy-MM-dd",value:e.value},on:{input:e.sync}}):typeof e.type=="string"&&e.type.match(/^\btime\b/i)?i(Mt,{attrs:{"value-format":"HH:mm:ss",value:e.value},on:{input:e.sync}}):e.isDateTime(e.type)?i(he,{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",value:e.value},on:{input:e.sync}}):[e.isMultiline(e.type)?i("vsc-input",{attrs:{required:e.isRequired,rows:2,type:"textarea",value:e.value,fixed:"",placeholder:e.placeholder},on:{input:e.sync}}):i("vsc-input",{attrs:{value:e.value,required:e.isRequired,placeholder:e.placeholder,maxlength:e.maxlength,fixed:""},on:{input:e.sync}}),e.isDbNumber(e.type)?e._e():i("div",{staticClass:"detail-btn",on:{click:function(s){e.dialogVisible=!0}}},[i("i",{staticClass:"codicon-zoom-in",attrs:{title:"View On Dialog"}})])],i("DetailDialog",{attrs:{visible:e.dialogVisible,editable:!1,data:e.value},on:{"update:visible":function(s){e.dialogVisible=s},input:e.sync}})],2)},qt=[],Ht=F(Pt,jt,qt,!1,null,"c390ef84",null,null);const Ut=Ht.exports;const Bt={components:{CellEditor:Ut},props:["fields"],computed:{...T(j,["dialog","editModel","originModel"]),...T(j,{visible:t=>t.dialog.visible,loading:t=>t.dialog.loading,model:t=>t.dialog.model}),...T(R,["dbType","database","table","primaryKey","primaryKeyList","columnList"]),...T(R,{result:t=>t}),needCenter(){return["ElasticSearch","MongoDB"].includes(this.dbType)},previewSQL(){return(this.model=="update"?this.buildUpdateSql(this.editModel,this.originModel):this.buildInsertSQL())??""},editorTilte(){return this.model=="insert"?`Insert To table: ${this.table}`:this.model=="update"?this.primaryKey?`Edit For ${this.table} : ${this.primaryKey}=${this.originModel[this.primaryKey]}`:`Edit For ${this.table}`:`Copy To ${this.table}`}},watch:{visible(t){if(t){const e=this.$refs.infoForm;e&&e.resetFields()}}},methods:{getWidth(t){if(!this.columnList)return"70px";const e=window.innerWidth<=820?1:2,i=this.columnList.filter((s,n)=>t%e==n%e).map(s=>`${s.name?s.name:""}`.length).max()*10;return`${Math.max(i+8,70)}px`},getLabel(t){return Q(t.type)?`${t.name}(${Ye(this.dbType)?"num":"int"})`:t.name},close(t=!1){this.dialog.loading=!1,this.dialog.visible=t&&this.visible},getTypeByColumn(t){return He(t,this.columnList)},isRequired(t){return t?t.isNotNull||t.isPrimary:!1},confirmInsert(){const t=this.buildInsertSQL();t?(this.dialog.loading=!0,this.$emit("execute",t)):O("Not any input, insert fail!")},buildInsertSQL(t){return t||(t=this.editModel),Ue({row:t,dbType:this.dbType,database:this.database,table:this.table,columnList:this.columnList})},buildUpdateSql(t,e,i=!0){try{return Be({currentNew:t,oldRow:e,database:this.database,dbType:this.dbType,table:this.table,primaryKeyList:this.primaryKeyList,primaryKey:this.primaryKey,columnList:this.columnList,fields:this.fields,compareMode:i})}catch(s){throw O(s.message),O}},confirmUpdate(t,e){if(this.result.readonly)return O(this.$t("common.readonly"));e||(e=this.originModel);const i=t||this.editModel,s=this.buildUpdateSql(i,e);s?(this.$emit("execute",s),this.dialog.loading=!0):O("No any change, update fail!")}}};var Qt=function(){var e=this,i=e._self._c;return i("div",{staticClass:"edit-container"},[i(ie,{ref:"editDialog",attrs:{title:e.editorTilte,visible:e.dialog.visible,width:"80%",top:"3vh",closeOnClickModal:!1,center:""},on:{"update:visible":function(s){return e.$set(e.dialog,"visible",s)}},scopedSlots:e._u([{key:"footer",fn:function(){return[i("vsc-button",{attrs:{type:"secondary"},on:{click:function(s){e.dialog.visible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),e.model=="insert"||e.model=="copy"?i("vsc-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.confirmInsert(e.editModel)}}},[e._v(" "+e._s(e.$t("result.insert")))]):e._e(),e.model=="update"?i("vsc-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.confirmUpdate(e.editModel)}}},[e._v(" "+e._s(e.$t("result.update")))]):e._e(),i("br"),e._v(" "),i("br"),i("div",{staticStyle:{"max-height":"300px",overflow:"scroll"},style:{"text-align":e.needCenter?"start":"inherit"}},[i("codemirror",{directives:[{name:"show",rawName:"v-show",value:e.previewSQL,expression:"previewSQL"}],attrs:{dbType:e.dbType,value:e.previewSQL}})],1)]},proxy:!0}])},[i("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 gap-y-5 gap-x-10"},e._l(e.columnList,function(s,n){return i("div",{key:s.name,staticClass:"flex basis-1/2"},[i("span",{style:{width:e.getWidth(n)}},[e.isRequired(s)?i("RedMark",{staticClass:"mr-0"}):e._e(),e._v(" "+e._s(e.getLabel(s))+" ")],1),e.editModel?i("CellEditor",{attrs:{column:s,type:s.type,dbType:e.dbType,placeholder:s.defaultValue},model:{value:e.editModel[s.name],callback:function(a){e.$set(e.editModel,s.name,a)},expression:"editModel[column.name]"}}):e._e()],1)}),0)])],1)},zt=[],Kt=F(Bt,Qt,zt,!1,null,null,null,null);const Wt=Kt.exports;class Xt{constructor(){this.commands=[],this.index=0}push(e){this.commands.push(e),this.index=this.commands.length-1}previous(){if(this.commands.length!=0){if(this.index--<0){this.index=0;return}return this.commands[this.index]}}next(){if(this.commands.length!=0){if(this.index++>=this.commands.length){this.index=this.commands.length-1;return}return this.commands[this.index]}}}const Gt={methods:{filter(t,e,i){var a;this.dontClear=!0;const s=this.getTypeByColumn(e);let n=((a=t==null?void 0:t.target)==null?void 0:a.value)??"";switch(this.result.dbType){case"ElasticSearch":this.sendToVscode("esFilter",{...ze(e,Ge(n),i)});break;case"MongoDB":const c=this.result.sql.replace(/find\(.+?\)/,`find({${e}:${Qe(n)}})`);this.execute(c);break;default:if(!i){const g=Q(s);i=g?"=":"like",n=!n||g?n:`'%${n}%'`}const v=ye(this.result.sql,e,s,i,n,this.result.dbType);this.execute(v)}},onHeaderContext(t,e){e.preventDefault(),oe({event:e,items:[{label:this.$t("result.copyColumns"),onClick:()=>{const i=this.filterData.filter(s=>!s.isFilter).map(s=>s[t.title]).join(`
`);this.sendToVscode("copy",i)},divided:!0}]})},onRowContext(t,e,i){var v;i.preventDefault();const s=e.title,n=t[s],a=Pe(this.getTypeByColumn(s),n,this.result.dbType);i.target.value=a;const c=(v=document.getSelection())==null?void 0:v.toString();oe({event:i,customClass:"class-a",zIndex:3,minWidth:230,items:[{label:this.$t("result.copy"),onClick:()=>{this.sendToVscode("copy",c||n)},divided:!0},{label:this.$t("result.editDialog"),onClick:()=>{this.openEditor(t,!1)}},{label:this.$t("result.copyDialog"),onClick:()=>{this.openEditor(t,!0)},divided:!0},{label:this.$t("result.setNull"),onClick:()=>{t[s]=null;const g=j(),_=se(),C=t._XID;let x=null;for(let k=0;k<_.filterData.length;k++)_.filterData[k]._XID==C&&(x=k);g.editCell(x,t,s,null)},divided:!0},{label:`Filter by ${s} = ${a}`,onClick:()=>{this.filter(i,s,"=")},hidden(){return n=="null"||n==null}},{label:`Filter by ${s} IS NULL`,onClick:()=>{i.target.value="NULL",this.filter(i,s,"IS")},hidden(){return n!="null"&&n!=null}},{label:"Filter by",divided:!0,children:[{label:`Filter by ${s} > ${a}`,onClick:()=>{this.filter(i,s,">")},hidden(){return n=="null"||n==null?!0:typeof n=="string"&&!(n!=null&&n.match(/^[\d.e]+$/))}},{label:`Filter by ${s} >= ${a}`,onClick:()=>{this.filter(i,s,">=")},hidden(){return n=="null"||n==null?!0:typeof n=="string"&&!(n!=null&&n.match(/^[\d.e]+$/))},divided:!0},{label:`Filter by ${s} < ${a}`,onClick:()=>{this.filter(i,s,"<")},hidden(){return n=="null"||n==null?!0:typeof n=="string"&&!(n!=null&&n.match(/^[\d.e]+$/))}},{label:`Filter by ${s} <= ${a}`,onClick:()=>{this.filter(i,s,"<=")},hidden(){return n=="null"||n==null?!0:typeof n=="string"&&!(n!=null&&n.match(/^[\d.e]+$/))},divided:!0},{label:`Filter by ${s} IS NULL`,onClick:()=>{i.target.value="NULL",this.filter(i,s,"IS")}},{label:`Filter by ${s} IS NOT NULL`,onClick:()=>{i.target.value="NULL",this.filter(i,s,"IS NOT")},divided:!0},{label:`Filter by ${s} LIKE '%${n}%'`,onClick:()=>{i.target.value=`'%${n}%'`,this.filter(i,s,"LIKE")},hidden:()=>n=="null"||n==null?!0:["ElasticSearch","MongoDB"].includes(this.result.dbType)},{label:`Filter by ${s} NOT LIKE '%${n}%'`,onClick:()=>{i.target.value=`'%${n}%'`,this.filter(i,s,"NOT LIKE")},hidden:()=>n=="null"||n==null?!0:["ElasticSearch","MongoDB"].includes(this.result.dbType)}]}]})}}};function W(t){if(t)for(let e=0;e<t;e++)document.getSelection().modify("move","right","character")}function Jt(t){let e=t.parentElement;for(;!(e instanceof HTMLTableCellElement);)e=e.parentElement;return{index:e.cellIndex+1,tr:e.parentElement}}const Yt={name:"Response",computed:{...T(A,["info"])}};var Zt=function(){var e=this,i=e._self._c;return e.info.message?i("div",[e.info.error?i("div",{staticClass:"info-panel",staticStyle:{color:"var(--vscode-terminal-ansiRed)"},domProps:{innerHTML:e._s(e.info.message)}}):e._e(),e.info.error?e._e():i("div",{staticClass:"info-panel",staticStyle:{color:"var(--vscode-terminal-ansiBrightGreen)"},domProps:{innerHTML:e._s(e.info.message)}})]):e._e()},ei=[],ti=F(Yt,Zt,ei,!1,null,"e6edf8b1",null,null);const ii=ti.exports,si={data(){return{columnSearcher:"",showColumnsAll:!0}},computed:{...T(A,["toolbar"]),...T(R,{result:t=>t}),showFields(){var t;return((t=this.result.fields)==null?void 0:t.filter(e=>!this.columnSearcher||e.name.includes(this.columnSearcher)))||[]}},watch:{"result.fields"(){this.columnSearcher="",this.showColumnsAll=!0}},methods:{changeCheck(){var a;const t="dbclientSelectALL",e=(a=this.result.fields)==null?void 0:a.length,i=this.toolbar.showColumns.length,s=this.toolbar.showColumns.includes(t);e==i+(s?1:0)?s||this.toolbar.showColumns.unshift(t):s&&this.toolbar.showColumns.shift()},changeAll(t){var e,i;this.toolbar.showColumns=t?["dbclientSelectALL",...(i=(e=this.result.fields)==null?void 0:e.map)==null?void 0:i.call(e,s=>s.name)]:[]}}};var ni=function(){var e=this,i=e._self._c;return i("div",[i(ve,{attrs:{placement:"bottom",trigger:"hover",type:"primary"},scopedSlots:e._u([{key:"reference",fn:function(){return[i("vsc-button",{attrs:{type:"icon",icon:"el-icon-search text-base",title:"Select columns to show."}})]},proxy:!0}])},[i("div",{staticClass:"mb-2"},[i("span",{staticClass:"mr-2"},[e._v("Columns: ")]),i(pe,{attrs:{label:"dbclientSelectALL"},on:{change:e.changeAll},model:{value:e.showColumnsAll,callback:function(s){e.showColumnsAll=s},expression:"showColumnsAll"}},[e._v("All")]),i("vsc-input",{staticClass:"ml-4",staticStyle:{width:"180px"},attrs:{clearable:!0,placeholder:"Enter column name"},model:{value:e.columnSearcher,callback:function(s){e.columnSearcher=s},expression:"columnSearcher"}})],1),i(rt,{model:{value:e.toolbar.showColumns,callback:function(s){e.$set(e.toolbar,"showColumns",s)},expression:"toolbar.showColumns"}},e._l(e.showFields,function(s,n){return i(pe,{key:n,attrs:{label:s.name},on:{change:e.changeCheck}},[e._v(" "+e._s(s.name)+" ")])}),1)],1)],1)},ri=[],ai=F(si,ni,ri,!1,null,null,null,null);const li=ai.exports,oi={components:{RowShowController:li},props:["fields","showFilter"],computed:{...T(A,{UI:t=>t}),isJSON(){return this.UI.viewType=="JSON"}},methods:{getRawJSON(t){return X({...t,_XID:void 0},null,2)}}};var ci=function(){var e=this,i=e._self._c;return i("ux-table-column",{attrs:{type:"expand",title:"Row",resizable:!0,width:e.isJSON?e.UI.rawColumnWidth:60},scopedSlots:e._u([{key:"header",fn:function(){return[e.isJSON?i("span",[e._v("Raw")]):i("RowShowController")]},proxy:!0},{key:"default",fn:function({row:s,rowIndex:n}){return[i("span",{staticClass:"relative left-2",class:{isFilter:s.isFilter}},[e.isJSON?i("span",[e._v(e._s(e.getRawJSON(s)))]):i("span",{staticClass:"opacity-60"},[e._v(e._s(e.showFilter?n:n+1))])])]}},{key:"content",fn:function({row:s}){return[i("ul",e._l(e.fields,function(n,a){return i("li",{key:a},[i("div",{staticClass:"flex"},[i("span",{staticClass:"mr-1 opacity-70"},[e._v(e._s(n.name)+":")]),i("span",{staticClass:"whitespace-nowrap"},[e._v(e._s(s[n.name]))])])])}),0)]}}])})},ui=[],di=F(oi,ci,ui,!1,null,null,null,null);const hi=di.exports;Ae.use(Ft);const pi={components:{Response:ii,DetailDialog:be,ExportDialog:Ct,ImportDialog:$t,EditDialog:Wt,Toolbar:Et,RowCell:ht,RowHeader:vt,ExpendRowCell:hi,UxGrid:ue.UxGrid,UxTableColumn:ue.UxTableColumn},mixins:[Gt,ee],data(){return{state:{showFilter:!1},detail:{visible:!1,scope:null},history:new Xt,completeItems:[],loadingTimeout:null,lock:!0,remainHeight:0,connection:{},transId:null,selection:[],dontClear:!1,lastEle:null,lastEleFocusOffset:null}},computed:{...Fe(se,["filterData"]),...me(j),...T(A,{UI:t=>t}),...T(A,["viewColumn","viewType","isSplitView","reverseData","showSQLPanel","info","table","config","toolbar","page"]),...T(R,{result:t=>t}),...T(j,["update","hasEdit"]),codemirror(){return this.$refs.cmEditor.codemirror},fields(){return(this.result.fields||[]).filter(t=>this.toolbar.showColumns.includes(t.name))},computeFields(){return this.reverseData?new Array(this.filterData.length+1).fill().map((t,e)=>({name:`col${e+1}`})):this.fields},filterOldData(){return this.update.oldData.filter(t=>!t.isFilter&&(!this.UI.table.search||JSON.stringify(t).toLowerCase().includes(this.UI.table.search.toLowerCase())))},editable(){return this.result.tableCount==1},columnCount(){return this.result.data==null||this.result.data[0]==null?0:Object.keys(this.result.data[0]).length}},watch:{"UI.table.search"(){this.reqFilterData()},reverseData(){this.reqFilterData()},"state.showFilter"(){this.reqFilterData()}},async mounted(){this.editStore.$subscribe((a,c)=>{!this.toolbar.showSaveBtn&&Object.keys(c.update.editList).length>0&&(this.emit("dataModify"),this.toolbar.showSaveBtn=!0)}),this.hackTitle(),this.loadConfig(),this.registerHint(),this.focusHolder();const t=this.$refs.hint,e=()=>{var c;const a=((c=document.getElementById("tableTab"))==null?void 0:c.clientHeight)||0;this.remainHeight=window.innerHeight-10-t.clientHeight-a,this.UI.rawColumnWidth=window.innerWidth-100,this==null||this.emit("viewColumn")};e(),new ResizeObserver(e).observe(t);const i=(a,c)=>{var v;this.result.columnTypeMap=null,at(this.result,a),this.UI.viewType=this.result.reverseData?"Reverse":this.UI.viewType,this.reqFilterData(),this.update.oldData=K.clone(this.result.data),((v=document.activeElement)==null?void 0:v.tagName)!="TEXTAREA"&&(this.toolbar.sql=a.sql),c?this.clear():this.reset(),this.page.total=this.result.data.length-1,(this.page.pageSize<=this.result.data.length||this.page.pageNum>1||this.result.hasTruncate)&&this.count(),this.update.editList={},this.update.hasEdit=!1,this.update.updateCounter=0,this.update.lock=!1},s=a=>{var c;this.dontClear?this.dontClear=!1:(this.result.fields=null,this.result.columnList=null,this.reset()),a.costTime&&(this.result.costTime=a.costTime),this.clearLoading(),this.update.lock=!1,this.detail.visible=!1,(c=this.$refs.editor)==null||c.close(!!this.info.error),this.info.message=a.message};this.on("table_info",()=>{setTimeout(()=>{e()},10)}).on("viewColumn",a=>{this.UI.viewColumn=a}).on("updateSuccess",a=>{var g;this.toolbar.saveLoading=!1;const c=Object.keys(this.update.editList).length;c>0&&c==this.update.updateCounter||setTimeout(()=>{this.result.data=[],this.reqFilterData(),this.update.oldData=[],this.refresh()},this.isEs()?1e3:0),this.detail.visible=!1,this.toolbar.showSaveBtn=!1,this.$refs.editor&&this.$refs.editor.close(),this.update.editList={},this.update.updateCounter=0,this.update.lock=!1,this.dontClear!=2?(this.info.error=!1,this.info.message=a):this.info.message=null,this.update.oldData=K.clone(this.result.data),ce({showClose:!0,duration:1e3,message:"Update Success",type:"success"}),(g=this.lastEle)==null||g.focus(),setTimeout(()=>W(this.lastEleFocusOffset),0)}).on("sort_result",({data:a,sql:c})=>{this.result.data=a,this.update.oldData=K.clone(a),this.result.sql=c,this.toolbar.sql=c,this.reqFilterData(),this.clearLoading()}).on("state",({lock:a,config:c,state:v})=>{a!=null&&(this.lock=a),c!=null&&(this.UI.config=c),v!=null&&(this.state=v)}).on("completion",a=>{this.completeItems=a,this.codemirror.showHint()}).on("copy_done",()=>{Ne(this.$t("notice.copySuccess"))}).on("import_done",()=>{this.UI.dialog.importVisible=!1,this.refresh()}).on("user",a=>{this.UI.user=a,this.UI.userInit=!0}),window.addEventListener("resize",e),window.addEventListener("keydown",a=>{var v,g,_;if(a.code=="F12")return this.emit("developerTool");const c=a.target.classList.contains("edit-column");if(a.code=="Enter"&&c||Y(a)&&a.code=="KeyS"?(this.lastEle=document.activeElement,this.lastEleFocusOffset=(v=window.getSelection())==null?void 0:v.focusOffset,a.stopPropagation(),a.preventDefault(),this.save()):Y(a)&&(a.altKey&&navigator.userAgent.includes("Mac OS")||a.code=="KeyV")&&a.preventDefault(),c&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","NumpadEnter"].includes(a.code)){const{index:C,tr:x}=Jt(a.target),k=(g=window.getSelection())==null?void 0:g.focusOffset;switch(a.code){case"ArrowLeft":if(k==0){const S=x.querySelector(`td:nth-child(${C-1}) .edit-column`);S&&(S.focus(),W(S.textContent.length),a.preventDefault())}break;case"ArrowRight":a.target.textContent.length==k&&((_=x.querySelector(`td:nth-child(${C+1}) .edit-column`))==null||_.focus(),a.preventDefault());break;case"ArrowUp":x.previousElementSibling&&x.previousElementSibling.querySelector(`td:nth-child(${C}) .edit-column`).focus(),W(k),a.preventDefault();break;case"ArrowDown":case"NumpadEnter":x.nextElementSibling&&x.nextElementSibling.querySelector(`td:nth-child(${C}) .edit-column`).focus(),W(k),a.preventDefault();break}}});const n=({data:a})=>{var g,_,C;if(!a)return;["state","user","language","completion","viewColumn"].includes(a==null?void 0:a.type)||console.log("message",a);const c=a.content;if(c!=null&&c.transId&&this.result.transId&&c.transId<this.result.transId)return;const v=this.result.transId==null||c&&c.transId>this.result.transId;switch(c&&(c.transId&&(this.result.transId=c.transId),c.language&&(this.$i18n.locale=c.language)),a.type){case"RUN":((g=document.activeElement)==null?void 0:g.tagName)!="TEXTAREA"&&(this.toolbar.sql=c.sql,this.result.dbType=c.dbType,this.codemirror.setValue(c.sql)),this.history.push(c.sql),this.table.start=c.executeTime,this.queueLoading(v);break;case"DATA":this.clearLoading(),i(c);break;case"NEXT_PAGE":this.clearLoading(),this.result.data=c.data,this.update.oldData=K.clone(c.data),this.result.costTime=c.costTime,this.result.sql=c.sql,this.toolbar.sql=c.sql,this.reqFilterData(),this.dontClear?this.dontClear=!1:this.info.message=null;break;case"COUNT":this.page.total=parseInt(c.data),this.$nextTick(()=>{this.page.pageNum=this.result.pageNum});break;case"DML":case"DDL":case"ERROR":case"MESSAGE_BLOCK":this.info.error=a.type=="ERROR",this.info.error&&((C=(_=a.content)==null?void 0:_.sql)!=null&&C.match(/^\s*select\b/i))&&(this.result.tableCount=0),s(c),(c.message.indexOf("AffectedRows")!=-1||c.isInsert)&&this.config.reloadAfterDML&&this.refresh();break;case"MESSAGE":this.clearLoading(),c.message&&ce({showClose:!0,duration:1e3,message:c.message,type:c.success?"success":"error"}),this.refresh();break}};window.addEventListener("message",n),this.emit("init",{width:window.innerWidth,height:window.innerHeight})},methods:{copySelection(){var e;if(((e=this.selection)==null?void 0:e.length)<=0)return;const t=this.selection.map(i=>Ke(i,"_isNewPush","_XID"));this.emit("copySelection",{fields:this.result.fields,selection:t})},hackTitle(){var e,i,s;(i=(e=this.$refs)==null?void 0:e.dataTable)!=null&&i.$el&&((s=this.$i18n.locale)!=null&&s.includes("zh")||new MutationObserver(n=>{var v;for(var a of n)for(var c of a.addedNodes){if(!c.querySelectorAll)continue;const g=(v=this.$i18n.locale)==null?void 0:v.includes("zh");for(const _ of c.querySelectorAll('i[title="éåºï¼æé«å°æä½"]'))_.setAttribute("title",g?"éåº":"Descending");for(const _ of c.querySelectorAll('i[title="ååºï¼æä½å°æé«"]'))_.setAttribute("title",g?"ååº":"Ascending");if(g)for(const _ of c.querySelectorAll('.elx-cell--checkbox[title="Select All"]'))_.setAttribute("title","å¨é/åæ¶");else for(const _ of c.querySelectorAll('.elx-cell--checkbox[title="å¨é/åæ¶"]'))_.setAttribute("title","Select All")}}).observe(document,{childList:!0,subtree:!0}))},doRunClick(){this.info.message=!1,this.$refs.dataTable.clearSort(),this.execute(this.toolbar.sql)},reqFilterData(){var t,e,i,s,n;if(Array.isArray(this.result.data)||(this.result.data=[]),!this.reverseData&&!((e=(t=this.result.data)==null?void 0:t[0])!=null&&e.isFilter)&&this.result.data.unshift({isFilter:!0,content:""}),this.filterData=this.result.data.filter(a=>(this.state.showFilter||!a.isFilter)&&(!this.UI.table.search||this.state.showFilter&&a.isFilter||JSON.stringify(a,(c,v)=>{if(c!="_XID")return v}).toLowerCase().includes(this.UI.table.search.toLowerCase()))),this.reverseData&&((i=this.fields)!=null&&i[0]))return(s=this.$refs.dataTable)==null?void 0:s.loadData(this.getReversedData());(n=this.$refs.dataTable)==null||n.loadData(this.filterData)},getReversedData(){const t=[];for(let e=0;e<this.fields.length;e++){const i=this.fields[e];t[e]={col1:i.name};for(let s=0;s<this.filterData.length;s++){const n=this.filterData[s];t[e][`col${s+2}`]=n[i.name]??n[e]}}return t},stopExecute(){this.table.loading=!1,clearInterval(this.table.loadingTimer),this.emit("stopExecute")},changeSelection(t,e){if(this.selection=t,this.toolbar.selectedRows=t.length>0,!e||t.length<2||!window.event.shiftKey)return;function i(v){var g;return parseInt((g=v._XID)==null?void 0:g.match(/row_(\d+)/)[1])}let s=i(e),n=s,a=s,c=!1;for(const v of t){const g=i(v);if(g<n&&(n=g),g==s)c=!0;else if(g>a&&(a=g,c))break}if(typeof n=="number"&&typeof a=="number"){const v=[];for(let _=n+1;_<a;_++)v.push(`row_${_}`);const g=this.filterData.filter(_=>v.includes(_._XID)).map(_=>({row:_,selected:c}));this.$refs.dataTable.toggleRowSelection(g)}},tableScroll(){const t=document.activeElement;t&&t.classList.contains("edit-column")&&t.blur()},clearLoading(){this.table.loading=!1,this.toolbar.saveLoading=!1,clearInterval(this.table.loadingTimer),this.loadingTimeout&&(clearTimeout(this.loadingTimeout),this.loadingTimeout=null)},queueLoading(t){t==null&&(t=!0),t&&!this.dontClear&&(this.info.message=null),this.loadingTimeout&&clearTimeout(this.loadingTimeout),this.loadingTimeout=setTimeout(()=>{this.table.loading=t,t&&(this.result.costTime=0,clearInterval(this.table.loadingTimer),this.table.loadingTimer=setInterval(()=>{this.result.costTime=new Date().getTime()-this.table.start},79))},100)},isEs(){return this.result.dbType=="ElasticSearch"},isMongo(){return this.result.dbType=="MongoDB"},openDetailDialog(t){this.detail.visible=!0,this.detail.scope=t},checkTableCount(){return this.result.tableCount==1?!1:(this.result.tableCount?O("The number of tables is greater than one!"):O("No table found!"),!0)},...ge(j,{reqOpenEditOrCopyDialog:"reqOpenEditOrCopyDialog"}),openEditor(t,e){this.checkTableCount()||this.reqOpenEditOrCopyDialog(t,e)},reqInsert(){if(this.result.readonly)return O("This connection is read-only!");this.reverseData||this.checkTableCount()||(this.result.columnList.length||(this.result.columnList=this.result.fields,this.result.columnList||O("Not columns found!")),this.result.data.push({_isNewPush:1}),this.reqFilterData(),setTimeout(()=>{const t=document.querySelector(".elx-table--body-wrapper");t.scrollTo({top:t.scrollHeight})},1),this.emit("telemetry","InsertRow"))},loadConfig(){try{const t=Ve();this.UI.config=t.config,this.state=t.state,this.lock=t.lock}catch{console.log("loadConfigFail")}},registerHint(){this.codemirror.on("keyup",(i,s)=>{if(s.key.length==1){const{ch:a,line:c}=i.getCursor();if(c==0&&a==0)return;this.emit("completion",{sql:this.toolbar.sql,line:c,ch:a})}});function e(i){return i.label.label||i.label}Je.registerHelper("hint","sql",(i,s)=>{const n=i.getCursor(),a=this.codemirror.getTokenAt(n).string.replace(/^\s+/,"").replace(/^[.,]/,"").toLowerCase();return{list:this.completeItems.filter(c=>!a||e(c).toLowerCase().startsWith(a)).sort((c,v)=>(c.sortText||e(c).charAt(0)).localeCompare(v.sortText||e(v).charAt(0))).map(c=>{var g;const v=(g=c.insertText)!=null&&g.value?c.insertText.value:c.insertText;return{displayText:e(c),text:v??e(c),kind:c.kind,hint(_,C,x){var S;const k=x.text.indexOf("$");if(_.replaceRange((S=x.text)==null?void 0:S.replace(/\$\d+/g,"  "),C.from,C.to),k!=-1){const o=x.text.length-k-1;setTimeout(()=>{const u=_.getCursor();_.setCursor({line:u.line,ch:u.ch-o})},1)}}}}),from:{line:n.line,ch:n.ch-a.length},to:n}})},focusHolder(){let t;window.onfocus=()=>{this.emit("state"),this.emit("getUser"),setTimeout(()=>{t&&t.focus()},10)},window.onblur=()=>{const e=document.activeElement;if(!e)return;const i=e.tagName.toLowerCase();(i=="input"||i=="textarea"||i=="div"&&e.contentEditable=="true")&&(t=e)}},panelInput(t){if(Y(t))switch(t.code){case"Enter":this.$refs.dataTable.clearSort(),this.codemirror.getSelection()?this.execute(this.codemirror.getSelection()):this.emit("executeByCursor",{sql:this.toolbar.sql,...this.codemirror.getCursor()}),t.stopPropagation();break;case"ArrowUp":const e=this.history.previous();e&&(this.toolbar.sql=e);break;case"ArrowDown":const i=this.history.next();i&&(this.toolbar.sql=i);break}},selectable({row:t}){return this.editable&&!t.isFilter},async save(){if(Object.keys(this.update.editList).length==0||this.update.lock)return;const t=this.result.primaryKey;if(!t||!this.fields.find(i=>i.name==t))try{await this.$confirm(this.$t("toolbar.noPkUpdateConfirm"),"Update Confirm",{confirmButtonText:this.$t("common.ok"),dangerouslyUseHTMLString:!0,cancelButtonText:this.$t("common.cancel"),type:"error"})}catch{return this.update.lock=!1}let e="";for(const i in this.update.editList){const s=this.update.editList[i];s&&(s._isNewPush?e+=this.$refs.editor.buildInsertSQL(s):(this.update.updateCounter++,e+=this.$refs.editor.buildUpdateSql(s,this.filterOldData[i-1],!1)))}this.dontClear=2,e?(this.update.lock=!0,this.toolbar.saveLoading=!0,this.emit("saveModify",e)):O("Generate SQL failed.")},sendToVscode(t,e){this.emit(t,e)},confirmImport(t){this.emit("import",{...t,table:this.result.table})},confirmExport(t){this.emit("export",{...t,...this.page,fields:this.reverseData?this.computeFields:null,rows:this.reverseData?this.getReversedData():null,sql:this.result.sql,table:this.result.table})},sort(t){t.order||(t.order="asc");const e=t.column.title;if(this.isEs()){this.emit("esSort",[{[e]:{order:t.order}}]);return}let i="";this.result.dbType=="MongoDB"?i=this.result.sql.replace(/.sort\(.+?\)/gi,"").replace(/(limit\(\d+\))/i,`sort({"${e}": ${t.order.toLowerCase()=="desc"?-1:1}}).$1`):(i=this.result.sql.replace(/(\bfrom\b.+?)\border\s+by\s+.+?((\s+(desc|asc)?)|$)/gi,"$1").replace(/\s*?(limit.+)?;?$/i,` ORDER BY ${je(e,this.result.dbType)} ${t.order} $1 `),this.dontClear=!0),this.emit("sort",i),this.table.start=new Date().getTime(),this.queueLoading()},getTypeByColumn(t){if(this.result.columnList){for(const e of this.result.columnList)if(e.name===t)return e.simpleType||e.type}},deleteConfirm(t){const e=this.$refs.dataTable.getCheckboxRecords(),i=[],s=[];for(let c=this.result.data.length-1;c>0;c--){const v=this.result.data[c];v._isNewPush&&e.filter(g=>g._XID==v._XID).length>0&&(i.push(v._XID),s.push(c))}const n=e.filter(c=>!i.includes(c._XID));if(n.length==0){if(t)return"";e.length==this.result.data.filter(c=>c==null?void 0:c._isNewPush).length&&(this.emit("clearSaveState"),this.toolbar.showSaveBtn=!1),this.toolbar.selectedRows=!1;for(const c of s)this.result.data.splice(c,1),delete this.update.editList[c];this.reqFilterData();return}const a=We(this.result,n);t?this.$refs.toolbar.setDeleteSQL(a):(this.emit("telemetry","DeleteRows"),this.reqDML(a))},computeWidth(t,e){if(this.result.fields.length==1&&this.result.dbType=="Neo4j")return 300;let i=t.name;if(this.table.widthItem[i])return this.table.widthItem[i];if(e||(e=0),!this.result.data[e]||e>10)return 70;const s=this.result.data[e][i];var n=Math.max((i+"").length*10,(s+"").length*10,(t.type+"").length*10);const a=this.config.maximumColumnWidth;n>a&&(n=this.result.fields.length==1?Math.min(n,800):a),n<70&&(n=70);var c=this.computeWidth(t,e+1);return n<c&&(n=c),this.table.widthItem[i]=n,n},refresh(){this.result.sql&&this.execute(this.result.sql)},count(){this.emit("count",{sql:this.result.sql})},reqFilter(t){this.info.message=null,this.dontClear=!0,this.execute(t)},reqDML(t){this.dontClear=!0,this.emit("saveModify",t)},execute(t){t&&(this.emit("executeSQL",{sql:t}),this.table.start=new Date().getTime(),this.queueLoading())},changePage(t,e){this.info.message=null,this.dontClear=!0,this.emit("next",{sql:this.result.sql,pageNum:e?t:this.page.pageNum+t,pageSize:this.page.pageSize}),this.table.start=new Date().getTime(),this.queueLoading()},clear(){var t,e,i,s;this.selection=[],this.lastEle=null,this.lastEleFocusOffset=null,this.page.pageNum=this.result.pageNum??1,this.page.pageSize=this.result.pageSize,this.page.total=null,this.toolbar.showSaveBtn=!1,this.toolbar.selectedRows=!1,this.dontClear?this.dontClear=!1:this.info.message=null,this.table.loading=!1,clearInterval(this.table.loadingTimer),this.detail.visible=!1,this.UI.dialog.exportVisible=!1,this.UI.dialog.importVisible=!1,(e=(t=this.$refs.editor)==null?void 0:t.close)==null||e.call(t,!!this.info.error),(s=(i=this.$refs.toolbar)==null?void 0:i.clear)==null||s.call(i)},reset(){var t,e,i;this.dontClear||(this.table.widthItem={},this.toolbar.showColumns=this.result.fields?["dbclientSelectALL",...(e=(t=this.result.fields)==null?void 0:t.map)==null?void 0:e.call(t,s=>s.name)]:[]),this.clear(),Array.isArray(this.result.data)?this.result.columnList&&this.reqFilterData():O("Unrecognized data!"),!this.result.sql.match(/\bwhere\b/gi)&&!this.isEs()&&!this.isMongo()&&(this.toolbar.filter={},(i=this.$refs.dataTable)==null||i.clearSort()),this.$refs.editor&&this.$refs.editor.close()}}};var fi=function(){var e=this,i=e._self._c;return i("div",{staticClass:"data-viewer",class:e.config.resultTheme,attrs:{id:"app","data-vscode-context":'{"preventDefaultContextMenuItems": true}'}},[i("div",{ref:"hint",staticClass:"hint"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.showSQLPanel,expression:"showSQLPanel"}],staticClass:"codemirror-container"},[i("codemirror",{ref:"cmEditor",attrs:{dbType:e.result.dbType},nativeOn:{keydown:function(s){return e.panelInput.apply(null,arguments)}},model:{value:e.toolbar.sql,callback:function(s){e.$set(e.toolbar,"sql",s)},expression:"toolbar.sql"}})],1),i("Toolbar",{ref:"toolbar",attrs:{showFilter:e.state.showFilter,lock:e.lock},on:{"update:showFilter":function(s){return e.$set(e.state,"showFilter",s)},"update:show-filter":function(s){return e.$set(e.state,"showFilter",s)},save:e.save,stopExecute:e.stopExecute,copySelection:e.copySelection,changePage:e.changePage,import:function(s){e.UI.dialog.importVisible=!0},insert:function(s){return e.reqInsert()},deleteConfirm:e.deleteConfirm,run:e.doRunClick}}),i("Response"),e.result.tableCount==1&&e.hasEdit&&!e.result.primaryKey&&!e.result.columnList.length?i("div",{staticClass:"m-1 text-base"},[i("i",{staticClass:"el-icon-warning mr-1",staticStyle:{color:"#E6A23C"}}),e._v(" No primary key found for "),i("span",{staticClass:"red"},[e._v(e._s(e.result.table))]),e._v("! The changes you make may affect more records than expected, please refer "),i("a",{attrs:{href:"https://github.com/cweijan/vscode-database-client/issues/1004"}},[e._v("this")]),e._v(". ")]):e._e()],1),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.table.loading,expression:"table.loading"}]},[i("ux-grid",{directives:[{name:"show",rawName:"v-show",value:e.result.fields,expression:"result.fields"}],ref:"dataTable",staticClass:"result-table",class:{reduceRowBorder:e.config.reduceRowBorder},attrs:{size:"small","cell-style":{height:e.config.resultRowHeight},height:e.remainHeight,stripe:"",checkboxConfig:{checkMethod:e.selectable}},on:{"sort-change":e.sort,"table-body-scroll":e.tableScroll,select:e.changeSelection,"select-all":e.changeSelection,"row-contextmenu":e.onRowContext,"header-contextmenu":e.onHeaderContext}},[i("ux-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}),i("ExpendRowCell",{attrs:{fields:e.computeFields,showFilter:e.state.showFilter}}),e.UI.viewType!="JSON"?e._l(e.computeFields,function(s,n){return i("ux-table-column",{key:n,attrs:{resizable:!0,field:n+"",title:s.name,width:e.computeWidth(s,0),"remote-sort":!e.reverseData},scopedSlots:e._u([{key:"header",fn:function(a){return[i("RowHeader",{attrs:{scope:a,index:n,fields:e.computeFields}})]}},{key:"default",fn:function(a){return[i("RowCell",{attrs:{scope:a,index:n,fields:e.computeFields,filterObj:e.toolbar.filter},on:{execute:e.reqFilter,sendToVscode:e.sendToVscode,openEditor:e.openEditor,viewOnDialog:e.openDetailDialog}})]}}],null,!0)})}):e._e()],2)],1),i("EditDialog",{ref:"editor",attrs:{fields:e.fields},on:{execute:e.reqDML,sendToVscode:e.sendToVscode}}),i("ExportDialog",{ref:"exportDialog",on:{exportHandle:e.confirmExport}}),i("ImportDialog",{on:{importHandle:e.confirmImport}}),i("DetailDialog",{attrs:{visible:e.detail.visible,editable:e.editable,scope:e.detail.scope,result:e.result},on:{"update:visible":function(s){return e.$set(e.detail,"visible",s)},execute:e.reqDML}})],1)},mi=[],gi=F(pi,fi,mi,!1,null,"1968f728",null,null);const qi=gi.exports;export{qi as default};
