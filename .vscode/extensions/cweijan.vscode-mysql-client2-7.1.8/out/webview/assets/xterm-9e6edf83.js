import{z as Rn,A as fs,n as Dr,i as ps,y as Lt}from"./app-aaf1260a.js";import{_ as An}from"./switch-6bf42133.js";import{_ as Tn,a as dt}from"./select-85394007.js";import{D as Dn}from"./DatabaseType-0c502678.js";import"./scrollbar-b60f2172.js";import"./index-72d37e73.js";var _s={exports:{}};(function(q,U){(function(Q,ne){q.exports=ne()})(self,()=>(()=>{var Q={4567:function(j,c,y){var _=this&&this.__decorate||function(i,h,p,g){var C,v=arguments.length,b=v<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(i,h,p,g);else for(var E=i.length-1;E>=0;E--)(C=i[E])&&(b=(v<3?C(b):v>3?C(h,p,b):C(h,p))||b);return v>3&&b&&Object.defineProperty(h,p,b),b},f=this&&this.__param||function(i,h){return function(p,g){h(p,g,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.AccessibilityManager=void 0;const d=y(9042),u=y(6114),w=y(9924),m=y(844),n=y(5596),t=y(4725),a=y(3656);let s=class extends m.Disposable{constructor(i,h){super(),this._terminal=i,this._renderService=h,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let p=0;p<this._terminal.rows;p++)this._rowElements[p]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[p]);if(this._topBoundaryFocusListener=p=>this._handleBoundaryFocus(p,0),this._bottomBoundaryFocusListener=p=>this._handleBoundaryFocus(p,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new w.TimeBasedDebouncer(this._announceCharacters.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._liveRegionDebouncer),this.register(this._terminal.onResize(p=>this._handleResize(p.rows))),this.register(this._terminal.onRender(p=>this._refreshRows(p.start,p.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(p=>this._handleChar(p))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(p=>this._handleTab(p))),this.register(this._terminal.onKey(p=>this._handleKey(p.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new n.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,a.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,m.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(i){for(let h=0;h<i;h++)this._handleChar(" ")}_handleChar(i){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==i&&(this._charsToAnnounce+=i):this._charsToAnnounce+=i,i===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=d.tooMuchOutput)),u.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,u.isMac&&this._liveRegion.remove()}_handleKey(i){this._clearLiveRegion(),/\p{Control}/u.test(i)||this._charsToConsume.push(i)}_refreshRows(i,h){this._liveRegionDebouncer.refresh(i,h,this._terminal.rows)}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(i,h){const p=i.target,g=this._rowElements[h===0?1:this._rowElements.length-2];if(p.getAttribute("aria-posinset")===(h===0?"1":`${this._terminal.buffer.lines.length}`)||i.relatedTarget!==g)return;let C,v;if(h===0?(C=p,v=this._rowElements.pop(),this._rowContainer.removeChild(v)):(C=this._rowElements.shift(),v=p,this._rowContainer.removeChild(C)),C.removeEventListener("focus",this._topBoundaryFocusListener),v.removeEventListener("focus",this._bottomBoundaryFocusListener),h===0){const b=this._createAccessibilityTreeNode();this._rowElements.unshift(b),this._rowContainer.insertAdjacentElement("afterbegin",b)}else{const b=this._createAccessibilityTreeNode();this._rowElements.push(b),this._rowContainer.appendChild(b)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(h===0?-1:1),this._rowElements[h===0?1:this._rowElements.length-2].focus(),i.preventDefault(),i.stopImmediatePropagation()}_handleResize(i){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let h=this._rowContainer.children.length;h<this._terminal.rows;h++)this._rowElements[h]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[h]);for(;this._rowElements.length>i;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const i=document.createElement("div");return i.setAttribute("role","listitem"),i.tabIndex=-1,this._refreshRowDimensions(i),i}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let i=0;i<this._terminal.rows;i++)this._refreshRowDimensions(this._rowElements[i])}}_refreshRowDimensions(i){i.style.height=`${this._renderService.dimensions.css.cell.height}px`}};s=_([f(1,t.IRenderService)],s),c.AccessibilityManager=s},3614:(j,c)=>{function y(u){return u.replace(/\r?\n/g,"\r")}function _(u,w){return w?"\x1B[200~"+u+"\x1B[201~":u}function f(u,w,m){u=_(u=y(u),m.decPrivateModes.bracketedPasteMode),m.triggerDataEvent(u,!0),w.value=""}function d(u,w,m){const n=m.getBoundingClientRect(),t=u.clientX-n.left-10,a=u.clientY-n.top-10;w.style.width="20px",w.style.height="20px",w.style.left=`${t}px`,w.style.top=`${a}px`,w.style.zIndex="1000",w.focus()}Object.defineProperty(c,"__esModule",{value:!0}),c.rightClickHandler=c.moveTextAreaUnderMouseCursor=c.paste=c.handlePasteEvent=c.copyHandler=c.bracketTextForPaste=c.prepareTextForTerminal=void 0,c.prepareTextForTerminal=y,c.bracketTextForPaste=_,c.copyHandler=function(u,w){u.clipboardData&&u.clipboardData.setData("text/plain",w.selectionText),u.preventDefault()},c.handlePasteEvent=function(u,w,m){u.stopPropagation(),u.clipboardData&&f(u.clipboardData.getData("text/plain"),w,m)},c.paste=f,c.moveTextAreaUnderMouseCursor=d,c.rightClickHandler=function(u,w,m,n,t){d(u,w,m),t&&n.rightClickSelect(u),w.value=n.selectionText,w.select()}},7239:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorContrastCache=void 0;const _=y(1505);c.ColorContrastCache=class{constructor(){this._color=new _.TwoKeyMap,this._css=new _.TwoKeyMap}setCss(f,d,u){this._css.set(f,d,u)}getCss(f,d){return this._css.get(f,d)}setColor(f,d,u){this._color.set(f,d,u)}getColor(f,d){return this._color.get(f,d)}clear(){this._color.clear(),this._css.clear()}}},3656:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.addDisposableDomListener=void 0,c.addDisposableDomListener=function(y,_,f,d){y.addEventListener(_,f,d);let u=!1;return{dispose:()=>{u||(u=!0,y.removeEventListener(_,f,d))}}}},6465:function(j,c,y){var _=this&&this.__decorate||function(t,a,s,i){var h,p=arguments.length,g=p<3?a:i===null?i=Object.getOwnPropertyDescriptor(a,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,a,s,i);else for(var C=t.length-1;C>=0;C--)(h=t[C])&&(g=(p<3?h(g):p>3?h(a,s,g):h(a,s))||g);return p>3&&g&&Object.defineProperty(a,s,g),g},f=this&&this.__param||function(t,a){return function(s,i){a(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Linkifier2=void 0;const d=y(2585),u=y(8460),w=y(844),m=y(3656);let n=class extends w.Disposable{constructor(t){super(),this._bufferService=t,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new u.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new u.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,w.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,w.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}get currentLink(){return this._currentLink}registerLinkProvider(t){return this._linkProviders.push(t),{dispose:()=>{const a=this._linkProviders.indexOf(t);a!==-1&&this._linkProviders.splice(a,1)}}}attachToDom(t,a,s){this._element=t,this._mouseService=a,this._renderService=s,this.register((0,m.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,m.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,m.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,m.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(t){if(this._lastMouseEvent=t,!this._element||!this._mouseService)return;const a=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!a)return;this._isMouseOut=!1;const s=t.composedPath();for(let i=0;i<s.length;i++){const h=s[i];if(h.classList.contains("xterm"))break;if(h.classList.contains("xterm-hover"))return}this._lastBufferCell&&a.x===this._lastBufferCell.x&&a.y===this._lastBufferCell.y||(this._handleHover(a),this._lastBufferCell=a)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(t,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,a){var s,i;this._activeProviderReplies&&a||((s=this._activeProviderReplies)===null||s===void 0||s.forEach(p=>{p==null||p.forEach(g=>{g.link.dispose&&g.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=t.y);let h=!1;for(const[p,g]of this._linkProviders.entries())a?!((i=this._activeProviderReplies)===null||i===void 0)&&i.get(p)&&(h=this._checkLinkProviderResult(p,t,h)):g.provideLinks(t.y,C=>{var v,b;if(this._isMouseOut)return;const E=C==null?void 0:C.map(A=>({link:A}));(v=this._activeProviderReplies)===null||v===void 0||v.set(p,E),h=this._checkLinkProviderResult(p,t,h),((b=this._activeProviderReplies)===null||b===void 0?void 0:b.size)===this._linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)})}_removeIntersectingLinks(t,a){const s=new Set;for(let i=0;i<a.size;i++){const h=a.get(i);if(h)for(let p=0;p<h.length;p++){const g=h[p],C=g.link.range.start.y<t?0:g.link.range.start.x,v=g.link.range.end.y>t?this._bufferService.cols:g.link.range.end.x;for(let b=C;b<=v;b++){if(s.has(b)){h.splice(p--,1);break}s.add(b)}}}}_checkLinkProviderResult(t,a,s){var i;if(!this._activeProviderReplies)return s;const h=this._activeProviderReplies.get(t);let p=!1;for(let g=0;g<t;g++)this._activeProviderReplies.has(g)&&!this._activeProviderReplies.get(g)||(p=!0);if(!p&&h){const g=h.find(C=>this._linkAtPosition(C.link,a));g&&(s=!0,this._handleNewLink(g))}if(this._activeProviderReplies.size===this._linkProviders.length&&!s)for(let g=0;g<this._activeProviderReplies.size;g++){const C=(i=this._activeProviderReplies.get(g))===null||i===void 0?void 0:i.find(v=>this._linkAtPosition(v.link,a));if(C){s=!0,this._handleNewLink(C);break}}return s}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._element||!this._mouseService||!this._currentLink)return;const a=this._positionFromMouseEvent(t,this._element,this._mouseService);a&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,a)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,a){this._element&&this._currentLink&&this._lastMouseEvent&&(!t||!a||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=a)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,w.disposeArray)(this._linkCacheDisposables))}_handleNewLink(t){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const a=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);a&&this._linkAtPosition(t.link,a)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0||t.link.decorations.underline,pointerCursor:t.link.decorations===void 0||t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>{var s,i;return(i=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||i===void 0?void 0:i.decorations.pointerCursor},set:s=>{var i,h;!((i=this._currentLink)===null||i===void 0)&&i.state&&this._currentLink.state.decorations.pointerCursor!==s&&(this._currentLink.state.decorations.pointerCursor=s,this._currentLink.state.isHovered&&((h=this._element)===null||h===void 0||h.classList.toggle("xterm-cursor-pointer",s)))}},underline:{get:()=>{var s,i;return(i=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||i===void 0?void 0:i.decorations.underline},set:s=>{var i,h,p;!((i=this._currentLink)===null||i===void 0)&&i.state&&((p=(h=this._currentLink)===null||h===void 0?void 0:h.state)===null||p===void 0?void 0:p.decorations.underline)!==s&&(this._currentLink.state.decorations.underline=s,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,s))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(s=>{if(!this._currentLink)return;const i=s.start===0?0:s.start+1+this._bufferService.buffer.ydisp,h=this._bufferService.buffer.ydisp+1+s.end;if(this._currentLink.link.range.start.y>=i&&this._currentLink.link.range.end.y<=h&&(this._clearCurrentLink(i,h),this._lastMouseEvent&&this._element)){const p=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);p&&this._askForLink(p,!1)}})))}_linkHover(t,a,s){var i;!((i=this._currentLink)===null||i===void 0)&&i.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(a,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),a.hover&&a.hover(s,a.text)}_fireUnderlineEvent(t,a){const s=t.range,i=this._bufferService.buffer.ydisp,h=this._createLinkUnderlineEvent(s.start.x-1,s.start.y-i-1,s.end.x,s.end.y-i-1,void 0);(a?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(h)}_linkLeave(t,a,s){var i;!((i=this._currentLink)===null||i===void 0)&&i.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(a,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),a.leave&&a.leave(s,a.text)}_linkAtPosition(t,a){const s=t.range.start.y*this._bufferService.cols+t.range.start.x,i=t.range.end.y*this._bufferService.cols+t.range.end.x,h=a.y*this._bufferService.cols+a.x;return s<=h&&h<=i}_positionFromMouseEvent(t,a,s){const i=s.getCoords(t,a,this._bufferService.cols,this._bufferService.rows);if(i)return{x:i[0],y:i[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,a,s,i,h){return{x1:t,y1:a,x2:s,y2:i,cols:this._bufferService.cols,fg:h}}};n=_([f(0,d.IBufferService)],n),c.Linkifier2=n},9042:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.tooMuchOutput=c.promptLabel=void 0,c.promptLabel="Terminal input",c.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(j,c,y){var _=this&&this.__decorate||function(n,t,a,s){var i,h=arguments.length,p=h<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,a):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(n,t,a,s);else for(var g=n.length-1;g>=0;g--)(i=n[g])&&(p=(h<3?i(p):h>3?i(t,a,p):i(t,a))||p);return h>3&&p&&Object.defineProperty(t,a,p),p},f=this&&this.__param||function(n,t){return function(a,s){t(a,s,n)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkProvider=void 0;const d=y(511),u=y(2585);let w=class{constructor(n,t,a){this._bufferService=n,this._optionsService=t,this._oscLinkService=a}provideLinks(n,t){var a;const s=this._bufferService.buffer.lines.get(n-1);if(!s)return void t(void 0);const i=[],h=this._optionsService.rawOptions.linkHandler,p=new d.CellData,g=s.getTrimmedLength();let C=-1,v=-1,b=!1;for(let E=0;E<g;E++)if(v!==-1||s.hasContent(E)){if(s.loadCell(E,p),p.hasExtendedAttrs()&&p.extended.urlId){if(v===-1){v=E,C=p.extended.urlId;continue}b=p.extended.urlId!==C}else v!==-1&&(b=!0);if(b||v!==-1&&E===g-1){const A=(a=this._oscLinkService.getLinkData(C))===null||a===void 0?void 0:a.uri;if(A){const T={start:{x:v+1,y:n},end:{x:E+(b||E!==g-1?0:1),y:n}};let O=!1;if(!(h!=null&&h.allowNonHttpProtocols))try{const H=new URL(A);["http:","https:"].includes(H.protocol)||(O=!0)}catch{O=!0}O||i.push({text:A,range:T,activate:(H,M)=>h?h.activate(H,M,T):m(0,M),hover:(H,M)=>{var N;return(N=h==null?void 0:h.hover)===null||N===void 0?void 0:N.call(h,H,M,T)},leave:(H,M)=>{var N;return(N=h==null?void 0:h.leave)===null||N===void 0?void 0:N.call(h,H,M,T)}})}b=!1,p.hasExtendedAttrs()&&p.extended.urlId?(v=E,C=p.extended.urlId):(v=-1,C=-1)}}t(i)}};function m(n,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){const a=window.open();if(a){try{a.opener=null}catch{}a.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}w=_([f(0,u.IBufferService),f(1,u.IOptionsService),f(2,u.IOscLinkService)],w),c.OscLinkProvider=w},6193:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.RenderDebouncer=void 0,c.RenderDebouncer=class{constructor(y,_){this._parentWindow=y,this._renderCallback=_,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(y){return this._refreshCallbacks.push(y),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(y,_,f){this._rowCount=f,y=y!==void 0?y:0,_=_!==void 0?_:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,y):y,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,_):_,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const y=Math.max(this._rowStart,0),_=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(y,_),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const y of this._refreshCallbacks)y(0);this._refreshCallbacks=[]}}},5596:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ScreenDprMonitor=void 0;const _=y(844);class f extends _.Disposable{constructor(u){super(),this._parentWindow=u,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,_.toDisposable)(()=>{this.clearListener()}))}setListener(u){this._listener&&this.clearListener(),this._listener=u,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var u;this._outerListener&&((u=this._resolutionMediaMatchList)===null||u===void 0||u.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}c.ScreenDprMonitor=f},3236:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Terminal=void 0;const _=y(2950),f=y(1680),d=y(3614),u=y(2584),w=y(5435),m=y(9312),n=y(6114),t=y(3656),a=y(9042),s=y(4567),i=y(1296),h=y(7399),p=y(8460),g=y(8437),C=y(3230),v=y(4725),b=y(428),E=y(8934),A=y(6465),T=y(5114),O=y(8969),H=y(8055),M=y(4269),N=y(5941),L=y(3107),B=y(5744),I=y(9074),P=y(2585),Z=y(3730),G=y(844),X=y(6731),V=typeof window<"u"?window.document:null;class ie extends O.CoreTerminal{constructor($={}){super($),this.browser=n,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new p.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new p.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new p.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new p.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new p.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new p.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new p.EventEmitter),this._onBlur=this.register(new p.EventEmitter),this._onA11yCharEmitter=this.register(new p.EventEmitter),this._onA11yTabEmitter=this.register(new p.EventEmitter),this._onWillOpen=this.register(new p.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(A.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(Z.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(I.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((W,te)=>this.refresh(W,te))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(W=>this._reportWindowsOptions(W))),this.register(this._inputHandler.onColor(W=>this._handleColorEvent(W))),this.register((0,p.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,p.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,p.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,p.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(W=>this._afterResize(W.cols,W.rows))),this.register((0,G.toDisposable)(()=>{var W,te;this._customKeyEventHandler=void 0,(te=(W=this.element)===null||W===void 0?void 0:W.parentNode)===null||te===void 0||te.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent($){if(this._themeService)for(const W of $){let te,se="";switch(W.index){case 256:te="foreground",se="10";break;case 257:te="background",se="11";break;case 258:te="cursor",se="12";break;default:te="ansi",se="4;"+W.index}switch(W.type){case 0:const be=H.color.toColorRGB(te==="ansi"?this._themeService.colors.ansi[W.index]:this._themeService.colors[te]);this.coreService.triggerDataEvent(`${u.C0.ESC}]${se};${(0,N.toRgbString)(be)}${u.C1_ESCAPED.ST}`);break;case 1:if(te==="ansi")this._themeService.modifyColors(ce=>ce.ansi[W.index]=H.rgba.toColor(...W.color));else{const ce=te;this._themeService.modifyColors(ke=>ke[ce]=H.rgba.toColor(...W.color))}break;case 2:this._themeService.restoreColor(W.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange($){var W;$?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=this._instantiationService.createInstance(s.AccessibilityManager,this)):((W=this._accessibilityManager)===null||W===void 0||W.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus($){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(u.C0.ESC+"[I"),this.updateCursorStyle($),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var $;return($=this.textarea)===null||$===void 0?void 0:$.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(u.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const $=this.buffer.ybase+this.buffer.y,W=this.buffer.lines.get($);if(!W)return;const te=Math.min(this.buffer.x,this.cols-1),se=this._renderService.dimensions.css.cell.height,be=W.getWidth(te),ce=this._renderService.dimensions.css.cell.width*be,ke=this.buffer.y*this._renderService.dimensions.css.cell.height,ee=te*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ee+"px",this.textarea.style.top=ke+"px",this.textarea.style.width=ce+"px",this.textarea.style.height=se+"px",this.textarea.style.lineHeight=se+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,t.addDisposableDomListener)(this.element,"copy",W=>{this.hasSelection()&&(0,d.copyHandler)(W,this._selectionService)}));const $=W=>(0,d.handlePasteEvent)(W,this.textarea,this.coreService);this.register((0,t.addDisposableDomListener)(this.textarea,"paste",$)),this.register((0,t.addDisposableDomListener)(this.element,"paste",$)),n.isFirefox?this.register((0,t.addDisposableDomListener)(this.element,"mousedown",W=>{W.button===2&&(0,d.rightClickHandler)(W,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,t.addDisposableDomListener)(this.element,"contextmenu",W=>{(0,d.rightClickHandler)(W,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),n.isLinux&&this.register((0,t.addDisposableDomListener)(this.element,"auxclick",W=>{W.button===1&&(0,d.moveTextAreaUnderMouseCursor)(W,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,t.addDisposableDomListener)(this.textarea,"keyup",$=>this._keyUp($),!0)),this.register((0,t.addDisposableDomListener)(this.textarea,"keydown",$=>this._keyDown($),!0)),this.register((0,t.addDisposableDomListener)(this.textarea,"keypress",$=>this._keyPress($),!0)),this.register((0,t.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,t.addDisposableDomListener)(this.textarea,"compositionupdate",$=>this._compositionHelper.compositionupdate($))),this.register((0,t.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,t.addDisposableDomListener)(this.textarea,"input",$=>this._inputEvent($),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open($){var W;if(!$)throw new Error("Terminal requires a parent element.");$.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=$.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),$.appendChild(this.element);const te=V.createDocumentFragment();this._viewportElement=V.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),te.appendChild(this._viewportElement),this._viewportScrollArea=V.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=V.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=V.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),te.appendChild(this.screenElement),this.textarea=V.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",a.promptLabel),n.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(T.CoreBrowserService,this.textarea,(W=this._document.defaultView)!==null&&W!==void 0?W:window),this._instantiationService.setService(v.ICoreBrowserService,this._coreBrowserService),this.register((0,t.addDisposableDomListener)(this.textarea,"focus",se=>this._handleTextAreaFocus(se))),this.register((0,t.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(b.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(v.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(X.ThemeService),this._instantiationService.setService(v.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(M.CharacterJoinerService),this._instantiationService.setService(v.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(C.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(v.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(se=>this._onRender.fire(se))),this.onResize(se=>this._renderService.resize(se.cols,se.rows)),this._compositionView=V.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(_.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(te);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(E.MouseService),this._instantiationService.setService(v.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(f.Viewport,se=>this.scrollLines(se,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(m.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(v.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(se=>this.scrollLines(se.amount,se.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(se=>this._renderService.handleSelectionChanged(se.start,se.end,se.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(se=>{this.textarea.value=se,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(se=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,t.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(L.BufferDecorationRenderer,this.screenElement)),this.register((0,t.addDisposableDomListener)(this.element,"mousedown",se=>this._selectionService.handleMouseDown(se))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=this._instantiationService.createInstance(s.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",se=>this._handleScreenReaderModeOptionChange(se))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(B.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",se=>{!this._overviewRulerRenderer&&se&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(B.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(i.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const $=this,W=this.element;function te(ce){const ke=$._mouseService.getMouseReportCoords(ce,$.screenElement);if(!ke)return!1;let ee,Ee;switch(ce.overrideType||ce.type){case"mousemove":Ee=32,ce.buttons===void 0?(ee=3,ce.button!==void 0&&(ee=ce.button<3?ce.button:3)):ee=1&ce.buttons?0:4&ce.buttons?1:2&ce.buttons?2:3;break;case"mouseup":Ee=0,ee=ce.button<3?ce.button:3;break;case"mousedown":Ee=1,ee=ce.button<3?ce.button:3;break;case"wheel":if($.viewport.getLinesScrolled(ce)===0)return!1;Ee=ce.deltaY<0?0:1,ee=4;break;default:return!1}return!(Ee===void 0||ee===void 0||ee>4)&&$.coreMouseService.triggerMouseEvent({col:ke.col,row:ke.row,x:ke.x,y:ke.y,button:ee,action:Ee,ctrl:ce.ctrlKey,alt:ce.altKey,shift:ce.shiftKey})}const se={mouseup:null,wheel:null,mousedrag:null,mousemove:null},be={mouseup:ce=>(te(ce),ce.buttons||(this._document.removeEventListener("mouseup",se.mouseup),se.mousedrag&&this._document.removeEventListener("mousemove",se.mousedrag)),this.cancel(ce)),wheel:ce=>(te(ce),this.cancel(ce,!0)),mousedrag:ce=>{ce.buttons&&te(ce)},mousemove:ce=>{ce.buttons||te(ce)}};this.register(this.coreMouseService.onProtocolChange(ce=>{ce?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(ce)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&ce?se.mousemove||(W.addEventListener("mousemove",be.mousemove),se.mousemove=be.mousemove):(W.removeEventListener("mousemove",se.mousemove),se.mousemove=null),16&ce?se.wheel||(W.addEventListener("wheel",be.wheel,{passive:!1}),se.wheel=be.wheel):(W.removeEventListener("wheel",se.wheel),se.wheel=null),2&ce?se.mouseup||(se.mouseup=be.mouseup):(this._document.removeEventListener("mouseup",se.mouseup),se.mouseup=null),4&ce?se.mousedrag||(se.mousedrag=be.mousedrag):(this._document.removeEventListener("mousemove",se.mousedrag),se.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,t.addDisposableDomListener)(W,"mousedown",ce=>{if(ce.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(ce))return te(ce),se.mouseup&&this._document.addEventListener("mouseup",se.mouseup),se.mousedrag&&this._document.addEventListener("mousemove",se.mousedrag),this.cancel(ce)})),this.register((0,t.addDisposableDomListener)(W,"wheel",ce=>{if(!se.wheel){if(!this.buffer.hasScrollback){const ke=this.viewport.getLinesScrolled(ce);if(ke===0)return;const ee=u.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(ce.deltaY<0?"A":"B");let Ee="";for(let fe=0;fe<Math.abs(ke);fe++)Ee+=ee;return this.coreService.triggerDataEvent(Ee,!0),this.cancel(ce,!0)}return this.viewport.handleWheel(ce)?this.cancel(ce):void 0}},{passive:!1})),this.register((0,t.addDisposableDomListener)(W,"touchstart",ce=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(ce),this.cancel(ce)},{passive:!0})),this.register((0,t.addDisposableDomListener)(W,"touchmove",ce=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(ce)?void 0:this.cancel(ce)},{passive:!1}))}refresh($,W){var te;(te=this._renderService)===null||te===void 0||te.refreshRows($,W)}updateCursorStyle($){var W;!((W=this._selectionService)===null||W===void 0)&&W.shouldColumnSelect($)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines($,W,te=0){super.scrollLines($,W,te),this.refresh(0,this.rows-1)}paste($){(0,d.paste)($,this.textarea,this.coreService)}attachCustomKeyEventHandler($){this._customKeyEventHandler=$}registerLinkProvider($){return this.linkifier2.registerLinkProvider($)}registerCharacterJoiner($){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const W=this._characterJoinerService.register($);return this.refresh(0,this.rows-1),W}deregisterCharacterJoiner($){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister($)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker($){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+$)}registerDecoration($){return this._decorationService.registerDecoration($)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select($,W,te){this._selectionService.setSelection($,W,te)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var $;($=this._selectionService)===null||$===void 0||$.clearSelection()}selectAll(){var $;($=this._selectionService)===null||$===void 0||$.selectAll()}selectLines($,W){var te;(te=this._selectionService)===null||te===void 0||te.selectLines($,W)}_keyDown($){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler($)===!1)return!1;const W=this.browser.isMac&&this.options.macOptionIsMeta&&$.altKey;if(!W&&!this._compositionHelper.keydown($))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;W||$.key!=="Dead"&&$.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const te=(0,h.evaluateKeyboardEvent)($,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle($),te.type===3||te.type===2){const se=this.rows-1;return this.scrollLines(te.type===2?-se:se),this.cancel($,!0)}return te.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,$)||(te.cancel&&this.cancel($,!0),!te.key||!!($.key&&!$.ctrlKey&&!$.altKey&&!$.metaKey&&$.key.length===1&&$.key.charCodeAt(0)>=65&&$.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(te.key!==u.C0.ETX&&te.key!==u.C0.CR||(this.textarea.value=""),this._onKey.fire({key:te.key,domEvent:$}),this._showCursor(),this.coreService.triggerDataEvent(te.key,!0),!this.optionsService.rawOptions.screenReaderMode||$.altKey||$.ctrlKey?this.cancel($,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift($,W){const te=$.isMac&&!this.options.macOptionIsMeta&&W.altKey&&!W.ctrlKey&&!W.metaKey||$.isWindows&&W.altKey&&W.ctrlKey&&!W.metaKey||$.isWindows&&W.getModifierState("AltGraph");return W.type==="keypress"?te:te&&(!W.keyCode||W.keyCode>47)}_keyUp($){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler($)===!1||(function(W){return W.keyCode===16||W.keyCode===17||W.keyCode===18}($)||this.focus(),this.updateCursorStyle($),this._keyPressHandled=!1)}_keyPress($){let W;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler($)===!1)return!1;if(this.cancel($),$.charCode)W=$.charCode;else if($.which===null||$.which===void 0)W=$.keyCode;else{if($.which===0||$.charCode===0)return!1;W=$.which}return!(!W||($.altKey||$.ctrlKey||$.metaKey)&&!this._isThirdLevelShift(this.browser,$)||(W=String.fromCharCode(W),this._onKey.fire({key:W,domEvent:$}),this._showCursor(),this.coreService.triggerDataEvent(W,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent($){if($.data&&$.inputType==="insertText"&&(!$.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const W=$.data;return this.coreService.triggerDataEvent(W,!0),this.cancel($),!0}return!1}resize($,W){$!==this.cols||W!==this.rows?super.resize($,W):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize($,W){var te,se;(te=this._charSizeService)===null||te===void 0||te.measure(),(se=this.viewport)===null||se===void 0||se.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let $=1;$<this.rows;$++)this.buffer.lines.push(this.buffer.getBlankLine(g.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var $,W;this.options.rows=this.rows,this.options.cols=this.cols;const te=this._customKeyEventHandler;this._setup(),super.reset(),($=this._selectionService)===null||$===void 0||$.reset(),this._decorationService.reset(),this._customKeyEventHandler=te,this.refresh(0,this.rows-1),(W=this.viewport)===null||W===void 0||W.syncScrollArea()}clearTextureAtlas(){var $;($=this._renderService)===null||$===void 0||$.clearTextureAtlas()}_reportFocus(){var $;!(($=this.element)===null||$===void 0)&&$.classList.contains("focus")?this.coreService.triggerDataEvent(u.C0.ESC+"[I"):this.coreService.triggerDataEvent(u.C0.ESC+"[O")}_reportWindowsOptions($){if(this._renderService)switch($){case w.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const W=this._renderService.dimensions.css.canvas.width.toFixed(0),te=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${u.C0.ESC}[4;${te};${W}t`);break;case w.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const se=this._renderService.dimensions.css.cell.width.toFixed(0),be=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${u.C0.ESC}[6;${be};${se}t`)}}cancel($,W){if(this.options.cancelEvents||W)return $.preventDefault(),$.stopPropagation(),!1}}c.Terminal=ie},9924:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TimeBasedDebouncer=void 0,c.TimeBasedDebouncer=class{constructor(y,_=1e3){this._renderCallback=y,this._debounceThresholdMS=_,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(y,_,f){this._rowCount=f,y=y!==void 0?y:0,_=_!==void 0?_:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,y):y,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,_):_;const d=Date.now();if(d-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=d,this._innerRefresh();else if(!this._additionalRefreshRequested){const u=d-this._lastRefreshMs,w=this._debounceThresholdMS-u;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},w)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const y=Math.max(this._rowStart,0),_=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(y,_)}}},1680:function(j,c,y){var _=this&&this.__decorate||function(t,a,s,i){var h,p=arguments.length,g=p<3?a:i===null?i=Object.getOwnPropertyDescriptor(a,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,a,s,i);else for(var C=t.length-1;C>=0;C--)(h=t[C])&&(g=(p<3?h(g):p>3?h(a,s,g):h(a,s))||g);return p>3&&g&&Object.defineProperty(a,s,g),g},f=this&&this.__param||function(t,a){return function(s,i){a(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Viewport=void 0;const d=y(844),u=y(3656),w=y(4725),m=y(2585);let n=class extends d.Disposable{constructor(t,a,s,i,h,p,g,C,v){super(),this._scrollLines=t,this._viewportElement=a,this._scrollArea=s,this._bufferService=i,this._optionsService=h,this._charSizeService=p,this._renderService=g,this._coreBrowserService=C,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,u.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(b=>this._activeBuffer=b.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(b=>this._renderDimensions=b)),this._handleThemeChange(v.colors),this.register(v.onChangeColors(b=>this._handleThemeChange(b))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(t){this._viewportElement.style.backgroundColor=t.background.css}_refresh(t){if(t)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const a=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==a&&(this._lastRecordedBufferHeight=a,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const t=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),this._refreshAnimationFrame=null}syncScrollArea(t=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(t);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(t)}_handleScroll(t){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const a=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(a)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const t=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(t*(this._smoothScrollState.target-this._smoothScrollState.origin)),t<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(t,a){const s=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(a<0&&this._viewportElement.scrollTop!==0||a>0&&s<this._lastRecordedBufferHeight)||(t.cancelable&&t.preventDefault(),!1)}handleWheel(t){const a=this._getPixelsScrolled(t);return a!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+a:this._smoothScrollState.target+=a,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=a,this._bubbleScroll(t,a))}_getPixelsScrolled(t){if(t.deltaY===0||t.shiftKey)return 0;let a=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_LINE?a*=this._currentRowHeight:t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(a*=this._currentRowHeight*this._bufferService.rows),a}getBufferElements(t,a){var s;let i,h="";const p=[],g=a??this._bufferService.buffer.lines.length,C=this._bufferService.buffer.lines;for(let v=t;v<g;v++){const b=C.get(v);if(!b)continue;const E=(s=C.get(v+1))===null||s===void 0?void 0:s.isWrapped;if(h+=b.translateToString(!E),!E||v===C.length-1){const A=document.createElement("div");A.textContent=h,p.push(A),h.length>0&&(i=A),h=""}}return{bufferElements:p,cursorElement:i}}getLinesScrolled(t){if(t.deltaY===0||t.shiftKey)return 0;let a=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(a/=this._currentRowHeight+0,this._wheelPartialScroll+=a,a=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(a*=this._bufferService.rows),a}_applyScrollModifier(t,a){const s=this._optionsService.rawOptions.fastScrollModifier;return s==="alt"&&a.altKey||s==="ctrl"&&a.ctrlKey||s==="shift"&&a.shiftKey?t*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:t*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(t){this._lastTouchY=t.touches[0].pageY}handleTouchMove(t){const a=this._lastTouchY-t.touches[0].pageY;return this._lastTouchY=t.touches[0].pageY,a!==0&&(this._viewportElement.scrollTop+=a,this._bubbleScroll(t,a))}};n=_([f(3,m.IBufferService),f(4,m.IOptionsService),f(5,w.ICharSizeService),f(6,w.IRenderService),f(7,w.ICoreBrowserService),f(8,w.IThemeService)],n),c.Viewport=n},3107:function(j,c,y){var _=this&&this.__decorate||function(t,a,s,i){var h,p=arguments.length,g=p<3?a:i===null?i=Object.getOwnPropertyDescriptor(a,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,a,s,i);else for(var C=t.length-1;C>=0;C--)(h=t[C])&&(g=(p<3?h(g):p>3?h(a,s,g):h(a,s))||g);return p>3&&g&&Object.defineProperty(a,s,g),g},f=this&&this.__param||function(t,a){return function(s,i){a(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferDecorationRenderer=void 0;const d=y(3656),u=y(4725),w=y(844),m=y(2585);let n=class extends w.Disposable{constructor(t,a,s,i){super(),this._screenElement=t,this._bufferService=a,this._decorationService=s,this._renderService=i,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,d.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(h=>this._removeDecoration(h))),this.register((0,w.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){var a,s;const i=document.createElement("div");i.classList.add("xterm-decoration"),i.classList.toggle("xterm-decoration-top-layer",((a=t==null?void 0:t.options)===null||a===void 0?void 0:a.layer)==="top"),i.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,i.style.height=(t.options.height||1)*this._renderService.dimensions.css.cell.height+"px",i.style.top=(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",i.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const h=(s=t.options.x)!==null&&s!==void 0?s:0;return h&&h>this._bufferService.cols&&(i.style.display="none"),this._refreshXPosition(t,i),i}_refreshStyle(t){const a=t.marker.line-this._bufferService.buffers.active.ydisp;if(a<0||a>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let s=this._decorationElements.get(t);s||(s=this._createElement(t),t.element=s,this._decorationElements.set(t,s),this._container.appendChild(s)),s.style.top=a*this._renderService.dimensions.css.cell.height+"px",s.style.display=this._altBufferIsActive?"none":"block",t.onRenderEmitter.fire(s)}}_refreshXPosition(t,a=t.element){var s;if(!a)return;const i=(s=t.options.x)!==null&&s!==void 0?s:0;(t.options.anchor||"left")==="right"?a.style.right=i?i*this._renderService.dimensions.css.cell.width+"px":"":a.style.left=i?i*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(t){var a;(a=this._decorationElements.get(t))===null||a===void 0||a.remove(),this._decorationElements.delete(t),t.dispose()}};n=_([f(1,m.IBufferService),f(2,m.IDecorationService),f(3,u.IRenderService)],n),c.BufferDecorationRenderer=n},5871:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorZoneStore=void 0,c.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(y){if(y.options.overviewRulerOptions){for(const _ of this._zones)if(_.color===y.options.overviewRulerOptions.color&&_.position===y.options.overviewRulerOptions.position){if(this._lineIntersectsZone(_,y.marker.line))return;if(this._lineAdjacentToZone(_,y.marker.line,y.options.overviewRulerOptions.position))return void this._addLineToZone(_,y.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=y.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=y.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=y.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=y.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:y.options.overviewRulerOptions.color,position:y.options.overviewRulerOptions.position,startBufferLine:y.marker.line,endBufferLine:y.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(y){this._linePadding=y}_lineIntersectsZone(y,_){return _>=y.startBufferLine&&_<=y.endBufferLine}_lineAdjacentToZone(y,_,f){return _>=y.startBufferLine-this._linePadding[f||"full"]&&_<=y.endBufferLine+this._linePadding[f||"full"]}_addLineToZone(y,_){y.startBufferLine=Math.min(y.startBufferLine,_),y.endBufferLine=Math.max(y.endBufferLine,_)}}},5744:function(j,c,y){var _=this&&this.__decorate||function(h,p,g,C){var v,b=arguments.length,E=b<3?p:C===null?C=Object.getOwnPropertyDescriptor(p,g):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(h,p,g,C);else for(var A=h.length-1;A>=0;A--)(v=h[A])&&(E=(b<3?v(E):b>3?v(p,g,E):v(p,g))||E);return b>3&&E&&Object.defineProperty(p,g,E),E},f=this&&this.__param||function(h,p){return function(g,C){p(g,C,h)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OverviewRulerRenderer=void 0;const d=y(5871),u=y(3656),w=y(4725),m=y(844),n=y(2585),t={full:0,left:0,center:0,right:0},a={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0};let i=class extends m.Disposable{constructor(h,p,g,C,v,b,E){var A;super(),this._viewportElement=h,this._screenElement=p,this._bufferService=g,this._decorationService=C,this._renderService=v,this._optionsService=b,this._coreBrowseService=E,this._colorZoneStore=new d.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(A=this._viewportElement.parentElement)===null||A===void 0||A.insertBefore(this._canvas,this._viewportElement);const T=this._canvas.getContext("2d");if(!T)throw new Error("Ctx cannot be null");this._ctx=T,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,m.toDisposable)(()=>{var O;(O=this._canvas)===null||O===void 0||O.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,u.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const h=Math.floor(this._canvas.width/3),p=Math.ceil(this._canvas.width/3);a.full=this._canvas.width,a.left=h,a.center=p,a.right=h,this._refreshDrawHeightConstants(),s.full=0,s.left=0,s.center=a.left,s.right=a.left+a.center}_refreshDrawHeightConstants(){t.full=Math.round(2*this._coreBrowseService.dpr);const h=this._canvas.height/this._bufferService.buffer.lines.length,p=Math.round(Math.max(Math.min(h,12),6)*this._coreBrowseService.dpr);t.left=p,t.center=p,t.right=p}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const p of this._decorationService.decorations)this._colorZoneStore.addDecoration(p);this._ctx.lineWidth=1;const h=this._colorZoneStore.zones;for(const p of h)p.position!=="full"&&this._renderColorZone(p);for(const p of h)p.position==="full"&&this._renderColorZone(p);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(h){this._ctx.fillStyle=h.color,this._ctx.fillRect(s[h.position||"full"],Math.round((this._canvas.height-1)*(h.startBufferLine/this._bufferService.buffers.active.lines.length)-t[h.position||"full"]/2),a[h.position||"full"],Math.round((this._canvas.height-1)*((h.endBufferLine-h.startBufferLine)/this._bufferService.buffers.active.lines.length)+t[h.position||"full"]))}_queueRefresh(h,p){this._shouldUpdateDimensions=h||this._shouldUpdateDimensions,this._shouldUpdateAnchor=p||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};i=_([f(2,n.IBufferService),f(3,n.IDecorationService),f(4,w.IRenderService),f(5,n.IOptionsService),f(6,w.ICoreBrowserService)],i),c.OverviewRulerRenderer=i},2950:function(j,c,y){var _=this&&this.__decorate||function(n,t,a,s){var i,h=arguments.length,p=h<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,a):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(n,t,a,s);else for(var g=n.length-1;g>=0;g--)(i=n[g])&&(p=(h<3?i(p):h>3?i(t,a,p):i(t,a))||p);return h>3&&p&&Object.defineProperty(t,a,p),p},f=this&&this.__param||function(n,t){return function(a,s){t(a,s,n)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CompositionHelper=void 0;const d=y(4725),u=y(2585),w=y(2584);let m=class{constructor(n,t,a,s,i,h){this._textarea=n,this._compositionView=t,this._bufferService=a,this._optionsService=s,this._coreService=i,this._renderService=h,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(n){this._compositionView.textContent=n.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(n){if(this._isComposing||this._isSendingComposition){if(n.keyCode===229||n.keyCode===16||n.keyCode===17||n.keyCode===18)return!1;this._finalizeComposition(!1)}return n.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(n){if(this._compositionView.classList.remove("active"),this._isComposing=!1,n){const t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let a;if(this._isSendingComposition=!1,t.start+=this._dataAlreadySent.length,this._isComposing)a=this._textarea.value.substring(t.start,t.end);else{const s=this._textarea.value.length-t.start;a=this._textarea.value.substring(0,s)}a.length>0&&this._coreService.triggerDataEvent(a,!0)}},0)}else{this._isSendingComposition=!1;const t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){const n=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const t=this._textarea.value,a=t.replace(n,"");this._dataAlreadySent=a,t.length>n.length?this._coreService.triggerDataEvent(a,!0):t.length<n.length?this._coreService.triggerDataEvent(`${w.C0.DEL}`,!0):t.length===n.length&&t!==n&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(n){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),a=this._renderService.dimensions.css.cell.height,s=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,i=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=i+"px",this._compositionView.style.top=s+"px",this._compositionView.style.height=a+"px",this._compositionView.style.lineHeight=a+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const h=this._compositionView.getBoundingClientRect();this._textarea.style.left=i+"px",this._textarea.style.top=s+"px",this._textarea.style.width=Math.max(h.width,1)+"px",this._textarea.style.height=Math.max(h.height,1)+"px",this._textarea.style.lineHeight=h.height+"px"}n||setTimeout(()=>this.updateCompositionElements(!0),0)}}};m=_([f(2,u.IBufferService),f(3,u.IOptionsService),f(4,u.ICoreService),f(5,d.IRenderService)],m),c.CompositionHelper=m},9806:(j,c)=>{function y(_,f,d){const u=d.getBoundingClientRect(),w=_.getComputedStyle(d),m=parseInt(w.getPropertyValue("padding-left")),n=parseInt(w.getPropertyValue("padding-top"));return[f.clientX-u.left-m,f.clientY-u.top-n]}Object.defineProperty(c,"__esModule",{value:!0}),c.getCoords=c.getCoordsRelativeToElement=void 0,c.getCoordsRelativeToElement=y,c.getCoords=function(_,f,d,u,w,m,n,t,a){if(!m)return;const s=y(_,f,d);return s?(s[0]=Math.ceil((s[0]+(a?n/2:0))/n),s[1]=Math.ceil(s[1]/t),s[0]=Math.min(Math.max(s[0],1),u+(a?1:0)),s[1]=Math.min(Math.max(s[1],1),w),s):void 0}},9504:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.moveToCellSequence=void 0;const _=y(2584);function f(t,a,s,i){const h=t-d(t,s),p=a-d(a,s),g=Math.abs(h-p)-function(C,v,b){let E=0;const A=C-d(C,b),T=v-d(v,b);for(let O=0;O<Math.abs(A-T);O++){const H=u(C,v)==="A"?-1:1,M=b.buffer.lines.get(A+H*O);M!=null&&M.isWrapped&&E++}return E}(t,a,s);return n(g,m(u(t,a),i))}function d(t,a){let s=0,i=a.buffer.lines.get(t),h=i==null?void 0:i.isWrapped;for(;h&&t>=0&&t<a.rows;)s++,i=a.buffer.lines.get(--t),h=i==null?void 0:i.isWrapped;return s}function u(t,a){return t>a?"A":"B"}function w(t,a,s,i,h,p){let g=t,C=a,v="";for(;g!==s||C!==i;)g+=h?1:-1,h&&g>p.cols-1?(v+=p.buffer.translateBufferLineToString(C,!1,t,g),g=0,t=0,C++):!h&&g<0&&(v+=p.buffer.translateBufferLineToString(C,!1,0,t+1),g=p.cols-1,t=g,C--);return v+p.buffer.translateBufferLineToString(C,!1,t,g)}function m(t,a){const s=a?"O":"[";return _.C0.ESC+s+t}function n(t,a){t=Math.floor(t);let s="";for(let i=0;i<t;i++)s+=a;return s}c.moveToCellSequence=function(t,a,s,i){const h=s.buffer.x,p=s.buffer.y;if(!s.buffer.hasScrollback)return function(v,b,E,A,T,O){return f(b,A,T,O).length===0?"":n(w(v,b,v,b-d(b,T),!1,T).length,m("D",O))}(h,p,0,a,s,i)+f(p,a,s,i)+function(v,b,E,A,T,O){let H;H=f(b,A,T,O).length>0?A-d(A,T):b;const M=A,N=function(L,B,I,P,Z,G){let X;return X=f(I,P,Z,G).length>0?P-d(P,Z):B,L<I&&X<=P||L>=I&&X<P?"C":"D"}(v,b,E,A,T,O);return n(w(v,H,E,M,N==="C",T).length,m(N,O))}(h,p,t,a,s,i);let g;if(p===a)return g=h>t?"D":"C",n(Math.abs(h-t),m(g,i));g=p>a?"D":"C";const C=Math.abs(p-a);return n(function(v,b){return b.cols-v}(p>a?t:h,s)+(C-1)*s.cols+1+((p>a?h:t)-1),m(g,i))}},1296:function(j,c,y){var _=this&&this.__decorate||function(C,v,b,E){var A,T=arguments.length,O=T<3?v:E===null?E=Object.getOwnPropertyDescriptor(v,b):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(C,v,b,E);else for(var H=C.length-1;H>=0;H--)(A=C[H])&&(O=(T<3?A(O):T>3?A(v,b,O):A(v,b))||O);return T>3&&O&&Object.defineProperty(v,b,O),O},f=this&&this.__param||function(C,v){return function(b,E){v(b,E,C)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRenderer=void 0;const d=y(3787),u=y(2223),w=y(6171),m=y(4725),n=y(8055),t=y(8460),a=y(844),s=y(2585),i="xterm-dom-renderer-owner-",h="xterm-focus";let p=1,g=class extends a.Disposable{constructor(C,v,b,E,A,T,O,H,M,N){super(),this._element=C,this._screenElement=v,this._viewportElement=b,this._linkifier2=E,this._charSizeService=T,this._optionsService=O,this._bufferService=H,this._coreBrowserService=M,this._themeService=N,this._terminalClass=p++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new t.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,w.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(L=>this._injectCss(L))),this._injectCss(this._themeService.colors),this._rowFactory=A.createInstance(d.DomRendererRowFactory,document),this._element.classList.add(i+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(L=>this._handleLinkHover(L))),this.register(this._linkifier2.onHideLinkUnderline(L=>this._handleLinkLeave(L))),this.register((0,a.toDisposable)(()=>{this._element.classList.remove(i+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))}_updateDimensions(){const C=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*C,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*C),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/C),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/C),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const b of this._rowElements)b.style.width=`${this.dimensions.css.canvas.width}px`,b.style.height=`${this.dimensions.css.cell.height}px`,b.style.lineHeight=`${this.dimensions.css.cell.height}px`,b.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const v=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=v,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(C){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let v=`${this._terminalSelector} .xterm-rows { color: ${C.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;v+=`${this._terminalSelector} .xterm-rows .xterm-dim { color: ${n.color.multiplyOpacity(C.foreground,.5).css};}`,v+=`${this._terminalSelector} span:not(.${d.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${d.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${d.ITALIC_CLASS} { font-style: italic;}`,v+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",v+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${C.cursor.css};  color: ${C.cursorAccent.css}; } 50% {  background-color: ${C.cursorAccent.css};  color: ${C.cursor.css}; }}`,v+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_BLOCK_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_BAR_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_UNDERLINE_CLASS} { outline: 1px solid ${C.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${d.CURSOR_CLASS}.${d.CURSOR_BLINK_CLASS}:not(.${d.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${d.CURSOR_CLASS}.${d.CURSOR_BLINK_CLASS}.${d.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${C.cursor.css}; color: ${C.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${C.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${C.cursor.css} inset;}`,v+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${C.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${C.selectionInactiveBackgroundOpaque.css};}`;for(const[b,E]of C.ansi.entries())v+=`${this._terminalSelector} .xterm-fg-${b} { color: ${E.css}; }${this._terminalSelector} .xterm-fg-${b}.${d.DIM_CLASS} { color: ${n.color.multiplyOpacity(E,.5).css}; }${this._terminalSelector} .xterm-bg-${b} { background-color: ${E.css}; }`;v+=`${this._terminalSelector} .xterm-fg-${u.INVERTED_DEFAULT_COLOR} { color: ${n.color.opaque(C.background).css}; }${this._terminalSelector} .xterm-fg-${u.INVERTED_DEFAULT_COLOR}.${d.DIM_CLASS} { color: ${n.color.multiplyOpacity(n.color.opaque(C.background),.5).css}; }${this._terminalSelector} .xterm-bg-${u.INVERTED_DEFAULT_COLOR} { background-color: ${C.foreground.css}; }`,this._themeStyleElement.textContent=v}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(C,v){for(let b=this._rowElements.length;b<=v;b++){const E=document.createElement("div");this._rowContainer.appendChild(E),this._rowElements.push(E)}for(;this._rowElements.length>v;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(C,v){this._refreshRowElements(C,v),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(h)}handleFocus(){this._rowContainer.classList.add(h)}handleSelectionChanged(C,v,b){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(C,v,b),this.renderRows(0,this._bufferService.rows-1),!C||!v)return;const E=C[1]-this._bufferService.buffer.ydisp,A=v[1]-this._bufferService.buffer.ydisp,T=Math.max(E,0),O=Math.min(A,this._bufferService.rows-1);if(T>=this._bufferService.rows||O<0)return;const H=document.createDocumentFragment();if(b){const M=C[0]>v[0];H.appendChild(this._createSelectionElement(T,M?v[0]:C[0],M?C[0]:v[0],O-T+1))}else{const M=E===T?C[0]:0,N=T===A?v[0]:this._bufferService.cols;H.appendChild(this._createSelectionElement(T,M,N));const L=O-T-1;if(H.appendChild(this._createSelectionElement(T+1,0,this._bufferService.cols,L)),T!==O){const B=A===O?v[0]:this._bufferService.cols;H.appendChild(this._createSelectionElement(O,0,B))}}this._selectionContainer.appendChild(H)}_createSelectionElement(C,v,b,E=1){const A=document.createElement("div");return A.style.height=E*this.dimensions.css.cell.height+"px",A.style.top=C*this.dimensions.css.cell.height+"px",A.style.left=v*this.dimensions.css.cell.width+"px",A.style.width=this.dimensions.css.cell.width*(b-v)+"px",A}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors)}clear(){for(const C of this._rowElements)C.replaceChildren()}renderRows(C,v){const b=this._bufferService.buffer.ybase+this._bufferService.buffer.y,E=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),A=this._optionsService.rawOptions.cursorBlink;for(let T=C;T<=v;T++){const O=this._rowElements[T],H=T+this._bufferService.buffer.ydisp,M=this._bufferService.buffer.lines.get(H),N=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[T]&&this._cellToRowElements[T].length===this._bufferService.cols||(this._cellToRowElements[T]=new Int16Array(this._bufferService.cols)),O.replaceChildren(this._rowFactory.createRow(M,H,H===b,N,E,A,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[T]))}}get _terminalSelector(){return`.${i}${this._terminalClass}`}_handleLinkHover(C){this._setCellUnderline(C.x1,C.x2,C.y1,C.y2,C.cols,!0)}_handleLinkLeave(C){this._setCellUnderline(C.x1,C.x2,C.y1,C.y2,C.cols,!1)}_setCellUnderline(C,v,b,E,A,T){if(C=this._cellToRowElements[b][C],v=this._cellToRowElements[E][v],C!==-1&&v!==-1)for(;C!==v||b!==E;){const O=this._rowElements[b];if(!O)return;const H=O.children[C];H&&(H.style.textDecoration=T?"underline":"none"),++C>=A&&(C=0,b++)}}};g=_([f(4,s.IInstantiationService),f(5,m.ICharSizeService),f(6,s.IOptionsService),f(7,s.IBufferService),f(8,m.ICoreBrowserService),f(9,m.IThemeService)],g),c.DomRenderer=g},3787:function(j,c,y){var _=this&&this.__decorate||function(g,C,v,b){var E,A=arguments.length,T=A<3?C:b===null?b=Object.getOwnPropertyDescriptor(C,v):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(g,C,v,b);else for(var O=g.length-1;O>=0;O--)(E=g[O])&&(T=(A<3?E(T):A>3?E(C,v,T):E(C,v))||T);return A>3&&T&&Object.defineProperty(C,v,T),T},f=this&&this.__param||function(g,C){return function(v,b){C(v,b,g)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRendererRowFactory=c.CURSOR_STYLE_UNDERLINE_CLASS=c.CURSOR_STYLE_BAR_CLASS=c.CURSOR_STYLE_BLOCK_CLASS=c.CURSOR_BLINK_CLASS=c.CURSOR_CLASS=c.STRIKETHROUGH_CLASS=c.OVERLINE_CLASS=c.UNDERLINE_CLASS=c.ITALIC_CLASS=c.DIM_CLASS=c.BOLD_CLASS=void 0;const d=y(2223),u=y(643),w=y(511),m=y(2585),n=y(8055),t=y(4725),a=y(4269),s=y(6171),i=y(3734);c.BOLD_CLASS="xterm-bold",c.DIM_CLASS="xterm-dim",c.ITALIC_CLASS="xterm-italic",c.UNDERLINE_CLASS="xterm-underline",c.OVERLINE_CLASS="xterm-overline",c.STRIKETHROUGH_CLASS="xterm-strikethrough",c.CURSOR_CLASS="xterm-cursor",c.CURSOR_BLINK_CLASS="xterm-cursor-blink",c.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",c.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",c.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let h=class{constructor(g,C,v,b,E,A,T){this._document=g,this._characterJoinerService=C,this._optionsService=v,this._coreBrowserService=b,this._coreService=E,this._decorationService=A,this._themeService=T,this._workCell=new w.CellData,this._columnSelectMode=!1}handleSelectionChanged(g,C,v){this._selectionStart=g,this._selectionEnd=C,this._columnSelectMode=v}createRow(g,C,v,b,E,A,T,O,H){const M=this._document.createDocumentFragment(),N=this._characterJoinerService.getJoinedCharacters(C);let L=0;for(let Z=Math.min(g.length,O)-1;Z>=0;Z--)if(g.loadCell(Z,this._workCell).getCode()!==u.NULL_CELL_CODE||v&&Z===E){L=Z+1;break}const B=this._themeService.colors;let I=-1,P=0;for(;P<L;P++){g.loadCell(P,this._workCell);let Z=this._workCell.getWidth();if(Z===0){H[P]=I;continue}let G=!1,X=P,V=this._workCell;if(N.length>0&&P===N[0][0]){G=!0;const fe=N.shift();V=new a.JoinedCellData(this._workCell,g.translateToString(!0,fe[0],fe[1]),fe[1]-fe[0]),X=fe[1]-1,Z=V.getWidth()}const ie=this._document.createElement("span");if(Z>1&&(ie.style.width=T*Z+"px"),G&&(ie.style.display="inline",E>=P&&E<=X&&(E=P)),!this._coreService.isCursorHidden&&v&&P===E)switch(ie.classList.add(c.CURSOR_CLASS),A&&ie.classList.add(c.CURSOR_BLINK_CLASS),b){case"bar":ie.classList.add(c.CURSOR_STYLE_BAR_CLASS);break;case"underline":ie.classList.add(c.CURSOR_STYLE_UNDERLINE_CLASS);break;default:ie.classList.add(c.CURSOR_STYLE_BLOCK_CLASS)}if(V.isBold()&&ie.classList.add(c.BOLD_CLASS),V.isItalic()&&ie.classList.add(c.ITALIC_CLASS),V.isDim()&&ie.classList.add(c.DIM_CLASS),V.isInvisible()?ie.textContent=u.WHITESPACE_CELL_CHAR:ie.textContent=V.getChars()||u.WHITESPACE_CELL_CHAR,V.isUnderline()&&(ie.classList.add(`${c.UNDERLINE_CLASS}-${V.extended.underlineStyle}`),ie.textContent===" "&&(ie.textContent=""),!V.isUnderlineColorDefault()))if(V.isUnderlineColorRGB())ie.style.textDecorationColor=`rgb(${i.AttributeData.toColorRGB(V.getUnderlineColor()).join(",")})`;else{let fe=V.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&V.isBold()&&fe<8&&(fe+=8),ie.style.textDecorationColor=B.ansi[fe].css}V.isOverline()&&(ie.classList.add(c.OVERLINE_CLASS),ie.textContent===" "&&(ie.textContent="")),V.isStrikethrough()&&ie.classList.add(c.STRIKETHROUGH_CLASS);let z=V.getFgColor(),$=V.getFgColorMode(),W=V.getBgColor(),te=V.getBgColorMode();const se=!!V.isInverse();if(se){const fe=z;z=W,W=fe;const st=$;$=te,te=st}let be,ce,ke=!1;this._decorationService.forEachDecorationAtCell(P,C,void 0,fe=>{fe.options.layer!=="top"&&ke||(fe.backgroundColorRGB&&(te=50331648,W=fe.backgroundColorRGB.rgba>>8&16777215,be=fe.backgroundColorRGB),fe.foregroundColorRGB&&($=50331648,z=fe.foregroundColorRGB.rgba>>8&16777215,ce=fe.foregroundColorRGB),ke=fe.options.layer==="top")});const ee=this._isCellInSelection(P,C);let Ee;switch(ke||B.selectionForeground&&ee&&($=50331648,z=B.selectionForeground.rgba>>8&16777215,ce=B.selectionForeground),ee&&(be=this._coreBrowserService.isFocused?B.selectionBackgroundOpaque:B.selectionInactiveBackgroundOpaque,ke=!0),ke&&ie.classList.add("xterm-decoration-top"),te){case 16777216:case 33554432:Ee=B.ansi[W],ie.classList.add(`xterm-bg-${W}`);break;case 50331648:Ee=n.rgba.toColor(W>>16,W>>8&255,255&W),this._addStyle(ie,`background-color:#${p((W>>>0).toString(16),"0",6)}`);break;default:se?(Ee=B.foreground,ie.classList.add(`xterm-bg-${d.INVERTED_DEFAULT_COLOR}`)):Ee=B.background}switch(be||V.isDim()&&(be=n.color.multiplyOpacity(Ee,.5)),$){case 16777216:case 33554432:V.isBold()&&z<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(z+=8),this._applyMinimumContrast(ie,Ee,B.ansi[z],V,be,void 0)||ie.classList.add(`xterm-fg-${z}`);break;case 50331648:const fe=n.rgba.toColor(z>>16&255,z>>8&255,255&z);this._applyMinimumContrast(ie,Ee,fe,V,be,ce)||this._addStyle(ie,`color:#${p(z.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(ie,Ee,B.foreground,V,be,void 0)||se&&ie.classList.add(`xterm-fg-${d.INVERTED_DEFAULT_COLOR}`)}M.appendChild(ie),H[P]=++I,P=X}return P<O-1&&H.subarray(P).fill(++I),M}_applyMinimumContrast(g,C,v,b,E,A){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,s.excludeFromContrastRatioDemands)(b.getCode()))return!1;let T;return E||A||(T=this._themeService.colors.contrastCache.getColor(C.rgba,v.rgba)),T===void 0&&(T=n.color.ensureContrastRatio(E||C,A||v,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((E||C).rgba,(A||v).rgba,T??null)),!!T&&(this._addStyle(g,`color:${T.css}`),!0)}_addStyle(g,C){g.setAttribute("style",`${g.getAttribute("style")||""}${C};`)}_isCellInSelection(g,C){const v=this._selectionStart,b=this._selectionEnd;return!(!v||!b)&&(this._columnSelectMode?v[0]<=b[0]?g>=v[0]&&C>=v[1]&&g<b[0]&&C<=b[1]:g<v[0]&&C>=v[1]&&g>=b[0]&&C<=b[1]:C>v[1]&&C<b[1]||v[1]===b[1]&&C===v[1]&&g>=v[0]&&g<b[0]||v[1]<b[1]&&C===b[1]&&g<b[0]||v[1]<b[1]&&C===v[1]&&g>=v[0])}};function p(g,C,v){for(;g.length<v;)g=C+g;return g}h=_([f(1,t.ICharacterJoinerService),f(2,m.IOptionsService),f(3,t.ICoreBrowserService),f(4,m.ICoreService),f(5,m.IDecorationService),f(6,t.IThemeService)],h),c.DomRendererRowFactory=h},2223:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_BASELINE=c.DIM_OPACITY=c.INVERTED_DEFAULT_COLOR=void 0;const _=y(6114);c.INVERTED_DEFAULT_COLOR=257,c.DIM_OPACITY=.5,c.TEXT_BASELINE=_.isFirefox||_.isLegacyEdge?"bottom":"ideographic"},6171:(j,c)=>{function y(_){return 57508<=_&&_<=57558}Object.defineProperty(c,"__esModule",{value:!0}),c.createRenderDimensions=c.excludeFromContrastRatioDemands=c.isRestrictedPowerlineGlyph=c.isPowerlineGlyph=c.throwIfFalsy=void 0,c.throwIfFalsy=function(_){if(!_)throw new Error("value must not be falsy");return _},c.isPowerlineGlyph=y,c.isRestrictedPowerlineGlyph=function(_){return 57520<=_&&_<=57527},c.excludeFromContrastRatioDemands=function(_){return y(_)||function(f){return 9472<=f&&f<=9631}(_)},c.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionModel=void 0,c.SelectionModel=class{constructor(y){this._bufferService=y,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const y=this.selectionStart[0]+this.selectionStartLength;return y>this._bufferService.cols?y%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(y/this._bufferService.cols)-1]:[y%this._bufferService.cols,this.selectionStart[1]+Math.floor(y/this._bufferService.cols)]:[y,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const y=this.selectionStart[0]+this.selectionStartLength;return y>this._bufferService.cols?[y%this._bufferService.cols,this.selectionStart[1]+Math.floor(y/this._bufferService.cols)]:[Math.max(y,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const y=this.selectionStart,_=this.selectionEnd;return!(!y||!_)&&(y[1]>_[1]||y[1]===_[1]&&y[0]>_[0])}handleTrim(y){return this.selectionStart&&(this.selectionStart[1]-=y),this.selectionEnd&&(this.selectionEnd[1]-=y),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(j,c,y){var _=this&&this.__decorate||function(t,a,s,i){var h,p=arguments.length,g=p<3?a:i===null?i=Object.getOwnPropertyDescriptor(a,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,a,s,i);else for(var C=t.length-1;C>=0;C--)(h=t[C])&&(g=(p<3?h(g):p>3?h(a,s,g):h(a,s))||g);return p>3&&g&&Object.defineProperty(a,s,g),g},f=this&&this.__param||function(t,a){return function(s,i){a(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharSizeService=void 0;const d=y(2585),u=y(8460),w=y(844);let m=class extends w.Disposable{constructor(t,a,s){super(),this._optionsService=s,this.width=0,this.height=0,this._onCharSizeChange=this.register(new u.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new n(t,a,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const t=this._measureStrategy.measure();t.width===this.width&&t.height===this.height||(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};m=_([f(2,d.IOptionsService)],m),c.CharSizeService=m;class n{constructor(a,s,i){this._document=a,this._parentElement=s,this._optionsService=i,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const a=this._measureElement.getBoundingClientRect();return a.width!==0&&a.height!==0&&(this._result.width=a.width,this._result.height=Math.ceil(a.height)),this._result}}},4269:function(j,c,y){var _=this&&this.__decorate||function(a,s,i,h){var p,g=arguments.length,C=g<3?s:h===null?h=Object.getOwnPropertyDescriptor(s,i):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(a,s,i,h);else for(var v=a.length-1;v>=0;v--)(p=a[v])&&(C=(g<3?p(C):g>3?p(s,i,C):p(s,i))||C);return g>3&&C&&Object.defineProperty(s,i,C),C},f=this&&this.__param||function(a,s){return function(i,h){s(i,h,a)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharacterJoinerService=c.JoinedCellData=void 0;const d=y(3734),u=y(643),w=y(511),m=y(2585);class n extends d.AttributeData{constructor(s,i,h){super(),this.content=0,this.combinedData="",this.fg=s.fg,this.bg=s.bg,this.combinedData=i,this._width=h}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(s){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.JoinedCellData=n;let t=class gs{constructor(s){this._bufferService=s,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new w.CellData}register(s){const i={id:this._nextCharacterJoinerId++,handler:s};return this._characterJoiners.push(i),i.id}deregister(s){for(let i=0;i<this._characterJoiners.length;i++)if(this._characterJoiners[i].id===s)return this._characterJoiners.splice(i,1),!0;return!1}getJoinedCharacters(s){if(this._characterJoiners.length===0)return[];const i=this._bufferService.buffer.lines.get(s);if(!i||i.length===0)return[];const h=[],p=i.translateToString(!0);let g=0,C=0,v=0,b=i.getFg(0),E=i.getBg(0);for(let A=0;A<i.getTrimmedLength();A++)if(i.loadCell(A,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==b||this._workCell.bg!==E){if(A-g>1){const T=this._getJoinedRanges(p,v,C,i,g);for(let O=0;O<T.length;O++)h.push(T[O])}g=A,v=C,b=this._workCell.fg,E=this._workCell.bg}C+=this._workCell.getChars().length||u.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-g>1){const A=this._getJoinedRanges(p,v,C,i,g);for(let T=0;T<A.length;T++)h.push(A[T])}return h}_getJoinedRanges(s,i,h,p,g){const C=s.substring(i,h);let v=[];try{v=this._characterJoiners[0].handler(C)}catch(b){console.error(b)}for(let b=1;b<this._characterJoiners.length;b++)try{const E=this._characterJoiners[b].handler(C);for(let A=0;A<E.length;A++)gs._mergeRanges(v,E[A])}catch(E){console.error(E)}return this._stringRangesToCellRanges(v,p,g),v}_stringRangesToCellRanges(s,i,h){let p=0,g=!1,C=0,v=s[p];if(v){for(let b=h;b<this._bufferService.cols;b++){const E=i.getWidth(b),A=i.getString(b).length||u.WHITESPACE_CELL_CHAR.length;if(E!==0){if(!g&&v[0]<=C&&(v[0]=b,g=!0),v[1]<=C){if(v[1]=b,v=s[++p],!v)break;v[0]<=C?(v[0]=b,g=!0):g=!1}C+=A}}v&&(v[1]=this._bufferService.cols)}}static _mergeRanges(s,i){let h=!1;for(let p=0;p<s.length;p++){const g=s[p];if(h){if(i[1]<=g[0])return s[p-1][1]=i[1],s;if(i[1]<=g[1])return s[p-1][1]=Math.max(i[1],g[1]),s.splice(p,1),s;s.splice(p,1),p--}else{if(i[1]<=g[0])return s.splice(p,0,i),s;if(i[1]<=g[1])return g[0]=Math.min(i[0],g[0]),s;i[0]<g[1]&&(g[0]=Math.min(i[0],g[0]),h=!0)}}return h?s[s.length-1][1]=i[1]:s.push(i),s}};t=_([f(0,m.IBufferService)],t),c.CharacterJoinerService=t},5114:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreBrowserService=void 0,c.CoreBrowserService=class{constructor(y,_){this._textarea=y,this.window=_,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(j,c,y){var _=this&&this.__decorate||function(m,n,t,a){var s,i=arguments.length,h=i<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,t):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(m,n,t,a);else for(var p=m.length-1;p>=0;p--)(s=m[p])&&(h=(i<3?s(h):i>3?s(n,t,h):s(n,t))||h);return i>3&&h&&Object.defineProperty(n,t,h),h},f=this&&this.__param||function(m,n){return function(t,a){n(t,a,m)}};Object.defineProperty(c,"__esModule",{value:!0}),c.MouseService=void 0;const d=y(4725),u=y(9806);let w=class{constructor(m,n){this._renderService=m,this._charSizeService=n}getCoords(m,n,t,a,s){return(0,u.getCoords)(window,m,n,t,a,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,s)}getMouseReportCoords(m,n){const t=(0,u.getCoordsRelativeToElement)(window,m,n);if(!(!this._charSizeService.hasValidSize||t[0]<0||t[1]<0||t[0]>=this._renderService.dimensions.css.canvas.width||t[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(t[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(t[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(t[0]),y:Math.floor(t[1])}}};w=_([f(0,d.IRenderService),f(1,d.ICharSizeService)],w),c.MouseService=w},3230:function(j,c,y){var _=this&&this.__decorate||function(h,p,g,C){var v,b=arguments.length,E=b<3?p:C===null?C=Object.getOwnPropertyDescriptor(p,g):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(h,p,g,C);else for(var A=h.length-1;A>=0;A--)(v=h[A])&&(E=(b<3?v(E):b>3?v(p,g,E):v(p,g))||E);return b>3&&E&&Object.defineProperty(p,g,E),E},f=this&&this.__param||function(h,p){return function(g,C){p(g,C,h)}};Object.defineProperty(c,"__esModule",{value:!0}),c.RenderService=void 0;const d=y(6193),u=y(8460),w=y(844),m=y(5596),n=y(3656),t=y(2585),a=y(4725),s=y(7226);let i=class extends w.Disposable{constructor(h,p,g,C,v,b,E,A){if(super(),this._rowCount=h,this._charSizeService=C,this._pausedResizeTask=new s.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new u.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new u.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new u.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new u.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var T;return(T=this._renderer)===null||T===void 0?void 0:T.dispose()}}),this._renderDebouncer=new d.RenderDebouncer(E.window,(T,O)=>this._renderRows(T,O)),this.register(this._renderDebouncer),this._screenDprMonitor=new m.ScreenDprMonitor(E.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(b.onResize(()=>this._fullRefresh())),this.register(b.buffers.onBufferActivate(()=>{var T;return(T=this._renderer)===null||T===void 0?void 0:T.clear()})),this.register(g.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(v.onDecorationRegistered(()=>this._fullRefresh())),this.register(v.onDecorationRemoved(()=>this._fullRefresh())),this.register(g.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(b.cols,b.rows),this._fullRefresh()})),this.register(g.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(b.buffer.y,b.buffer.y,!0))),this.register((0,n.addDisposableDomListener)(E.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(A.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in E.window){const T=new E.window.IntersectionObserver(O=>this._handleIntersectionChange(O[O.length-1]),{threshold:0});T.observe(p),this.register({dispose:()=>T.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(h){this._isPaused=h.isIntersecting===void 0?h.intersectionRatio===0:!h.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(h,p,g=!1){this._isPaused?this._needsFullRefresh=!0:(g||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(h,p,this._rowCount))}_renderRows(h,p){this._renderer&&(h=Math.min(h,this._rowCount-1),p=Math.min(p,this._rowCount-1),this._renderer.renderRows(h,p),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:h,end:p}),this._onRender.fire({start:h,end:p}),this._isNextRenderRedrawOnly=!0)}resize(h,p){this._rowCount=p,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(h){var p;(p=this._renderer)===null||p===void 0||p.dispose(),this._renderer=h,this._renderer.onRequestRedraw(g=>this.refreshRows(g.start,g.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(h){return this._renderDebouncer.addRefreshCallback(h)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var h,p;this._renderer&&((p=(h=this._renderer).clearTextureAtlas)===null||p===void 0||p.call(h),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(h,p){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(h,p)):this._renderer.handleResize(h,p),this._fullRefresh())}handleCharSizeChanged(){var h;(h=this._renderer)===null||h===void 0||h.handleCharSizeChanged()}handleBlur(){var h;(h=this._renderer)===null||h===void 0||h.handleBlur()}handleFocus(){var h;(h=this._renderer)===null||h===void 0||h.handleFocus()}handleSelectionChanged(h,p,g){var C;this._selectionState.start=h,this._selectionState.end=p,this._selectionState.columnSelectMode=g,(C=this._renderer)===null||C===void 0||C.handleSelectionChanged(h,p,g)}handleCursorMove(){var h;(h=this._renderer)===null||h===void 0||h.handleCursorMove()}clear(){var h;(h=this._renderer)===null||h===void 0||h.clear()}};i=_([f(2,t.IOptionsService),f(3,a.ICharSizeService),f(4,t.IDecorationService),f(5,t.IBufferService),f(6,a.ICoreBrowserService),f(7,a.IThemeService)],i),c.RenderService=i},9312:function(j,c,y){var _=this&&this.__decorate||function(v,b,E,A){var T,O=arguments.length,H=O<3?b:A===null?A=Object.getOwnPropertyDescriptor(b,E):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(v,b,E,A);else for(var M=v.length-1;M>=0;M--)(T=v[M])&&(H=(O<3?T(H):O>3?T(b,E,H):T(b,E))||H);return O>3&&H&&Object.defineProperty(b,E,H),H},f=this&&this.__param||function(v,b){return function(E,A){b(E,A,v)}};Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionService=void 0;const d=y(6114),u=y(456),w=y(511),m=y(8460),n=y(4725),t=y(2585),a=y(9806),s=y(9504),i=y(844),h=y(4841),p=String.fromCharCode(160),g=new RegExp(p,"g");let C=class extends i.Disposable{constructor(v,b,E,A,T,O,H,M,N){super(),this._element=v,this._screenElement=b,this._linkifier=E,this._bufferService=A,this._coreService=T,this._mouseService=O,this._optionsService=H,this._renderService=M,this._coreBrowserService=N,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new w.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new m.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new m.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new m.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=L=>this._handleMouseMove(L),this._mouseUpListener=L=>this._handleMouseUp(L),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(L=>this._handleTrim(L)),this.register(this._bufferService.buffers.onBufferActivate(L=>this._handleBufferActivate(L))),this.enable(),this._model=new u.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,i.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const v=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;return!(!v||!b||v[0]===b[0]&&v[1]===b[1])}get selectionText(){const v=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;if(!v||!b)return"";const E=this._bufferService.buffer,A=[];if(this._activeSelectionMode===3){if(v[0]===b[0])return"";const T=v[0]<b[0]?v[0]:b[0],O=v[0]<b[0]?b[0]:v[0];for(let H=v[1];H<=b[1];H++){const M=E.translateBufferLineToString(H,!0,T,O);A.push(M)}}else{const T=v[1]===b[1]?b[0]:void 0;A.push(E.translateBufferLineToString(v[1],!0,v[0],T));for(let O=v[1]+1;O<=b[1]-1;O++){const H=E.lines.get(O),M=E.translateBufferLineToString(O,!0);H!=null&&H.isWrapped?A[A.length-1]+=M:A.push(M)}if(v[1]!==b[1]){const O=E.lines.get(b[1]),H=E.translateBufferLineToString(b[1],!0,0,b[0]);O&&O.isWrapped?A[A.length-1]+=H:A.push(H)}}return A.map(T=>T.replace(g," ")).join(d.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(v){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),d.isLinux&&v&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(v){const b=this._getMouseBufferCoords(v),E=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!!(E&&A&&b)&&this._areCoordsInSelection(b,E,A)}isCellInSelection(v,b){const E=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!(!E||!A)&&this._areCoordsInSelection([v,b],E,A)}_areCoordsInSelection(v,b,E){return v[1]>b[1]&&v[1]<E[1]||b[1]===E[1]&&v[1]===b[1]&&v[0]>=b[0]&&v[0]<E[0]||b[1]<E[1]&&v[1]===E[1]&&v[0]<E[0]||b[1]<E[1]&&v[1]===b[1]&&v[0]>=b[0]}_selectWordAtCursor(v,b){var E,A;const T=(A=(E=this._linkifier.currentLink)===null||E===void 0?void 0:E.link)===null||A===void 0?void 0:A.range;if(T)return this._model.selectionStart=[T.start.x-1,T.start.y-1],this._model.selectionStartLength=(0,h.getRangeLength)(T,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const O=this._getMouseBufferCoords(v);return!!O&&(this._selectWordAt(O,b),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(v,b){this._model.clearSelection(),v=Math.max(v,0),b=Math.min(b,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,v],this._model.selectionEnd=[this._bufferService.cols,b],this.refresh(),this._onSelectionChange.fire()}_handleTrim(v){this._model.handleTrim(v)&&this.refresh()}_getMouseBufferCoords(v){const b=this._mouseService.getCoords(v,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(b)return b[0]--,b[1]--,b[1]+=this._bufferService.buffer.ydisp,b}_getMouseEventScrollAmount(v){let b=(0,a.getCoordsRelativeToElement)(this._coreBrowserService.window,v,this._screenElement)[1];const E=this._renderService.dimensions.css.canvas.height;return b>=0&&b<=E?0:(b>E&&(b-=E),b=Math.min(Math.max(b,-50),50),b/=50,b/Math.abs(b)+Math.round(14*b))}shouldForceSelection(v){return d.isMac?v.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:v.shiftKey}handleMouseDown(v){if(this._mouseDownTimeStamp=v.timeStamp,(v.button!==2||!this.hasSelection)&&v.button===0){if(!this._enabled){if(!this.shouldForceSelection(v))return;v.stopPropagation()}v.preventDefault(),this._dragScrollAmount=0,this._enabled&&v.shiftKey?this._handleIncrementalClick(v):v.detail===1?this._handleSingleClick(v):v.detail===2?this._handleDoubleClick(v):v.detail===3&&this._handleTripleClick(v),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(v){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(v))}_handleSingleClick(v){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(v)?3:0,this._model.selectionStart=this._getMouseBufferCoords(v),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const b=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);b&&b.length!==this._model.selectionStart[0]&&b.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(v){this._selectWordAtCursor(v,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(v){const b=this._getMouseBufferCoords(v);b&&(this._activeSelectionMode=2,this._selectLineAt(b[1]))}shouldColumnSelect(v){return v.altKey&&!(d.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(v){if(v.stopImmediatePropagation(),!this._model.selectionStart)return;const b=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(v),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(v),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const E=this._bufferService.buffer;if(this._model.selectionEnd[1]<E.lines.length){const A=E.lines.get(this._model.selectionEnd[1]);A&&A.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}b&&b[0]===this._model.selectionEnd[0]&&b[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const v=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(v.ydisp+this._bufferService.rows,v.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=v.ydisp),this.refresh()}}_handleMouseUp(v){const b=v.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&b<500&&v.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const E=this._mouseService.getCoords(v,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(E&&E[0]!==void 0&&E[1]!==void 0){const A=(0,s.moveToCellSequence)(E[0]-1,E[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(A,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const v=this._model.finalSelectionStart,b=this._model.finalSelectionEnd,E=!(!v||!b||v[0]===b[0]&&v[1]===b[1]);E?v&&b&&(this._oldSelectionStart&&this._oldSelectionEnd&&v[0]===this._oldSelectionStart[0]&&v[1]===this._oldSelectionStart[1]&&b[0]===this._oldSelectionEnd[0]&&b[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(v,b,E)):this._oldHasSelection&&this._fireOnSelectionChange(v,b,E)}_fireOnSelectionChange(v,b,E){this._oldSelectionStart=v,this._oldSelectionEnd=b,this._oldHasSelection=E,this._onSelectionChange.fire()}_handleBufferActivate(v){this.clearSelection(),this._trimListener.dispose(),this._trimListener=v.activeBuffer.lines.onTrim(b=>this._handleTrim(b))}_convertViewportColToCharacterIndex(v,b){let E=b;for(let A=0;b>=A;A++){const T=v.loadCell(A,this._workCell).getChars().length;this._workCell.getWidth()===0?E--:T>1&&b!==A&&(E+=T-1)}return E}setSelection(v,b,E){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[v,b],this._model.selectionStartLength=E,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(v){this._isClickInSelection(v)||(this._selectWordAtCursor(v,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(v,b,E=!0,A=!0){if(v[0]>=this._bufferService.cols)return;const T=this._bufferService.buffer,O=T.lines.get(v[1]);if(!O)return;const H=T.translateBufferLineToString(v[1],!1);let M=this._convertViewportColToCharacterIndex(O,v[0]),N=M;const L=v[0]-M;let B=0,I=0,P=0,Z=0;if(H.charAt(M)===" "){for(;M>0&&H.charAt(M-1)===" ";)M--;for(;N<H.length&&H.charAt(N+1)===" ";)N++}else{let V=v[0],ie=v[0];O.getWidth(V)===0&&(B++,V--),O.getWidth(ie)===2&&(I++,ie++);const z=O.getString(ie).length;for(z>1&&(Z+=z-1,N+=z-1);V>0&&M>0&&!this._isCharWordSeparator(O.loadCell(V-1,this._workCell));){O.loadCell(V-1,this._workCell);const $=this._workCell.getChars().length;this._workCell.getWidth()===0?(B++,V--):$>1&&(P+=$-1,M-=$-1),M--,V--}for(;ie<O.length&&N+1<H.length&&!this._isCharWordSeparator(O.loadCell(ie+1,this._workCell));){O.loadCell(ie+1,this._workCell);const $=this._workCell.getChars().length;this._workCell.getWidth()===2?(I++,ie++):$>1&&(Z+=$-1,N+=$-1),N++,ie++}}N++;let G=M+L-B+P,X=Math.min(this._bufferService.cols,N-M+B+I-P-Z);if(b||H.slice(M,N).trim()!==""){if(E&&G===0&&O.getCodePoint(0)!==32){const V=T.lines.get(v[1]-1);if(V&&O.isWrapped&&V.getCodePoint(this._bufferService.cols-1)!==32){const ie=this._getWordAt([this._bufferService.cols-1,v[1]-1],!1,!0,!1);if(ie){const z=this._bufferService.cols-ie.start;G-=z,X+=z}}}if(A&&G+X===this._bufferService.cols&&O.getCodePoint(this._bufferService.cols-1)!==32){const V=T.lines.get(v[1]+1);if(V!=null&&V.isWrapped&&V.getCodePoint(0)!==32){const ie=this._getWordAt([0,v[1]+1],!1,!1,!0);ie&&(X+=ie.length)}}return{start:G,length:X}}}_selectWordAt(v,b){const E=this._getWordAt(v,b);if(E){for(;E.start<0;)E.start+=this._bufferService.cols,v[1]--;this._model.selectionStart=[E.start,v[1]],this._model.selectionStartLength=E.length}}_selectToWordAt(v){const b=this._getWordAt(v,!0);if(b){let E=v[1];for(;b.start<0;)b.start+=this._bufferService.cols,E--;if(!this._model.areSelectionValuesReversed())for(;b.start+b.length>this._bufferService.cols;)b.length-=this._bufferService.cols,E++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?b.start:b.start+b.length,E]}}_isCharWordSeparator(v){return v.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(v.getChars())>=0}_selectLineAt(v){const b=this._bufferService.buffer.getWrappedRangeForLine(v),E={start:{x:0,y:b.first},end:{x:this._bufferService.cols-1,y:b.last}};this._model.selectionStart=[0,b.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,h.getRangeLength)(E,this._bufferService.cols)}};C=_([f(3,t.IBufferService),f(4,t.ICoreService),f(5,n.IMouseService),f(6,t.IOptionsService),f(7,n.IRenderService),f(8,n.ICoreBrowserService)],C),c.SelectionService=C},4725:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IThemeService=c.ICharacterJoinerService=c.ISelectionService=c.IRenderService=c.IMouseService=c.ICoreBrowserService=c.ICharSizeService=void 0;const _=y(8343);c.ICharSizeService=(0,_.createDecorator)("CharSizeService"),c.ICoreBrowserService=(0,_.createDecorator)("CoreBrowserService"),c.IMouseService=(0,_.createDecorator)("MouseService"),c.IRenderService=(0,_.createDecorator)("RenderService"),c.ISelectionService=(0,_.createDecorator)("SelectionService"),c.ICharacterJoinerService=(0,_.createDecorator)("CharacterJoinerService"),c.IThemeService=(0,_.createDecorator)("ThemeService")},6731:function(j,c,y){var _=this&&this.__decorate||function(C,v,b,E){var A,T=arguments.length,O=T<3?v:E===null?E=Object.getOwnPropertyDescriptor(v,b):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(C,v,b,E);else for(var H=C.length-1;H>=0;H--)(A=C[H])&&(O=(T<3?A(O):T>3?A(v,b,O):A(v,b))||O);return T>3&&O&&Object.defineProperty(v,b,O),O},f=this&&this.__param||function(C,v){return function(b,E){v(b,E,C)}};Object.defineProperty(c,"__esModule",{value:!0}),c.ThemeService=c.DEFAULT_ANSI_COLORS=void 0;const d=y(7239),u=y(8055),w=y(8460),m=y(844),n=y(2585),t=u.css.toColor("#ffffff"),a=u.css.toColor("#000000"),s=u.css.toColor("#ffffff"),i=u.css.toColor("#000000"),h={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};c.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const C=[u.css.toColor("#2e3436"),u.css.toColor("#cc0000"),u.css.toColor("#4e9a06"),u.css.toColor("#c4a000"),u.css.toColor("#3465a4"),u.css.toColor("#75507b"),u.css.toColor("#06989a"),u.css.toColor("#d3d7cf"),u.css.toColor("#555753"),u.css.toColor("#ef2929"),u.css.toColor("#8ae234"),u.css.toColor("#fce94f"),u.css.toColor("#729fcf"),u.css.toColor("#ad7fa8"),u.css.toColor("#34e2e2"),u.css.toColor("#eeeeec")],v=[0,95,135,175,215,255];for(let b=0;b<216;b++){const E=v[b/36%6|0],A=v[b/6%6|0],T=v[b%6];C.push({css:u.channels.toCss(E,A,T),rgba:u.channels.toRgba(E,A,T)})}for(let b=0;b<24;b++){const E=8+10*b;C.push({css:u.channels.toCss(E,E,E),rgba:u.channels.toRgba(E,E,E)})}return C})());let p=class extends m.Disposable{constructor(C){super(),this._optionsService=C,this._onChangeColors=this.register(new w.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new d.ColorContrastCache,this._colors={foreground:t,background:a,cursor:s,cursorAccent:i,selectionForeground:void 0,selectionBackgroundTransparent:h,selectionBackgroundOpaque:u.color.blend(a,h),selectionInactiveBackgroundTransparent:h,selectionInactiveBackgroundOpaque:u.color.blend(a,h),ansi:c.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(C={}){const v=this._colors;if(v.foreground=g(C.foreground,t),v.background=g(C.background,a),v.cursor=g(C.cursor,s),v.cursorAccent=g(C.cursorAccent,i),v.selectionBackgroundTransparent=g(C.selectionBackground,h),v.selectionBackgroundOpaque=u.color.blend(v.background,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundTransparent=g(C.selectionInactiveBackground,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundOpaque=u.color.blend(v.background,v.selectionInactiveBackgroundTransparent),v.selectionForeground=C.selectionForeground?g(C.selectionForeground,u.NULL_COLOR):void 0,v.selectionForeground===u.NULL_COLOR&&(v.selectionForeground=void 0),u.color.isOpaque(v.selectionBackgroundTransparent)&&(v.selectionBackgroundTransparent=u.color.opacity(v.selectionBackgroundTransparent,.3)),u.color.isOpaque(v.selectionInactiveBackgroundTransparent)&&(v.selectionInactiveBackgroundTransparent=u.color.opacity(v.selectionInactiveBackgroundTransparent,.3)),v.ansi=c.DEFAULT_ANSI_COLORS.slice(),v.ansi[0]=g(C.black,c.DEFAULT_ANSI_COLORS[0]),v.ansi[1]=g(C.red,c.DEFAULT_ANSI_COLORS[1]),v.ansi[2]=g(C.green,c.DEFAULT_ANSI_COLORS[2]),v.ansi[3]=g(C.yellow,c.DEFAULT_ANSI_COLORS[3]),v.ansi[4]=g(C.blue,c.DEFAULT_ANSI_COLORS[4]),v.ansi[5]=g(C.magenta,c.DEFAULT_ANSI_COLORS[5]),v.ansi[6]=g(C.cyan,c.DEFAULT_ANSI_COLORS[6]),v.ansi[7]=g(C.white,c.DEFAULT_ANSI_COLORS[7]),v.ansi[8]=g(C.brightBlack,c.DEFAULT_ANSI_COLORS[8]),v.ansi[9]=g(C.brightRed,c.DEFAULT_ANSI_COLORS[9]),v.ansi[10]=g(C.brightGreen,c.DEFAULT_ANSI_COLORS[10]),v.ansi[11]=g(C.brightYellow,c.DEFAULT_ANSI_COLORS[11]),v.ansi[12]=g(C.brightBlue,c.DEFAULT_ANSI_COLORS[12]),v.ansi[13]=g(C.brightMagenta,c.DEFAULT_ANSI_COLORS[13]),v.ansi[14]=g(C.brightCyan,c.DEFAULT_ANSI_COLORS[14]),v.ansi[15]=g(C.brightWhite,c.DEFAULT_ANSI_COLORS[15]),C.extendedAnsi){const b=Math.min(v.ansi.length-16,C.extendedAnsi.length);for(let E=0;E<b;E++)v.ansi[E+16]=g(C.extendedAnsi[E],c.DEFAULT_ANSI_COLORS[E+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(C){this._restoreColor(C),this._onChangeColors.fire(this.colors)}_restoreColor(C){if(C!==void 0)switch(C){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[C]=this._restoreColors.ansi[C]}else for(let v=0;v<this._restoreColors.ansi.length;++v)this._colors.ansi[v]=this._restoreColors.ansi[v]}modifyColors(C){C(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function g(C,v){if(C!==void 0)try{return u.css.toColor(C)}catch{}return v}p=_([f(0,n.IOptionsService)],p),c.ThemeService=p},6349:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CircularList=void 0;const _=y(8460),f=y(844);class d extends f.Disposable{constructor(w){super(),this._maxLength=w,this.onDeleteEmitter=this.register(new _.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new _.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new _.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(w){if(this._maxLength===w)return;const m=new Array(w);for(let n=0;n<Math.min(w,this.length);n++)m[n]=this._array[this._getCyclicIndex(n)];this._array=m,this._maxLength=w,this._startIndex=0}get length(){return this._length}set length(w){if(w>this._length)for(let m=this._length;m<w;m++)this._array[m]=void 0;this._length=w}get(w){return this._array[this._getCyclicIndex(w)]}set(w,m){this._array[this._getCyclicIndex(w)]=m}push(w){this._array[this._getCyclicIndex(this._length)]=w,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(w,m,...n){if(m){for(let t=w;t<this._length-m;t++)this._array[this._getCyclicIndex(t)]=this._array[this._getCyclicIndex(t+m)];this._length-=m,this.onDeleteEmitter.fire({index:w,amount:m})}for(let t=this._length-1;t>=w;t--)this._array[this._getCyclicIndex(t+n.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<n.length;t++)this._array[this._getCyclicIndex(w+t)]=n[t];if(n.length&&this.onInsertEmitter.fire({index:w,amount:n.length}),this._length+n.length>this._maxLength){const t=this._length+n.length-this._maxLength;this._startIndex+=t,this._length=this._maxLength,this.onTrimEmitter.fire(t)}else this._length+=n.length}trimStart(w){w>this._length&&(w=this._length),this._startIndex+=w,this._length-=w,this.onTrimEmitter.fire(w)}shiftElements(w,m,n){if(!(m<=0)){if(w<0||w>=this._length)throw new Error("start argument out of range");if(w+n<0)throw new Error("Cannot shift elements in list beyond index 0");if(n>0){for(let a=m-1;a>=0;a--)this.set(w+a+n,this.get(w+a));const t=w+m+n-this._length;if(t>0)for(this._length+=t;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let t=0;t<m;t++)this.set(w+t+n,this.get(w+t))}}_getCyclicIndex(w){return(this._startIndex+w)%this._maxLength}}c.CircularList=d},1439:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.clone=void 0,c.clone=function y(_,f=5){if(typeof _!="object")return _;const d=Array.isArray(_)?[]:{};for(const u in _)d[u]=f<=1?_[u]:_[u]&&y(_[u],f-1);return d}},8055:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.contrastRatio=c.toPaddedHex=c.rgba=c.rgb=c.css=c.color=c.channels=c.NULL_COLOR=void 0;const _=y(6114);let f=0,d=0,u=0,w=0;var m,n,t;function a(i){const h=i.toString(16);return h.length<2?"0"+h:h}function s(i,h){return i<h?(h+.05)/(i+.05):(i+.05)/(h+.05)}c.NULL_COLOR={css:"#00000000",rgba:0},function(i){i.toCss=function(h,p,g,C){return C!==void 0?`#${a(h)}${a(p)}${a(g)}${a(C)}`:`#${a(h)}${a(p)}${a(g)}`},i.toRgba=function(h,p,g,C=255){return(h<<24|p<<16|g<<8|C)>>>0}}(m=c.channels||(c.channels={})),function(i){function h(p,g){return w=Math.round(255*g),[f,d,u]=t.toChannels(p.rgba),{css:m.toCss(f,d,u,w),rgba:m.toRgba(f,d,u,w)}}i.blend=function(p,g){if(w=(255&g.rgba)/255,w===1)return{css:g.css,rgba:g.rgba};const C=g.rgba>>24&255,v=g.rgba>>16&255,b=g.rgba>>8&255,E=p.rgba>>24&255,A=p.rgba>>16&255,T=p.rgba>>8&255;return f=E+Math.round((C-E)*w),d=A+Math.round((v-A)*w),u=T+Math.round((b-T)*w),{css:m.toCss(f,d,u),rgba:m.toRgba(f,d,u)}},i.isOpaque=function(p){return(255&p.rgba)==255},i.ensureContrastRatio=function(p,g,C){const v=t.ensureContrastRatio(p.rgba,g.rgba,C);if(v)return t.toColor(v>>24&255,v>>16&255,v>>8&255)},i.opaque=function(p){const g=(255|p.rgba)>>>0;return[f,d,u]=t.toChannels(g),{css:m.toCss(f,d,u),rgba:g}},i.opacity=h,i.multiplyOpacity=function(p,g){return w=255&p.rgba,h(p,w*g/255)},i.toColorRGB=function(p){return[p.rgba>>24&255,p.rgba>>16&255,p.rgba>>8&255]}}(c.color||(c.color={})),function(i){let h,p;if(!_.isNode){const g=document.createElement("canvas");g.width=1,g.height=1;const C=g.getContext("2d",{willReadFrequently:!0});C&&(h=C,h.globalCompositeOperation="copy",p=h.createLinearGradient(0,0,1,1))}i.toColor=function(g){if(g.match(/#[\da-f]{3,8}/i))switch(g.length){case 4:return f=parseInt(g.slice(1,2).repeat(2),16),d=parseInt(g.slice(2,3).repeat(2),16),u=parseInt(g.slice(3,4).repeat(2),16),t.toColor(f,d,u);case 5:return f=parseInt(g.slice(1,2).repeat(2),16),d=parseInt(g.slice(2,3).repeat(2),16),u=parseInt(g.slice(3,4).repeat(2),16),w=parseInt(g.slice(4,5).repeat(2),16),t.toColor(f,d,u,w);case 7:return{css:g,rgba:(parseInt(g.slice(1),16)<<8|255)>>>0};case 9:return{css:g,rgba:parseInt(g.slice(1),16)>>>0}}const C=g.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(C)return f=parseInt(C[1]),d=parseInt(C[2]),u=parseInt(C[3]),w=Math.round(255*(C[5]===void 0?1:parseFloat(C[5]))),t.toColor(f,d,u,w);if(!h||!p)throw new Error("css.toColor: Unsupported css format");if(h.fillStyle=p,h.fillStyle=g,typeof h.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(h.fillRect(0,0,1,1),[f,d,u,w]=h.getImageData(0,0,1,1).data,w!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:m.toRgba(f,d,u,w),css:g}}}(c.css||(c.css={})),function(i){function h(p,g,C){const v=p/255,b=g/255,E=C/255;return .2126*(v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4))+.7152*(b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4))+.0722*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))}i.relativeLuminance=function(p){return h(p>>16&255,p>>8&255,255&p)},i.relativeLuminance2=h}(n=c.rgb||(c.rgb={})),function(i){function h(g,C,v){const b=g>>24&255,E=g>>16&255,A=g>>8&255;let T=C>>24&255,O=C>>16&255,H=C>>8&255,M=s(n.relativeLuminance2(T,O,H),n.relativeLuminance2(b,E,A));for(;M<v&&(T>0||O>0||H>0);)T-=Math.max(0,Math.ceil(.1*T)),O-=Math.max(0,Math.ceil(.1*O)),H-=Math.max(0,Math.ceil(.1*H)),M=s(n.relativeLuminance2(T,O,H),n.relativeLuminance2(b,E,A));return(T<<24|O<<16|H<<8|255)>>>0}function p(g,C,v){const b=g>>24&255,E=g>>16&255,A=g>>8&255;let T=C>>24&255,O=C>>16&255,H=C>>8&255,M=s(n.relativeLuminance2(T,O,H),n.relativeLuminance2(b,E,A));for(;M<v&&(T<255||O<255||H<255);)T=Math.min(255,T+Math.ceil(.1*(255-T))),O=Math.min(255,O+Math.ceil(.1*(255-O))),H=Math.min(255,H+Math.ceil(.1*(255-H))),M=s(n.relativeLuminance2(T,O,H),n.relativeLuminance2(b,E,A));return(T<<24|O<<16|H<<8|255)>>>0}i.ensureContrastRatio=function(g,C,v){const b=n.relativeLuminance(g>>8),E=n.relativeLuminance(C>>8);if(s(b,E)<v){if(E<b){const O=h(g,C,v),H=s(b,n.relativeLuminance(O>>8));if(H<v){const M=p(g,C,v);return H>s(b,n.relativeLuminance(M>>8))?O:M}return O}const A=p(g,C,v),T=s(b,n.relativeLuminance(A>>8));if(T<v){const O=h(g,C,v);return T>s(b,n.relativeLuminance(O>>8))?A:O}return A}},i.reduceLuminance=h,i.increaseLuminance=p,i.toChannels=function(g){return[g>>24&255,g>>16&255,g>>8&255,255&g]},i.toColor=function(g,C,v,b){return{css:m.toCss(g,C,v,b),rgba:m.toRgba(g,C,v,b)}}}(t=c.rgba||(c.rgba={})),c.toPaddedHex=a,c.contrastRatio=s},8969:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreTerminal=void 0;const _=y(844),f=y(2585),d=y(4348),u=y(7866),w=y(744),m=y(7302),n=y(6975),t=y(8460),a=y(1753),s=y(1480),i=y(7994),h=y(9282),p=y(5435),g=y(5981),C=y(2660);let v=!1;class b extends _.Disposable{constructor(A){super(),this._onBinary=this.register(new t.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new t.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new t.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new t.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new t.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new t.EventEmitter),this._instantiationService=new d.InstantiationService,this.optionsService=this.register(new m.OptionsService(A)),this._instantiationService.setService(f.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(w.BufferService)),this._instantiationService.setService(f.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(u.LogService)),this._instantiationService.setService(f.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(n.CoreService)),this._instantiationService.setService(f.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(a.CoreMouseService)),this._instantiationService.setService(f.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(s.UnicodeService)),this._instantiationService.setService(f.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(i.CharsetService),this._instantiationService.setService(f.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(C.OscLinkService),this._instantiationService.setService(f.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new p.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,t.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,t.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,t.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,t.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",T=>this._handleWindowsModeOptionChange(T))),this.register(this._bufferService.onScroll(T=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(T=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new g.WriteBuffer((T,O)=>this._inputHandler.parse(T,O))),this.register((0,t.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,_.toDisposable)(()=>{var T;(T=this._windowsMode)===null||T===void 0||T.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new t.EventEmitter),this._onScroll.event(A=>{var T;(T=this._onScrollApi)===null||T===void 0||T.fire(A.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(A){for(const T in A)this.optionsService.options[T]=A[T]}write(A,T){this._writeBuffer.write(A,T)}writeSync(A,T){this._logService.logLevel<=f.LogLevelEnum.WARN&&!v&&(this._logService.warn("writeSync is unreliable and will be removed soon."),v=!0),this._writeBuffer.writeSync(A,T)}resize(A,T){isNaN(A)||isNaN(T)||(A=Math.max(A,w.MINIMUM_COLS),T=Math.max(T,w.MINIMUM_ROWS),this._bufferService.resize(A,T))}scroll(A,T=!1){this._bufferService.scroll(A,T)}scrollLines(A,T,O){this._bufferService.scrollLines(A,T,O)}scrollPages(A){this._bufferService.scrollPages(A)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(A){this._bufferService.scrollToLine(A)}registerEscHandler(A,T){return this._inputHandler.registerEscHandler(A,T)}registerDcsHandler(A,T){return this._inputHandler.registerDcsHandler(A,T)}registerCsiHandler(A,T){return this._inputHandler.registerCsiHandler(A,T)}registerOscHandler(A,T){return this._inputHandler.registerOscHandler(A,T)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(A){var T;A?this._enableWindowsMode():((T=this._windowsMode)===null||T===void 0||T.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){const A=[];A.push(this.onLineFeed(h.updateWindowsModeWrappedState.bind(null,this._bufferService))),A.push(this.registerCsiHandler({final:"H"},()=>((0,h.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsMode={dispose:()=>{for(const T of A)T.dispose()}}}}}c.CoreTerminal=b},8460:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=y=>(this._listeners.push(y),{dispose:()=>{if(!this._disposed){for(let _=0;_<this._listeners.length;_++)if(this._listeners[_]===y)return void this._listeners.splice(_,1)}}})),this._event}fire(y,_){const f=[];for(let d=0;d<this._listeners.length;d++)f.push(this._listeners[d]);for(let d=0;d<f.length;d++)f[d].call(void 0,y,_)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(y,_){return y(f=>_.fire(f))}},5435:function(j,c,y){var _=this&&this.__decorate||function(N,L,B,I){var P,Z=arguments.length,G=Z<3?L:I===null?I=Object.getOwnPropertyDescriptor(L,B):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")G=Reflect.decorate(N,L,B,I);else for(var X=N.length-1;X>=0;X--)(P=N[X])&&(G=(Z<3?P(G):Z>3?P(L,B,G):P(L,B))||G);return Z>3&&G&&Object.defineProperty(L,B,G),G},f=this&&this.__param||function(N,L){return function(B,I){L(B,I,N)}};Object.defineProperty(c,"__esModule",{value:!0}),c.InputHandler=c.WindowsOptionsReportType=void 0;const d=y(2584),u=y(7116),w=y(2015),m=y(844),n=y(482),t=y(8437),a=y(8460),s=y(643),i=y(511),h=y(3734),p=y(2585),g=y(6242),C=y(6351),v=y(5941),b={"(":0,")":1,"*":2,"+":3,"-":1,".":2},E=131072;function A(N,L){if(N>24)return L.setWinLines||!1;switch(N){case 1:return!!L.restoreWin;case 2:return!!L.minimizeWin;case 3:return!!L.setWinPosition;case 4:return!!L.setWinSizePixels;case 5:return!!L.raiseWin;case 6:return!!L.lowerWin;case 7:return!!L.refreshWin;case 8:return!!L.setWinSizeChars;case 9:return!!L.maximizeWin;case 10:return!!L.fullscreenWin;case 11:return!!L.getWinState;case 13:return!!L.getWinPosition;case 14:return!!L.getWinSizePixels;case 15:return!!L.getScreenSizePixels;case 16:return!!L.getCellSizePixels;case 18:return!!L.getWinSizeChars;case 19:return!!L.getScreenSizeChars;case 20:return!!L.getIconTitle;case 21:return!!L.getWinTitle;case 22:return!!L.pushTitle;case 23:return!!L.popTitle;case 24:return!!L.setWinLines}return!1}var T;(function(N){N[N.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",N[N.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(T=c.WindowsOptionsReportType||(c.WindowsOptionsReportType={}));let O=0;class H extends m.Disposable{constructor(L,B,I,P,Z,G,X,V,ie=new w.EscapeSequenceParser){super(),this._bufferService=L,this._charsetService=B,this._coreService=I,this._logService=P,this._optionsService=Z,this._oscLinkService=G,this._coreMouseService=X,this._unicodeService=V,this._parser=ie,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new n.StringToUtf32,this._utf8Decoder=new n.Utf8ToUtf32,this._workCell=new i.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new a.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new a.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new a.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new a.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new a.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new a.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new a.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new a.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new a.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new a.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new a.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new a.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new M(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(z=>this._activeBuffer=z.activeBuffer)),this._parser.setCsiHandlerFallback((z,$)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(z),params:$.toArray()})}),this._parser.setEscHandlerFallback(z=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(z)})}),this._parser.setExecuteHandlerFallback(z=>{this._logService.debug("Unknown EXECUTE code: ",{code:z})}),this._parser.setOscHandlerFallback((z,$,W)=>{this._logService.debug("Unknown OSC code: ",{identifier:z,action:$,data:W})}),this._parser.setDcsHandlerFallback((z,$,W)=>{$==="HOOK"&&(W=W.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(z),action:$,payload:W})}),this._parser.setPrintHandler((z,$,W)=>this.print(z,$,W)),this._parser.registerCsiHandler({final:"@"},z=>this.insertChars(z)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},z=>this.scrollLeft(z)),this._parser.registerCsiHandler({final:"A"},z=>this.cursorUp(z)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},z=>this.scrollRight(z)),this._parser.registerCsiHandler({final:"B"},z=>this.cursorDown(z)),this._parser.registerCsiHandler({final:"C"},z=>this.cursorForward(z)),this._parser.registerCsiHandler({final:"D"},z=>this.cursorBackward(z)),this._parser.registerCsiHandler({final:"E"},z=>this.cursorNextLine(z)),this._parser.registerCsiHandler({final:"F"},z=>this.cursorPrecedingLine(z)),this._parser.registerCsiHandler({final:"G"},z=>this.cursorCharAbsolute(z)),this._parser.registerCsiHandler({final:"H"},z=>this.cursorPosition(z)),this._parser.registerCsiHandler({final:"I"},z=>this.cursorForwardTab(z)),this._parser.registerCsiHandler({final:"J"},z=>this.eraseInDisplay(z,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},z=>this.eraseInDisplay(z,!0)),this._parser.registerCsiHandler({final:"K"},z=>this.eraseInLine(z,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},z=>this.eraseInLine(z,!0)),this._parser.registerCsiHandler({final:"L"},z=>this.insertLines(z)),this._parser.registerCsiHandler({final:"M"},z=>this.deleteLines(z)),this._parser.registerCsiHandler({final:"P"},z=>this.deleteChars(z)),this._parser.registerCsiHandler({final:"S"},z=>this.scrollUp(z)),this._parser.registerCsiHandler({final:"T"},z=>this.scrollDown(z)),this._parser.registerCsiHandler({final:"X"},z=>this.eraseChars(z)),this._parser.registerCsiHandler({final:"Z"},z=>this.cursorBackwardTab(z)),this._parser.registerCsiHandler({final:"`"},z=>this.charPosAbsolute(z)),this._parser.registerCsiHandler({final:"a"},z=>this.hPositionRelative(z)),this._parser.registerCsiHandler({final:"b"},z=>this.repeatPrecedingCharacter(z)),this._parser.registerCsiHandler({final:"c"},z=>this.sendDeviceAttributesPrimary(z)),this._parser.registerCsiHandler({prefix:">",final:"c"},z=>this.sendDeviceAttributesSecondary(z)),this._parser.registerCsiHandler({final:"d"},z=>this.linePosAbsolute(z)),this._parser.registerCsiHandler({final:"e"},z=>this.vPositionRelative(z)),this._parser.registerCsiHandler({final:"f"},z=>this.hVPosition(z)),this._parser.registerCsiHandler({final:"g"},z=>this.tabClear(z)),this._parser.registerCsiHandler({final:"h"},z=>this.setMode(z)),this._parser.registerCsiHandler({prefix:"?",final:"h"},z=>this.setModePrivate(z)),this._parser.registerCsiHandler({final:"l"},z=>this.resetMode(z)),this._parser.registerCsiHandler({prefix:"?",final:"l"},z=>this.resetModePrivate(z)),this._parser.registerCsiHandler({final:"m"},z=>this.charAttributes(z)),this._parser.registerCsiHandler({final:"n"},z=>this.deviceStatus(z)),this._parser.registerCsiHandler({prefix:"?",final:"n"},z=>this.deviceStatusPrivate(z)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},z=>this.softReset(z)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},z=>this.setCursorStyle(z)),this._parser.registerCsiHandler({final:"r"},z=>this.setScrollRegion(z)),this._parser.registerCsiHandler({final:"s"},z=>this.saveCursor(z)),this._parser.registerCsiHandler({final:"t"},z=>this.windowOptions(z)),this._parser.registerCsiHandler({final:"u"},z=>this.restoreCursor(z)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},z=>this.insertColumns(z)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},z=>this.deleteColumns(z)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},z=>this.selectProtected(z)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},z=>this.requestMode(z,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},z=>this.requestMode(z,!1)),this._parser.setExecuteHandler(d.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(d.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(d.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(d.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(d.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(d.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(d.C1.IND,()=>this.index()),this._parser.setExecuteHandler(d.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(d.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new g.OscHandler(z=>(this.setTitle(z),this.setIconName(z),!0))),this._parser.registerOscHandler(1,new g.OscHandler(z=>this.setIconName(z))),this._parser.registerOscHandler(2,new g.OscHandler(z=>this.setTitle(z))),this._parser.registerOscHandler(4,new g.OscHandler(z=>this.setOrReportIndexedColor(z))),this._parser.registerOscHandler(8,new g.OscHandler(z=>this.setHyperlink(z))),this._parser.registerOscHandler(10,new g.OscHandler(z=>this.setOrReportFgColor(z))),this._parser.registerOscHandler(11,new g.OscHandler(z=>this.setOrReportBgColor(z))),this._parser.registerOscHandler(12,new g.OscHandler(z=>this.setOrReportCursorColor(z))),this._parser.registerOscHandler(104,new g.OscHandler(z=>this.restoreIndexedColor(z))),this._parser.registerOscHandler(110,new g.OscHandler(z=>this.restoreFgColor(z))),this._parser.registerOscHandler(111,new g.OscHandler(z=>this.restoreBgColor(z))),this._parser.registerOscHandler(112,new g.OscHandler(z=>this.restoreCursorColor(z))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const z in u.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:z},()=>this.selectCharset("("+z)),this._parser.registerEscHandler({intermediates:")",final:z},()=>this.selectCharset(")"+z)),this._parser.registerEscHandler({intermediates:"*",final:z},()=>this.selectCharset("*"+z)),this._parser.registerEscHandler({intermediates:"+",final:z},()=>this.selectCharset("+"+z)),this._parser.registerEscHandler({intermediates:"-",final:z},()=>this.selectCharset("-"+z)),this._parser.registerEscHandler({intermediates:".",final:z},()=>this.selectCharset("."+z)),this._parser.registerEscHandler({intermediates:"/",final:z},()=>this.selectCharset("/"+z));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(z=>(this._logService.error("Parsing error: ",z),z)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new C.DcsHandler((z,$)=>this.requestStatusString(z,$)))}getAttrData(){return this._curAttrData}_preserveStack(L,B,I,P){this._parseStack.paused=!0,this._parseStack.cursorStartX=L,this._parseStack.cursorStartY=B,this._parseStack.decodedLength=I,this._parseStack.position=P}_logSlowResolvingAsync(L){this._logService.logLevel<=p.LogLevelEnum.WARN&&Promise.race([L,new Promise((B,I)=>setTimeout(()=>I("#SLOW_TIMEOUT"),5e3))]).catch(B=>{if(B!=="#SLOW_TIMEOUT")throw B;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(L,B){let I,P=this._activeBuffer.x,Z=this._activeBuffer.y,G=0;const X=this._parseStack.paused;if(X){if(I=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,B))return this._logSlowResolvingAsync(I),I;P=this._parseStack.cursorStartX,Z=this._parseStack.cursorStartY,this._parseStack.paused=!1,L.length>E&&(G=this._parseStack.position+E)}if(this._logService.logLevel<=p.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof L=="string"?` "${L}"`:` "${Array.prototype.map.call(L,V=>String.fromCharCode(V)).join("")}"`),typeof L=="string"?L.split("").map(V=>V.charCodeAt(0)):L),this._parseBuffer.length<L.length&&this._parseBuffer.length<E&&(this._parseBuffer=new Uint32Array(Math.min(L.length,E))),X||this._dirtyRowTracker.clearRange(),L.length>E)for(let V=G;V<L.length;V+=E){const ie=V+E<L.length?V+E:L.length,z=typeof L=="string"?this._stringDecoder.decode(L.substring(V,ie),this._parseBuffer):this._utf8Decoder.decode(L.subarray(V,ie),this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,z))return this._preserveStack(P,Z,z,V),this._logSlowResolvingAsync(I),I}else if(!X){const V=typeof L=="string"?this._stringDecoder.decode(L,this._parseBuffer):this._utf8Decoder.decode(L,this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,V))return this._preserveStack(P,Z,V,0),this._logSlowResolvingAsync(I),I}this._activeBuffer.x===P&&this._activeBuffer.y===Z||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(L,B,I){let P,Z;const G=this._charsetService.charset,X=this._optionsService.rawOptions.screenReaderMode,V=this._bufferService.cols,ie=this._coreService.decPrivateModes.wraparound,z=this._coreService.modes.insertMode,$=this._curAttrData;let W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&I-B>0&&W.getWidth(this._activeBuffer.x-1)===2&&W.setCellFromCodePoint(this._activeBuffer.x-1,0,1,$.fg,$.bg,$.extended);for(let te=B;te<I;++te){if(P=L[te],Z=this._unicodeService.wcwidth(P),P<127&&G){const se=G[String.fromCharCode(P)];se&&(P=se.charCodeAt(0))}if(X&&this._onA11yChar.fire((0,n.stringFromCodePoint)(P)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),Z||!this._activeBuffer.x){if(this._activeBuffer.x+Z-1>=V){if(ie){for(;this._activeBuffer.x<V;)W.setCellFromCodePoint(this._activeBuffer.x++,0,1,$.fg,$.bg,$.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=V-1,Z===2)continue}if(z&&(W.insertCells(this._activeBuffer.x,Z,this._activeBuffer.getNullCell($),$),W.getWidth(V-1)===2&&W.setCellFromCodePoint(V-1,s.NULL_CELL_CODE,s.NULL_CELL_WIDTH,$.fg,$.bg,$.extended)),W.setCellFromCodePoint(this._activeBuffer.x++,P,Z,$.fg,$.bg,$.extended),Z>0)for(;--Z;)W.setCellFromCodePoint(this._activeBuffer.x++,0,0,$.fg,$.bg,$.extended)}else W.getWidth(this._activeBuffer.x-1)?W.addCodepointToCell(this._activeBuffer.x-1,P):W.addCodepointToCell(this._activeBuffer.x-2,P)}I-B>0&&(W.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<V&&I-B>0&&W.getWidth(this._activeBuffer.x)===0&&!W.hasContent(this._activeBuffer.x)&&W.setCellFromCodePoint(this._activeBuffer.x,0,1,$.fg,$.bg,$.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(L,B){return L.final!=="t"||L.prefix||L.intermediates?this._parser.registerCsiHandler(L,B):this._parser.registerCsiHandler(L,I=>!A(I.params[0],this._optionsService.rawOptions.windowOptions)||B(I))}registerDcsHandler(L,B){return this._parser.registerDcsHandler(L,new C.DcsHandler(B))}registerEscHandler(L,B){return this._parser.registerEscHandler(L,B)}registerOscHandler(L,B){return this._parser.registerOscHandler(L,new g.OscHandler(B))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var L;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||L===void 0)&&L.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);B.hasWidth(this._activeBuffer.x)&&!B.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const L=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-L),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(L=this._bufferService.cols-1){this._activeBuffer.x=Math.min(L,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(L,B){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=L,this._activeBuffer.y=this._activeBuffer.scrollTop+B):(this._activeBuffer.x=L,this._activeBuffer.y=B),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(L,B){this._restrictCursor(),this._setCursor(this._activeBuffer.x+L,this._activeBuffer.y+B)}cursorUp(L){const B=this._activeBuffer.y-this._activeBuffer.scrollTop;return B>=0?this._moveCursor(0,-Math.min(B,L.params[0]||1)):this._moveCursor(0,-(L.params[0]||1)),!0}cursorDown(L){const B=this._activeBuffer.scrollBottom-this._activeBuffer.y;return B>=0?this._moveCursor(0,Math.min(B,L.params[0]||1)):this._moveCursor(0,L.params[0]||1),!0}cursorForward(L){return this._moveCursor(L.params[0]||1,0),!0}cursorBackward(L){return this._moveCursor(-(L.params[0]||1),0),!0}cursorNextLine(L){return this.cursorDown(L),this._activeBuffer.x=0,!0}cursorPrecedingLine(L){return this.cursorUp(L),this._activeBuffer.x=0,!0}cursorCharAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(L){return this._setCursor(L.length>=2?(L.params[1]||1)-1:0,(L.params[0]||1)-1),!0}charPosAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(L){return this._moveCursor(L.params[0]||1,0),!0}linePosAbsolute(L){return this._setCursor(this._activeBuffer.x,(L.params[0]||1)-1),!0}vPositionRelative(L){return this._moveCursor(0,L.params[0]||1),!0}hVPosition(L){return this.cursorPosition(L),!0}tabClear(L){const B=L.params[0];return B===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:B===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=L.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=L.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(L){const B=L.params[0];return B===1&&(this._curAttrData.bg|=536870912),B!==2&&B!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(L,B,I,P=!1,Z=!1){const G=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);G.replaceCells(B,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),Z),P&&(G.isWrapped=!1)}_resetBufferLine(L,B=!1){const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);I.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),B),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+L),I.isWrapped=!1}eraseInDisplay(L,B=!1){let I;switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);I<this._bufferService.rows;I++)this._resetBufferLine(I,B);this._dirtyRowTracker.markDirty(I);break;case 1:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I,0,this._activeBuffer.x+1,!0,B),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(I+1).isWrapped=!1);I--;)this._resetBufferLine(I,B);this._dirtyRowTracker.markDirty(0);break;case 2:for(I=this._bufferService.rows,this._dirtyRowTracker.markDirty(I-1);I--;)this._resetBufferLine(I,B);this._dirtyRowTracker.markDirty(0);break;case 3:const P=this._activeBuffer.lines.length-this._bufferService.rows;P>0&&(this._activeBuffer.lines.trimStart(P),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-P,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-P,0),this._onScroll.fire(0))}return!0}eraseInLine(L,B=!1){switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,B);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,B)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(L){this._restrictCursor();let B=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y,P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,Z=this._bufferService.rows-1+this._activeBuffer.ybase-P+1;for(;B--;)this._activeBuffer.lines.splice(Z-1,1),this._activeBuffer.lines.splice(I,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(L){this._restrictCursor();let B=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y;let P;for(P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,P=this._bufferService.rows-1+this._activeBuffer.ybase-P;B--;)this._activeBuffer.lines.splice(I,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.insertCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.deleteCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(L){let B=L.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(L){let B=L.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(t.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);P.deleteCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);P.insertCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);P.insertCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);P.deleteCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(L.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(L){if(!this._parser.precedingCodepoint)return!0;const B=L.params[0]||1,I=new Uint32Array(B);for(let P=0;P<B;++P)I[P]=this._parser.precedingCodepoint;return this.print(I,0,I.length),!0}sendDeviceAttributesPrimary(L){return L.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(d.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(d.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(L){return L.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(d.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(d.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(L.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(d.C0.ESC+"[>83;40003;0c")),!0}_is(L){return(this._optionsService.rawOptions.termName+"").indexOf(L)===0}setMode(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,u.DEFAULT_CHARSET),this._charsetService.setgCharset(1,u.DEFAULT_CHARSET),this._charsetService.setgCharset(2,u.DEFAULT_CHARSET),this._charsetService.setgCharset(3,u.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),L.params[B]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(L,B){const I=this._coreService.decPrivateModes,{activeProtocol:P,activeEncoding:Z}=this._coreMouseService,G=this._coreService,{buffers:X,cols:V}=this._bufferService,{active:ie,alt:z}=X,$=this._optionsService.rawOptions,W=ce=>ce?1:2,te=L.params[0];return se=te,be=B?te===2?4:te===4?W(G.modes.insertMode):te===12?3:te===20?W($.convertEol):0:te===1?W(I.applicationCursorKeys):te===3?$.windowOptions.setWinLines?V===80?2:V===132?1:0:0:te===6?W(I.origin):te===7?W(I.wraparound):te===8?3:te===9?W(P==="X10"):te===12?W($.cursorBlink):te===25?W(!G.isCursorHidden):te===45?W(I.reverseWraparound):te===66?W(I.applicationKeypad):te===67?4:te===1e3?W(P==="VT200"):te===1002?W(P==="DRAG"):te===1003?W(P==="ANY"):te===1004?W(I.sendFocus):te===1005?4:te===1006?W(Z==="SGR"):te===1015?4:te===1016?W(Z==="SGR_PIXELS"):te===1048?1:te===47||te===1047||te===1049?W(ie===z):te===2004?W(I.bracketedPasteMode):0,G.triggerDataEvent(`${d.C0.ESC}[${B?"":"?"}${se};${be}$y`),!0;var se,be}_updateAttrColor(L,B,I,P,Z){return B===2?(L|=50331648,L&=-16777216,L|=h.AttributeData.fromColorRGB([I,P,Z])):B===5&&(L&=-50331904,L|=33554432|255&I),L}_extractColor(L,B,I){const P=[0,0,-1,0,0,0];let Z=0,G=0;do{if(P[G+Z]=L.params[B+G],L.hasSubParams(B+G)){const X=L.getSubParams(B+G);let V=0;do P[1]===5&&(Z=1),P[G+V+1+Z]=X[V];while(++V<X.length&&V+G+1+Z<P.length);break}if(P[1]===5&&G+Z>=2||P[1]===2&&G+Z>=5)break;P[1]&&(Z=1)}while(++G+B<L.length&&G+Z<P.length);for(let X=2;X<P.length;++X)P[X]===-1&&(P[X]=0);switch(P[0]){case 38:I.fg=this._updateAttrColor(I.fg,P[1],P[3],P[4],P[5]);break;case 48:I.bg=this._updateAttrColor(I.bg,P[1],P[3],P[4],P[5]);break;case 58:I.extended=I.extended.clone(),I.extended.underlineColor=this._updateAttrColor(I.extended.underlineColor,P[1],P[3],P[4],P[5])}return G}_processUnderline(L,B){B.extended=B.extended.clone(),(!~L||L>5)&&(L=1),B.extended.underlineStyle=L,B.fg|=268435456,L===0&&(B.fg&=-268435457),B.updateExtended()}_processSGR0(L){L.fg=t.DEFAULT_ATTR_DATA.fg,L.bg=t.DEFAULT_ATTR_DATA.bg,L.extended=L.extended.clone(),L.extended.underlineStyle=0,L.extended.underlineColor&=-67108864,L.updateExtended()}charAttributes(L){if(L.length===1&&L.params[0]===0)return this._processSGR0(this._curAttrData),!0;const B=L.length;let I;const P=this._curAttrData;for(let Z=0;Z<B;Z++)I=L.params[Z],I>=30&&I<=37?(P.fg&=-50331904,P.fg|=16777216|I-30):I>=40&&I<=47?(P.bg&=-50331904,P.bg|=16777216|I-40):I>=90&&I<=97?(P.fg&=-50331904,P.fg|=16777224|I-90):I>=100&&I<=107?(P.bg&=-50331904,P.bg|=16777224|I-100):I===0?this._processSGR0(P):I===1?P.fg|=134217728:I===3?P.bg|=67108864:I===4?(P.fg|=268435456,this._processUnderline(L.hasSubParams(Z)?L.getSubParams(Z)[0]:1,P)):I===5?P.fg|=536870912:I===7?P.fg|=67108864:I===8?P.fg|=1073741824:I===9?P.fg|=2147483648:I===2?P.bg|=134217728:I===21?this._processUnderline(2,P):I===22?(P.fg&=-134217729,P.bg&=-134217729):I===23?P.bg&=-67108865:I===24?(P.fg&=-268435457,this._processUnderline(0,P)):I===25?P.fg&=-536870913:I===27?P.fg&=-67108865:I===28?P.fg&=-1073741825:I===29?P.fg&=2147483647:I===39?(P.fg&=-67108864,P.fg|=16777215&t.DEFAULT_ATTR_DATA.fg):I===49?(P.bg&=-67108864,P.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):I===38||I===48||I===58?Z+=this._extractColor(L,Z,P):I===53?P.bg|=1073741824:I===55?P.bg&=-1073741825:I===59?(P.extended=P.extended.clone(),P.extended.underlineColor=-1,P.updateExtended()):I===100?(P.fg&=-67108864,P.fg|=16777215&t.DEFAULT_ATTR_DATA.fg,P.bg&=-67108864,P.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",I);return!0}deviceStatus(L){switch(L.params[0]){case 5:this._coreService.triggerDataEvent(`${d.C0.ESC}[0n`);break;case 6:const B=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[${B};${I}R`)}return!0}deviceStatusPrivate(L){if(L.params[0]===6){const B=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[?${B};${I}R`)}return!0}softReset(L){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(L){const B=L.params[0]||1;switch(B){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const I=B%2==1;return this._optionsService.options.cursorBlink=I,!0}setScrollRegion(L){const B=L.params[0]||1;let I;return(L.length<2||(I=L.params[1])>this._bufferService.rows||I===0)&&(I=this._bufferService.rows),I>B&&(this._activeBuffer.scrollTop=B-1,this._activeBuffer.scrollBottom=I-1,this._setCursor(0,0)),!0}windowOptions(L){if(!A(L.params[0],this._optionsService.rawOptions.windowOptions))return!0;const B=L.length>1?L.params[1]:0;switch(L.params[0]){case 14:B!==2&&this._onRequestWindowsOptionsReport.fire(T.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(T.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${d.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:B!==0&&B!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),B!==0&&B!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:B!==0&&B!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),B!==0&&B!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(L){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(L){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(L){return this._windowTitle=L,this._onTitleChange.fire(L),!0}setIconName(L){return this._iconName=L,!0}setOrReportIndexedColor(L){const B=[],I=L.split(";");for(;I.length>1;){const P=I.shift(),Z=I.shift();if(/^\d+$/.exec(P)){const G=parseInt(P);if(0<=G&&G<256)if(Z==="?")B.push({type:0,index:G});else{const X=(0,v.parseColor)(Z);X&&B.push({type:1,index:G,color:X})}}}return B.length&&this._onColor.fire(B),!0}setHyperlink(L){const B=L.split(";");return!(B.length<2)&&(B[1]?this._createHyperlink(B[0],B[1]):!B[0]&&this._finishHyperlink())}_createHyperlink(L,B){this._getCurrentLinkId()&&this._finishHyperlink();const I=L.split(":");let P;const Z=I.findIndex(G=>G.startsWith("id="));return Z!==-1&&(P=I[Z].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:P,uri:B}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(L,B){const I=L.split(";");for(let P=0;P<I.length&&!(B>=this._specialColors.length);++P,++B)if(I[P]==="?")this._onColor.fire([{type:0,index:this._specialColors[B]}]);else{const Z=(0,v.parseColor)(I[P]);Z&&this._onColor.fire([{type:1,index:this._specialColors[B],color:Z}])}return!0}setOrReportFgColor(L){return this._setOrReportSpecialColor(L,0)}setOrReportBgColor(L){return this._setOrReportSpecialColor(L,1)}setOrReportCursorColor(L){return this._setOrReportSpecialColor(L,2)}restoreIndexedColor(L){if(!L)return this._onColor.fire([{type:2}]),!0;const B=[],I=L.split(";");for(let P=0;P<I.length;++P)if(/^\d+$/.exec(I[P])){const Z=parseInt(I[P]);0<=Z&&Z<256&&B.push({type:2,index:Z})}return B.length&&this._onColor.fire(B),!0}restoreFgColor(L){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(L){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(L){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,u.DEFAULT_CHARSET),!0}selectCharset(L){return L.length!==2?(this.selectDefaultCharset(),!0):(L[0]==="/"||this._charsetService.setgCharset(b[L[0]],u.CHARSETS[L[1]]||u.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const L=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,L,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(L){return this._charsetService.setgLevel(L),!0}screenAlignmentPattern(){const L=new i.CellData;L.content=4194304|"E".charCodeAt(0),L.fg=this._curAttrData.fg,L.bg=this._curAttrData.bg,this._setCursor(0,0);for(let B=0;B<this._bufferService.rows;++B){const I=this._activeBuffer.ybase+this._activeBuffer.y+B,P=this._activeBuffer.lines.get(I);P&&(P.fill(L),P.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(L,B){const I=this._bufferService.buffer,P=this._optionsService.rawOptions;return(Z=>(this._coreService.triggerDataEvent(`${d.C0.ESC}${Z}${d.C0.ESC}\\`),!0))(L==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:L==='"p'?'P1$r61;1"p':L==="r"?`P1$r${I.scrollTop+1};${I.scrollBottom+1}r`:L==="m"?"P1$r0m":L===" q"?`P1$r${{block:2,underline:4,bar:6}[P.cursorStyle]-(P.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(L,B){this._dirtyRowTracker.markRangeDirty(L,B)}}c.InputHandler=H;let M=class{constructor(N){this._bufferService=N,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(N){N<this.start?this.start=N:N>this.end&&(this.end=N)}markRangeDirty(N,L){N>L&&(O=N,N=L,L=O),N<this.start&&(this.start=N),L>this.end&&(this.end=L)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};M=_([f(0,p.IBufferService)],M)},844:(j,c)=>{function y(_){for(const f of _)f.dispose();_.length=0}Object.defineProperty(c,"__esModule",{value:!0}),c.getDisposeArrayDisposable=c.disposeArray=c.toDisposable=c.Disposable=void 0,c.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const _ of this._disposables)_.dispose();this._disposables.length=0}register(_){return this._disposables.push(_),_}unregister(_){const f=this._disposables.indexOf(_);f!==-1&&this._disposables.splice(f,1)}},c.toDisposable=function(_){return{dispose:_}},c.disposeArray=y,c.getDisposeArrayDisposable=function(_){return{dispose:()=>y(_)}}},1505:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FourKeyMap=c.TwoKeyMap=void 0;class y{constructor(){this._data={}}set(f,d,u){this._data[f]||(this._data[f]={}),this._data[f][d]=u}get(f,d){return this._data[f]?this._data[f][d]:void 0}clear(){this._data={}}}c.TwoKeyMap=y,c.FourKeyMap=class{constructor(){this._data=new y}set(_,f,d,u,w){this._data.get(_,f)||this._data.set(_,f,new y),this._data.get(_,f).set(d,u,w)}get(_,f,d,u){var w;return(w=this._data.get(_,f))===null||w===void 0?void 0:w.get(d,u)}clear(){this._data.clear()}}},6114:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isChromeOS=c.isLinux=c.isWindows=c.isIphone=c.isIpad=c.isMac=c.getSafariVersion=c.isSafari=c.isLegacyEdge=c.isFirefox=c.isNode=void 0,c.isNode=typeof navigator>"u";const y=c.isNode?"node":navigator.userAgent,_=c.isNode?"node":navigator.platform;c.isFirefox=y.includes("Firefox"),c.isLegacyEdge=y.includes("Edge"),c.isSafari=/^((?!chrome|android).)*safari/i.test(y),c.getSafariVersion=function(){if(!c.isSafari)return 0;const f=y.match(/Version\/(\d+)/);return f===null||f.length<2?0:parseInt(f[1])},c.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(_),c.isIpad=_==="iPad",c.isIphone=_==="iPhone",c.isWindows=["Windows","Win16","Win32","WinCE"].includes(_),c.isLinux=_.indexOf("Linux")>=0,c.isChromeOS=/\bCrOS\b/.test(y)},6106:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SortedList=void 0;let y=0;c.SortedList=class{constructor(_){this._getKey=_,this._array=[]}clear(){this._array.length=0}insert(_){this._array.length!==0?(y=this._search(this._getKey(_),0,this._array.length-1),this._array.splice(y,0,_)):this._array.push(_)}delete(_){if(this._array.length===0)return!1;const f=this._getKey(_);if(f===void 0||(y=this._search(f,0,this._array.length-1),y===-1)||this._getKey(this._array[y])!==f)return!1;do if(this._array[y]===_)return this._array.splice(y,1),!0;while(++y<this._array.length&&this._getKey(this._array[y])===f);return!1}*getKeyIterator(_){if(this._array.length!==0&&(y=this._search(_,0,this._array.length-1),!(y<0||y>=this._array.length)&&this._getKey(this._array[y])===_))do yield this._array[y];while(++y<this._array.length&&this._getKey(this._array[y])===_)}forEachByKey(_,f){if(this._array.length!==0&&(y=this._search(_,0,this._array.length-1),!(y<0||y>=this._array.length)&&this._getKey(this._array[y])===_))do f(this._array[y]);while(++y<this._array.length&&this._getKey(this._array[y])===_)}values(){return this._array.values()}_search(_,f,d){if(d<f)return f;let u=Math.floor((f+d)/2);const w=this._getKey(this._array[u]);if(w>_)return this._search(_,f,u-1);if(w<_)return this._search(_,u+1,d);for(;u>0&&this._getKey(this._array[u-1])===_;)u--;return u}}},7226:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebouncedIdleTask=c.IdleTaskQueue=c.PriorityTaskQueue=void 0;const _=y(6114);class f{constructor(){this._tasks=[],this._i=0}enqueue(w){this._tasks.push(w),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(w){this._idleCallback=void 0;let m=0,n=0,t=w.timeRemaining(),a=0;for(;this._i<this._tasks.length;){if(m=Date.now(),this._tasks[this._i]()||this._i++,m=Math.max(1,Date.now()-m),n=Math.max(m,n),a=w.timeRemaining(),1.5*n>a)return t-m<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-m))}ms`),void this._start();t=a}this.clear()}}class d extends f{_requestCallback(w){return setTimeout(()=>w(this._createDeadline(16)))}_cancelCallback(w){clearTimeout(w)}_createDeadline(w){const m=Date.now()+w;return{timeRemaining:()=>Math.max(0,m-Date.now())}}}c.PriorityTaskQueue=d,c.IdleTaskQueue=!_.isNode&&"requestIdleCallback"in window?class extends f{_requestCallback(u){return requestIdleCallback(u)}_cancelCallback(u){cancelIdleCallback(u)}}:d,c.DebouncedIdleTask=class{constructor(){this._queue=new c.IdleTaskQueue}set(u){this._queue.clear(),this._queue.enqueue(u)}flush(){this._queue.flush()}}},9282:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.updateWindowsModeWrappedState=void 0;const _=y(643);c.updateWindowsModeWrappedState=function(f){const d=f.buffer.lines.get(f.buffer.ybase+f.buffer.y-1),u=d==null?void 0:d.get(f.cols-1),w=f.buffer.lines.get(f.buffer.ybase+f.buffer.y);w&&u&&(w.isWrapped=u[_.CHAR_DATA_CODE_INDEX]!==_.NULL_CELL_CODE&&u[_.CHAR_DATA_CODE_INDEX]!==_.WHITESPACE_CELL_CODE)}},3734:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtendedAttrs=c.AttributeData=void 0;class y{constructor(){this.fg=0,this.bg=0,this.extended=new _}static toColorRGB(d){return[d>>>16&255,d>>>8&255,255&d]}static fromColorRGB(d){return(255&d[0])<<16|(255&d[1])<<8|255&d[2]}clone(){const d=new y;return d.fg=this.fg,d.bg=this.bg,d.extended=this.extended.clone(),d}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}c.AttributeData=y;class _{constructor(d=0,u=0){this._ext=0,this._urlId=0,this._ext=d,this._urlId=u}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(d){this._ext=d}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(d){this._ext&=-469762049,this._ext|=d<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(d){this._ext&=-67108864,this._ext|=67108863&d}get urlId(){return this._urlId}set urlId(d){this._urlId=d}clone(){return new _(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}c.ExtendedAttrs=_},9092:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Buffer=c.MAX_BUFFER_SIZE=void 0;const _=y(6349),f=y(8437),d=y(511),u=y(643),w=y(4634),m=y(4863),n=y(7116),t=y(3734),a=y(7226);c.MAX_BUFFER_SIZE=4294967295,c.Buffer=class{constructor(s,i,h){this._hasScrollback=s,this._optionsService=i,this._bufferService=h,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=f.DEFAULT_ATTR_DATA.clone(),this.savedCharset=n.DEFAULT_CHARSET,this.markers=[],this._nullCell=d.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]),this._whitespaceCell=d.CellData.fromCharData([0,u.WHITESPACE_CELL_CHAR,u.WHITESPACE_CELL_WIDTH,u.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new a.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new _.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(s){return s?(this._nullCell.fg=s.fg,this._nullCell.bg=s.bg,this._nullCell.extended=s.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new t.ExtendedAttrs),this._nullCell}getWhitespaceCell(s){return s?(this._whitespaceCell.fg=s.fg,this._whitespaceCell.bg=s.bg,this._whitespaceCell.extended=s.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new t.ExtendedAttrs),this._whitespaceCell}getBlankLine(s,i){return new f.BufferLine(this._bufferService.cols,this.getNullCell(s),i)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const s=this.ybase+this.y-this.ydisp;return s>=0&&s<this._rows}_getCorrectBufferLength(s){if(!this._hasScrollback)return s;const i=s+this._optionsService.rawOptions.scrollback;return i>c.MAX_BUFFER_SIZE?c.MAX_BUFFER_SIZE:i}fillViewportRows(s){if(this.lines.length===0){s===void 0&&(s=f.DEFAULT_ATTR_DATA);let i=this._rows;for(;i--;)this.lines.push(this.getBlankLine(s))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new _.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(s,i){const h=this.getNullCell(f.DEFAULT_ATTR_DATA);let p=0;const g=this._getCorrectBufferLength(i);if(g>this.lines.maxLength&&(this.lines.maxLength=g),this.lines.length>0){if(this._cols<s)for(let v=0;v<this.lines.length;v++)p+=+this.lines.get(v).resize(s,h);let C=0;if(this._rows<i)for(let v=this._rows;v<i;v++)this.lines.length<i+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new f.BufferLine(s,h)):this.ybase>0&&this.lines.length<=this.ybase+this.y+C+1?(this.ybase--,C++,this.ydisp>0&&this.ydisp--):this.lines.push(new f.BufferLine(s,h)));else for(let v=this._rows;v>i;v--)this.lines.length>i+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(g<this.lines.maxLength){const v=this.lines.length-g;v>0&&(this.lines.trimStart(v),this.ybase=Math.max(this.ybase-v,0),this.ydisp=Math.max(this.ydisp-v,0),this.savedY=Math.max(this.savedY-v,0)),this.lines.maxLength=g}this.x=Math.min(this.x,s-1),this.y=Math.min(this.y,i-1),C&&(this.y+=C),this.savedX=Math.min(this.savedX,s-1),this.scrollTop=0}if(this.scrollBottom=i-1,this._isReflowEnabled&&(this._reflow(s,i),this._cols>s))for(let C=0;C<this.lines.length;C++)p+=+this.lines.get(C).resize(s,h);this._cols=s,this._rows=i,this._memoryCleanupQueue.clear(),p>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let s=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,s=!1);let i=0;for(;this._memoryCleanupPosition<this.lines.length;)if(i+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),i>100)return!0;return s}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(s,i){this._cols!==s&&(s>this._cols?this._reflowLarger(s,i):this._reflowSmaller(s,i))}_reflowLarger(s,i){const h=(0,w.reflowLargerGetLinesToRemove)(this.lines,this._cols,s,this.ybase+this.y,this.getNullCell(f.DEFAULT_ATTR_DATA));if(h.length>0){const p=(0,w.reflowLargerCreateNewLayout)(this.lines,h);(0,w.reflowLargerApplyNewLayout)(this.lines,p.layout),this._reflowLargerAdjustViewport(s,i,p.countRemoved)}}_reflowLargerAdjustViewport(s,i,h){const p=this.getNullCell(f.DEFAULT_ATTR_DATA);let g=h;for(;g-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<i&&this.lines.push(new f.BufferLine(s,p))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-h,0)}_reflowSmaller(s,i){const h=this.getNullCell(f.DEFAULT_ATTR_DATA),p=[];let g=0;for(let C=this.lines.length-1;C>=0;C--){let v=this.lines.get(C);if(!v||!v.isWrapped&&v.getTrimmedLength()<=s)continue;const b=[v];for(;v.isWrapped&&C>0;)v=this.lines.get(--C),b.unshift(v);const E=this.ybase+this.y;if(E>=C&&E<C+b.length)continue;const A=b[b.length-1].getTrimmedLength(),T=(0,w.reflowSmallerGetNewLineLengths)(b,this._cols,s),O=T.length-b.length;let H;H=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+O):Math.max(0,this.lines.length-this.lines.maxLength+O);const M=[];for(let Z=0;Z<O;Z++){const G=this.getBlankLine(f.DEFAULT_ATTR_DATA,!0);M.push(G)}M.length>0&&(p.push({start:C+b.length+g,newLines:M}),g+=M.length),b.push(...M);let N=T.length-1,L=T[N];L===0&&(N--,L=T[N]);let B=b.length-O-1,I=A;for(;B>=0;){const Z=Math.min(I,L);if(b[N]===void 0)break;if(b[N].copyCellsFrom(b[B],I-Z,L-Z,Z,!0),L-=Z,L===0&&(N--,L=T[N]),I-=Z,I===0){B--;const G=Math.max(B,0);I=(0,w.getWrappedLineTrimmedLength)(b,G,this._cols)}}for(let Z=0;Z<b.length;Z++)T[Z]<s&&b[Z].setCell(T[Z],h);let P=O-H;for(;P-- >0;)this.ybase===0?this.y<i-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+g)-i&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+O,this.ybase+i-1)}if(p.length>0){const C=[],v=[];for(let N=0;N<this.lines.length;N++)v.push(this.lines.get(N));const b=this.lines.length;let E=b-1,A=0,T=p[A];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+g);let O=0;for(let N=Math.min(this.lines.maxLength-1,b+g-1);N>=0;N--)if(T&&T.start>E+O){for(let L=T.newLines.length-1;L>=0;L--)this.lines.set(N--,T.newLines[L]);N++,C.push({index:E+1,amount:T.newLines.length}),O+=T.newLines.length,T=p[++A]}else this.lines.set(N,v[E--]);let H=0;for(let N=C.length-1;N>=0;N--)C[N].index+=H,this.lines.onInsertEmitter.fire(C[N]),H+=C[N].amount;const M=Math.max(0,b+g-this.lines.maxLength);M>0&&this.lines.onTrimEmitter.fire(M)}}translateBufferLineToString(s,i,h=0,p){const g=this.lines.get(s);return g?g.translateToString(i,h,p):""}getWrappedRangeForLine(s){let i=s,h=s;for(;i>0&&this.lines.get(i).isWrapped;)i--;for(;h+1<this.lines.length&&this.lines.get(h+1).isWrapped;)h++;return{first:i,last:h}}setupTabStops(s){for(s!=null?this.tabs[s]||(s=this.prevStop(s)):(this.tabs={},s=0);s<this._cols;s+=this._optionsService.rawOptions.tabStopWidth)this.tabs[s]=!0}prevStop(s){for(s==null&&(s=this.x);!this.tabs[--s]&&s>0;);return s>=this._cols?this._cols-1:s<0?0:s}nextStop(s){for(s==null&&(s=this.x);!this.tabs[++s]&&s<this._cols;);return s>=this._cols?this._cols-1:s<0?0:s}clearMarkers(s){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].line===s&&(this.markers[i].dispose(),this.markers.splice(i--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].dispose(),this.markers.splice(s--,1);this._isClearing=!1}addMarker(s){const i=new m.Marker(s);return this.markers.push(i),i.register(this.lines.onTrim(h=>{i.line-=h,i.line<0&&i.dispose()})),i.register(this.lines.onInsert(h=>{i.line>=h.index&&(i.line+=h.amount)})),i.register(this.lines.onDelete(h=>{i.line>=h.index&&i.line<h.index+h.amount&&i.dispose(),i.line>h.index&&(i.line-=h.amount)})),i.register(i.onDispose(()=>this._removeMarker(i))),i}_removeMarker(s){this._isClearing||this.markers.splice(this.markers.indexOf(s),1)}}},8437:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLine=c.DEFAULT_ATTR_DATA=void 0;const _=y(482),f=y(643),d=y(511),u=y(3734);c.DEFAULT_ATTR_DATA=Object.freeze(new u.AttributeData);let w=0;class m{constructor(t,a,s=!1){this.isWrapped=s,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*t);const i=a||d.CellData.fromCharData([0,f.NULL_CELL_CHAR,f.NULL_CELL_WIDTH,f.NULL_CELL_CODE]);for(let h=0;h<t;++h)this.setCell(h,i);this.length=t}get(t){const a=this._data[3*t+0],s=2097151&a;return[this._data[3*t+1],2097152&a?this._combined[t]:s?(0,_.stringFromCodePoint)(s):"",a>>22,2097152&a?this._combined[t].charCodeAt(this._combined[t].length-1):s]}set(t,a){this._data[3*t+1]=a[f.CHAR_DATA_ATTR_INDEX],a[f.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[t]=a[1],this._data[3*t+0]=2097152|t|a[f.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*t+0]=a[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|a[f.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(t){return this._data[3*t+0]>>22}hasWidth(t){return 12582912&this._data[3*t+0]}getFg(t){return this._data[3*t+1]}getBg(t){return this._data[3*t+2]}hasContent(t){return 4194303&this._data[3*t+0]}getCodePoint(t){const a=this._data[3*t+0];return 2097152&a?this._combined[t].charCodeAt(this._combined[t].length-1):2097151&a}isCombined(t){return 2097152&this._data[3*t+0]}getString(t){const a=this._data[3*t+0];return 2097152&a?this._combined[t]:2097151&a?(0,_.stringFromCodePoint)(2097151&a):""}isProtected(t){return 536870912&this._data[3*t+2]}loadCell(t,a){return w=3*t,a.content=this._data[w+0],a.fg=this._data[w+1],a.bg=this._data[w+2],2097152&a.content&&(a.combinedData=this._combined[t]),268435456&a.bg&&(a.extended=this._extendedAttrs[t]),a}setCell(t,a){2097152&a.content&&(this._combined[t]=a.combinedData),268435456&a.bg&&(this._extendedAttrs[t]=a.extended),this._data[3*t+0]=a.content,this._data[3*t+1]=a.fg,this._data[3*t+2]=a.bg}setCellFromCodePoint(t,a,s,i,h,p){268435456&h&&(this._extendedAttrs[t]=p),this._data[3*t+0]=a|s<<22,this._data[3*t+1]=i,this._data[3*t+2]=h}addCodepointToCell(t,a){let s=this._data[3*t+0];2097152&s?this._combined[t]+=(0,_.stringFromCodePoint)(a):(2097151&s?(this._combined[t]=(0,_.stringFromCodePoint)(2097151&s)+(0,_.stringFromCodePoint)(a),s&=-2097152,s|=2097152):s=a|4194304,this._data[3*t+0]=s)}insertCells(t,a,s,i){if((t%=this.length)&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new u.ExtendedAttrs),a<this.length-t){const h=new d.CellData;for(let p=this.length-t-a-1;p>=0;--p)this.setCell(t+a+p,this.loadCell(t+p,h));for(let p=0;p<a;++p)this.setCell(t+p,s)}else for(let h=t;h<this.length;++h)this.setCell(h,s);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new u.ExtendedAttrs)}deleteCells(t,a,s,i){if(t%=this.length,a<this.length-t){const h=new d.CellData;for(let p=0;p<this.length-t-a;++p)this.setCell(t+p,this.loadCell(t+a+p,h));for(let p=this.length-a;p<this.length;++p)this.setCell(p,s)}else for(let h=t;h<this.length;++h)this.setCell(h,s);t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new u.ExtendedAttrs),this.getWidth(t)!==0||this.hasContent(t)||this.setCellFromCodePoint(t,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new u.ExtendedAttrs)}replaceCells(t,a,s,i,h=!1){if(h)for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodePoint(t-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new u.ExtendedAttrs),a<this.length&&this.getWidth(a-1)===2&&!this.isProtected(a)&&this.setCellFromCodePoint(a,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new u.ExtendedAttrs);t<a&&t<this.length;)this.isProtected(t)||this.setCell(t,s),t++;else for(t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new u.ExtendedAttrs),a<this.length&&this.getWidth(a-1)===2&&this.setCellFromCodePoint(a,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new u.ExtendedAttrs);t<a&&t<this.length;)this.setCell(t++,s)}resize(t,a){if(t===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const s=3*t;if(t>this.length){if(this._data.buffer.byteLength>=4*s)this._data=new Uint32Array(this._data.buffer,0,s);else{const i=new Uint32Array(s);i.set(this._data),this._data=i}for(let i=this.length;i<t;++i)this.setCell(i,a)}else{this._data=this._data.subarray(0,s);const i=Object.keys(this._combined);for(let p=0;p<i.length;p++){const g=parseInt(i[p],10);g>=t&&delete this._combined[g]}const h=Object.keys(this._extendedAttrs);for(let p=0;p<h.length;p++){const g=parseInt(h[p],10);g>=t&&delete this._extendedAttrs[g]}}return this.length=t,4*s*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,a=!1){if(a)for(let s=0;s<this.length;++s)this.isProtected(s)||this.setCell(s,t);else{this._combined={},this._extendedAttrs={};for(let s=0;s<this.length;++s)this.setCell(s,t)}}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(const a in t._combined)this._combined[a]=t._combined[a];this._extendedAttrs={};for(const a in t._extendedAttrs)this._extendedAttrs[a]=t._extendedAttrs[a];this.isWrapped=t.isWrapped}clone(){const t=new m(0);t._data=new Uint32Array(this._data),t.length=this.length;for(const a in this._combined)t._combined[a]=this._combined[a];for(const a in this._extendedAttrs)t._extendedAttrs[a]=this._extendedAttrs[a];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0])return t+(this._data[3*t+0]>>22);return 0}copyCellsFrom(t,a,s,i,h){const p=t._data;if(h)for(let C=i-1;C>=0;C--){for(let v=0;v<3;v++)this._data[3*(s+C)+v]=p[3*(a+C)+v];268435456&p[3*(a+C)+2]&&(this._extendedAttrs[s+C]=t._extendedAttrs[a+C])}else for(let C=0;C<i;C++){for(let v=0;v<3;v++)this._data[3*(s+C)+v]=p[3*(a+C)+v];268435456&p[3*(a+C)+2]&&(this._extendedAttrs[s+C]=t._extendedAttrs[a+C])}const g=Object.keys(t._combined);for(let C=0;C<g.length;C++){const v=parseInt(g[C],10);v>=a&&(this._combined[v-a+s]=t._combined[v])}}translateToString(t=!1,a=0,s=this.length){t&&(s=Math.min(s,this.getTrimmedLength()));let i="";for(;a<s;){const h=this._data[3*a+0],p=2097151&h;i+=2097152&h?this._combined[a]:p?(0,_.stringFromCodePoint)(p):f.WHITESPACE_CELL_CHAR,a+=h>>22||1}return i}}c.BufferLine=m},4841:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.getRangeLength=void 0,c.getRangeLength=function(y,_){if(y.start.y>y.end.y)throw new Error(`Buffer range end (${y.end.x}, ${y.end.y}) cannot be before start (${y.start.x}, ${y.start.y})`);return _*(y.end.y-y.start.y)+(y.end.x-y.start.x+1)}},4634:(j,c)=>{function y(_,f,d){if(f===_.length-1)return _[f].getTrimmedLength();const u=!_[f].hasContent(d-1)&&_[f].getWidth(d-1)===1,w=_[f+1].getWidth(0)===2;return u&&w?d-1:d}Object.defineProperty(c,"__esModule",{value:!0}),c.getWrappedLineTrimmedLength=c.reflowSmallerGetNewLineLengths=c.reflowLargerApplyNewLayout=c.reflowLargerCreateNewLayout=c.reflowLargerGetLinesToRemove=void 0,c.reflowLargerGetLinesToRemove=function(_,f,d,u,w){const m=[];for(let n=0;n<_.length-1;n++){let t=n,a=_.get(++t);if(!a.isWrapped)continue;const s=[_.get(n)];for(;t<_.length&&a.isWrapped;)s.push(a),a=_.get(++t);if(u>=n&&u<t){n+=s.length-1;continue}let i=0,h=y(s,i,f),p=1,g=0;for(;p<s.length;){const v=y(s,p,f),b=v-g,E=d-h,A=Math.min(b,E);s[i].copyCellsFrom(s[p],g,h,A,!1),h+=A,h===d&&(i++,h=0),g+=A,g===v&&(p++,g=0),h===0&&i!==0&&s[i-1].getWidth(d-1)===2&&(s[i].copyCellsFrom(s[i-1],d-1,h++,1,!1),s[i-1].setCell(d-1,w))}s[i].replaceCells(h,d,w);let C=0;for(let v=s.length-1;v>0&&(v>i||s[v].getTrimmedLength()===0);v--)C++;C>0&&(m.push(n+s.length-C),m.push(C)),n+=s.length-1}return m},c.reflowLargerCreateNewLayout=function(_,f){const d=[];let u=0,w=f[u],m=0;for(let n=0;n<_.length;n++)if(w===n){const t=f[++u];_.onDeleteEmitter.fire({index:n-m,amount:t}),n+=t-1,m+=t,w=f[++u]}else d.push(n);return{layout:d,countRemoved:m}},c.reflowLargerApplyNewLayout=function(_,f){const d=[];for(let u=0;u<f.length;u++)d.push(_.get(f[u]));for(let u=0;u<d.length;u++)_.set(u,d[u]);_.length=f.length},c.reflowSmallerGetNewLineLengths=function(_,f,d){const u=[],w=_.map((a,s)=>y(_,s,f)).reduce((a,s)=>a+s);let m=0,n=0,t=0;for(;t<w;){if(w-t<d){u.push(w-t);break}m+=d;const a=y(_,n,f);m>a&&(m-=a,n++);const s=_[n].getWidth(m-1)===2;s&&m--;const i=s?d-1:d;u.push(i),t+=i}return u},c.getWrappedLineTrimmedLength=y},5295:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferSet=void 0;const _=y(9092),f=y(8460),d=y(844);class u extends d.Disposable{constructor(m,n){super(),this._optionsService=m,this._bufferService=n,this._onBufferActivate=this.register(new f.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new _.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new _.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(m){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(m),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(m,n){this._normal.resize(m,n),this._alt.resize(m,n),this.setupTabStops(m)}setupTabStops(m){this._normal.setupTabStops(m),this._alt.setupTabStops(m)}}c.BufferSet=u},511:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellData=void 0;const _=y(482),f=y(643),d=y(3734);class u extends d.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new d.ExtendedAttrs,this.combinedData=""}static fromCharData(m){const n=new u;return n.setFromCharData(m),n}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,_.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(m){this.fg=m[f.CHAR_DATA_ATTR_INDEX],this.bg=0;let n=!1;if(m[f.CHAR_DATA_CHAR_INDEX].length>2)n=!0;else if(m[f.CHAR_DATA_CHAR_INDEX].length===2){const t=m[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const a=m[f.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=a&&a<=57343?this.content=1024*(t-55296)+a-56320+65536|m[f.CHAR_DATA_WIDTH_INDEX]<<22:n=!0}else n=!0}else this.content=m[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|m[f.CHAR_DATA_WIDTH_INDEX]<<22;n&&(this.combinedData=m[f.CHAR_DATA_CHAR_INDEX],this.content=2097152|m[f.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.CellData=u},643:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WHITESPACE_CELL_CODE=c.WHITESPACE_CELL_WIDTH=c.WHITESPACE_CELL_CHAR=c.NULL_CELL_CODE=c.NULL_CELL_WIDTH=c.NULL_CELL_CHAR=c.CHAR_DATA_CODE_INDEX=c.CHAR_DATA_WIDTH_INDEX=c.CHAR_DATA_CHAR_INDEX=c.CHAR_DATA_ATTR_INDEX=c.DEFAULT_EXT=c.DEFAULT_ATTR=c.DEFAULT_COLOR=void 0,c.DEFAULT_COLOR=0,c.DEFAULT_ATTR=256|c.DEFAULT_COLOR<<9,c.DEFAULT_EXT=0,c.CHAR_DATA_ATTR_INDEX=0,c.CHAR_DATA_CHAR_INDEX=1,c.CHAR_DATA_WIDTH_INDEX=2,c.CHAR_DATA_CODE_INDEX=3,c.NULL_CELL_CHAR="",c.NULL_CELL_WIDTH=1,c.NULL_CELL_CODE=0,c.WHITESPACE_CELL_CHAR=" ",c.WHITESPACE_CELL_WIDTH=1,c.WHITESPACE_CELL_CODE=32},4863:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Marker=void 0;const _=y(8460),f=y(844);class d{constructor(w){this.line=w,this.isDisposed=!1,this._disposables=[],this._id=d._nextId++,this._onDispose=this.register(new _.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,f.disposeArray)(this._disposables),this._disposables.length=0)}register(w){return this._disposables.push(w),w}}c.Marker=d,d._nextId=1},7116:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_CHARSET=c.CHARSETS=void 0,c.CHARSETS={},c.DEFAULT_CHARSET=c.CHARSETS.B,c.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},c.CHARSETS.A={"#":""},c.CHARSETS.B=void 0,c.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},c.CHARSETS.C=c.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.E=c.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},c.CHARSETS.H=c.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(j,c)=>{var y,_;Object.defineProperty(c,"__esModule",{value:!0}),c.C1_ESCAPED=c.C1=c.C0=void 0,function(f){f.NUL="\0",f.SOH="",f.STX="",f.ETX="",f.EOT="",f.ENQ="",f.ACK="",f.BEL="\x07",f.BS="\b",f.HT="	",f.LF=`
`,f.VT="\v",f.FF="\f",f.CR="\r",f.SO="",f.SI="",f.DLE="",f.DC1="",f.DC2="",f.DC3="",f.DC4="",f.NAK="",f.SYN="",f.ETB="",f.CAN="",f.EM="",f.SUB="",f.ESC="\x1B",f.FS="",f.GS="",f.RS="",f.US="",f.SP=" ",f.DEL=""}(y=c.C0||(c.C0={})),(_=c.C1||(c.C1={})).PAD="",_.HOP="",_.BPH="",_.NBH="",_.IND="",_.NEL="",_.SSA="",_.ESA="",_.HTS="",_.HTJ="",_.VTS="",_.PLD="",_.PLU="",_.RI="",_.SS2="",_.SS3="",_.DCS="",_.PU1="",_.PU2="",_.STS="",_.CCH="",_.MW="",_.SPA="",_.EPA="",_.SOS="",_.SGCI="",_.SCI="",_.CSI="",_.ST="",_.OSC="",_.PM="",_.APC="",(c.C1_ESCAPED||(c.C1_ESCAPED={})).ST=`${y.ESC}\\`},7399:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.evaluateKeyboardEvent=void 0;const _=y(2584),f={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};c.evaluateKeyboardEvent=function(d,u,w,m){const n={type:0,cancel:!1,key:void 0},t=(d.shiftKey?1:0)|(d.altKey?2:0)|(d.ctrlKey?4:0)|(d.metaKey?8:0);switch(d.keyCode){case 0:d.key==="UIKeyInputUpArrow"?n.key=u?_.C0.ESC+"OA":_.C0.ESC+"[A":d.key==="UIKeyInputLeftArrow"?n.key=u?_.C0.ESC+"OD":_.C0.ESC+"[D":d.key==="UIKeyInputRightArrow"?n.key=u?_.C0.ESC+"OC":_.C0.ESC+"[C":d.key==="UIKeyInputDownArrow"&&(n.key=u?_.C0.ESC+"OB":_.C0.ESC+"[B");break;case 8:if(d.altKey){n.key=_.C0.ESC+_.C0.DEL;break}n.key=_.C0.DEL;break;case 9:if(d.shiftKey){n.key=_.C0.ESC+"[Z";break}n.key=_.C0.HT,n.cancel=!0;break;case 13:n.key=d.altKey?_.C0.ESC+_.C0.CR:_.C0.CR,n.cancel=!0;break;case 27:n.key=_.C0.ESC,d.altKey&&(n.key=_.C0.ESC+_.C0.ESC),n.cancel=!0;break;case 37:if(d.metaKey)break;t?(n.key=_.C0.ESC+"[1;"+(t+1)+"D",n.key===_.C0.ESC+"[1;3D"&&(n.key=_.C0.ESC+(w?"b":"[1;5D"))):n.key=u?_.C0.ESC+"OD":_.C0.ESC+"[D";break;case 39:if(d.metaKey)break;t?(n.key=_.C0.ESC+"[1;"+(t+1)+"C",n.key===_.C0.ESC+"[1;3C"&&(n.key=_.C0.ESC+(w?"f":"[1;5C"))):n.key=u?_.C0.ESC+"OC":_.C0.ESC+"[C";break;case 38:if(d.metaKey)break;t?(n.key=_.C0.ESC+"[1;"+(t+1)+"A",w||n.key!==_.C0.ESC+"[1;3A"||(n.key=_.C0.ESC+"[1;5A")):n.key=u?_.C0.ESC+"OA":_.C0.ESC+"[A";break;case 40:if(d.metaKey)break;t?(n.key=_.C0.ESC+"[1;"+(t+1)+"B",w||n.key!==_.C0.ESC+"[1;3B"||(n.key=_.C0.ESC+"[1;5B")):n.key=u?_.C0.ESC+"OB":_.C0.ESC+"[B";break;case 45:d.shiftKey||d.ctrlKey||(n.key=_.C0.ESC+"[2~");break;case 46:n.key=t?_.C0.ESC+"[3;"+(t+1)+"~":_.C0.ESC+"[3~";break;case 36:n.key=t?_.C0.ESC+"[1;"+(t+1)+"H":u?_.C0.ESC+"OH":_.C0.ESC+"[H";break;case 35:n.key=t?_.C0.ESC+"[1;"+(t+1)+"F":u?_.C0.ESC+"OF":_.C0.ESC+"[F";break;case 33:d.shiftKey?n.type=2:d.ctrlKey?n.key=_.C0.ESC+"[5;"+(t+1)+"~":n.key=_.C0.ESC+"[5~";break;case 34:d.shiftKey?n.type=3:d.ctrlKey?n.key=_.C0.ESC+"[6;"+(t+1)+"~":n.key=_.C0.ESC+"[6~";break;case 112:n.key=t?_.C0.ESC+"[1;"+(t+1)+"P":_.C0.ESC+"OP";break;case 113:n.key=t?_.C0.ESC+"[1;"+(t+1)+"Q":_.C0.ESC+"OQ";break;case 114:n.key=t?_.C0.ESC+"[1;"+(t+1)+"R":_.C0.ESC+"OR";break;case 115:n.key=t?_.C0.ESC+"[1;"+(t+1)+"S":_.C0.ESC+"OS";break;case 116:n.key=t?_.C0.ESC+"[15;"+(t+1)+"~":_.C0.ESC+"[15~";break;case 117:n.key=t?_.C0.ESC+"[17;"+(t+1)+"~":_.C0.ESC+"[17~";break;case 118:n.key=t?_.C0.ESC+"[18;"+(t+1)+"~":_.C0.ESC+"[18~";break;case 119:n.key=t?_.C0.ESC+"[19;"+(t+1)+"~":_.C0.ESC+"[19~";break;case 120:n.key=t?_.C0.ESC+"[20;"+(t+1)+"~":_.C0.ESC+"[20~";break;case 121:n.key=t?_.C0.ESC+"[21;"+(t+1)+"~":_.C0.ESC+"[21~";break;case 122:n.key=t?_.C0.ESC+"[23;"+(t+1)+"~":_.C0.ESC+"[23~";break;case 123:n.key=t?_.C0.ESC+"[24;"+(t+1)+"~":_.C0.ESC+"[24~";break;default:if(!d.ctrlKey||d.shiftKey||d.altKey||d.metaKey)if(w&&!m||!d.altKey||d.metaKey)!w||d.altKey||d.ctrlKey||d.shiftKey||!d.metaKey?d.key&&!d.ctrlKey&&!d.altKey&&!d.metaKey&&d.keyCode>=48&&d.key.length===1?n.key=d.key:d.key&&d.ctrlKey&&(d.key==="_"&&(n.key=_.C0.US),d.key==="@"&&(n.key=_.C0.NUL)):d.keyCode===65&&(n.type=1);else{const a=f[d.keyCode],s=a==null?void 0:a[d.shiftKey?1:0];if(s)n.key=_.C0.ESC+s;else if(d.keyCode>=65&&d.keyCode<=90){const i=d.ctrlKey?d.keyCode-64:d.keyCode+32;let h=String.fromCharCode(i);d.shiftKey&&(h=h.toUpperCase()),n.key=_.C0.ESC+h}else if(d.keyCode===32)n.key=_.C0.ESC+(d.ctrlKey?_.C0.NUL:" ");else if(d.key==="Dead"&&d.code.startsWith("Key")){let i=d.code.slice(3,4);d.shiftKey||(i=i.toLowerCase()),n.key=_.C0.ESC+i,n.cancel=!0}}else d.keyCode>=65&&d.keyCode<=90?n.key=String.fromCharCode(d.keyCode-64):d.keyCode===32?n.key=_.C0.NUL:d.keyCode>=51&&d.keyCode<=55?n.key=String.fromCharCode(d.keyCode-51+27):d.keyCode===56?n.key=_.C0.DEL:d.keyCode===219?n.key=_.C0.ESC:d.keyCode===220?n.key=_.C0.FS:d.keyCode===221&&(n.key=_.C0.GS)}return n}},482:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Utf8ToUtf32=c.StringToUtf32=c.utf32ToString=c.stringFromCodePoint=void 0,c.stringFromCodePoint=function(y){return y>65535?(y-=65536,String.fromCharCode(55296+(y>>10))+String.fromCharCode(y%1024+56320)):String.fromCharCode(y)},c.utf32ToString=function(y,_=0,f=y.length){let d="";for(let u=_;u<f;++u){let w=y[u];w>65535?(w-=65536,d+=String.fromCharCode(55296+(w>>10))+String.fromCharCode(w%1024+56320)):d+=String.fromCharCode(w)}return d},c.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(y,_){const f=y.length;if(!f)return 0;let d=0,u=0;if(this._interim){const w=y.charCodeAt(u++);56320<=w&&w<=57343?_[d++]=1024*(this._interim-55296)+w-56320+65536:(_[d++]=this._interim,_[d++]=w),this._interim=0}for(let w=u;w<f;++w){const m=y.charCodeAt(w);if(55296<=m&&m<=56319){if(++w>=f)return this._interim=m,d;const n=y.charCodeAt(w);56320<=n&&n<=57343?_[d++]=1024*(m-55296)+n-56320+65536:(_[d++]=m,_[d++]=n)}else m!==65279&&(_[d++]=m)}return d}},c.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(y,_){const f=y.length;if(!f)return 0;let d,u,w,m,n=0,t=0,a=0;if(this.interim[0]){let h=!1,p=this.interim[0];p&=(224&p)==192?31:(240&p)==224?15:7;let g,C=0;for(;(g=63&this.interim[++C])&&C<4;)p<<=6,p|=g;const v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,b=v-C;for(;a<b;){if(a>=f)return 0;if(g=y[a++],(192&g)!=128){a--,h=!0;break}this.interim[C++]=g,p<<=6,p|=63&g}h||(v===2?p<128?a--:_[n++]=p:v===3?p<2048||p>=55296&&p<=57343||p===65279||(_[n++]=p):p<65536||p>1114111||(_[n++]=p)),this.interim.fill(0)}const s=f-4;let i=a;for(;i<f;){for(;!(!(i<s)||128&(d=y[i])||128&(u=y[i+1])||128&(w=y[i+2])||128&(m=y[i+3]));)_[n++]=d,_[n++]=u,_[n++]=w,_[n++]=m,i+=4;if(d=y[i++],d<128)_[n++]=d;else if((224&d)==192){if(i>=f)return this.interim[0]=d,n;if(u=y[i++],(192&u)!=128){i--;continue}if(t=(31&d)<<6|63&u,t<128){i--;continue}_[n++]=t}else if((240&d)==224){if(i>=f)return this.interim[0]=d,n;if(u=y[i++],(192&u)!=128){i--;continue}if(i>=f)return this.interim[0]=d,this.interim[1]=u,n;if(w=y[i++],(192&w)!=128){i--;continue}if(t=(15&d)<<12|(63&u)<<6|63&w,t<2048||t>=55296&&t<=57343||t===65279)continue;_[n++]=t}else if((248&d)==240){if(i>=f)return this.interim[0]=d,n;if(u=y[i++],(192&u)!=128){i--;continue}if(i>=f)return this.interim[0]=d,this.interim[1]=u,n;if(w=y[i++],(192&w)!=128){i--;continue}if(i>=f)return this.interim[0]=d,this.interim[1]=u,this.interim[2]=w,n;if(m=y[i++],(192&m)!=128){i--;continue}if(t=(7&d)<<18|(63&u)<<12|(63&w)<<6|63&m,t<65536||t>1114111)continue;_[n++]=t}}return n}}},225:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeV6=void 0;const y=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],_=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let f;c.UnicodeV6=class{constructor(){if(this.version="6",!f){f=new Uint8Array(65536),f.fill(1),f[0]=0,f.fill(0,1,32),f.fill(0,127,160),f.fill(2,4352,4448),f[9001]=2,f[9002]=2,f.fill(2,11904,42192),f[12351]=1,f.fill(2,44032,55204),f.fill(2,63744,64256),f.fill(2,65040,65050),f.fill(2,65072,65136),f.fill(2,65280,65377),f.fill(2,65504,65511);for(let d=0;d<y.length;++d)f.fill(0,y[d][0],y[d][1]+1)}}wcwidth(d){return d<32?0:d<127?1:d<65536?f[d]:function(u,w){let m,n=0,t=w.length-1;if(u<w[0][0]||u>w[t][1])return!1;for(;t>=n;)if(m=n+t>>1,u>w[m][1])n=m+1;else{if(!(u<w[m][0]))return!0;t=m-1}return!1}(d,_)?0:d>=131072&&d<=196605||d>=196608&&d<=262141?2:1}}},5981:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WriteBuffer=void 0;const _=y(8460),f=y(844);class d extends f.Disposable{constructor(w){super(),this._action=w,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new _.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(w,m){if(m!==void 0&&this._syncCalls>m)return void(this._syncCalls=0);if(this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let n;for(this._isSyncWriting=!0;n=this._writeBuffer.shift();){this._action(n);const t=this._callbacks.shift();t&&t()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(w,m){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(m),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(m)}_innerWrite(w=0,m=!0){const n=w||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const t=this._writeBuffer[this._bufferOffset],a=this._action(t,m);if(a){const i=h=>Date.now()-n>=12?setTimeout(()=>this._innerWrite(0,h)):this._innerWrite(n,h);return void a.catch(h=>(queueMicrotask(()=>{throw h}),Promise.resolve(!1))).then(i)}const s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=t.length,Date.now()-n>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}c.WriteBuffer=d},5941:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.toRgbString=c.parseColor=void 0;const y=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,_=/^[\da-f]+$/;function f(d,u){const w=d.toString(16),m=w.length<2?"0"+w:w;switch(u){case 4:return w[0];case 8:return m;case 12:return(m+m).slice(0,3);default:return m+m}}c.parseColor=function(d){if(!d)return;let u=d.toLowerCase();if(u.indexOf("rgb:")===0){u=u.slice(4);const w=y.exec(u);if(w){const m=w[1]?15:w[4]?255:w[7]?4095:65535;return[Math.round(parseInt(w[1]||w[4]||w[7]||w[10],16)/m*255),Math.round(parseInt(w[2]||w[5]||w[8]||w[11],16)/m*255),Math.round(parseInt(w[3]||w[6]||w[9]||w[12],16)/m*255)]}}else if(u.indexOf("#")===0&&(u=u.slice(1),_.exec(u)&&[3,6,9,12].includes(u.length))){const w=u.length/3,m=[0,0,0];for(let n=0;n<3;++n){const t=parseInt(u.slice(w*n,w*n+w),16);m[n]=w===1?t<<4:w===2?t:w===3?t>>4:t>>8}return m}},c.toRgbString=function(d,u=16){const[w,m,n]=d;return`rgb:${f(w,u)}/${f(m,u)}/${f(n,u)}`}},5770:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PAYLOAD_LIMIT=void 0,c.PAYLOAD_LIMIT=1e7},6351:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DcsHandler=c.DcsParser=void 0;const _=y(482),f=y(8742),d=y(5770),u=[];c.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=u,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=u}registerHandler(m,n){this._handlers[m]===void 0&&(this._handlers[m]=[]);const t=this._handlers[m];return t.push(n),{dispose:()=>{const a=t.indexOf(n);a!==-1&&t.splice(a,1)}}}clearHandler(m){this._handlers[m]&&delete this._handlers[m]}setHandlerFallback(m){this._handlerFb=m}reset(){if(this._active.length)for(let m=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;m>=0;--m)this._active[m].unhook(!1);this._stack.paused=!1,this._active=u,this._ident=0}hook(m,n){if(this.reset(),this._ident=m,this._active=this._handlers[m]||u,this._active.length)for(let t=this._active.length-1;t>=0;t--)this._active[t].hook(n);else this._handlerFb(this._ident,"HOOK",n)}put(m,n,t){if(this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].put(m,n,t);else this._handlerFb(this._ident,"PUT",(0,_.utf32ToString)(m,n,t))}unhook(m,n=!0){if(this._active.length){let t=!1,a=this._active.length-1,s=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,t=n,s=this._stack.fallThrough,this._stack.paused=!1),!s&&t===!1){for(;a>=0&&(t=this._active[a].unhook(m),t!==!0);a--)if(t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,t;a--}for(;a>=0;a--)if(t=this._active[a].unhook(!1),t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,t}else this._handlerFb(this._ident,"UNHOOK",m);this._active=u,this._ident=0}};const w=new f.Params;w.addParam(0),c.DcsHandler=class{constructor(m){this._handler=m,this._data="",this._params=w,this._hitLimit=!1}hook(m){this._params=m.length>1||m.params[0]?m.clone():w,this._data="",this._hitLimit=!1}put(m,n,t){this._hitLimit||(this._data+=(0,_.utf32ToString)(m,n,t),this._data.length>d.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(m){let n=!1;if(this._hitLimit)n=!1;else if(m&&(n=this._handler(this._data,this._params),n instanceof Promise))return n.then(t=>(this._params=w,this._data="",this._hitLimit=!1,t));return this._params=w,this._data="",this._hitLimit=!1,n}}},2015:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.EscapeSequenceParser=c.VT500_TRANSITION_TABLE=c.TransitionTable=void 0;const _=y(844),f=y(8742),d=y(6242),u=y(6351);class w{constructor(a){this.table=new Uint8Array(a)}setDefault(a,s){this.table.fill(a<<4|s)}add(a,s,i,h){this.table[s<<8|a]=i<<4|h}addMany(a,s,i,h){for(let p=0;p<a.length;p++)this.table[s<<8|a[p]]=i<<4|h}}c.TransitionTable=w;const m=160;c.VT500_TRANSITION_TABLE=function(){const t=new w(4095),a=Array.apply(null,Array(256)).map((C,v)=>v),s=(C,v)=>a.slice(C,v),i=s(32,127),h=s(0,24);h.push(25),h.push.apply(h,s(28,32));const p=s(0,14);let g;for(g in t.setDefault(1,0),t.addMany(i,0,2,0),p)t.addMany([24,26,153,154],g,3,0),t.addMany(s(128,144),g,3,0),t.addMany(s(144,152),g,3,0),t.add(156,g,0,0),t.add(27,g,11,1),t.add(157,g,4,8),t.addMany([152,158,159],g,0,7),t.add(155,g,11,3),t.add(144,g,11,9);return t.addMany(h,0,3,0),t.addMany(h,1,3,1),t.add(127,1,0,1),t.addMany(h,8,0,8),t.addMany(h,3,3,3),t.add(127,3,0,3),t.addMany(h,4,3,4),t.add(127,4,0,4),t.addMany(h,6,3,6),t.addMany(h,5,3,5),t.add(127,5,0,5),t.addMany(h,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(i,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(s(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(i,7,0,7),t.addMany(h,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(s(64,127),3,7,0),t.addMany(s(48,60),3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(s(48,60),4,8,4),t.addMany(s(64,127),4,7,0),t.addMany([60,61,62,63],4,0,6),t.addMany(s(32,64),6,0,6),t.add(127,6,0,6),t.addMany(s(64,127),6,0,0),t.addMany(s(32,48),3,9,5),t.addMany(s(32,48),5,9,5),t.addMany(s(48,64),5,0,6),t.addMany(s(64,127),5,7,0),t.addMany(s(32,48),4,9,5),t.addMany(s(32,48),1,9,2),t.addMany(s(32,48),2,9,2),t.addMany(s(48,127),2,10,0),t.addMany(s(48,80),1,10,0),t.addMany(s(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(s(96,127),1,10,0),t.add(80,1,11,9),t.addMany(h,9,0,9),t.add(127,9,0,9),t.addMany(s(28,32),9,0,9),t.addMany(s(32,48),9,9,12),t.addMany(s(48,60),9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(h,11,0,11),t.addMany(s(32,128),11,0,11),t.addMany(s(28,32),11,0,11),t.addMany(h,10,0,10),t.add(127,10,0,10),t.addMany(s(28,32),10,0,10),t.addMany(s(48,60),10,8,10),t.addMany([60,61,62,63],10,0,11),t.addMany(s(32,48),10,9,12),t.addMany(h,12,0,12),t.add(127,12,0,12),t.addMany(s(28,32),12,0,12),t.addMany(s(32,48),12,9,12),t.addMany(s(48,64),12,0,11),t.addMany(s(64,127),12,12,13),t.addMany(s(64,127),10,12,13),t.addMany(s(64,127),9,12,13),t.addMany(h,13,13,13),t.addMany(i,13,13,13),t.add(127,13,0,13),t.addMany([27,156,24,26],13,14,0),t.add(m,0,2,0),t.add(m,8,5,8),t.add(m,6,0,6),t.add(m,11,0,11),t.add(m,13,13,13),t}();class n extends _.Disposable{constructor(a=c.VT500_TRANSITION_TABLE){super(),this._transitions=a,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new f.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(s,i,h)=>{},this._executeHandlerFb=s=>{},this._csiHandlerFb=(s,i)=>{},this._escHandlerFb=s=>{},this._errorHandlerFb=s=>s,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,_.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new d.OscParser),this._dcsParser=this.register(new u.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(a,s=[64,126]){let i=0;if(a.prefix){if(a.prefix.length>1)throw new Error("only one byte as prefix supported");if(i=a.prefix.charCodeAt(0),i&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(a.intermediates){if(a.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let p=0;p<a.intermediates.length;++p){const g=a.intermediates.charCodeAt(p);if(32>g||g>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=g}}if(a.final.length!==1)throw new Error("final must be a single byte");const h=a.final.charCodeAt(0);if(s[0]>h||h>s[1])throw new Error(`final must be in range ${s[0]} .. ${s[1]}`);return i<<=8,i|=h,i}identToString(a){const s=[];for(;a;)s.push(String.fromCharCode(255&a)),a>>=8;return s.reverse().join("")}setPrintHandler(a){this._printHandler=a}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(a,s){const i=this._identifier(a,[48,126]);this._escHandlers[i]===void 0&&(this._escHandlers[i]=[]);const h=this._escHandlers[i];return h.push(s),{dispose:()=>{const p=h.indexOf(s);p!==-1&&h.splice(p,1)}}}clearEscHandler(a){this._escHandlers[this._identifier(a,[48,126])]&&delete this._escHandlers[this._identifier(a,[48,126])]}setEscHandlerFallback(a){this._escHandlerFb=a}setExecuteHandler(a,s){this._executeHandlers[a.charCodeAt(0)]=s}clearExecuteHandler(a){this._executeHandlers[a.charCodeAt(0)]&&delete this._executeHandlers[a.charCodeAt(0)]}setExecuteHandlerFallback(a){this._executeHandlerFb=a}registerCsiHandler(a,s){const i=this._identifier(a);this._csiHandlers[i]===void 0&&(this._csiHandlers[i]=[]);const h=this._csiHandlers[i];return h.push(s),{dispose:()=>{const p=h.indexOf(s);p!==-1&&h.splice(p,1)}}}clearCsiHandler(a){this._csiHandlers[this._identifier(a)]&&delete this._csiHandlers[this._identifier(a)]}setCsiHandlerFallback(a){this._csiHandlerFb=a}registerDcsHandler(a,s){return this._dcsParser.registerHandler(this._identifier(a),s)}clearDcsHandler(a){this._dcsParser.clearHandler(this._identifier(a))}setDcsHandlerFallback(a){this._dcsParser.setHandlerFallback(a)}registerOscHandler(a,s){return this._oscParser.registerHandler(a,s)}clearOscHandler(a){this._oscParser.clearHandler(a)}setOscHandlerFallback(a){this._oscParser.setHandlerFallback(a)}setErrorHandler(a){this._errorHandler=a}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(a,s,i,h,p){this._parseStack.state=a,this._parseStack.handlers=s,this._parseStack.handlerPos=i,this._parseStack.transition=h,this._parseStack.chunkPos=p}parse(a,s,i){let h,p=0,g=0,C=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,C=this._parseStack.chunkPos+1;else{if(i===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const v=this._parseStack.handlers;let b=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(i===!1&&b>-1){for(;b>=0&&(h=v[b](this._params),h!==!0);b--)if(h instanceof Promise)return this._parseStack.handlerPos=b,h}this._parseStack.handlers=[];break;case 4:if(i===!1&&b>-1){for(;b>=0&&(h=v[b](),h!==!0);b--)if(h instanceof Promise)return this._parseStack.handlerPos=b,h}this._parseStack.handlers=[];break;case 6:if(p=a[this._parseStack.chunkPos],h=this._dcsParser.unhook(p!==24&&p!==26,i),h)return h;p===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(p=a[this._parseStack.chunkPos],h=this._oscParser.end(p!==24&&p!==26,i),h)return h;p===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,C=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let v=C;v<s;++v){switch(p=a[v],g=this._transitions.table[this.currentState<<8|(p<160?p:m)],g>>4){case 2:for(let O=v+1;;++O){if(O>=s||(p=a[O])<32||p>126&&p<m){this._printHandler(a,v,O),v=O-1;break}if(++O>=s||(p=a[O])<32||p>126&&p<m){this._printHandler(a,v,O),v=O-1;break}if(++O>=s||(p=a[O])<32||p>126&&p<m){this._printHandler(a,v,O),v=O-1;break}if(++O>=s||(p=a[O])<32||p>126&&p<m){this._printHandler(a,v,O),v=O-1;break}}break;case 3:this._executeHandlers[p]?this._executeHandlers[p]():this._executeHandlerFb(p),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:v,code:p,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const b=this._csiHandlers[this._collect<<8|p];let E=b?b.length-1:-1;for(;E>=0&&(h=b[E](this._params),h!==!0);E--)if(h instanceof Promise)return this._preserveStack(3,b,E,g,v),h;E<0&&this._csiHandlerFb(this._collect<<8|p,this._params),this.precedingCodepoint=0;break;case 8:do switch(p){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(p-48)}while(++v<s&&(p=a[v])>47&&p<60);v--;break;case 9:this._collect<<=8,this._collect|=p;break;case 10:const A=this._escHandlers[this._collect<<8|p];let T=A?A.length-1:-1;for(;T>=0&&(h=A[T](),h!==!0);T--)if(h instanceof Promise)return this._preserveStack(4,A,T,g,v),h;T<0&&this._escHandlerFb(this._collect<<8|p),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|p,this._params);break;case 13:for(let O=v+1;;++O)if(O>=s||(p=a[O])===24||p===26||p===27||p>127&&p<m){this._dcsParser.put(a,v,O),v=O-1;break}break;case 14:if(h=this._dcsParser.unhook(p!==24&&p!==26),h)return this._preserveStack(6,[],0,g,v),h;p===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let O=v+1;;O++)if(O>=s||(p=a[O])<32||p>127&&p<m){this._oscParser.put(a,v,O),v=O-1;break}break;case 6:if(h=this._oscParser.end(p!==24&&p!==26),h)return this._preserveStack(5,[],0,g,v),h;p===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&g}}}c.EscapeSequenceParser=n},6242:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OscHandler=c.OscParser=void 0;const _=y(5770),f=y(482),d=[];c.OscParser=class{constructor(){this._state=0,this._active=d,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(u,w){this._handlers[u]===void 0&&(this._handlers[u]=[]);const m=this._handlers[u];return m.push(w),{dispose:()=>{const n=m.indexOf(w);n!==-1&&m.splice(n,1)}}}clearHandler(u){this._handlers[u]&&delete this._handlers[u]}setHandlerFallback(u){this._handlerFb=u}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}reset(){if(this._state===2)for(let u=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;u>=0;--u)this._active[u].end(!1);this._stack.paused=!1,this._active=d,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||d,this._active.length)for(let u=this._active.length-1;u>=0;u--)this._active[u].start();else this._handlerFb(this._id,"START")}_put(u,w,m){if(this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].put(u,w,m);else this._handlerFb(this._id,"PUT",(0,f.utf32ToString)(u,w,m))}start(){this.reset(),this._state=1}put(u,w,m){if(this._state!==3){if(this._state===1)for(;w<m;){const n=u[w++];if(n===59){this._state=2,this._start();break}if(n<48||57<n)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+n-48}this._state===2&&m-w>0&&this._put(u,w,m)}}end(u,w=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let m=!1,n=this._active.length-1,t=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,m=w,t=this._stack.fallThrough,this._stack.paused=!1),!t&&m===!1){for(;n>=0&&(m=this._active[n].end(u),m!==!0);n--)if(m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,m;n--}for(;n>=0;n--)if(m=this._active[n].end(!1),m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,m}else this._handlerFb(this._id,"END",u);this._active=d,this._id=-1,this._state=0}}},c.OscHandler=class{constructor(u){this._handler=u,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(u,w,m){this._hitLimit||(this._data+=(0,f.utf32ToString)(u,w,m),this._data.length>_.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(u){let w=!1;if(this._hitLimit)w=!1;else if(u&&(w=this._handler(this._data),w instanceof Promise))return w.then(m=>(this._data="",this._hitLimit=!1,m));return this._data="",this._hitLimit=!1,w}}},8742:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Params=void 0;const y=2147483647;class _{constructor(d=32,u=32){if(this.maxLength=d,this.maxSubParamsLength=u,u>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(d),this.length=0,this._subParams=new Int32Array(u),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(d),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(d){const u=new _;if(!d.length)return u;for(let w=Array.isArray(d[0])?1:0;w<d.length;++w){const m=d[w];if(Array.isArray(m))for(let n=0;n<m.length;++n)u.addSubParam(m[n]);else u.addParam(m)}return u}clone(){const d=new _(this.maxLength,this.maxSubParamsLength);return d.params.set(this.params),d.length=this.length,d._subParams.set(this._subParams),d._subParamsLength=this._subParamsLength,d._subParamsIdx.set(this._subParamsIdx),d._rejectDigits=this._rejectDigits,d._rejectSubDigits=this._rejectSubDigits,d._digitIsSub=this._digitIsSub,d}toArray(){const d=[];for(let u=0;u<this.length;++u){d.push(this.params[u]);const w=this._subParamsIdx[u]>>8,m=255&this._subParamsIdx[u];m-w>0&&d.push(Array.prototype.slice.call(this._subParams,w,m))}return d}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(d){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=d>y?y:d}}addSubParam(d){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=d>y?y:d,this._subParamsIdx[this.length-1]++}}hasSubParams(d){return(255&this._subParamsIdx[d])-(this._subParamsIdx[d]>>8)>0}getSubParams(d){const u=this._subParamsIdx[d]>>8,w=255&this._subParamsIdx[d];return w-u>0?this._subParams.subarray(u,w):null}getSubParamsAll(){const d={};for(let u=0;u<this.length;++u){const w=this._subParamsIdx[u]>>8,m=255&this._subParamsIdx[u];m-w>0&&(d[u]=this._subParams.slice(w,m))}return d}addDigit(d){let u;if(this._rejectDigits||!(u=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const w=this._digitIsSub?this._subParams:this.params,m=w[u-1];w[u-1]=~m?Math.min(10*m+d,y):d}}c.Params=_},5741:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.AddonManager=void 0,c.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let y=this._addons.length-1;y>=0;y--)this._addons[y].instance.dispose()}loadAddon(y,_){const f={instance:_,dispose:_.dispose,isDisposed:!1};this._addons.push(f),_.dispose=()=>this._wrappedAddonDispose(f),_.activate(y)}_wrappedAddonDispose(y){if(y.isDisposed)return;let _=-1;for(let f=0;f<this._addons.length;f++)if(this._addons[f]===y){_=f;break}if(_===-1)throw new Error("Could not dispose an addon that has not been loaded");y.isDisposed=!0,y.dispose.apply(y.instance),this._addons.splice(_,1)}}},8771:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferApiView=void 0;const _=y(3785),f=y(511);c.BufferApiView=class{constructor(d,u){this._buffer=d,this.type=u}init(d){return this._buffer=d,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(d){const u=this._buffer.lines.get(d);if(u)return new _.BufferLineApiView(u)}getNullCell(){return new f.CellData}}},3785:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLineApiView=void 0;const _=y(511);c.BufferLineApiView=class{constructor(f){this._line=f}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(f,d){if(!(f<0||f>=this._line.length))return d?(this._line.loadCell(f,d),d):this._line.loadCell(f,new _.CellData)}translateToString(f,d,u){return this._line.translateToString(f,d,u)}}},8285:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferNamespaceApi=void 0;const _=y(8771),f=y(8460);c.BufferNamespaceApi=class{constructor(d){this._core=d,this._onBufferChange=new f.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new _.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new _.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ParserApi=void 0,c.ParserApi=class{constructor(y){this._core=y}registerCsiHandler(y,_){return this._core.registerCsiHandler(y,f=>_(f.toArray()))}addCsiHandler(y,_){return this.registerCsiHandler(y,_)}registerDcsHandler(y,_){return this._core.registerDcsHandler(y,(f,d)=>_(f,d.toArray()))}addDcsHandler(y,_){return this.registerDcsHandler(y,_)}registerEscHandler(y,_){return this._core.registerEscHandler(y,_)}addEscHandler(y,_){return this.registerEscHandler(y,_)}registerOscHandler(y,_){return this._core.registerOscHandler(y,_)}addOscHandler(y,_){return this.registerOscHandler(y,_)}}},7090:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeApi=void 0,c.UnicodeApi=class{constructor(y){this._core=y}register(y){this._core.unicodeService.register(y)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(y){this._core.unicodeService.activeVersion=y}}},744:function(j,c,y){var _=this&&this.__decorate||function(t,a,s,i){var h,p=arguments.length,g=p<3?a:i===null?i=Object.getOwnPropertyDescriptor(a,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,a,s,i);else for(var C=t.length-1;C>=0;C--)(h=t[C])&&(g=(p<3?h(g):p>3?h(a,s,g):h(a,s))||g);return p>3&&g&&Object.defineProperty(a,s,g),g},f=this&&this.__param||function(t,a){return function(s,i){a(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferService=c.MINIMUM_ROWS=c.MINIMUM_COLS=void 0;const d=y(2585),u=y(5295),w=y(8460),m=y(844);c.MINIMUM_COLS=2,c.MINIMUM_ROWS=1;let n=class extends m.Disposable{constructor(t){super(),this.isUserScrolling=!1,this._onResize=this.register(new w.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new w.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(t.rawOptions.cols||0,c.MINIMUM_COLS),this.rows=Math.max(t.rawOptions.rows||0,c.MINIMUM_ROWS),this.buffers=this.register(new u.BufferSet(t,this))}get buffer(){return this.buffers.active}resize(t,a){this.cols=t,this.rows=a,this.buffers.resize(t,a),this._onResize.fire({cols:t,rows:a})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(t,a=!1){const s=this.buffer;let i;i=this._cachedBlankLine,i&&i.length===this.cols&&i.getFg(0)===t.fg&&i.getBg(0)===t.bg||(i=s.getBlankLine(t,a),this._cachedBlankLine=i),i.isWrapped=a;const h=s.ybase+s.scrollTop,p=s.ybase+s.scrollBottom;if(s.scrollTop===0){const g=s.lines.isFull;p===s.lines.length-1?g?s.lines.recycle().copyFrom(i):s.lines.push(i.clone()):s.lines.splice(p+1,0,i.clone()),g?this.isUserScrolling&&(s.ydisp=Math.max(s.ydisp-1,0)):(s.ybase++,this.isUserScrolling||s.ydisp++)}else{const g=p-h+1;s.lines.shiftElements(h+1,g-1,-1),s.lines.set(p,i.clone())}this.isUserScrolling||(s.ydisp=s.ybase),this._onScroll.fire(s.ydisp)}scrollLines(t,a,s){const i=this.buffer;if(t<0){if(i.ydisp===0)return;this.isUserScrolling=!0}else t+i.ydisp>=i.ybase&&(this.isUserScrolling=!1);const h=i.ydisp;i.ydisp=Math.max(Math.min(i.ydisp+t,i.ybase),0),h!==i.ydisp&&(a||this._onScroll.fire(i.ydisp))}scrollPages(t){this.scrollLines(t*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(t){const a=t-this.buffer.ydisp;a!==0&&this.scrollLines(a)}};n=_([f(0,d.IOptionsService)],n),c.BufferService=n},7994:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CharsetService=void 0,c.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(y){this.glevel=y,this.charset=this._charsets[y]}setgCharset(y,_){this._charsets[y]=_,this.glevel===y&&(this.charset=_)}}},1753:function(j,c,y){var _=this&&this.__decorate||function(i,h,p,g){var C,v=arguments.length,b=v<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(i,h,p,g);else for(var E=i.length-1;E>=0;E--)(C=i[E])&&(b=(v<3?C(b):v>3?C(h,p,b):C(h,p))||b);return v>3&&b&&Object.defineProperty(h,p,b),b},f=this&&this.__param||function(i,h){return function(p,g){h(p,g,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreMouseService=void 0;const d=y(2585),u=y(8460),w=y(844),m={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:i=>i.button!==4&&i.action===1&&(i.ctrl=!1,i.alt=!1,i.shift=!1,!0)},VT200:{events:19,restrict:i=>i.action!==32},DRAG:{events:23,restrict:i=>i.action!==32||i.button!==3},ANY:{events:31,restrict:i=>!0}};function n(i,h){let p=(i.ctrl?16:0)|(i.shift?4:0)|(i.alt?8:0);return i.button===4?(p|=64,p|=i.action):(p|=3&i.button,4&i.button&&(p|=64),8&i.button&&(p|=128),i.action===32?p|=32:i.action!==0||h||(p|=3)),p}const t=String.fromCharCode,a={DEFAULT:i=>{const h=[n(i,!1)+32,i.col+32,i.row+32];return h[0]>255||h[1]>255||h[2]>255?"":`\x1B[M${t(h[0])}${t(h[1])}${t(h[2])}`},SGR:i=>{const h=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${n(i,!0)};${i.col};${i.row}${h}`},SGR_PIXELS:i=>{const h=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${n(i,!0)};${i.x};${i.y}${h}`}};let s=class extends w.Disposable{constructor(i,h){super(),this._bufferService=i,this._coreService=h,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new u.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const p of Object.keys(m))this.addProtocol(p,m[p]);for(const p of Object.keys(a))this.addEncoding(p,a[p]);this.reset()}addProtocol(i,h){this._protocols[i]=h}addEncoding(i,h){this._encodings[i]=h}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(i){if(!this._protocols[i])throw new Error(`unknown protocol "${i}"`);this._activeProtocol=i,this._onProtocolChange.fire(this._protocols[i].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(i){if(!this._encodings[i])throw new Error(`unknown encoding "${i}"`);this._activeEncoding=i}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(i){if(i.col<0||i.col>=this._bufferService.cols||i.row<0||i.row>=this._bufferService.rows||i.button===4&&i.action===32||i.button===3&&i.action!==32||i.button!==4&&(i.action===2||i.action===3)||(i.col++,i.row++,i.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,i,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(i))return!1;const h=this._encodings[this._activeEncoding](i);return h&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(h):this._coreService.triggerDataEvent(h,!0)),this._lastEvent=i,!0}explainEvents(i){return{down:!!(1&i),up:!!(2&i),drag:!!(4&i),move:!!(8&i),wheel:!!(16&i)}}_equalEvents(i,h,p){if(p){if(i.x!==h.x||i.y!==h.y)return!1}else if(i.col!==h.col||i.row!==h.row)return!1;return i.button===h.button&&i.action===h.action&&i.ctrl===h.ctrl&&i.alt===h.alt&&i.shift===h.shift}};s=_([f(0,d.IBufferService),f(1,d.ICoreService)],s),c.CoreMouseService=s},6975:function(j,c,y){var _=this&&this.__decorate||function(s,i,h,p){var g,C=arguments.length,v=C<3?i:p===null?p=Object.getOwnPropertyDescriptor(i,h):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(s,i,h,p);else for(var b=s.length-1;b>=0;b--)(g=s[b])&&(v=(C<3?g(v):C>3?g(i,h,v):g(i,h))||v);return C>3&&v&&Object.defineProperty(i,h,v),v},f=this&&this.__param||function(s,i){return function(h,p){i(h,p,s)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreService=void 0;const d=y(2585),u=y(8460),w=y(1439),m=y(844),n=Object.freeze({insertMode:!1}),t=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let a=class extends m.Disposable{constructor(s,i,h){super(),this._bufferService=s,this._logService=i,this._optionsService=h,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new u.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new u.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new u.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new u.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,w.clone)(n),this.decPrivateModes=(0,w.clone)(t)}reset(){this.modes=(0,w.clone)(n),this.decPrivateModes=(0,w.clone)(t)}triggerDataEvent(s,i=!1){if(this._optionsService.rawOptions.disableStdin)return;const h=this._bufferService.buffer;i&&this._optionsService.rawOptions.scrollOnUserInput&&h.ybase!==h.ydisp&&this._onRequestScrollToBottom.fire(),i&&this._onUserInput.fire(),this._logService.debug(`sending data "${s}"`,()=>s.split("").map(p=>p.charCodeAt(0))),this._onData.fire(s)}triggerBinaryEvent(s){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${s}"`,()=>s.split("").map(i=>i.charCodeAt(0))),this._onBinary.fire(s))}};a=_([f(0,d.IBufferService),f(1,d.ILogService),f(2,d.IOptionsService)],a),c.CoreService=a},9074:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DecorationService=void 0;const _=y(8055),f=y(8460),d=y(844),u=y(6106);let w=0,m=0;class n extends d.Disposable{constructor(){super(),this._decorations=new u.SortedList(s=>s==null?void 0:s.marker.line),this._onDecorationRegistered=this.register(new f.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new f.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,d.toDisposable)(()=>{for(const s of this._decorations.values())this._onDecorationRemoved.fire(s);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(s){if(s.marker.isDisposed)return;const i=new t(s);if(i){const h=i.marker.onDispose(()=>i.dispose());i.onDispose(()=>{i&&(this._decorations.delete(i)&&this._onDecorationRemoved.fire(i),h.dispose())}),this._decorations.insert(i),this._onDecorationRegistered.fire(i)}return i}reset(){for(const s of this._decorations.values())s.dispose();this._decorations.clear()}*getDecorationsAtCell(s,i,h){var p,g,C;let v=0,b=0;for(const E of this._decorations.getKeyIterator(i))v=(p=E.options.x)!==null&&p!==void 0?p:0,b=v+((g=E.options.width)!==null&&g!==void 0?g:1),s>=v&&s<b&&(!h||((C=E.options.layer)!==null&&C!==void 0?C:"bottom")===h)&&(yield E)}forEachDecorationAtCell(s,i,h,p){this._decorations.forEachByKey(i,g=>{var C,v,b;w=(C=g.options.x)!==null&&C!==void 0?C:0,m=w+((v=g.options.width)!==null&&v!==void 0?v:1),s>=w&&s<m&&(!h||((b=g.options.layer)!==null&&b!==void 0?b:"bottom")===h)&&p(g)})}dispose(){for(const s of this._decorations.values())this._onDecorationRemoved.fire(s);this.reset()}}c.DecorationService=n;class t extends d.Disposable{constructor(s){super(),this.options=s,this.onRenderEmitter=this.register(new f.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new f.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=s.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=_.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=_.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.InstantiationService=c.ServiceCollection=void 0;const _=y(2585),f=y(8343);class d{constructor(...w){this._entries=new Map;for(const[m,n]of w)this.set(m,n)}set(w,m){const n=this._entries.get(w);return this._entries.set(w,m),n}forEach(w){for(const[m,n]of this._entries.entries())w(m,n)}has(w){return this._entries.has(w)}get(w){return this._entries.get(w)}}c.ServiceCollection=d,c.InstantiationService=class{constructor(){this._services=new d,this._services.set(_.IInstantiationService,this)}setService(u,w){this._services.set(u,w)}getService(u){return this._services.get(u)}createInstance(u,...w){const m=(0,f.getServiceDependencies)(u).sort((a,s)=>a.index-s.index),n=[];for(const a of m){const s=this._services.get(a.id);if(!s)throw new Error(`[createInstance] ${u.name} depends on UNKNOWN service ${a.id}.`);n.push(s)}const t=m.length>0?m[0].index:w.length;if(w.length!==t)throw new Error(`[createInstance] First service dependency of ${u.name} at position ${t+1} conflicts with ${w.length} static arguments`);return new u(...w,...n)}}},7866:function(j,c,y){var _=this&&this.__decorate||function(n,t,a,s){var i,h=arguments.length,p=h<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,a):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(n,t,a,s);else for(var g=n.length-1;g>=0;g--)(i=n[g])&&(p=(h<3?i(p):h>3?i(t,a,p):i(t,a))||p);return h>3&&p&&Object.defineProperty(t,a,p),p},f=this&&this.__param||function(n,t){return function(a,s){t(a,s,n)}};Object.defineProperty(c,"__esModule",{value:!0}),c.LogService=void 0;const d=y(844),u=y(2585),w={debug:u.LogLevelEnum.DEBUG,info:u.LogLevelEnum.INFO,warn:u.LogLevelEnum.WARN,error:u.LogLevelEnum.ERROR,off:u.LogLevelEnum.OFF};let m=class extends d.Disposable{constructor(n){super(),this._optionsService=n,this.logLevel=u.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=w[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(n){for(let t=0;t<n.length;t++)typeof n[t]=="function"&&(n[t]=n[t]())}_log(n,t,a){this._evalLazyOptionalParams(a),n.call(console,"xterm.js: "+t,...a)}debug(n,...t){this.logLevel<=u.LogLevelEnum.DEBUG&&this._log(console.log,n,t)}info(n,...t){this.logLevel<=u.LogLevelEnum.INFO&&this._log(console.info,n,t)}warn(n,...t){this.logLevel<=u.LogLevelEnum.WARN&&this._log(console.warn,n,t)}error(n,...t){this.logLevel<=u.LogLevelEnum.ERROR&&this._log(console.error,n,t)}};m=_([f(0,u.IOptionsService)],m),c.LogService=m},7302:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OptionsService=c.DEFAULT_OPTIONS=void 0;const _=y(8460),f=y(6114),d=y(844);c.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:f.isMac,windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const u=["normal","bold","100","200","300","400","500","600","700","800","900"];class w extends d.Disposable{constructor(n){super(),this._onOptionChange=this.register(new _.EventEmitter),this.onOptionChange=this._onOptionChange.event;const t=Object.assign({},c.DEFAULT_OPTIONS);for(const a in n)if(a in t)try{const s=n[a];t[a]=this._sanitizeAndValidateOption(a,s)}catch(s){console.error(s)}this.rawOptions=t,this.options=Object.assign({},t),this._setupOptions()}onSpecificOptionChange(n,t){return this.onOptionChange(a=>{a===n&&t(this.rawOptions[n])})}onMultipleOptionChange(n,t){return this.onOptionChange(a=>{n.indexOf(a)!==-1&&t()})}_setupOptions(){const n=a=>{if(!(a in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);return this.rawOptions[a]},t=(a,s)=>{if(!(a in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);s=this._sanitizeAndValidateOption(a,s),this.rawOptions[a]!==s&&(this.rawOptions[a]=s,this._onOptionChange.fire(a))};for(const a in this.rawOptions){const s={get:n.bind(this,a),set:t.bind(this,a)};Object.defineProperty(this.options,a,s)}}_sanitizeAndValidateOption(n,t){switch(n){case"cursorStyle":if(t||(t=c.DEFAULT_OPTIONS[n]),!function(a){return a==="block"||a==="underline"||a==="bar"}(t))throw new Error(`"${t}" is not a valid value for ${n}`);break;case"wordSeparator":t||(t=c.DEFAULT_OPTIONS[n]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=u.includes(t)?t:c.DEFAULT_OPTIONS[n];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${n} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(10*t)/10));break;case"scrollback":if((t=Math.min(t,4294967295))<0)throw new Error(`${n} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${n} cannot be less than or equal to 0, value: ${t}`);case"rows":case"cols":if(!t&&t!==0)throw new Error(`${n} must be numeric, value: ${t}`)}return t}}c.OptionsService=w},2660:function(j,c,y){var _=this&&this.__decorate||function(w,m,n,t){var a,s=arguments.length,i=s<3?m:t===null?t=Object.getOwnPropertyDescriptor(m,n):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(w,m,n,t);else for(var h=w.length-1;h>=0;h--)(a=w[h])&&(i=(s<3?a(i):s>3?a(m,n,i):a(m,n))||i);return s>3&&i&&Object.defineProperty(m,n,i),i},f=this&&this.__param||function(w,m){return function(n,t){m(n,t,w)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkService=void 0;const d=y(2585);let u=class{constructor(w){this._bufferService=w,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(w){const m=this._bufferService.buffer;if(w.id===void 0){const h=m.addMarker(m.ybase+m.y),p={data:w,id:this._nextId++,lines:[h]};return h.onDispose(()=>this._removeMarkerFromLink(p,h)),this._dataByLinkId.set(p.id,p),p.id}const n=w,t=this._getEntryIdKey(n),a=this._entriesWithId.get(t);if(a)return this.addLineToLink(a.id,m.ybase+m.y),a.id;const s=m.addMarker(m.ybase+m.y),i={id:this._nextId++,key:this._getEntryIdKey(n),data:n,lines:[s]};return s.onDispose(()=>this._removeMarkerFromLink(i,s)),this._entriesWithId.set(i.key,i),this._dataByLinkId.set(i.id,i),i.id}addLineToLink(w,m){const n=this._dataByLinkId.get(w);if(n&&n.lines.every(t=>t.line!==m)){const t=this._bufferService.buffer.addMarker(m);n.lines.push(t),t.onDispose(()=>this._removeMarkerFromLink(n,t))}}getLinkData(w){var m;return(m=this._dataByLinkId.get(w))===null||m===void 0?void 0:m.data}_getEntryIdKey(w){return`${w.id};;${w.uri}`}_removeMarkerFromLink(w,m){const n=w.lines.indexOf(m);n!==-1&&(w.lines.splice(n,1),w.lines.length===0&&(w.data.id!==void 0&&this._entriesWithId.delete(w.key),this._dataByLinkId.delete(w.id)))}};u=_([f(0,d.IBufferService)],u),c.OscLinkService=u},8343:(j,c)=>{function y(_,f,d){f.di$target===f?f.di$dependencies.push({id:_,index:d}):(f.di$dependencies=[{id:_,index:d}],f.di$target=f)}Object.defineProperty(c,"__esModule",{value:!0}),c.createDecorator=c.getServiceDependencies=c.serviceRegistry=void 0,c.serviceRegistry=new Map,c.getServiceDependencies=function(_){return _.di$dependencies||[]},c.createDecorator=function(_){if(c.serviceRegistry.has(_))return c.serviceRegistry.get(_);const f=function(d,u,w){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");y(f,d,w)};return f.toString=()=>_,c.serviceRegistry.set(_,f),f}},2585:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IDecorationService=c.IUnicodeService=c.IOscLinkService=c.IOptionsService=c.ILogService=c.LogLevelEnum=c.IInstantiationService=c.ICharsetService=c.ICoreService=c.ICoreMouseService=c.IBufferService=void 0;const _=y(8343);var f;c.IBufferService=(0,_.createDecorator)("BufferService"),c.ICoreMouseService=(0,_.createDecorator)("CoreMouseService"),c.ICoreService=(0,_.createDecorator)("CoreService"),c.ICharsetService=(0,_.createDecorator)("CharsetService"),c.IInstantiationService=(0,_.createDecorator)("InstantiationService"),(f=c.LogLevelEnum||(c.LogLevelEnum={}))[f.DEBUG=0]="DEBUG",f[f.INFO=1]="INFO",f[f.WARN=2]="WARN",f[f.ERROR=3]="ERROR",f[f.OFF=4]="OFF",c.ILogService=(0,_.createDecorator)("LogService"),c.IOptionsService=(0,_.createDecorator)("OptionsService"),c.IOscLinkService=(0,_.createDecorator)("OscLinkService"),c.IUnicodeService=(0,_.createDecorator)("UnicodeService"),c.IDecorationService=(0,_.createDecorator)("DecorationService")},1480:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeService=void 0;const _=y(8460),f=y(225);c.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new _.EventEmitter,this.onChange=this._onChange.event;const d=new f.UnicodeV6;this.register(d),this._active=d.version,this._activeProvider=d}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(d){if(!this._providers[d])throw new Error(`unknown Unicode version "${d}"`);this._active=d,this._activeProvider=this._providers[d],this._onChange.fire(d)}register(d){this._providers[d.version]=d}wcwidth(d){return this._activeProvider.wcwidth(d)}getStringCellWidth(d){let u=0;const w=d.length;for(let m=0;m<w;++m){let n=d.charCodeAt(m);if(55296<=n&&n<=56319){if(++m>=w)return u+this.wcwidth(n);const t=d.charCodeAt(m);56320<=t&&t<=57343?n=1024*(n-55296)+t-56320+65536:u+=this.wcwidth(t)}u+=this.wcwidth(n)}return u}}}},ne={};function ue(j){var c=ne[j];if(c!==void 0)return c.exports;var y=ne[j]={exports:{}};return Q[j].call(y.exports,y,y.exports,ue),y.exports}var pe={};return(()=>{var j=pe;Object.defineProperty(j,"__esModule",{value:!0}),j.Terminal=void 0;const c=ue(3236),y=ue(9042),_=ue(7975),f=ue(7090),d=ue(5741),u=ue(8285),w=["cols","rows"];j.Terminal=class{constructor(m){this._core=new c.Terminal(m),this._addonManager=new d.AddonManager,this._publicOptions=Object.assign({},this._core.options);const n=a=>this._core.options[a],t=(a,s)=>{this._checkReadonlyOptions(a),this._core.options[a]=s};for(const a in this._core.options){const s={get:n.bind(this,a),set:t.bind(this,a)};Object.defineProperty(this._publicOptions,a,s)}}_checkReadonlyOptions(m){if(w.includes(m))throw new Error(`Option "${m}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new _.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new f.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new u.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const m=this._core.coreService.decPrivateModes;let n="none";switch(this._core.coreMouseService.activeProtocol){case"X10":n="x10";break;case"VT200":n="vt200";break;case"DRAG":n="drag";break;case"ANY":n="any"}return{applicationCursorKeysMode:m.applicationCursorKeys,applicationKeypadMode:m.applicationKeypad,bracketedPasteMode:m.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:n,originMode:m.origin,reverseWraparoundMode:m.reverseWraparound,sendFocusMode:m.sendFocus,wraparoundMode:m.wraparound}}get options(){return this._publicOptions}set options(m){for(const n in m)this._publicOptions[n]=m[n]}blur(){this._core.blur()}focus(){this._core.focus()}resize(m,n){this._verifyIntegers(m,n),this._core.resize(m,n)}open(m){this._core.open(m)}attachCustomKeyEventHandler(m){this._core.attachCustomKeyEventHandler(m)}registerLinkProvider(m){return this._core.registerLinkProvider(m)}registerCharacterJoiner(m){return this._checkProposedApi(),this._core.registerCharacterJoiner(m)}deregisterCharacterJoiner(m){this._checkProposedApi(),this._core.deregisterCharacterJoiner(m)}registerMarker(m=0){return this._verifyIntegers(m),this._core.addMarker(m)}registerDecoration(m){var n,t,a;return this._checkProposedApi(),this._verifyPositiveIntegers((n=m.x)!==null&&n!==void 0?n:0,(t=m.width)!==null&&t!==void 0?t:0,(a=m.height)!==null&&a!==void 0?a:0),this._core.registerDecoration(m)}hasSelection(){return this._core.hasSelection()}select(m,n,t){this._verifyIntegers(m,n,t),this._core.select(m,n,t)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(m,n){this._verifyIntegers(m,n),this._core.selectLines(m,n)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(m){this._verifyIntegers(m),this._core.scrollLines(m)}scrollPages(m){this._verifyIntegers(m),this._core.scrollPages(m)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(m){this._verifyIntegers(m),this._core.scrollToLine(m)}clear(){this._core.clear()}write(m,n){this._core.write(m,n)}writeln(m,n){this._core.write(m),this._core.write(`\r
`,n)}paste(m){this._core.paste(m)}refresh(m,n){this._verifyIntegers(m,n),this._core.refresh(m,n)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(m){return this._addonManager.loadAddon(this,m)}static get strings(){return y}_verifyIntegers(...m){for(const n of m)if(n===1/0||isNaN(n)||n%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...m){for(const n of m)if(n&&(n===1/0||isNaN(n)||n%1!=0||n<0))throw new Error("This API only accepts positive integers")}}})(),pe})())})(_s);var Mn=_s.exports,vs={exports:{}};(function(q,U){(function(Q,ne){q.exports=ne()})(self,function(){return(()=>{var Q={903:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BaseRenderLayer=void 0;const _=y(503),f=y(627),d=y(237),u=y(860),w=y(374),m=y(296),n=y(855),t=y(274),a=y(859),s=y(399),i=y(345);class h extends a.Disposable{constructor(C,v,b,E,A,T,O,H,M,N){super(),this._terminal=C,this._container=v,this._alpha=A,this._themeService=T,this._bufferService=O,this._optionsService=H,this._decorationService=M,this._coreBrowserService=N,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._selectionModel=(0,m.createSelectionRenderModel)(),this._bitmapGenerator=[],this._onAddTextureAtlasCanvas=this.register(new i.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._cellColorResolver=new t.CellColorResolver(this._terminal,this._selectionModel,this._decorationService,this._coreBrowserService,this._themeService),this._canvas=document.createElement("canvas"),this._canvas.classList.add(`xterm-${b}-layer`),this._canvas.style.zIndex=E.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this._refreshCharAtlas(this._themeService.colors),this.register(this._themeService.onChangeColors(L=>{this._refreshCharAtlas(L),this.reset()})),this.register((0,a.toDisposable)(()=>{var L;(0,_.removeElementFromParent)(this._canvas),(L=this._charAtlas)===null||L===void 0||L.dispose()}))}get canvas(){return this._canvas}get cacheCanvas(){var C;return(C=this._charAtlas)===null||C===void 0?void 0:C.pages[0].canvas}_initCanvas(){this._ctx=(0,w.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(){}handleFocus(){}handleCursorMove(){}handleGridChanged(C,v){}handleSelectionChanged(C,v,b=!1){this._selectionModel.update(this._terminal,C,v,b)}_setTransparency(C){if(C===this._alpha)return;const v=this._canvas;this._alpha=C,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,v),this._refreshCharAtlas(this._themeService.colors),this.handleGridChanged(0,this._bufferService.rows-1)}_refreshCharAtlas(C){var v;if(!(this._deviceCharWidth<=0&&this._deviceCharHeight<=0)){(v=this._charAtlasDisposable)===null||v===void 0||v.dispose(),this._charAtlas=(0,f.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,C,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlasDisposable=(0,i.forwardEvent)(this._charAtlas.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),this._charAtlas.warmUp();for(let b=0;b<this._charAtlas.pages.length;b++)this._bitmapGenerator[b]=new p(this._charAtlas.pages[b].canvas)}}resize(C){this._deviceCellWidth=C.device.cell.width,this._deviceCellHeight=C.device.cell.height,this._deviceCharWidth=C.device.char.width,this._deviceCharHeight=C.device.char.height,this._deviceCharLeft=C.device.char.left,this._deviceCharTop=C.device.char.top,this._canvas.width=C.device.canvas.width,this._canvas.height=C.device.canvas.height,this._canvas.style.width=`${C.css.canvas.width}px`,this._canvas.style.height=`${C.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(this._themeService.colors)}clearTextureAtlas(){var C;(C=this._charAtlas)===null||C===void 0||C.clearTexture()}_fillCells(C,v,b,E){this._ctx.fillRect(C*this._deviceCellWidth,v*this._deviceCellHeight,b*this._deviceCellWidth,E*this._deviceCellHeight)}_fillMiddleLineAtCells(C,v,b=1){const E=Math.ceil(.5*this._deviceCellHeight);this._ctx.fillRect(C*this._deviceCellWidth,(v+1)*this._deviceCellHeight-E-this._coreBrowserService.dpr,b*this._deviceCellWidth,this._coreBrowserService.dpr)}_fillBottomLineAtCells(C,v,b=1,E=0){this._ctx.fillRect(C*this._deviceCellWidth,(v+1)*this._deviceCellHeight+E-this._coreBrowserService.dpr-1,b*this._deviceCellWidth,this._coreBrowserService.dpr)}_curlyUnderlineAtCell(C,v,b=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const E=this._coreBrowserService.dpr;this._ctx.lineWidth=E;for(let A=0;A<b;A++){const T=(C+A)*this._deviceCellWidth,O=(C+A+.5)*this._deviceCellWidth,H=(C+A+1)*this._deviceCellWidth,M=(v+1)*this._deviceCellHeight-E-1,N=M-E,L=M+E;this._ctx.moveTo(T,M),this._ctx.bezierCurveTo(T,N,O,N,O,M),this._ctx.bezierCurveTo(O,L,H,L,H,M)}this._ctx.stroke(),this._ctx.restore()}_dottedUnderlineAtCell(C,v,b=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const E=this._coreBrowserService.dpr;this._ctx.lineWidth=E,this._ctx.setLineDash([2*E,E]);const A=C*this._deviceCellWidth,T=(v+1)*this._deviceCellHeight-E-1;this._ctx.moveTo(A,T);for(let O=0;O<b;O++){const H=(C+b+O)*this._deviceCellWidth;this._ctx.lineTo(H,T)}this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}_dashedUnderlineAtCell(C,v,b=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const E=this._coreBrowserService.dpr;this._ctx.lineWidth=E,this._ctx.setLineDash([4*E,3*E]);const A=C*this._deviceCellWidth,T=(C+b)*this._deviceCellWidth,O=(v+1)*this._deviceCellHeight-E-1;this._ctx.moveTo(A,O),this._ctx.lineTo(T,O),this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}_fillLeftLineAtCell(C,v,b){this._ctx.fillRect(C*this._deviceCellWidth,v*this._deviceCellHeight,this._coreBrowserService.dpr*b,this._deviceCellHeight)}_strokeRectAtCell(C,v,b,E){const A=this._coreBrowserService.dpr;this._ctx.lineWidth=A,this._ctx.strokeRect(C*this._deviceCellWidth+A/2,v*this._deviceCellHeight+A/2,b*this._deviceCellWidth-A,E*this._deviceCellHeight-A)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(C,v,b,E){this._alpha?this._ctx.clearRect(C*this._deviceCellWidth,v*this._deviceCellHeight,b*this._deviceCellWidth,E*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(C*this._deviceCellWidth,v*this._deviceCellHeight,b*this._deviceCellWidth,E*this._deviceCellHeight))}_fillCharTrueColor(C,v,b){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=d.TEXT_BASELINE,this._clipRow(b);let E=!1;this._optionsService.rawOptions.customGlyphs!==!1&&(E=(0,u.tryDrawCustomChar)(this._ctx,C.getChars(),v*this._deviceCellWidth,b*this._deviceCellHeight,this._deviceCellWidth,this._deviceCellHeight,this._optionsService.rawOptions.fontSize,this._coreBrowserService.dpr)),E||this._ctx.fillText(C.getChars(),v*this._deviceCellWidth+this._deviceCharLeft,b*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_drawChars(C,v,b){var E,A;const T=C.getChars();let O;this._cellColorResolver.resolve(C,v,this._bufferService.buffer.ydisp+b),O=T&&T.length>1?this._charAtlas.getRasterizedGlyphCombinedChar(T,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext):this._charAtlas.getRasterizedGlyph(C.getCode()||n.WHITESPACE_CELL_CODE,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext),O.size.x&&O.size.y&&(this._ctx.save(),this._clipRow(b),this._charAtlas.pages[O.texturePage].version!==((E=this._bitmapGenerator[O.texturePage])===null||E===void 0?void 0:E.version)&&(this._bitmapGenerator[O.texturePage]||(this._bitmapGenerator[O.texturePage]=new p(this._charAtlas.pages[O.texturePage].canvas)),this._bitmapGenerator[O.texturePage].refresh(),this._bitmapGenerator[O.texturePage].version=this._charAtlas.pages[O.texturePage].version),this._ctx.drawImage(((A=this._bitmapGenerator[O.texturePage])===null||A===void 0?void 0:A.bitmap)||this._charAtlas.pages[O.texturePage].canvas,O.texturePosition.x,O.texturePosition.y,O.size.x,O.size.y,v*this._deviceCellWidth+this._deviceCharLeft-O.offset.x,b*this._deviceCellHeight+this._deviceCharTop-O.offset.y,O.size.x,O.size.y),this._ctx.restore())}_clipRow(C){this._ctx.beginPath(),this._ctx.rect(0,C*this._deviceCellHeight,this._bufferService.cols*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(C,v){return`${v?"italic":""} ${C?this._optionsService.rawOptions.fontWeightBold:this._optionsService.rawOptions.fontWeight} ${this._optionsService.rawOptions.fontSize*this._coreBrowserService.dpr}px ${this._optionsService.rawOptions.fontFamily}`}}c.BaseRenderLayer=h;class p{constructor(C){this._canvas=C,this._state=0,this._commitTimeout=void 0,this._bitmap=void 0,this.version=-1}get bitmap(){return this._bitmap}refresh(){this._bitmap=void 0,s.isSafari||(this._commitTimeout===void 0&&(this._commitTimeout=window.setTimeout(()=>this._generate(),100)),this._state===1&&(this._state=2))}_generate(){this._state===0&&(this._bitmap=void 0,this._state=1,window.createImageBitmap(this._canvas).then(C=>{this._state===2?this.refresh():this._bitmap=C,this._state=0}),this._commitTimeout&&(this._commitTimeout=void 0))}}},949:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CanvasRenderer=void 0;const _=y(627),f=y(56),d=y(374),u=y(345),w=y(859),m=y(873),n=y(43),t=y(630),a=y(744);class s extends w.Disposable{constructor(h,p,g,C,v,b,E,A,T,O,H){super(),this._terminal=h,this._screenElement=p,this._bufferService=C,this._charSizeService=v,this._optionsService=b,this._coreBrowserService=T,this._themeService=H,this._onRequestRedraw=this.register(new u.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onChangeTextureAtlas=this.register(new u.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new u.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event;const M=this._optionsService.rawOptions.allowTransparency;this._renderLayers=[new a.TextRenderLayer(this._terminal,this._screenElement,0,M,this._bufferService,this._optionsService,E,O,this._coreBrowserService,H),new t.SelectionRenderLayer(this._terminal,this._screenElement,1,this._bufferService,this._coreBrowserService,O,this._optionsService,H),new n.LinkRenderLayer(this._terminal,this._screenElement,2,g,this._bufferService,this._optionsService,O,this._coreBrowserService,H),new m.CursorRenderLayer(this._terminal,this._screenElement,3,this._onRequestRedraw,this._bufferService,this._optionsService,A,this._coreBrowserService,O,H)];for(const N of this._renderLayers)(0,u.forwardEvent)(N.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas);this.dimensions=(0,d.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this.register((0,f.observeDevicePixelDimensions)(this._renderLayers[0].canvas,this._coreBrowserService.window,(N,L)=>this._setCanvasDevicePixelDimensions(N,L))),this.register((0,w.toDisposable)(()=>{for(const N of this._renderLayers)N.dispose();(0,_.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){return this._renderLayers[0].cacheCanvas}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._bufferService.cols,this._bufferService.rows))}handleResize(h,p){this._updateDimensions();for(const g of this._renderLayers)g.resize(this.dimensions);this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}handleCharSizeChanged(){this.handleResize(this._bufferService.cols,this._bufferService.rows)}handleBlur(){this._runOperation(h=>h.handleBlur())}handleFocus(){this._runOperation(h=>h.handleFocus())}handleSelectionChanged(h,p,g=!1){this._runOperation(C=>C.handleSelectionChanged(h,p,g)),this._themeService.colors.selectionForeground&&this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}handleCursorMove(){this._runOperation(h=>h.handleCursorMove())}clear(){this._runOperation(h=>h.reset())}_runOperation(h){for(const p of this._renderLayers)h(p)}renderRows(h,p){for(const g of this._renderLayers)g.handleGridChanged(h,p)}clearTextureAtlas(){for(const h of this._renderLayers)h.clearTextureAtlas()}_updateDimensions(){if(!this._charSizeService.hasValidSize)return;const h=this._coreBrowserService.dpr;this.dimensions.device.char.width=Math.floor(this._charSizeService.width*h),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*h),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._bufferService.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._bufferService.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/h),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/h),this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows,this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols}_setCanvasDevicePixelDimensions(h,p){this.dimensions.device.canvas.height=p,this.dimensions.device.canvas.width=h;for(const g of this._renderLayers)g.resize(this.dimensions);this._requestRedrawViewport()}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}}c.CanvasRenderer=s},873:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CursorRenderLayer=void 0;const _=y(903),f=y(782),d=y(859);class u extends _.BaseRenderLayer{constructor(n,t,a,s,i,h,p,g,C,v){super(n,t,"cursor",a,!0,v,i,h,C,g),this._onRequestRedraw=s,this._coreService=p,this._cell=new f.CellData,this._state={x:0,y:0,isFocused:!1,style:"",width:0},this._cursorRenderers={bar:this._renderBarCursor.bind(this),block:this._renderBlockCursor.bind(this),underline:this._renderUnderlineCursor.bind(this)},this.register(h.onOptionChange(()=>this._handleOptionsChanged())),this.register((0,d.toDisposable)(()=>{var b;(b=this._cursorBlinkStateManager)===null||b===void 0||b.dispose(),this._cursorBlinkStateManager=void 0}))}resize(n){super.resize(n),this._state={x:0,y:0,isFocused:!1,style:"",width:0}}reset(){var n;this._clearCursor(),(n=this._cursorBlinkStateManager)===null||n===void 0||n.restartBlinkAnimation(),this._handleOptionsChanged()}handleBlur(){var n;(n=this._cursorBlinkStateManager)===null||n===void 0||n.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}handleFocus(){var n;(n=this._cursorBlinkStateManager)===null||n===void 0||n.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}_handleOptionsChanged(){var n;this._optionsService.rawOptions.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new w(this._coreBrowserService.isFocused,()=>{this._render(!0)},this._coreBrowserService)):((n=this._cursorBlinkStateManager)===null||n===void 0||n.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}handleCursorMove(){var n;(n=this._cursorBlinkStateManager)===null||n===void 0||n.restartBlinkAnimation()}handleGridChanged(n,t){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(!1):this._cursorBlinkStateManager.restartBlinkAnimation()}_render(n){if(!this._coreService.isCursorInitialized||this._coreService.isCursorHidden)return void this._clearCursor();const t=this._bufferService.buffer.ybase+this._bufferService.buffer.y,a=t-this._bufferService.buffer.ydisp;if(a<0||a>=this._bufferService.rows)return void this._clearCursor();const s=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(t).loadCell(s,this._cell),this._cell.content!==void 0){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css;const i=this._optionsService.rawOptions.cursorStyle;return i&&i!=="block"?this._cursorRenderers[i](s,a,this._cell):this._renderBlurCursor(s,a,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=a,this._state.isFocused=!1,this._state.style=i,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===s&&this._state.y===a&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.rawOptions.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.rawOptions.cursorStyle||"block"](s,a,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=a,this._state.isFocused=!1,this._state.style=this._optionsService.rawOptions.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}_clearCursor(){this._state&&(this._coreBrowserService.dpr<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})}_renderBarCursor(n,t,a){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillLeftLineAtCell(n,t,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()}_renderBlockCursor(n,t,a){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillCells(n,t,a.getWidth(),1),this._ctx.fillStyle=this._themeService.colors.cursorAccent.css,this._fillCharTrueColor(a,n,t),this._ctx.restore()}_renderUnderlineCursor(n,t,a){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillBottomLineAtCells(n,t),this._ctx.restore()}_renderBlurCursor(n,t,a){this._ctx.save(),this._ctx.strokeStyle=this._themeService.colors.cursor.css,this._strokeRectAtCell(n,t,a.getWidth(),1),this._ctx.restore()}}c.CursorRenderLayer=u;class w{constructor(n,t,a){this._renderCallback=t,this._coreBrowserService=a,this.isCursorVisible=!0,n&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(n=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){const t=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,t>0)return void this._restartInterval(t)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){const t=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(t)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},n)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},574:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GridCache=void 0,c.GridCache=class{constructor(){this.cache=[]}resize(y,_){for(let f=0;f<y;f++){this.cache.length<=f&&this.cache.push([]);for(let d=this.cache[f].length;d<_;d++)this.cache[f].push(void 0);this.cache[f].length=_}this.cache.length=y}clear(){for(let y=0;y<this.cache.length;y++)for(let _=0;_<this.cache[y].length;_++)this.cache[y][_]=void 0}}},43:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.LinkRenderLayer=void 0;const _=y(903),f=y(237),d=y(197);class u extends _.BaseRenderLayer{constructor(m,n,t,a,s,i,h,p,g){super(m,n,"link",t,!0,g,s,i,h,p),this.register(a.onShowLinkUnderline(C=>this._handleShowLinkUnderline(C))),this.register(a.onHideLinkUnderline(C=>this._handleHideLinkUnderline(C)))}resize(m){super.resize(m),this._state=void 0}reset(){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);const m=this._state.y2-this._state.y1-1;m>0&&this._clearCells(0,this._state.y1+1,this._state.cols,m),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(m){if(m.fg===f.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:m.fg&&(0,d.is256Color)(m.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[m.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,m.y1===m.y2)this._fillBottomLineAtCells(m.x1,m.y1,m.x2-m.x1);else{this._fillBottomLineAtCells(m.x1,m.y1,m.cols-m.x1);for(let n=m.y1+1;n<m.y2;n++)this._fillBottomLineAtCells(0,n,m.cols);this._fillBottomLineAtCells(0,m.y2,m.x2)}this._state=m}_handleHideLinkUnderline(m){this._clearCurrentLink()}}c.LinkRenderLayer=u},630:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionRenderLayer=void 0;const _=y(903);class f extends _.BaseRenderLayer{constructor(u,w,m,n,t,a,s,i){super(u,w,"selection",m,!0,i,n,s,a,t),this._clearState()}_clearState(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}}resize(u){super.resize(u),this._selectionModel.selectionStart&&this._selectionModel.selectionEnd&&this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}reset(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())}handleBlur(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}handleFocus(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}handleSelectionChanged(u,w,m){super.handleSelectionChanged(u,w,m),this._redrawSelection(u,w,m)}_redrawSelection(u,w,m){if(!this._didStateChange(u,w,m,this._bufferService.buffer.ydisp))return;if(this._clearAll(),!u||!w)return void this._clearState();const n=u[1]-this._bufferService.buffer.ydisp,t=w[1]-this._bufferService.buffer.ydisp,a=Math.max(n,0),s=Math.min(t,this._bufferService.rows-1);if(a>=this._bufferService.rows||s<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=(this._coreBrowserService.isFocused?this._themeService.colors.selectionBackgroundTransparent:this._themeService.colors.selectionInactiveBackgroundTransparent).css,m){const i=u[0],h=w[0]-i,p=s-a+1;this._fillCells(i,a,h,p)}else{const i=n===a?u[0]:0,h=a===t?w[0]:this._bufferService.cols;this._fillCells(i,a,h-i,1);const p=Math.max(s-a-1,0);if(this._fillCells(0,a+1,this._bufferService.cols,p),a!==s){const g=t===s?w[0]:this._bufferService.cols;this._fillCells(0,s,g,1)}}this._state.start=[u[0],u[1]],this._state.end=[w[0],w[1]],this._state.columnSelectMode=m,this._state.ydisp=this._bufferService.buffer.ydisp}}_didStateChange(u,w,m,n){return!this._areCoordinatesEqual(u,this._state.start)||!this._areCoordinatesEqual(w,this._state.end)||m!==this._state.columnSelectMode||n!==this._state.ydisp}_areCoordinatesEqual(u,w){return!(!u||!w)&&u[0]===w[0]&&u[1]===w[1]}}c.SelectionRenderLayer=f},744:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextRenderLayer=void 0;const _=y(574),f=y(903),d=y(147),u=y(855),w=y(782),m=y(577),n=y(160);class t extends f.BaseRenderLayer{constructor(s,i,h,p,g,C,v,b,E,A){super(s,i,"text",h,p,A,g,C,b,E),this._characterJoinerService=v,this._characterWidth=0,this._characterFont="",this._characterOverlapCache={},this._workCell=new w.CellData,this._state=new _.GridCache,this.register(C.onSpecificOptionChange("allowTransparency",T=>this._setTransparency(T)))}resize(s){super.resize(s);const i=this._getFont(!1,!1);this._characterWidth===s.device.char.width&&this._characterFont===i||(this._characterWidth=s.device.char.width,this._characterFont=i,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)}reset(){this._state.clear(),this._clearAll()}_forEachCell(s,i,h){for(let p=s;p<=i;p++){const g=p+this._bufferService.buffer.ydisp,C=this._bufferService.buffer.lines.get(g),v=this._characterJoinerService.getJoinedCharacters(g);for(let b=0;b<this._bufferService.cols;b++){C.loadCell(b,this._workCell);let E=this._workCell,A=!1,T=b;if(E.getWidth()===0)continue;const O=E.getCode();if(O!==0&&O!==32){if(v.length>0&&b===v[0][0]){A=!0;const H=v.shift();E=new m.JoinedCellData(this._workCell,C.translateToString(!0,H[0],H[1]),H[1]-H[0]),T=H[1]-1}!A&&this._isOverlapping(E)&&T<C.length-1&&C.getCodePoint(T+1)===u.NULL_CELL_CODE&&(E.content&=-12582913,E.content|=8388608),h(E,b,p),b=T}}}}_drawBackground(s,i){const h=this._ctx,p=this._bufferService.cols;let g=0,C=0,v=null;h.save(),this._forEachCell(s,i,(b,E,A)=>{let T=null;b.isInverse()?T=b.isFgDefault()?this._themeService.colors.foreground.css:b.isFgRGB()?`rgb(${d.AttributeData.toColorRGB(b.getFgColor()).join(",")})`:this._themeService.colors.ansi[b.getFgColor()].css:b.isBgRGB()?T=`rgb(${d.AttributeData.toColorRGB(b.getBgColor()).join(",")})`:b.isBgPalette()&&(T=this._themeService.colors.ansi[b.getBgColor()].css),T&&b.isDim()&&(T=n.color.multiplyOpacity(n.css.toColor(T),.5).css);let O=!1;this._decorationService.forEachDecorationAtCell(E,this._bufferService.buffer.ydisp+A,void 0,H=>{H.options.layer!=="top"&&O||(H.backgroundColorRGB&&(T=H.backgroundColorRGB.css),O=H.options.layer==="top")}),v===null&&(g=E,C=A),A!==C?(h.fillStyle=v||"",this._fillCells(g,C,p-g,1),g=E,C=A):v!==T&&(h.fillStyle=v||"",this._fillCells(g,C,E-g,1),g=E,C=A),v=T}),v!==null&&(h.fillStyle=v,this._fillCells(g,C,p-g,1)),h.restore()}_drawForeground(s,i){this._forEachCell(s,i,(h,p,g)=>this._drawChars(h,p,g))}handleGridChanged(s,i){this._state.cache.length!==0&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,s,this._bufferService.cols,i-s+1),this._drawBackground(s,i),this._drawForeground(s,i))}_isOverlapping(s){if(s.getWidth()!==1||s.getCode()<256)return!1;const i=s.getChars();if(this._characterOverlapCache.hasOwnProperty(i))return this._characterOverlapCache[i];this._ctx.save(),this._ctx.font=this._characterFont;const h=Math.floor(this._ctx.measureText(i).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[i]=h,h}}c.TextRenderLayer=t},503:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.removeElementFromParent=void 0,c.removeElementFromParent=function(...y){var _;for(const f of y)(_=f==null?void 0:f.parentElement)===null||_===void 0||_.removeChild(f)}},274:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellColorResolver=void 0;let y,_=0,f=0,d=!1,u=!1,w=!1;c.CellColorResolver=class{constructor(m,n,t,a,s){this._terminal=m,this._selectionRenderModel=n,this._decorationService=t,this._coreBrowserService=a,this._themeService=s,this.result={fg:0,bg:0,ext:0}}resolve(m,n,t){this.result.bg=m.bg,this.result.fg=m.fg,this.result.ext=268435456&m.bg?m.extended.ext:0,f=0,_=0,u=!1,d=!1,w=!1,y=this._themeService.colors,this._decorationService.forEachDecorationAtCell(n,t,"bottom",a=>{a.backgroundColorRGB&&(f=a.backgroundColorRGB.rgba>>8&16777215,u=!0),a.foregroundColorRGB&&(_=a.foregroundColorRGB.rgba>>8&16777215,d=!0)}),w=this._selectionRenderModel.isCellSelected(this._terminal,n,t),w&&(f=(this._coreBrowserService.isFocused?y.selectionBackgroundOpaque:y.selectionInactiveBackgroundOpaque).rgba>>8&16777215,u=!0,y.selectionForeground&&(_=y.selectionForeground.rgba>>8&16777215,d=!0)),this._decorationService.forEachDecorationAtCell(n,t,"top",a=>{a.backgroundColorRGB&&(f=a.backgroundColorRGB.rgba>>8&16777215,u=!0),a.foregroundColorRGB&&(_=a.foregroundColorRGB.rgba>>8&16777215,d=!0)}),u&&(f=w?-16777216&m.bg&-134217729|f|50331648:-16777216&m.bg|f|50331648),d&&(_=-16777216&m.fg&-67108865|_|50331648),67108864&this.result.fg&&(u&&!d&&(_=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&y.background.rgba>>8|50331648,d=!0),!u&&d&&(f=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&y.foreground.rgba>>8|50331648,u=!0)),y=void 0,this.result.bg=u?f:this.result.bg,this.result.fg=d?_:this.result.fg}}},627:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.removeTerminalFromCache=c.acquireTextureAtlas=void 0;const _=y(509),f=y(197),d=[];c.acquireTextureAtlas=function(u,w,m,n,t,a,s,i){const h=(0,f.generateConfig)(n,t,a,s,w,m,i);for(let C=0;C<d.length;C++){const v=d[C],b=v.ownedBy.indexOf(u);if(b>=0){if((0,f.configEquals)(v.config,h))return v.atlas;v.ownedBy.length===1?(v.atlas.dispose(),d.splice(C,1)):v.ownedBy.splice(b,1);break}}for(let C=0;C<d.length;C++){const v=d[C];if((0,f.configEquals)(v.config,h))return v.ownedBy.push(u),v.atlas}const p=u._core,g={atlas:new _.TextureAtlas(document,h,p.unicodeService),config:h,ownedBy:[u]};return d.push(g),g.atlas},c.removeTerminalFromCache=function(u){for(let w=0;w<d.length;w++){const m=d[w].ownedBy.indexOf(u);if(m!==-1){d[w].ownedBy.length===1?(d[w].atlas.dispose(),d.splice(w,1)):d[w].ownedBy.splice(m,1);break}}}},197:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.is256Color=c.configEquals=c.generateConfig=void 0;const _=y(160);c.generateConfig=function(f,d,u,w,m,n,t){const a={foreground:n.foreground,background:n.background,cursor:_.NULL_COLOR,cursorAccent:_.NULL_COLOR,selectionForeground:_.NULL_COLOR,selectionBackgroundTransparent:_.NULL_COLOR,selectionBackgroundOpaque:_.NULL_COLOR,selectionInactiveBackgroundTransparent:_.NULL_COLOR,selectionInactiveBackgroundOpaque:_.NULL_COLOR,ansi:n.ansi.slice(),contrastCache:n.contrastCache};return{customGlyphs:m.customGlyphs,devicePixelRatio:t,letterSpacing:m.letterSpacing,lineHeight:m.lineHeight,deviceCellWidth:f,deviceCellHeight:d,deviceCharWidth:u,deviceCharHeight:w,fontFamily:m.fontFamily,fontSize:m.fontSize,fontWeight:m.fontWeight,fontWeightBold:m.fontWeightBold,allowTransparency:m.allowTransparency,drawBoldTextInBrightColors:m.drawBoldTextInBrightColors,minimumContrastRatio:m.minimumContrastRatio,colors:a}},c.configEquals=function(f,d){for(let u=0;u<f.colors.ansi.length;u++)if(f.colors.ansi[u].rgba!==d.colors.ansi[u].rgba)return!1;return f.devicePixelRatio===d.devicePixelRatio&&f.customGlyphs===d.customGlyphs&&f.lineHeight===d.lineHeight&&f.letterSpacing===d.letterSpacing&&f.fontFamily===d.fontFamily&&f.fontSize===d.fontSize&&f.fontWeight===d.fontWeight&&f.fontWeightBold===d.fontWeightBold&&f.allowTransparency===d.allowTransparency&&f.deviceCharWidth===d.deviceCharWidth&&f.deviceCharHeight===d.deviceCharHeight&&f.drawBoldTextInBrightColors===d.drawBoldTextInBrightColors&&f.minimumContrastRatio===d.minimumContrastRatio&&f.colors.foreground.rgba===d.colors.foreground.rgba&&f.colors.background.rgba===d.colors.background.rgba},c.is256Color=function(f){return(50331648&f)==16777216||(50331648&f)==33554432}},237:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_BASELINE=c.DIM_OPACITY=c.INVERTED_DEFAULT_COLOR=void 0;const _=y(399);c.INVERTED_DEFAULT_COLOR=257,c.DIM_OPACITY=.5,c.TEXT_BASELINE=_.isFirefox||_.isLegacyEdge?"bottom":"ideographic"},860:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.tryDrawCustomChar=c.powerlineDefinitions=c.boxDrawingDefinitions=c.blockElementDefinitions=void 0;const _=y(374);c.blockElementDefinitions={"":[{x:0,y:0,w:8,h:4}],"":[{x:0,y:7,w:8,h:1}],"":[{x:0,y:6,w:8,h:2}],"":[{x:0,y:5,w:8,h:3}],"":[{x:0,y:4,w:8,h:4}],"":[{x:0,y:3,w:8,h:5}],"":[{x:0,y:2,w:8,h:6}],"":[{x:0,y:1,w:8,h:7}],"":[{x:0,y:0,w:8,h:8}],"":[{x:0,y:0,w:7,h:8}],"":[{x:0,y:0,w:6,h:8}],"":[{x:0,y:0,w:5,h:8}],"":[{x:0,y:0,w:4,h:8}],"":[{x:0,y:0,w:3,h:8}],"":[{x:0,y:0,w:2,h:8}],"":[{x:0,y:0,w:1,h:8}],"":[{x:4,y:0,w:4,h:8}],"":[{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8}],"":[{x:0,y:4,w:4,h:4}],"":[{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"":[{x:4,y:0,w:4,h:4}],"":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:1,y:0,w:1,h:8}],"":[{x:2,y:0,w:1,h:8}],"":[{x:3,y:0,w:1,h:8}],"":[{x:4,y:0,w:1,h:8}],"":[{x:5,y:0,w:1,h:8}],"":[{x:6,y:0,w:1,h:8}],"":[{x:0,y:1,w:8,h:1}],"":[{x:0,y:2,w:8,h:1}],"":[{x:0,y:3,w:8,h:1}],"":[{x:0,y:4,w:8,h:1}],"":[{x:0,y:5,w:8,h:1}],"":[{x:0,y:6,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:2}],"":[{x:0,y:0,w:8,h:3}],"":[{x:0,y:0,w:8,h:5}],"":[{x:0,y:0,w:8,h:6}],"":[{x:0,y:0,w:8,h:7}],"":[{x:6,y:0,w:2,h:8}],"":[{x:5,y:0,w:3,h:8}],"":[{x:3,y:0,w:5,h:8}],"":[{x:2,y:0,w:6,h:8}],"":[{x:1,y:0,w:7,h:8}],"":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};const f={"":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"":[[1,0],[0,0],[0,1],[0,0]],"":[[0,1],[1,1],[1,0],[1,1]]};c.boxDrawingDefinitions={"":{1:"M0,.5 L1,.5"},"":{3:"M0,.5 L1,.5"},"":{1:"M.5,0 L.5,1"},"":{3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5"},"":{3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M0,.5 L.5,.5 L.5,1"},"":{3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L1,.5"},"":{3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L0,.5"},"":{3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{1:"M.5,.5 L0,.5"},"":{3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0"},"":{3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5"},"":{3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1"},"":{3:"M.5,.5 L.5,1"},"":{1:(n,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"":{1:(n,t)=>`M${.5-n},0 L${.5-n},1 M${.5+n},0 L${.5+n},1`},"":{1:(n,t)=>`M.5,1 L.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"":{1:(n,t)=>`M${.5-n},1 L${.5-n},.5 L1,.5 M${.5+n},.5 L${.5+n},1`},"":{1:(n,t)=>`M1,${.5-t} L${.5-n},${.5-t} L${.5-n},1 M1,${.5+t} L${.5+n},${.5+t} L${.5+n},1`},"":{1:(n,t)=>`M0,${.5-t} L.5,${.5-t} L.5,1 M0,${.5+t} L.5,${.5+t}`},"":{1:(n,t)=>`M${.5+n},1 L${.5+n},.5 L0,.5 M${.5-n},.5 L${.5-n},1`},"":{1:(n,t)=>`M0,${.5+t} L${.5-n},${.5+t} L${.5-n},1 M0,${.5-t} L${.5+n},${.5-t} L${.5+n},1`},"":{1:(n,t)=>`M.5,0 L.5,${.5+t} L1,${.5+t} M.5,${.5-t} L1,${.5-t}`},"":{1:(n,t)=>`M1,.5 L${.5-n},.5 L${.5-n},0 M${.5+n},.5 L${.5+n},0`},"":{1:(n,t)=>`M1,${.5-t} L${.5+n},${.5-t} L${.5+n},0 M1,${.5+t} L${.5-n},${.5+t} L${.5-n},0`},"":{1:(n,t)=>`M0,${.5+t} L.5,${.5+t} L.5,0 M0,${.5-t} L.5,${.5-t}`},"":{1:(n,t)=>`M0,.5 L${.5+n},.5 L${.5+n},0 M${.5-n},.5 L${.5-n},0`},"":{1:(n,t)=>`M0,${.5-t} L${.5-n},${.5-t} L${.5-n},0 M0,${.5+t} L${.5+n},${.5+t} L${.5+n},0`},"":{1:(n,t)=>`M.5,0 L.5,1 M.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"":{1:(n,t)=>`M${.5-n},0 L${.5-n},1 M${.5+n},0 L${.5+n},1 M${.5+n},.5 L1,.5`},"":{1:(n,t)=>`M${.5-n},0 L${.5-n},1 M1,${.5+t} L${.5+n},${.5+t} L${.5+n},1 M1,${.5-t} L${.5+n},${.5-t} L${.5+n},0`},"":{1:(n,t)=>`M.5,0 L.5,1 M0,${.5-t} L.5,${.5-t} M0,${.5+t} L.5,${.5+t}`},"":{1:(n,t)=>`M0,.5 L${.5-n},.5 M${.5-n},0 L${.5-n},1 M${.5+n},0 L${.5+n},1`},"":{1:(n,t)=>`M${.5+n},0 L${.5+n},1 M0,${.5+t} L${.5-n},${.5+t} L${.5-n},1 M0,${.5-t} L${.5-n},${.5-t} L${.5-n},0`},"":{1:(n,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t} M.5,${.5+t} L.5,1`},"":{1:(n,t)=>`M0,.5 L1,.5 M${.5-n},.5 L${.5-n},1 M${.5+n},.5 L${.5+n},1`},"":{1:(n,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L${.5-n},${.5+t} L${.5-n},1 M1,${.5+t} L${.5+n},${.5+t} L${.5+n},1`},"":{1:(n,t)=>`M.5,0 L.5,${.5-t} M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"":{1:(n,t)=>`M0,.5 L1,.5 M${.5-n},.5 L${.5-n},0 M${.5+n},.5 L${.5+n},0`},"":{1:(n,t)=>`M0,${.5+t} L1,${.5+t} M0,${.5-t} L${.5-n},${.5-t} L${.5-n},0 M1,${.5-t} L${.5+n},${.5-t} L${.5+n},0`},"":{1:(n,t)=>`M.5,0 L.5,1 M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"":{1:(n,t)=>`M0,.5 L1,.5 M${.5-n},0 L${.5-n},1 M${.5+n},0 L${.5+n},1`},"":{1:(n,t)=>`M0,${.5+t} L${.5-n},${.5+t} L${.5-n},1 M1,${.5+t} L${.5+n},${.5+t} L${.5+n},1 M0,${.5-t} L${.5-n},${.5-t} L${.5-n},0 M1,${.5-t} L${.5+n},${.5-t} L${.5+n},0`},"":{1:"M1,0 L0,1"},"":{1:"M0,0 L1,1"},"":{1:"M1,0 L0,1 M0,0 L1,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{1:(n,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,1,.5`},"":{1:(n,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,0,.5`},"":{1:(n,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,0,.5`},"":{1:(n,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,1,.5`}},c.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"":{d:"M0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:1,rightPadding:1},"":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"":{d:"M1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:1,leftPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},c.powerlineDefinitions[""]=c.powerlineDefinitions[""],c.powerlineDefinitions[""]=c.powerlineDefinitions[""],c.tryDrawCustomChar=function(n,t,a,s,i,h,p,g){const C=c.blockElementDefinitions[t];if(C)return function(A,T,O,H,M,N){for(let L=0;L<T.length;L++){const B=T[L],I=M/8,P=N/8;A.fillRect(O+B.x*I,H+B.y*P,B.w*I,B.h*P)}}(n,C,a,s,i,h),!0;const v=f[t];if(v)return function(A,T,O,H,M,N){let L=d.get(T);L||(L=new Map,d.set(T,L));const B=A.fillStyle;if(typeof B!="string")throw new Error(`Unexpected fillStyle type "${B}"`);let I=L.get(B);if(!I){const P=T[0].length,Z=T.length,G=document.createElement("canvas");G.width=P,G.height=Z;const X=(0,_.throwIfFalsy)(G.getContext("2d")),V=new ImageData(P,Z);let ie,z,$,W;if(B.startsWith("#"))ie=parseInt(B.slice(1,3),16),z=parseInt(B.slice(3,5),16),$=parseInt(B.slice(5,7),16),W=B.length>7&&parseInt(B.slice(7,9),16)||1;else{if(!B.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${B}" when drawing pattern glyph`);[ie,z,$,W]=B.substring(5,B.length-1).split(",").map(te=>parseFloat(te))}for(let te=0;te<Z;te++)for(let se=0;se<P;se++)V.data[4*(te*P+se)]=ie,V.data[4*(te*P+se)+1]=z,V.data[4*(te*P+se)+2]=$,V.data[4*(te*P+se)+3]=T[te][se]*(255*W);X.putImageData(V,0,0),I=(0,_.throwIfFalsy)(A.createPattern(G,null)),L.set(B,I)}A.fillStyle=I,A.fillRect(O,H,M,N)}(n,v,a,s,i,h),!0;const b=c.boxDrawingDefinitions[t];if(b)return function(A,T,O,H,M,N,L){A.strokeStyle=A.fillStyle;for(const[B,I]of Object.entries(T)){let P;A.beginPath(),A.lineWidth=L*Number.parseInt(B),P=typeof I=="function"?I(.15,.15/N*M):I;for(const Z of P.split(" ")){const G=Z[0],X=w[G];if(!X){console.error(`Could not find drawing instructions for "${G}"`);continue}const V=Z.substring(1).split(",");V[0]&&V[1]&&X(A,m(V,M,N,O,H,!0,L))}A.stroke(),A.closePath()}}(n,b,a,s,i,h,g),!0;const E=c.powerlineDefinitions[t];return!!E&&(function(A,T,O,H,M,N,L,B){var I,P;const Z=new Path2D;Z.rect(O,H,M,N),A.clip(Z),A.beginPath();const G=L/12;A.lineWidth=B*G;for(const X of T.d.split(" ")){const V=X[0],ie=w[V];if(!ie){console.error(`Could not find drawing instructions for "${V}"`);continue}const z=X.substring(1).split(",");z[0]&&z[1]&&ie(A,m(z,M,N,O,H,!1,B,((I=T.leftPadding)!==null&&I!==void 0?I:0)*(G/2),((P=T.rightPadding)!==null&&P!==void 0?P:0)*(G/2)))}T.type===1?(A.strokeStyle=A.fillStyle,A.stroke()):A.fill(),A.closePath()}(n,E,a,s,i,h,p,g),!0)};const d=new Map;function u(n,t,a=0){return Math.max(Math.min(n,t),a)}const w={C:(n,t)=>n.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5]),L:(n,t)=>n.lineTo(t[0],t[1]),M:(n,t)=>n.moveTo(t[0],t[1])};function m(n,t,a,s,i,h,p,g=0,C=0){const v=n.map(b=>parseFloat(b)||parseInt(b));if(v.length<2)throw new Error("Too few arguments for instruction");for(let b=0;b<v.length;b+=2)v[b]*=t-g*p-C*p,h&&v[b]!==0&&(v[b]=u(Math.round(v[b]+.5)-.5,t,0)),v[b]+=s+g*p;for(let b=1;b<v.length;b+=2)v[b]*=a,h&&v[b]!==0&&(v[b]=u(Math.round(v[b]+.5)-.5,a,0)),v[b]+=i;return v}},56:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.observeDevicePixelDimensions=void 0;const _=y(859);c.observeDevicePixelDimensions=function(f,d,u){let w=new d.ResizeObserver(m=>{const n=m.find(s=>s.target===f);if(!n)return;if(!("devicePixelContentBoxSize"in n))return w==null||w.disconnect(),void(w=void 0);const t=n.devicePixelContentBoxSize[0].inlineSize,a=n.devicePixelContentBoxSize[0].blockSize;t>0&&a>0&&u(t,a)});try{w.observe(f,{box:["device-pixel-content-box"]})}catch{w.disconnect(),w=void 0}return(0,_.toDisposable)(()=>w==null?void 0:w.disconnect())}},374:(j,c)=>{function y(_){return 57508<=_&&_<=57558}Object.defineProperty(c,"__esModule",{value:!0}),c.createRenderDimensions=c.excludeFromContrastRatioDemands=c.isRestrictedPowerlineGlyph=c.isPowerlineGlyph=c.throwIfFalsy=void 0,c.throwIfFalsy=function(_){if(!_)throw new Error("value must not be falsy");return _},c.isPowerlineGlyph=y,c.isRestrictedPowerlineGlyph=function(_){return 57520<=_&&_<=57527},c.excludeFromContrastRatioDemands=function(_){return y(_)||function(f){return 9472<=f&&f<=9631}(_)},c.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createSelectionRenderModel=void 0;class y{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(f,d,u,w=!1){if(this.selectionStart=d,this.selectionEnd=u,!d||!u||d[0]===u[0]&&d[1]===u[1])return void this.clear();const m=d[1]-f.buffer.active.viewportY,n=u[1]-f.buffer.active.viewportY,t=Math.max(m,0),a=Math.min(n,f.rows-1);t>=f.rows||a<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=w,this.viewportStartRow=m,this.viewportEndRow=n,this.viewportCappedStartRow=t,this.viewportCappedEndRow=a,this.startCol=d[0],this.endCol=u[0])}isCellSelected(f,d,u){return!!this.hasSelection&&(u-=f.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?d>=this.startCol&&u>=this.viewportCappedStartRow&&d<this.endCol&&u<=this.viewportCappedEndRow:d<this.startCol&&u>=this.viewportCappedStartRow&&d>=this.endCol&&u<=this.viewportCappedEndRow:u>this.viewportStartRow&&u<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&u===this.viewportStartRow&&d>=this.startCol&&d<this.endCol||this.viewportStartRow<this.viewportEndRow&&u===this.viewportEndRow&&d<this.endCol||this.viewportStartRow<this.viewportEndRow&&u===this.viewportStartRow&&d>=this.startCol)}}c.createSelectionRenderModel=function(){return new y}},509:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextureAtlas=void 0;const _=y(237),f=y(855),d=y(147),u=y(160),w=y(860),m=y(374),n=y(485),t=y(385),a=y(345),s={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}};let i;class h{constructor(b,E,A){this._document=b,this._config=E,this._unicodeService=A,this._didWarmUp=!1,this._cacheMap=new n.FourKeyMap,this._cacheMapCombined=new n.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new d.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new a.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new a.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=C(b,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,m.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}get pages(){return this._pages}dispose(){for(const b of this.pages)b.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){const b=new t.IdleTaskQueue;for(let E=33;E<126;E++)b.enqueue(()=>{if(!this._cacheMap.get(E,f.DEFAULT_COLOR,f.DEFAULT_COLOR,f.DEFAULT_EXT)){const A=this._drawToCache(E,f.DEFAULT_COLOR,f.DEFAULT_COLOR,f.DEFAULT_EXT);this._cacheMap.set(E,f.DEFAULT_COLOR,f.DEFAULT_COLOR,f.DEFAULT_EXT,A)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(const b of this._pages)b.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){h.maxAtlasPages&&this._pages.length>=Math.max(4,h.maxAtlasPages/2)&&queueMicrotask(()=>{const E=this._pages.filter(L=>2*L.canvas.width<=(h.maxTextureSize||4096)).sort((L,B)=>B.canvas.width!==L.canvas.width?B.canvas.width-L.canvas.width:B.percentageUsed-L.percentageUsed);let A=-1,T=0;for(let L=0;L<E.length;L++)if(E[L].canvas.width!==T)A=L,T=E[L].canvas.width;else if(L-A==3)break;const O=E.slice(A,A+4),H=O.map(L=>L.glyphs[0].texturePage).sort((L,B)=>L>B?1:-1),M=H[0],N=this._mergePages(O,M);N.version++,this._pages[M]=N;for(let L=H.length-1;L>=1;L--)this._deletePage(H[L]);this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(N.canvas)});const b=new p(this._document,this._textureSize);return this._pages.push(b),this._activePages.push(b),this._onAddTextureAtlasCanvas.fire(b.canvas),b}_mergePages(b,E){const A=2*b[0].canvas.width,T=new p(this._document,A,b);for(const[O,H]of b.entries()){const M=O*H.canvas.width%A,N=Math.floor(O/2)*H.canvas.height;T.ctx.drawImage(H.canvas,M,N);for(const B of H.glyphs)B.texturePage=E,B.sizeClipSpace.x=B.size.x/A,B.sizeClipSpace.y=B.size.y/A,B.texturePosition.x+=M,B.texturePosition.y+=N,B.texturePositionClipSpace.x=B.texturePosition.x/A,B.texturePositionClipSpace.y=B.texturePosition.y/A;this._onRemoveTextureAtlasCanvas.fire(H.canvas);const L=this._activePages.indexOf(H);L!==-1&&this._activePages.splice(L,1)}return T}_deletePage(b){this._pages.splice(b,1);for(let E=b;E<this._pages.length;E++){const A=this._pages[E];for(const T of A.glyphs)T.texturePage--;A.version++}}getRasterizedGlyphCombinedChar(b,E,A,T){return this._getFromCacheMap(this._cacheMapCombined,b,E,A,T)}getRasterizedGlyph(b,E,A,T){return this._getFromCacheMap(this._cacheMap,b,E,A,T)}_getFromCacheMap(b,E,A,T,O){return i=b.get(E,A,T,O),i||(i=this._drawToCache(E,A,T,O),b.set(E,A,T,O,i)),i}_getColorFromAnsiIndex(b){if(b>=this._config.colors.ansi.length)throw new Error("No color found for idx "+b);return this._config.colors.ansi[b]}_getBackgroundColor(b,E,A,T){if(this._config.allowTransparency)return u.NULL_COLOR;let O;switch(b){case 16777216:case 33554432:O=this._getColorFromAnsiIndex(E);break;case 50331648:const H=d.AttributeData.toColorRGB(E);O=u.rgba.toColor(H[0],H[1],H[2]);break;default:O=A?this._config.colors.foreground:this._config.colors.background}return T&&(O=u.color.blend(this._config.colors.background,u.color.multiplyOpacity(O,_.DIM_OPACITY))),O}_getForegroundColor(b,E,A,T,O,H,M,N,L,B){const I=this._getMinimumContrastColor(b,E,A,T,O,H,!1,L,B);if(I)return I;let P;switch(O){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&L&&H<8&&(H+=8),P=this._getColorFromAnsiIndex(H);break;case 50331648:const Z=d.AttributeData.toColorRGB(H);P=u.rgba.toColor(Z[0],Z[1],Z[2]);break;default:P=M?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(P=u.color.opaque(P)),N&&(P=u.color.multiplyOpacity(P,_.DIM_OPACITY)),P}_resolveBackgroundRgba(b,E,A){switch(b){case 16777216:case 33554432:return this._getColorFromAnsiIndex(E).rgba;case 50331648:return E<<8;default:return A?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(b,E,A,T){switch(b){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&T&&E<8&&(E+=8),this._getColorFromAnsiIndex(E).rgba;case 50331648:return E<<8;default:return A?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(b,E,A,T,O,H,M,N,L){if(this._config.minimumContrastRatio===1||L)return;const B=this._config.colors.contrastCache.getColor(b,T);if(B!==void 0)return B||void 0;const I=this._resolveBackgroundRgba(E,A,M),P=this._resolveForegroundRgba(O,H,M,N),Z=u.rgba.ensureContrastRatio(I,P,this._config.minimumContrastRatio);if(!Z)return void this._config.colors.contrastCache.setColor(b,T,null);const G=u.rgba.toColor(Z>>24&255,Z>>16&255,Z>>8&255);return this._config.colors.contrastCache.setColor(b,T,G),G}_drawToCache(b,E,A,T){const O=typeof b=="number"?String.fromCharCode(b):b,H=this._config.deviceCellWidth*Math.max(O.length,2)+4;this._tmpCanvas.width<H&&(this._tmpCanvas.width=H);const M=this._config.deviceCellHeight+8;if(this._tmpCanvas.height<M&&(this._tmpCanvas.height=M),this._tmpCtx.save(),this._workAttributeData.fg=A,this._workAttributeData.bg=E,this._workAttributeData.extended.ext=T,this._workAttributeData.isInvisible())return s;const N=!!this._workAttributeData.isBold(),L=!!this._workAttributeData.isInverse(),B=!!this._workAttributeData.isDim(),I=!!this._workAttributeData.isItalic(),P=!!this._workAttributeData.isUnderline(),Z=!!this._workAttributeData.isStrikethrough();let G=this._workAttributeData.getFgColor(),X=this._workAttributeData.getFgColorMode(),V=this._workAttributeData.getBgColor(),ie=this._workAttributeData.getBgColorMode();if(L){const Ce=G;G=V,V=Ce;const Ae=X;X=ie,ie=Ae}const z=this._getBackgroundColor(ie,V,L,B);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=z.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";const $=N?this._config.fontWeightBold:this._config.fontWeight,W=I?"italic":"";this._tmpCtx.font=`${W} ${$} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=_.TEXT_BASELINE;const te=O.length===1&&(0,m.isPowerlineGlyph)(O.charCodeAt(0)),se=O.length===1&&(0,m.isRestrictedPowerlineGlyph)(O.charCodeAt(0)),be=this._getForegroundColor(E,ie,V,A,X,G,L,B,N,(0,m.excludeFromContrastRatioDemands)(O.charCodeAt(0)));this._tmpCtx.fillStyle=be.css;const ce=se?0:4;let ke=!1;this._config.customGlyphs!==!1&&(ke=(0,w.tryDrawCustomChar)(this._tmpCtx,O,ce,ce,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let ee,Ee=!te;if(ee=typeof b=="number"?this._unicodeService.wcwidth(b):this._unicodeService.getStringCellWidth(b),P){this._tmpCtx.save();const Ce=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),Ae=Ce%2==1?.5:0;if(this._tmpCtx.lineWidth=Ce,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())Ee=!1,this._tmpCtx.strokeStyle=`rgb(${d.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{Ee=!1;let ze=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&ze<8&&(ze+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(ze).css}this._tmpCtx.beginPath();const Pe=ce,Ne=Math.ceil(ce+this._config.deviceCharHeight)-Ae,nt=ce+this._config.deviceCharHeight+Ce-Ae,Qe=Math.ceil(ce+this._config.deviceCharHeight+2*Ce)-Ae;for(let ze=0;ze<ee;ze++){this._tmpCtx.save();const Me=Pe+ze*this._config.deviceCellWidth,Ve=Pe+(ze+1)*this._config.deviceCellWidth,St=Me+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne),this._tmpCtx.moveTo(Me,Qe),this._tmpCtx.lineTo(Ve,Qe);break;case 3:const ot=Ce<=1?Qe:Math.ceil(ce+this._config.deviceCharHeight-Ce/2)-Ae,ft=Ce<=1?Ne:Math.ceil(ce+this._config.deviceCharHeight+Ce/2)-Ae,Rt=new Path2D;Rt.rect(Me,Ne,this._config.deviceCellWidth,Qe-Ne),this._tmpCtx.clip(Rt),this._tmpCtx.moveTo(Me-this._config.deviceCellWidth/2,nt),this._tmpCtx.bezierCurveTo(Me-this._config.deviceCellWidth/2,ft,Me,ft,Me,nt),this._tmpCtx.bezierCurveTo(Me,ot,St,ot,St,nt),this._tmpCtx.bezierCurveTo(St,ft,Ve,ft,Ve,nt),this._tmpCtx.bezierCurveTo(Ve,ot,Ve+this._config.deviceCellWidth/2,ot,Ve+this._config.deviceCellWidth/2,nt);break;case 4:this._tmpCtx.setLineDash([2*this._config.devicePixelRatio,this._config.devicePixelRatio]),this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne);break;default:this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!ke&&this._config.fontSize>=12&&!this._config.allowTransparency&&O!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";const ze=this._tmpCtx.measureText(O);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in ze&&ze.actualBoundingBoxDescent>0){this._tmpCtx.save();const Me=new Path2D;Me.rect(Pe,Ne-Math.ceil(Ce/2),this._config.deviceCellWidth,Qe-Ne+Math.ceil(Ce/2)),this._tmpCtx.clip(Me),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=z.css,this._tmpCtx.strokeText(O,ce,ce+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(ke||this._tmpCtx.fillText(O,ce,ce+this._config.deviceCharHeight),O==="_"&&!this._config.allowTransparency){let Ce=g(this._tmpCtx.getImageData(ce,ce,this._config.deviceCellWidth,this._config.deviceCellHeight),z,be,Ee);if(Ce)for(let Ae=1;Ae<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=z.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(O,ce,ce+this._config.deviceCharHeight-Ae),Ce=g(this._tmpCtx.getImageData(ce,ce,this._config.deviceCellWidth,this._config.deviceCellHeight),z,be,Ee),Ce);Ae++);}if(Z){const Ce=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),Ae=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=Ce,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(ce,ce+Math.floor(this._config.deviceCharHeight/2)-Ae),this._tmpCtx.lineTo(ce+this._config.deviceCharWidth*ee,ce+Math.floor(this._config.deviceCharHeight/2)-Ae),this._tmpCtx.stroke()}this._tmpCtx.restore();const fe=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);let st;if(st=this._config.allowTransparency?function(Ce){for(let Ae=0;Ae<Ce.data.length;Ae+=4)if(Ce.data[Ae+3]>0)return!1;return!0}(fe):g(fe,z,be,Ee),st)return s;const Re=this._findGlyphBoundingBox(fe,this._workBoundingBox,H,se,ke,ce);let re,xe;for(;;){if(this._activePages.length===0){const Ce=this._createNewPage();re=Ce,xe=Ce.currentRow,xe.height=Re.size.y;break}re=this._activePages[this._activePages.length-1],xe=re.currentRow;for(const Ce of this._activePages)Re.size.y<=Ce.currentRow.height&&(re=Ce,xe=Ce.currentRow);for(let Ce=this._activePages.length-1;Ce>=0;Ce--)for(const Ae of this._activePages[Ce].fixedRows)Ae.height<=xe.height&&Re.size.y<=Ae.height&&(re=this._activePages[Ce],xe=Ae);if(xe.y+Re.size.y>=re.canvas.height||xe.height>Re.size.y+2){let Ce=!1;if(re.currentRow.y+re.currentRow.height+Re.size.y>=re.canvas.height){let Ae;for(const Pe of this._activePages)if(Pe.currentRow.y+Pe.currentRow.height+Re.size.y<Pe.canvas.height){Ae=Pe;break}if(Ae)re=Ae;else{const Pe=this._createNewPage();re=Pe,xe=Pe.currentRow,xe.height=Re.size.y,Ce=!0}}Ce||(re.currentRow.height>0&&re.fixedRows.push(re.currentRow),xe={x:0,y:re.currentRow.y+re.currentRow.height,height:Re.size.y},re.fixedRows.push(xe),re.currentRow={x:0,y:xe.y+xe.height,height:0})}if(xe.x+Re.size.x<=re.canvas.width)break;xe===re.currentRow?(xe.x=0,xe.y+=xe.height,xe.height=0):re.fixedRows.splice(re.fixedRows.indexOf(xe),1)}return Re.texturePage=this._pages.indexOf(re),Re.texturePosition.x=xe.x,Re.texturePosition.y=xe.y,Re.texturePositionClipSpace.x=xe.x/re.canvas.width,Re.texturePositionClipSpace.y=xe.y/re.canvas.height,Re.sizeClipSpace.x/=re.canvas.width,Re.sizeClipSpace.y/=re.canvas.height,xe.height=Math.max(xe.height,Re.size.y),xe.x+=Re.size.x,re.ctx.putImageData(fe,Re.texturePosition.x-this._workBoundingBox.left,Re.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,Re.size.x,Re.size.y),re.addGlyph(Re),re.version++,Re}_findGlyphBoundingBox(b,E,A,T,O,H){E.top=0;const M=T?this._config.deviceCellHeight:this._tmpCanvas.height,N=T?this._config.deviceCellWidth:A;let L=!1;for(let B=0;B<M;B++){for(let I=0;I<N;I++){const P=B*this._tmpCanvas.width*4+4*I+3;if(b.data[P]!==0){E.top=B,L=!0;break}}if(L)break}E.left=0,L=!1;for(let B=0;B<H+N;B++){for(let I=0;I<M;I++){const P=I*this._tmpCanvas.width*4+4*B+3;if(b.data[P]!==0){E.left=B,L=!0;break}}if(L)break}E.right=N,L=!1;for(let B=H+N-1;B>=H;B--){for(let I=0;I<M;I++){const P=I*this._tmpCanvas.width*4+4*B+3;if(b.data[P]!==0){E.right=B,L=!0;break}}if(L)break}E.bottom=M,L=!1;for(let B=M-1;B>=0;B--){for(let I=0;I<N;I++){const P=B*this._tmpCanvas.width*4+4*I+3;if(b.data[P]!==0){E.bottom=B,L=!0;break}}if(L)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:E.right-E.left+1,y:E.bottom-E.top+1},sizeClipSpace:{x:E.right-E.left+1,y:E.bottom-E.top+1},offset:{x:-E.left+H+(T||O?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-E.top+H+(T||O?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}c.TextureAtlas=h;class p{constructor(b,E,A){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],A)for(const T of A)this._glyphs.push(...T.glyphs),this._usedPixels+=T._usedPixels;this.canvas=C(b,E,E),this.ctx=(0,m.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(b){this._glyphs.push(b),this._usedPixels+=b.size.x*b.size.y}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function g(v,b,E,A){const T=b.rgba>>>24,O=b.rgba>>>16&255,H=b.rgba>>>8&255,M=E.rgba>>>24,N=E.rgba>>>16&255,L=E.rgba>>>8&255,B=Math.floor((Math.abs(T-M)+Math.abs(O-N)+Math.abs(H-L))/12);let I=!0;for(let P=0;P<v.data.length;P+=4)v.data[P]===T&&v.data[P+1]===O&&v.data[P+2]===H||A&&Math.abs(v.data[P]-T)+Math.abs(v.data[P+1]-O)+Math.abs(v.data[P+2]-H)<B?v.data[P+3]=0:I=!1;return I}function C(v,b,E){const A=v.createElement("canvas");return A.width=b,A.height=E,A}},577:function(j,c,y){var _=this&&this.__decorate||function(a,s,i,h){var p,g=arguments.length,C=g<3?s:h===null?h=Object.getOwnPropertyDescriptor(s,i):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(a,s,i,h);else for(var v=a.length-1;v>=0;v--)(p=a[v])&&(C=(g<3?p(C):g>3?p(s,i,C):p(s,i))||C);return g>3&&C&&Object.defineProperty(s,i,C),C},f=this&&this.__param||function(a,s){return function(i,h){s(i,h,a)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharacterJoinerService=c.JoinedCellData=void 0;const d=y(147),u=y(855),w=y(782),m=y(97);class n extends d.AttributeData{constructor(s,i,h){super(),this.content=0,this.combinedData="",this.fg=s.fg,this.bg=s.bg,this.combinedData=i,this._width=h}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(s){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.JoinedCellData=n;let t=class ms{constructor(s){this._bufferService=s,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new w.CellData}register(s){const i={id:this._nextCharacterJoinerId++,handler:s};return this._characterJoiners.push(i),i.id}deregister(s){for(let i=0;i<this._characterJoiners.length;i++)if(this._characterJoiners[i].id===s)return this._characterJoiners.splice(i,1),!0;return!1}getJoinedCharacters(s){if(this._characterJoiners.length===0)return[];const i=this._bufferService.buffer.lines.get(s);if(!i||i.length===0)return[];const h=[],p=i.translateToString(!0);let g=0,C=0,v=0,b=i.getFg(0),E=i.getBg(0);for(let A=0;A<i.getTrimmedLength();A++)if(i.loadCell(A,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==b||this._workCell.bg!==E){if(A-g>1){const T=this._getJoinedRanges(p,v,C,i,g);for(let O=0;O<T.length;O++)h.push(T[O])}g=A,v=C,b=this._workCell.fg,E=this._workCell.bg}C+=this._workCell.getChars().length||u.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-g>1){const A=this._getJoinedRanges(p,v,C,i,g);for(let T=0;T<A.length;T++)h.push(A[T])}return h}_getJoinedRanges(s,i,h,p,g){const C=s.substring(i,h);let v=[];try{v=this._characterJoiners[0].handler(C)}catch(b){console.error(b)}for(let b=1;b<this._characterJoiners.length;b++)try{const E=this._characterJoiners[b].handler(C);for(let A=0;A<E.length;A++)ms._mergeRanges(v,E[A])}catch(E){console.error(E)}return this._stringRangesToCellRanges(v,p,g),v}_stringRangesToCellRanges(s,i,h){let p=0,g=!1,C=0,v=s[p];if(v){for(let b=h;b<this._bufferService.cols;b++){const E=i.getWidth(b),A=i.getString(b).length||u.WHITESPACE_CELL_CHAR.length;if(E!==0){if(!g&&v[0]<=C&&(v[0]=b,g=!0),v[1]<=C){if(v[1]=b,v=s[++p],!v)break;v[0]<=C?(v[0]=b,g=!0):g=!1}C+=A}}v&&(v[1]=this._bufferService.cols)}}static _mergeRanges(s,i){let h=!1;for(let p=0;p<s.length;p++){const g=s[p];if(h){if(i[1]<=g[0])return s[p-1][1]=i[1],s;if(i[1]<=g[1])return s[p-1][1]=Math.max(i[1],g[1]),s.splice(p,1),s;s.splice(p,1),p--}else{if(i[1]<=g[0])return s.splice(p,0,i),s;if(i[1]<=g[1])return g[0]=Math.min(i[0],g[0]),s;i[0]<g[1]&&(g[0]=Math.min(i[0],g[0]),h=!0)}}return h?s[s.length-1][1]=i[1]:s.push(i),s}};t=_([f(0,m.IBufferService)],t),c.CharacterJoinerService=t},160:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.contrastRatio=c.toPaddedHex=c.rgba=c.rgb=c.css=c.color=c.channels=c.NULL_COLOR=void 0;const _=y(399);let f=0,d=0,u=0,w=0;var m,n,t;function a(i){const h=i.toString(16);return h.length<2?"0"+h:h}function s(i,h){return i<h?(h+.05)/(i+.05):(i+.05)/(h+.05)}c.NULL_COLOR={css:"#00000000",rgba:0},function(i){i.toCss=function(h,p,g,C){return C!==void 0?`#${a(h)}${a(p)}${a(g)}${a(C)}`:`#${a(h)}${a(p)}${a(g)}`},i.toRgba=function(h,p,g,C=255){return(h<<24|p<<16|g<<8|C)>>>0}}(m=c.channels||(c.channels={})),function(i){function h(p,g){return w=Math.round(255*g),[f,d,u]=t.toChannels(p.rgba),{css:m.toCss(f,d,u,w),rgba:m.toRgba(f,d,u,w)}}i.blend=function(p,g){if(w=(255&g.rgba)/255,w===1)return{css:g.css,rgba:g.rgba};const C=g.rgba>>24&255,v=g.rgba>>16&255,b=g.rgba>>8&255,E=p.rgba>>24&255,A=p.rgba>>16&255,T=p.rgba>>8&255;return f=E+Math.round((C-E)*w),d=A+Math.round((v-A)*w),u=T+Math.round((b-T)*w),{css:m.toCss(f,d,u),rgba:m.toRgba(f,d,u)}},i.isOpaque=function(p){return(255&p.rgba)==255},i.ensureContrastRatio=function(p,g,C){const v=t.ensureContrastRatio(p.rgba,g.rgba,C);if(v)return t.toColor(v>>24&255,v>>16&255,v>>8&255)},i.opaque=function(p){const g=(255|p.rgba)>>>0;return[f,d,u]=t.toChannels(g),{css:m.toCss(f,d,u),rgba:g}},i.opacity=h,i.multiplyOpacity=function(p,g){return w=255&p.rgba,h(p,w*g/255)},i.toColorRGB=function(p){return[p.rgba>>24&255,p.rgba>>16&255,p.rgba>>8&255]}}(c.color||(c.color={})),function(i){let h,p;if(!_.isNode){const g=document.createElement("canvas");g.width=1,g.height=1;const C=g.getContext("2d",{willReadFrequently:!0});C&&(h=C,h.globalCompositeOperation="copy",p=h.createLinearGradient(0,0,1,1))}i.toColor=function(g){if(g.match(/#[\da-f]{3,8}/i))switch(g.length){case 4:return f=parseInt(g.slice(1,2).repeat(2),16),d=parseInt(g.slice(2,3).repeat(2),16),u=parseInt(g.slice(3,4).repeat(2),16),t.toColor(f,d,u);case 5:return f=parseInt(g.slice(1,2).repeat(2),16),d=parseInt(g.slice(2,3).repeat(2),16),u=parseInt(g.slice(3,4).repeat(2),16),w=parseInt(g.slice(4,5).repeat(2),16),t.toColor(f,d,u,w);case 7:return{css:g,rgba:(parseInt(g.slice(1),16)<<8|255)>>>0};case 9:return{css:g,rgba:parseInt(g.slice(1),16)>>>0}}const C=g.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(C)return f=parseInt(C[1]),d=parseInt(C[2]),u=parseInt(C[3]),w=Math.round(255*(C[5]===void 0?1:parseFloat(C[5]))),t.toColor(f,d,u,w);if(!h||!p)throw new Error("css.toColor: Unsupported css format");if(h.fillStyle=p,h.fillStyle=g,typeof h.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(h.fillRect(0,0,1,1),[f,d,u,w]=h.getImageData(0,0,1,1).data,w!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:m.toRgba(f,d,u,w),css:g}}}(c.css||(c.css={})),function(i){function h(p,g,C){const v=p/255,b=g/255,E=C/255;return .2126*(v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4))+.7152*(b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4))+.0722*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))}i.relativeLuminance=function(p){return h(p>>16&255,p>>8&255,255&p)},i.relativeLuminance2=h}(n=c.rgb||(c.rgb={})),function(i){function h(g,C,v){const b=g>>24&255,E=g>>16&255,A=g>>8&255;let T=C>>24&255,O=C>>16&255,H=C>>8&255,M=s(n.relativeLuminance2(T,O,H),n.relativeLuminance2(b,E,A));for(;M<v&&(T>0||O>0||H>0);)T-=Math.max(0,Math.ceil(.1*T)),O-=Math.max(0,Math.ceil(.1*O)),H-=Math.max(0,Math.ceil(.1*H)),M=s(n.relativeLuminance2(T,O,H),n.relativeLuminance2(b,E,A));return(T<<24|O<<16|H<<8|255)>>>0}function p(g,C,v){const b=g>>24&255,E=g>>16&255,A=g>>8&255;let T=C>>24&255,O=C>>16&255,H=C>>8&255,M=s(n.relativeLuminance2(T,O,H),n.relativeLuminance2(b,E,A));for(;M<v&&(T<255||O<255||H<255);)T=Math.min(255,T+Math.ceil(.1*(255-T))),O=Math.min(255,O+Math.ceil(.1*(255-O))),H=Math.min(255,H+Math.ceil(.1*(255-H))),M=s(n.relativeLuminance2(T,O,H),n.relativeLuminance2(b,E,A));return(T<<24|O<<16|H<<8|255)>>>0}i.ensureContrastRatio=function(g,C,v){const b=n.relativeLuminance(g>>8),E=n.relativeLuminance(C>>8);if(s(b,E)<v){if(E<b){const O=h(g,C,v),H=s(b,n.relativeLuminance(O>>8));if(H<v){const M=p(g,C,v);return H>s(b,n.relativeLuminance(M>>8))?O:M}return O}const A=p(g,C,v),T=s(b,n.relativeLuminance(A>>8));if(T<v){const O=h(g,C,v);return T>s(b,n.relativeLuminance(O>>8))?A:O}return A}},i.reduceLuminance=h,i.increaseLuminance=p,i.toChannels=function(g){return[g>>24&255,g>>16&255,g>>8&255,255&g]},i.toColor=function(g,C,v,b){return{css:m.toCss(g,C,v,b),rgba:m.toRgba(g,C,v,b)}}}(t=c.rgba||(c.rgba={})),c.toPaddedHex=a,c.contrastRatio=s},345:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=y=>(this._listeners.push(y),{dispose:()=>{if(!this._disposed){for(let _=0;_<this._listeners.length;_++)if(this._listeners[_]===y)return void this._listeners.splice(_,1)}}})),this._event}fire(y,_){const f=[];for(let d=0;d<this._listeners.length;d++)f.push(this._listeners[d]);for(let d=0;d<f.length;d++)f[d].call(void 0,y,_)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(y,_){return y(f=>_.fire(f))}},859:(j,c)=>{function y(_){for(const f of _)f.dispose();_.length=0}Object.defineProperty(c,"__esModule",{value:!0}),c.getDisposeArrayDisposable=c.disposeArray=c.toDisposable=c.Disposable=void 0,c.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const _ of this._disposables)_.dispose();this._disposables.length=0}register(_){return this._disposables.push(_),_}unregister(_){const f=this._disposables.indexOf(_);f!==-1&&this._disposables.splice(f,1)}},c.toDisposable=function(_){return{dispose:_}},c.disposeArray=y,c.getDisposeArrayDisposable=function(_){return{dispose:()=>y(_)}}},485:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FourKeyMap=c.TwoKeyMap=void 0;class y{constructor(){this._data={}}set(f,d,u){this._data[f]||(this._data[f]={}),this._data[f][d]=u}get(f,d){return this._data[f]?this._data[f][d]:void 0}clear(){this._data={}}}c.TwoKeyMap=y,c.FourKeyMap=class{constructor(){this._data=new y}set(_,f,d,u,w){this._data.get(_,f)||this._data.set(_,f,new y),this._data.get(_,f).set(d,u,w)}get(_,f,d,u){var w;return(w=this._data.get(_,f))===null||w===void 0?void 0:w.get(d,u)}clear(){this._data.clear()}}},399:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isChromeOS=c.isLinux=c.isWindows=c.isIphone=c.isIpad=c.isMac=c.getSafariVersion=c.isSafari=c.isLegacyEdge=c.isFirefox=c.isNode=void 0,c.isNode=typeof navigator>"u";const y=c.isNode?"node":navigator.userAgent,_=c.isNode?"node":navigator.platform;c.isFirefox=y.includes("Firefox"),c.isLegacyEdge=y.includes("Edge"),c.isSafari=/^((?!chrome|android).)*safari/i.test(y),c.getSafariVersion=function(){if(!c.isSafari)return 0;const f=y.match(/Version\/(\d+)/);return f===null||f.length<2?0:parseInt(f[1])},c.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(_),c.isIpad=_==="iPad",c.isIphone=_==="iPhone",c.isWindows=["Windows","Win16","Win32","WinCE"].includes(_),c.isLinux=_.indexOf("Linux")>=0,c.isChromeOS=/\bCrOS\b/.test(y)},385:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebouncedIdleTask=c.IdleTaskQueue=c.PriorityTaskQueue=void 0;const _=y(399);class f{constructor(){this._tasks=[],this._i=0}enqueue(w){this._tasks.push(w),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(w){this._idleCallback=void 0;let m=0,n=0,t=w.timeRemaining(),a=0;for(;this._i<this._tasks.length;){if(m=Date.now(),this._tasks[this._i]()||this._i++,m=Math.max(1,Date.now()-m),n=Math.max(m,n),a=w.timeRemaining(),1.5*n>a)return t-m<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-m))}ms`),void this._start();t=a}this.clear()}}class d extends f{_requestCallback(w){return setTimeout(()=>w(this._createDeadline(16)))}_cancelCallback(w){clearTimeout(w)}_createDeadline(w){const m=Date.now()+w;return{timeRemaining:()=>Math.max(0,m-Date.now())}}}c.PriorityTaskQueue=d,c.IdleTaskQueue=!_.isNode&&"requestIdleCallback"in window?class extends f{_requestCallback(u){return requestIdleCallback(u)}_cancelCallback(u){cancelIdleCallback(u)}}:d,c.DebouncedIdleTask=class{constructor(){this._queue=new c.IdleTaskQueue}set(u){this._queue.clear(),this._queue.enqueue(u)}flush(){this._queue.flush()}}},147:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtendedAttrs=c.AttributeData=void 0;class y{constructor(){this.fg=0,this.bg=0,this.extended=new _}static toColorRGB(d){return[d>>>16&255,d>>>8&255,255&d]}static fromColorRGB(d){return(255&d[0])<<16|(255&d[1])<<8|255&d[2]}clone(){const d=new y;return d.fg=this.fg,d.bg=this.bg,d.extended=this.extended.clone(),d}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}c.AttributeData=y;class _{constructor(d=0,u=0){this._ext=0,this._urlId=0,this._ext=d,this._urlId=u}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(d){this._ext=d}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(d){this._ext&=-469762049,this._ext|=d<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(d){this._ext&=-67108864,this._ext|=67108863&d}get urlId(){return this._urlId}set urlId(d){this._urlId=d}clone(){return new _(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}c.ExtendedAttrs=_},782:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellData=void 0;const _=y(133),f=y(855),d=y(147);class u extends d.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new d.ExtendedAttrs,this.combinedData=""}static fromCharData(m){const n=new u;return n.setFromCharData(m),n}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,_.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(m){this.fg=m[f.CHAR_DATA_ATTR_INDEX],this.bg=0;let n=!1;if(m[f.CHAR_DATA_CHAR_INDEX].length>2)n=!0;else if(m[f.CHAR_DATA_CHAR_INDEX].length===2){const t=m[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const a=m[f.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=a&&a<=57343?this.content=1024*(t-55296)+a-56320+65536|m[f.CHAR_DATA_WIDTH_INDEX]<<22:n=!0}else n=!0}else this.content=m[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|m[f.CHAR_DATA_WIDTH_INDEX]<<22;n&&(this.combinedData=m[f.CHAR_DATA_CHAR_INDEX],this.content=2097152|m[f.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.CellData=u},855:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WHITESPACE_CELL_CODE=c.WHITESPACE_CELL_WIDTH=c.WHITESPACE_CELL_CHAR=c.NULL_CELL_CODE=c.NULL_CELL_WIDTH=c.NULL_CELL_CHAR=c.CHAR_DATA_CODE_INDEX=c.CHAR_DATA_WIDTH_INDEX=c.CHAR_DATA_CHAR_INDEX=c.CHAR_DATA_ATTR_INDEX=c.DEFAULT_EXT=c.DEFAULT_ATTR=c.DEFAULT_COLOR=void 0,c.DEFAULT_COLOR=0,c.DEFAULT_ATTR=256|c.DEFAULT_COLOR<<9,c.DEFAULT_EXT=0,c.CHAR_DATA_ATTR_INDEX=0,c.CHAR_DATA_CHAR_INDEX=1,c.CHAR_DATA_WIDTH_INDEX=2,c.CHAR_DATA_CODE_INDEX=3,c.NULL_CELL_CHAR="",c.NULL_CELL_WIDTH=1,c.NULL_CELL_CODE=0,c.WHITESPACE_CELL_CHAR=" ",c.WHITESPACE_CELL_WIDTH=1,c.WHITESPACE_CELL_CODE=32},133:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Utf8ToUtf32=c.StringToUtf32=c.utf32ToString=c.stringFromCodePoint=void 0,c.stringFromCodePoint=function(y){return y>65535?(y-=65536,String.fromCharCode(55296+(y>>10))+String.fromCharCode(y%1024+56320)):String.fromCharCode(y)},c.utf32ToString=function(y,_=0,f=y.length){let d="";for(let u=_;u<f;++u){let w=y[u];w>65535?(w-=65536,d+=String.fromCharCode(55296+(w>>10))+String.fromCharCode(w%1024+56320)):d+=String.fromCharCode(w)}return d},c.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(y,_){const f=y.length;if(!f)return 0;let d=0,u=0;if(this._interim){const w=y.charCodeAt(u++);56320<=w&&w<=57343?_[d++]=1024*(this._interim-55296)+w-56320+65536:(_[d++]=this._interim,_[d++]=w),this._interim=0}for(let w=u;w<f;++w){const m=y.charCodeAt(w);if(55296<=m&&m<=56319){if(++w>=f)return this._interim=m,d;const n=y.charCodeAt(w);56320<=n&&n<=57343?_[d++]=1024*(m-55296)+n-56320+65536:(_[d++]=m,_[d++]=n)}else m!==65279&&(_[d++]=m)}return d}},c.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(y,_){const f=y.length;if(!f)return 0;let d,u,w,m,n=0,t=0,a=0;if(this.interim[0]){let h=!1,p=this.interim[0];p&=(224&p)==192?31:(240&p)==224?15:7;let g,C=0;for(;(g=63&this.interim[++C])&&C<4;)p<<=6,p|=g;const v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,b=v-C;for(;a<b;){if(a>=f)return 0;if(g=y[a++],(192&g)!=128){a--,h=!0;break}this.interim[C++]=g,p<<=6,p|=63&g}h||(v===2?p<128?a--:_[n++]=p:v===3?p<2048||p>=55296&&p<=57343||p===65279||(_[n++]=p):p<65536||p>1114111||(_[n++]=p)),this.interim.fill(0)}const s=f-4;let i=a;for(;i<f;){for(;!(!(i<s)||128&(d=y[i])||128&(u=y[i+1])||128&(w=y[i+2])||128&(m=y[i+3]));)_[n++]=d,_[n++]=u,_[n++]=w,_[n++]=m,i+=4;if(d=y[i++],d<128)_[n++]=d;else if((224&d)==192){if(i>=f)return this.interim[0]=d,n;if(u=y[i++],(192&u)!=128){i--;continue}if(t=(31&d)<<6|63&u,t<128){i--;continue}_[n++]=t}else if((240&d)==224){if(i>=f)return this.interim[0]=d,n;if(u=y[i++],(192&u)!=128){i--;continue}if(i>=f)return this.interim[0]=d,this.interim[1]=u,n;if(w=y[i++],(192&w)!=128){i--;continue}if(t=(15&d)<<12|(63&u)<<6|63&w,t<2048||t>=55296&&t<=57343||t===65279)continue;_[n++]=t}else if((248&d)==240){if(i>=f)return this.interim[0]=d,n;if(u=y[i++],(192&u)!=128){i--;continue}if(i>=f)return this.interim[0]=d,this.interim[1]=u,n;if(w=y[i++],(192&w)!=128){i--;continue}if(i>=f)return this.interim[0]=d,this.interim[1]=u,this.interim[2]=w,n;if(m=y[i++],(192&m)!=128){i--;continue}if(t=(7&d)<<18|(63&u)<<12|(63&w)<<6|63&m,t<65536||t>1114111)continue;_[n++]=t}}return n}}},726:(j,c)=>{function y(_,f,d){f.di$target===f?f.di$dependencies.push({id:_,index:d}):(f.di$dependencies=[{id:_,index:d}],f.di$target=f)}Object.defineProperty(c,"__esModule",{value:!0}),c.createDecorator=c.getServiceDependencies=c.serviceRegistry=void 0,c.serviceRegistry=new Map,c.getServiceDependencies=function(_){return _.di$dependencies||[]},c.createDecorator=function(_){if(c.serviceRegistry.has(_))return c.serviceRegistry.get(_);const f=function(d,u,w){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");y(f,d,w)};return f.toString=()=>_,c.serviceRegistry.set(_,f),f}},97:(j,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IDecorationService=c.IUnicodeService=c.IOscLinkService=c.IOptionsService=c.ILogService=c.LogLevelEnum=c.IInstantiationService=c.ICharsetService=c.ICoreService=c.ICoreMouseService=c.IBufferService=void 0;const _=y(726);var f;c.IBufferService=(0,_.createDecorator)("BufferService"),c.ICoreMouseService=(0,_.createDecorator)("CoreMouseService"),c.ICoreService=(0,_.createDecorator)("CoreService"),c.ICharsetService=(0,_.createDecorator)("CharsetService"),c.IInstantiationService=(0,_.createDecorator)("InstantiationService"),(f=c.LogLevelEnum||(c.LogLevelEnum={}))[f.DEBUG=0]="DEBUG",f[f.INFO=1]="INFO",f[f.WARN=2]="WARN",f[f.ERROR=3]="ERROR",f[f.OFF=4]="OFF",c.ILogService=(0,_.createDecorator)("LogService"),c.IOptionsService=(0,_.createDecorator)("OptionsService"),c.IOscLinkService=(0,_.createDecorator)("OscLinkService"),c.IUnicodeService=(0,_.createDecorator)("UnicodeService"),c.IDecorationService=(0,_.createDecorator)("DecorationService")}},ne={};function ue(j){var c=ne[j];if(c!==void 0)return c.exports;var y=ne[j]={exports:{}};return Q[j].call(y.exports,y,y.exports,ue),y.exports}var pe={};return(()=>{var j=pe;Object.defineProperty(j,"__esModule",{value:!0}),j.CanvasAddon=void 0;const c=ue(949),y=ue(345),_=ue(859);class f extends _.Disposable{constructor(){super(...arguments),this._onChangeTextureAtlas=this.register(new y.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new y.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event}get textureAtlas(){var u;return(u=this._renderer)===null||u===void 0?void 0:u.textureAtlas}activate(u){const w=u._core;if(!u.element)return void this.register(w.onWillOpen(()=>this.activate(u)));this._terminal=u;const m=w.coreService,n=w.optionsService,t=w.screenElement,a=w.linkifier2,s=w,i=s._bufferService,h=s._renderService,p=s._characterJoinerService,g=s._charSizeService,C=s._coreBrowserService,v=s._decorationService,b=s._themeService;this._renderer=new c.CanvasRenderer(u,t,a,i,g,n,p,m,C,v,b),this.register((0,y.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,y.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),h.setRenderer(this._renderer),h.handleResize(i.cols,i.rows),this.register((0,_.toDisposable)(()=>{var E;h.setRenderer(this._terminal._core._createRenderer()),h.handleResize(u.cols,u.rows),(E=this._renderer)===null||E===void 0||E.dispose(),this._renderer=void 0}))}}j.CanvasAddon=f})(),pe})()})})(vs);var Bn=vs.exports,ys={exports:{}};(function(q,U){(function(Q,ne){q.exports=ne()})(self,function(){return(()=>{var Q={};return(()=>{var ne=Q;Object.defineProperty(ne,"__esModule",{value:!0}),ne.FitAddon=void 0,ne.FitAddon=class{constructor(){}activate(ue){this._terminal=ue}dispose(){}fit(){const ue=this.proposeDimensions();if(!ue||!this._terminal||isNaN(ue.cols)||isNaN(ue.rows))return;const pe=this._terminal._core;this._terminal.rows===ue.rows&&this._terminal.cols===ue.cols||(pe._renderService.clear(),this._terminal.resize(ue.cols,ue.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const ue=this._terminal._core,pe=ue._renderService.dimensions;if(pe.css.cell.width===0||pe.css.cell.height===0)return;const j=this._terminal.options.scrollback===0?0:ue.viewport.scrollBarWidth,c=window.getComputedStyle(this._terminal.element.parentElement),y=parseInt(c.getPropertyValue("height")),_=Math.max(0,parseInt(c.getPropertyValue("width"))),f=window.getComputedStyle(this._terminal.element),d=y-(parseInt(f.getPropertyValue("padding-top"))+parseInt(f.getPropertyValue("padding-bottom"))),u=_-(parseInt(f.getPropertyValue("padding-right"))+parseInt(f.getPropertyValue("padding-left")))-j;return{cols:Math.max(2,Math.floor(u/pe.css.cell.width)),rows:Math.max(1,Math.floor(d/pe.css.cell.height))}}}})(),Q})()})})(ys);var On=ys.exports,Tr={exports:{}};const In={},Pn=Object.freeze(Object.defineProperty({__proto__:null,default:In},Symbol.toStringTag,{value:"Module"})),Kt=Rn(Pn);var Xt={},Yt={},Zt,Bi;function bs(){return Bi||(Bi=1,Zt=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var U={},Q=Symbol("test"),ne=Object(Q);if(typeof Q=="string"||Object.prototype.toString.call(Q)!=="[object Symbol]"||Object.prototype.toString.call(ne)!=="[object Symbol]")return!1;var ue=42;U[Q]=ue;for(Q in U)return!1;if(typeof Object.keys=="function"&&Object.keys(U).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(U).length!==0)return!1;var pe=Object.getOwnPropertySymbols(U);if(pe.length!==1||pe[0]!==Q||!Object.prototype.propertyIsEnumerable.call(U,Q))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var j=Object.getOwnPropertyDescriptor(U,Q);if(j.value!==ue||j.enumerable!==!0)return!1}return!0}),Zt}var Jt,Oi;function Mr(){if(Oi)return Jt;Oi=1;var q=bs();return Jt=function(){return q()&&!!Symbol.toStringTag},Jt}var Qt,Ii;function Un(){return Ii||(Ii=1,Qt=Error),Qt}var er,Pi;function Fn(){return Pi||(Pi=1,er=EvalError),er}var tr,Ui;function Hn(){return Ui||(Ui=1,tr=RangeError),tr}var rr,Fi;function Nn(){return Fi||(Fi=1,rr=ReferenceError),rr}var ir,Hi;function Ss(){return Hi||(Hi=1,ir=SyntaxError),ir}var sr,Ni;function Ut(){return Ni||(Ni=1,sr=TypeError),sr}var nr,Wi;function Wn(){return Wi||(Wi=1,nr=URIError),nr}var or,Gi;function Gn(){if(Gi)return or;Gi=1;var q=typeof Symbol<"u"&&Symbol,U=bs();return or=function(){return typeof q!="function"||typeof Symbol!="function"||typeof q("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:U()},or}var ar,zi;function zn(){if(zi)return ar;zi=1;var q={__proto__:null,foo:{}},U=Object;return ar=function(){return{__proto__:q}.foo===q.foo&&!(q instanceof U)},ar}var lr,$i;function $n(){if($i)return lr;$i=1;var q="Function.prototype.bind called on incompatible ",U=Object.prototype.toString,Q=Math.max,ne="[object Function]",ue=function(y,_){for(var f=[],d=0;d<y.length;d+=1)f[d]=y[d];for(var u=0;u<_.length;u+=1)f[u+y.length]=_[u];return f},pe=function(y,_){for(var f=[],d=_||0,u=0;d<y.length;d+=1,u+=1)f[u]=y[d];return f},j=function(c,y){for(var _="",f=0;f<c.length;f+=1)_+=c[f],f+1<c.length&&(_+=y);return _};return lr=function(y){var _=this;if(typeof _!="function"||U.apply(_)!==ne)throw new TypeError(q+_);for(var f=pe(arguments,1),d,u=function(){if(this instanceof d){var a=_.apply(this,ue(f,arguments));return Object(a)===a?a:this}return _.apply(y,ue(f,arguments))},w=Q(0,_.length-f.length),m=[],n=0;n<w;n++)m[n]="$"+n;if(d=Function("binder","return function ("+j(m,",")+"){ return binder.apply(this,arguments); }")(u),_.prototype){var t=function(){};t.prototype=_.prototype,d.prototype=new t,t.prototype=null}return d},lr}var cr,ji;function Br(){if(ji)return cr;ji=1;var q=$n();return cr=Function.prototype.bind||q,cr}var hr,qi;function jn(){if(qi)return hr;qi=1;var q=Function.prototype.call,U=Object.prototype.hasOwnProperty,Q=Br();return hr=Q.call(q,U),hr}var ur,Vi;function kt(){if(Vi)return ur;Vi=1;var q,U=Un(),Q=Fn(),ne=Hn(),ue=Nn(),pe=Ss(),j=Ut(),c=Wn(),y=Function,_=function(L){try{return y('"use strict"; return ('+L+").constructor;")()}catch{}},f=Object.getOwnPropertyDescriptor;if(f)try{f({},"")}catch{f=null}var d=function(){throw new j},u=f?function(){try{return arguments.callee,d}catch{try{return f(arguments,"callee").get}catch{return d}}}():d,w=Gn()(),m=zn()(),n=Object.getPrototypeOf||(m?function(L){return L.__proto__}:null),t={},a=typeof Uint8Array>"u"||!n?q:n(Uint8Array),s={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?q:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?q:ArrayBuffer,"%ArrayIteratorPrototype%":w&&n?n([][Symbol.iterator]()):q,"%AsyncFromSyncIteratorPrototype%":q,"%AsyncFunction%":t,"%AsyncGenerator%":t,"%AsyncGeneratorFunction%":t,"%AsyncIteratorPrototype%":t,"%Atomics%":typeof Atomics>"u"?q:Atomics,"%BigInt%":typeof BigInt>"u"?q:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?q:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?q:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?q:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":U,"%eval%":eval,"%EvalError%":Q,"%Float32Array%":typeof Float32Array>"u"?q:Float32Array,"%Float64Array%":typeof Float64Array>"u"?q:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?q:FinalizationRegistry,"%Function%":y,"%GeneratorFunction%":t,"%Int8Array%":typeof Int8Array>"u"?q:Int8Array,"%Int16Array%":typeof Int16Array>"u"?q:Int16Array,"%Int32Array%":typeof Int32Array>"u"?q:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":w&&n?n(n([][Symbol.iterator]())):q,"%JSON%":typeof JSON=="object"?JSON:q,"%Map%":typeof Map>"u"?q:Map,"%MapIteratorPrototype%":typeof Map>"u"||!w||!n?q:n(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?q:Promise,"%Proxy%":typeof Proxy>"u"?q:Proxy,"%RangeError%":ne,"%ReferenceError%":ue,"%Reflect%":typeof Reflect>"u"?q:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?q:Set,"%SetIteratorPrototype%":typeof Set>"u"||!w||!n?q:n(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?q:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":w&&n?n(""[Symbol.iterator]()):q,"%Symbol%":w?Symbol:q,"%SyntaxError%":pe,"%ThrowTypeError%":u,"%TypedArray%":a,"%TypeError%":j,"%Uint8Array%":typeof Uint8Array>"u"?q:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?q:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?q:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?q:Uint32Array,"%URIError%":c,"%WeakMap%":typeof WeakMap>"u"?q:WeakMap,"%WeakRef%":typeof WeakRef>"u"?q:WeakRef,"%WeakSet%":typeof WeakSet>"u"?q:WeakSet};if(n)try{null.error}catch(L){var i=n(n(L));s["%Error.prototype%"]=i}var h=function L(B){var I;if(B==="%AsyncFunction%")I=_("async function () {}");else if(B==="%GeneratorFunction%")I=_("function* () {}");else if(B==="%AsyncGeneratorFunction%")I=_("async function* () {}");else if(B==="%AsyncGenerator%"){var P=L("%AsyncGeneratorFunction%");P&&(I=P.prototype)}else if(B==="%AsyncIteratorPrototype%"){var Z=L("%AsyncGenerator%");Z&&n&&(I=n(Z.prototype))}return s[B]=I,I},p={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},g=Br(),C=jn(),v=g.call(Function.call,Array.prototype.concat),b=g.call(Function.apply,Array.prototype.splice),E=g.call(Function.call,String.prototype.replace),A=g.call(Function.call,String.prototype.slice),T=g.call(Function.call,RegExp.prototype.exec),O=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,H=/\\(\\)?/g,M=function(B){var I=A(B,0,1),P=A(B,-1);if(I==="%"&&P!=="%")throw new pe("invalid intrinsic syntax, expected closing `%`");if(P==="%"&&I!=="%")throw new pe("invalid intrinsic syntax, expected opening `%`");var Z=[];return E(B,O,function(G,X,V,ie){Z[Z.length]=V?E(ie,H,"$1"):X||G}),Z},N=function(B,I){var P=B,Z;if(C(p,P)&&(Z=p[P],P="%"+Z[0]+"%"),C(s,P)){var G=s[P];if(G===t&&(G=h(P)),typeof G>"u"&&!I)throw new j("intrinsic "+B+" exists, but is not available. Please file an issue!");return{alias:Z,name:P,value:G}}throw new pe("intrinsic "+B+" does not exist!")};return ur=function(B,I){if(typeof B!="string"||B.length===0)throw new j("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof I!="boolean")throw new j('"allowMissing" argument must be a boolean');if(T(/^%?[^%]*%?$/,B)===null)throw new pe("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var P=M(B),Z=P.length>0?P[0]:"",G=N("%"+Z+"%",I),X=G.name,V=G.value,ie=!1,z=G.alias;z&&(Z=z[0],b(P,v([0,1],z)));for(var $=1,W=!0;$<P.length;$+=1){var te=P[$],se=A(te,0,1),be=A(te,-1);if((se==='"'||se==="'"||se==="`"||be==='"'||be==="'"||be==="`")&&se!==be)throw new pe("property names with quotes must have matching quotes");if((te==="constructor"||!W)&&(ie=!0),Z+="."+te,X="%"+Z+"%",C(s,X))V=s[X];else if(V!=null){if(!(te in V)){if(!I)throw new j("base intrinsic for "+B+" exists, but the property is not available.");return}if(f&&$+1>=P.length){var ce=f(V,te);W=!!ce,W&&"get"in ce&&!("originalValue"in ce.get)?V=ce.get:V=V[te]}else W=C(V,te),V=V[te];W&&!ie&&(s[X]=V)}}return V},ur}var dr={exports:{}},fr,Ki;function Or(){if(Ki)return fr;Ki=1;var q=kt(),U=q("%Object.defineProperty%",!0)||!1;if(U)try{U({},"a",{value:1})}catch{U=!1}return fr=U,fr}var pr,Xi;function Ir(){if(Xi)return pr;Xi=1;var q=kt(),U=q("%Object.getOwnPropertyDescriptor%",!0);if(U)try{U([],"length")}catch{U=null}return pr=U,pr}var _r,Yi;function qn(){if(Yi)return _r;Yi=1;var q=Or(),U=Ss(),Q=Ut(),ne=Ir();return _r=function(pe,j,c){if(!pe||typeof pe!="object"&&typeof pe!="function")throw new Q("`obj` must be an object or a function`");if(typeof j!="string"&&typeof j!="symbol")throw new Q("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Q("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Q("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Q("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Q("`loose`, if provided, must be a boolean");var y=arguments.length>3?arguments[3]:null,_=arguments.length>4?arguments[4]:null,f=arguments.length>5?arguments[5]:null,d=arguments.length>6?arguments[6]:!1,u=!!ne&&ne(pe,j);if(q)q(pe,j,{configurable:f===null&&u?u.configurable:!f,enumerable:y===null&&u?u.enumerable:!y,value:c,writable:_===null&&u?u.writable:!_});else if(d||!y&&!_&&!f)pe[j]=c;else throw new U("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},_r}var gr,Zi;function Vn(){if(Zi)return gr;Zi=1;var q=Or(),U=function(){return!!q};return U.hasArrayLengthDefineBug=function(){if(!q)return null;try{return q([],"length",{value:1}).length!==1}catch{return!0}},gr=U,gr}var vr,Ji;function Kn(){if(Ji)return vr;Ji=1;var q=kt(),U=qn(),Q=Vn()(),ne=Ir(),ue=Ut(),pe=q("%Math.floor%");return vr=function(c,y){if(typeof c!="function")throw new ue("`fn` is not a function");if(typeof y!="number"||y<0||y>4294967295||pe(y)!==y)throw new ue("`length` must be a positive 32-bit integer");var _=arguments.length>2&&!!arguments[2],f=!0,d=!0;if("length"in c&&ne){var u=ne(c,"length");u&&!u.configurable&&(f=!1),u&&!u.writable&&(d=!1)}return(f||d||!_)&&(Q?U(c,"length",y,!0,!0):U(c,"length",y)),c},vr}var Qi;function Cs(){return Qi||(Qi=1,function(q){var U=Br(),Q=kt(),ne=Kn(),ue=Ut(),pe=Q("%Function.prototype.apply%"),j=Q("%Function.prototype.call%"),c=Q("%Reflect.apply%",!0)||U.call(j,pe),y=Or(),_=Q("%Math.max%");q.exports=function(u){if(typeof u!="function")throw new ue("a function is required");var w=c(U,j,arguments);return ne(w,1+_(0,u.length-(arguments.length-1)),!0)};var f=function(){return c(U,pe,arguments)};y?y(q.exports,"apply",{value:f}):q.exports.apply=f}(dr)),dr.exports}var mr,es;function ws(){if(es)return mr;es=1;var q=kt(),U=Cs(),Q=U(q("String.prototype.indexOf"));return mr=function(ue,pe){var j=q(ue,!!pe);return typeof j=="function"&&Q(ue,".prototype.")>-1?U(j):j},mr}var yr,ts;function Xn(){if(ts)return yr;ts=1;var q=Mr()(),U=ws(),Q=U("Object.prototype.toString"),ne=function(c){return q&&c&&typeof c=="object"&&Symbol.toStringTag in c?!1:Q(c)==="[object Arguments]"},ue=function(c){return ne(c)?!0:c!==null&&typeof c=="object"&&typeof c.length=="number"&&c.length>=0&&Q(c)!=="[object Array]"&&Q(c.callee)==="[object Function]"},pe=function(){return ne(arguments)}();return ne.isLegacyArguments=ue,yr=pe?ne:ue,yr}var br,rs;function Yn(){if(rs)return br;rs=1;var q=Object.prototype.toString,U=Function.prototype.toString,Q=/^\s*(?:function)?\*/,ne=Mr()(),ue=Object.getPrototypeOf,pe=function(){if(!ne)return!1;try{return Function("return function*() {}")()}catch{}},j;return br=function(y){if(typeof y!="function")return!1;if(Q.test(U.call(y)))return!0;if(!ne){var _=q.call(y);return _==="[object GeneratorFunction]"}if(!ue)return!1;if(typeof j>"u"){var f=pe();j=f?ue(f):!1}return ue(y)===j},br}var Sr,is;function Zn(){if(is)return Sr;is=1;var q=Function.prototype.toString,U=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,Q,ne;if(typeof U=="function"&&typeof Object.defineProperty=="function")try{Q=Object.defineProperty({},"length",{get:function(){throw ne}}),ne={},U(function(){throw 42},null,Q)}catch(s){s!==ne&&(U=null)}else U=null;var ue=/^\s*class\b/,pe=function(i){try{var h=q.call(i);return ue.test(h)}catch{return!1}},j=function(i){try{return pe(i)?!1:(q.call(i),!0)}catch{return!1}},c=Object.prototype.toString,y="[object Object]",_="[object Function]",f="[object GeneratorFunction]",d="[object HTMLAllCollection]",u="[object HTML document.all class]",w="[object HTMLCollection]",m=typeof Symbol=="function"&&!!Symbol.toStringTag,n=!(0 in[,]),t=function(){return!1};if(typeof document=="object"){var a=document.all;c.call(a)===c.call(document.all)&&(t=function(i){if((n||!i)&&(typeof i>"u"||typeof i=="object"))try{var h=c.call(i);return(h===d||h===u||h===w||h===y)&&i("")==null}catch{}return!1})}return Sr=U?function(i){if(t(i))return!0;if(!i||typeof i!="function"&&typeof i!="object")return!1;try{U(i,null,Q)}catch(h){if(h!==ne)return!1}return!pe(i)&&j(i)}:function(i){if(t(i))return!0;if(!i||typeof i!="function"&&typeof i!="object")return!1;if(m)return j(i);if(pe(i))return!1;var h=c.call(i);return h!==_&&h!==f&&!/^\[object HTML/.test(h)?!1:j(i)},Sr}var Cr,ss;function Jn(){if(ss)return Cr;ss=1;var q=Zn(),U=Object.prototype.toString,Q=Object.prototype.hasOwnProperty,ne=function(y,_,f){for(var d=0,u=y.length;d<u;d++)Q.call(y,d)&&(f==null?_(y[d],d,y):_.call(f,y[d],d,y))},ue=function(y,_,f){for(var d=0,u=y.length;d<u;d++)f==null?_(y.charAt(d),d,y):_.call(f,y.charAt(d),d,y)},pe=function(y,_,f){for(var d in y)Q.call(y,d)&&(f==null?_(y[d],d,y):_.call(f,y[d],d,y))},j=function(y,_,f){if(!q(_))throw new TypeError("iterator must be a function");var d;arguments.length>=3&&(d=f),U.call(y)==="[object Array]"?ne(y,_,d):typeof y=="string"?ue(y,_,d):pe(y,_,d)};return Cr=j,Cr}var wr,ns;function Qn(){return ns||(ns=1,wr=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),wr}var xr,os;function eo(){if(os)return xr;os=1;var q=Qn(),U=typeof globalThis>"u"?fs:globalThis;return xr=function(){for(var ne=[],ue=0;ue<q.length;ue++)typeof U[q[ue]]=="function"&&(ne[ne.length]=q[ue]);return ne},xr}var Er,as;function xs(){if(as)return Er;as=1;var q=Jn(),U=eo(),Q=Cs(),ne=ws(),ue=Ir(),pe=ne("Object.prototype.toString"),j=Mr()(),c=typeof globalThis>"u"?fs:globalThis,y=U(),_=ne("String.prototype.slice"),f=Object.getPrototypeOf,d=ne("Array.prototype.indexOf",!0)||function(t,a){for(var s=0;s<t.length;s+=1)if(t[s]===a)return s;return-1},u={__proto__:null};j&&ue&&f?q(y,function(n){var t=new c[n];if(Symbol.toStringTag in t){var a=f(t),s=ue(a,Symbol.toStringTag);if(!s){var i=f(a);s=ue(i,Symbol.toStringTag)}u["$"+n]=Q(s.get)}}):q(y,function(n){var t=new c[n],a=t.slice||t.set;a&&(u["$"+n]=Q(a))});var w=function(t){var a=!1;return q(u,function(s,i){if(!a)try{"$"+s(t)===i&&(a=_(i,1))}catch{}}),a},m=function(t){var a=!1;return q(u,function(s,i){if(!a)try{s(t),a=_(i,1)}catch{}}),a};return Er=function(t){if(!t||typeof t!="object")return!1;if(!j){var a=_(pe(t),8,-1);return d(y,a)>-1?a:a!=="Object"?!1:m(t)}return ue?w(t):null},Er}var Lr,ls;function to(){if(ls)return Lr;ls=1;var q=xs();return Lr=function(Q){return!!q(Q)},Lr}var cs;function ro(){return cs||(cs=1,function(q){var U=Xn(),Q=Yn(),ne=xs(),ue=to();function pe(re){return re.call.bind(re)}var j=typeof BigInt<"u",c=typeof Symbol<"u",y=pe(Object.prototype.toString),_=pe(Number.prototype.valueOf),f=pe(String.prototype.valueOf),d=pe(Boolean.prototype.valueOf);if(j)var u=pe(BigInt.prototype.valueOf);if(c)var w=pe(Symbol.prototype.valueOf);function m(re,xe){if(typeof re!="object")return!1;try{return xe(re),!0}catch{return!1}}q.isArgumentsObject=U,q.isGeneratorFunction=Q,q.isTypedArray=ue;function n(re){return typeof Promise<"u"&&re instanceof Promise||re!==null&&typeof re=="object"&&typeof re.then=="function"&&typeof re.catch=="function"}q.isPromise=n;function t(re){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(re):ue(re)||X(re)}q.isArrayBufferView=t;function a(re){return ne(re)==="Uint8Array"}q.isUint8Array=a;function s(re){return ne(re)==="Uint8ClampedArray"}q.isUint8ClampedArray=s;function i(re){return ne(re)==="Uint16Array"}q.isUint16Array=i;function h(re){return ne(re)==="Uint32Array"}q.isUint32Array=h;function p(re){return ne(re)==="Int8Array"}q.isInt8Array=p;function g(re){return ne(re)==="Int16Array"}q.isInt16Array=g;function C(re){return ne(re)==="Int32Array"}q.isInt32Array=C;function v(re){return ne(re)==="Float32Array"}q.isFloat32Array=v;function b(re){return ne(re)==="Float64Array"}q.isFloat64Array=b;function E(re){return ne(re)==="BigInt64Array"}q.isBigInt64Array=E;function A(re){return ne(re)==="BigUint64Array"}q.isBigUint64Array=A;function T(re){return y(re)==="[object Map]"}T.working=typeof Map<"u"&&T(new Map);function O(re){return typeof Map>"u"?!1:T.working?T(re):re instanceof Map}q.isMap=O;function H(re){return y(re)==="[object Set]"}H.working=typeof Set<"u"&&H(new Set);function M(re){return typeof Set>"u"?!1:H.working?H(re):re instanceof Set}q.isSet=M;function N(re){return y(re)==="[object WeakMap]"}N.working=typeof WeakMap<"u"&&N(new WeakMap);function L(re){return typeof WeakMap>"u"?!1:N.working?N(re):re instanceof WeakMap}q.isWeakMap=L;function B(re){return y(re)==="[object WeakSet]"}B.working=typeof WeakSet<"u"&&B(new WeakSet);function I(re){return B(re)}q.isWeakSet=I;function P(re){return y(re)==="[object ArrayBuffer]"}P.working=typeof ArrayBuffer<"u"&&P(new ArrayBuffer);function Z(re){return typeof ArrayBuffer>"u"?!1:P.working?P(re):re instanceof ArrayBuffer}q.isArrayBuffer=Z;function G(re){return y(re)==="[object DataView]"}G.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&G(new DataView(new ArrayBuffer(1),0,1));function X(re){return typeof DataView>"u"?!1:G.working?G(re):re instanceof DataView}q.isDataView=X;var V=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ie(re){return y(re)==="[object SharedArrayBuffer]"}function z(re){return typeof V>"u"?!1:(typeof ie.working>"u"&&(ie.working=ie(new V)),ie.working?ie(re):re instanceof V)}q.isSharedArrayBuffer=z;function $(re){return y(re)==="[object AsyncFunction]"}q.isAsyncFunction=$;function W(re){return y(re)==="[object Map Iterator]"}q.isMapIterator=W;function te(re){return y(re)==="[object Set Iterator]"}q.isSetIterator=te;function se(re){return y(re)==="[object Generator]"}q.isGeneratorObject=se;function be(re){return y(re)==="[object WebAssembly.Module]"}q.isWebAssemblyCompiledModule=be;function ce(re){return m(re,_)}q.isNumberObject=ce;function ke(re){return m(re,f)}q.isStringObject=ke;function ee(re){return m(re,d)}q.isBooleanObject=ee;function Ee(re){return j&&m(re,u)}q.isBigIntObject=Ee;function fe(re){return c&&m(re,w)}q.isSymbolObject=fe;function st(re){return ce(re)||ke(re)||ee(re)||Ee(re)||fe(re)}q.isBoxedPrimitive=st;function Re(re){return typeof Uint8Array<"u"&&(Z(re)||z(re))}q.isAnyArrayBuffer=Re,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(re){Object.defineProperty(q,re,{enumerable:!1,value:function(){throw new Error(re+" is not supported in userland")}})})}(Yt)),Yt}var kr,hs;function io(){return hs||(hs=1,kr=function(U){return U&&typeof U=="object"&&typeof U.copy=="function"&&typeof U.fill=="function"&&typeof U.readUInt8=="function"}),kr}var Pt={exports:{}},us;function so(){return us||(us=1,typeof Object.create=="function"?Pt.exports=function(U,Q){Q&&(U.super_=Q,U.prototype=Object.create(Q.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}))}:Pt.exports=function(U,Q){if(Q){U.super_=Q;var ne=function(){};ne.prototype=Q.prototype,U.prototype=new ne,U.prototype.constructor=U}}),Pt.exports}var ds;function no(){return ds||(ds=1,function(q){var U=Object.getOwnPropertyDescriptors||function(X){for(var V=Object.keys(X),ie={},z=0;z<V.length;z++)ie[V[z]]=Object.getOwnPropertyDescriptor(X,V[z]);return ie},Q=/%[sdj%]/g;q.format=function(G){if(!p(G)){for(var X=[],V=0;V<arguments.length;V++)X.push(j(arguments[V]));return X.join(" ")}for(var V=1,ie=arguments,z=ie.length,$=String(G).replace(Q,function(te){if(te==="%%")return"%";if(V>=z)return te;switch(te){case"%s":return String(ie[V++]);case"%d":return Number(ie[V++]);case"%j":try{return JSON.stringify(ie[V++])}catch{return"[Circular]"}default:return te}}),W=ie[V];V<z;W=ie[++V])s(W)||!b(W)?$+=" "+W:$+=" "+j(W);return $},q.deprecate=function(G,X){if(typeof process<"u"&&process.noDeprecation===!0)return G;if(typeof process>"u")return function(){return q.deprecate(G,X).apply(this,arguments)};var V=!1;function ie(){if(!V){if(process.throwDeprecation)throw new Error(X);process.traceDeprecation?console.trace(X):console.error(X),V=!0}return G.apply(this,arguments)}return ie};var ne={},ue=/^$/;if({}.NODE_DEBUG){var pe={}.NODE_DEBUG;pe=pe.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),ue=new RegExp("^"+pe+"$","i")}q.debuglog=function(G){if(G=G.toUpperCase(),!ne[G])if(ue.test(G)){var X=process.pid;ne[G]=function(){var V=q.format.apply(q,arguments);console.error("%s %d: %s",G,X,V)}}else ne[G]=function(){};return ne[G]};function j(G,X){var V={seen:[],stylize:y};return arguments.length>=3&&(V.depth=arguments[2]),arguments.length>=4&&(V.colors=arguments[3]),a(X)?V.showHidden=X:X&&q._extend(V,X),C(V.showHidden)&&(V.showHidden=!1),C(V.depth)&&(V.depth=2),C(V.colors)&&(V.colors=!1),C(V.customInspect)&&(V.customInspect=!0),V.colors&&(V.stylize=c),f(V,G,V.depth)}q.inspect=j,j.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},j.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function c(G,X){var V=j.styles[X];return V?"\x1B["+j.colors[V][0]+"m"+G+"\x1B["+j.colors[V][1]+"m":G}function y(G,X){return G}function _(G){var X={};return G.forEach(function(V,ie){X[V]=!0}),X}function f(G,X,V){if(G.customInspect&&X&&T(X.inspect)&&X.inspect!==q.inspect&&!(X.constructor&&X.constructor.prototype===X)){var ie=X.inspect(V,G);return p(ie)||(ie=f(G,ie,V)),ie}var z=d(G,X);if(z)return z;var $=Object.keys(X),W=_($);if(G.showHidden&&($=Object.getOwnPropertyNames(X)),A(X)&&($.indexOf("message")>=0||$.indexOf("description")>=0))return u(X);if($.length===0){if(T(X)){var te=X.name?": "+X.name:"";return G.stylize("[Function"+te+"]","special")}if(v(X))return G.stylize(RegExp.prototype.toString.call(X),"regexp");if(E(X))return G.stylize(Date.prototype.toString.call(X),"date");if(A(X))return u(X)}var se="",be=!1,ce=["{","}"];if(t(X)&&(be=!0,ce=["[","]"]),T(X)){var ke=X.name?": "+X.name:"";se=" [Function"+ke+"]"}if(v(X)&&(se=" "+RegExp.prototype.toString.call(X)),E(X)&&(se=" "+Date.prototype.toUTCString.call(X)),A(X)&&(se=" "+u(X)),$.length===0&&(!be||X.length==0))return ce[0]+se+ce[1];if(V<0)return v(X)?G.stylize(RegExp.prototype.toString.call(X),"regexp"):G.stylize("[Object]","special");G.seen.push(X);var ee;return be?ee=w(G,X,V,W,$):ee=$.map(function(Ee){return m(G,X,V,W,Ee,be)}),G.seen.pop(),n(ee,se,ce)}function d(G,X){if(C(X))return G.stylize("undefined","undefined");if(p(X)){var V="'"+JSON.stringify(X).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return G.stylize(V,"string")}if(h(X))return G.stylize(""+X,"number");if(a(X))return G.stylize(""+X,"boolean");if(s(X))return G.stylize("null","null")}function u(G){return"["+Error.prototype.toString.call(G)+"]"}function w(G,X,V,ie,z){for(var $=[],W=0,te=X.length;W<te;++W)B(X,String(W))?$.push(m(G,X,V,ie,String(W),!0)):$.push("");return z.forEach(function(se){se.match(/^\d+$/)||$.push(m(G,X,V,ie,se,!0))}),$}function m(G,X,V,ie,z,$){var W,te,se;if(se=Object.getOwnPropertyDescriptor(X,z)||{value:X[z]},se.get?se.set?te=G.stylize("[Getter/Setter]","special"):te=G.stylize("[Getter]","special"):se.set&&(te=G.stylize("[Setter]","special")),B(ie,z)||(W="["+z+"]"),te||(G.seen.indexOf(se.value)<0?(s(V)?te=f(G,se.value,null):te=f(G,se.value,V-1),te.indexOf(`
`)>-1&&($?te=te.split(`
`).map(function(be){return"  "+be}).join(`
`).slice(2):te=`
`+te.split(`
`).map(function(be){return"   "+be}).join(`
`))):te=G.stylize("[Circular]","special")),C(W)){if($&&z.match(/^\d+$/))return te;W=JSON.stringify(""+z),W.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(W=W.slice(1,-1),W=G.stylize(W,"name")):(W=W.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),W=G.stylize(W,"string"))}return W+": "+te}function n(G,X,V){var ie=G.reduce(function(z,$){return $.indexOf(`
`)>=0,z+$.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ie>60?V[0]+(X===""?"":X+`
 `)+" "+G.join(`,
  `)+" "+V[1]:V[0]+X+" "+G.join(", ")+" "+V[1]}q.types=ro();function t(G){return Array.isArray(G)}q.isArray=t;function a(G){return typeof G=="boolean"}q.isBoolean=a;function s(G){return G===null}q.isNull=s;function i(G){return G==null}q.isNullOrUndefined=i;function h(G){return typeof G=="number"}q.isNumber=h;function p(G){return typeof G=="string"}q.isString=p;function g(G){return typeof G=="symbol"}q.isSymbol=g;function C(G){return G===void 0}q.isUndefined=C;function v(G){return b(G)&&H(G)==="[object RegExp]"}q.isRegExp=v,q.types.isRegExp=v;function b(G){return typeof G=="object"&&G!==null}q.isObject=b;function E(G){return b(G)&&H(G)==="[object Date]"}q.isDate=E,q.types.isDate=E;function A(G){return b(G)&&(H(G)==="[object Error]"||G instanceof Error)}q.isError=A,q.types.isNativeError=A;function T(G){return typeof G=="function"}q.isFunction=T;function O(G){return G===null||typeof G=="boolean"||typeof G=="number"||typeof G=="string"||typeof G=="symbol"||typeof G>"u"}q.isPrimitive=O,q.isBuffer=io();function H(G){return Object.prototype.toString.call(G)}function M(G){return G<10?"0"+G.toString(10):G.toString(10)}var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function L(){var G=new Date,X=[M(G.getHours()),M(G.getMinutes()),M(G.getSeconds())].join(":");return[G.getDate(),N[G.getMonth()],X].join(" ")}q.log=function(){console.log("%s - %s",L(),q.format.apply(q,arguments))},q.inherits=so(),q._extend=function(G,X){if(!X||!b(X))return G;for(var V=Object.keys(X),ie=V.length;ie--;)G[V[ie]]=X[V[ie]];return G};function B(G,X){return Object.prototype.hasOwnProperty.call(G,X)}var I=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;q.promisify=function(X){if(typeof X!="function")throw new TypeError('The "original" argument must be of type Function');if(I&&X[I]){var V=X[I];if(typeof V!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(V,I,{value:V,enumerable:!1,writable:!1,configurable:!0}),V}function V(){for(var ie,z,$=new Promise(function(se,be){ie=se,z=be}),W=[],te=0;te<arguments.length;te++)W.push(arguments[te]);W.push(function(se,be){se?z(se):ie(be)});try{X.apply(this,W)}catch(se){z(se)}return $}return Object.setPrototypeOf(V,Object.getPrototypeOf(X)),I&&Object.defineProperty(V,I,{value:V,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(V,U(X))},q.promisify.custom=I;function P(G,X){if(!G){var V=new Error("Promise was rejected with a falsy value");V.reason=G,G=V}return X(G)}function Z(G){if(typeof G!="function")throw new TypeError('The "original" argument must be of type Function');function X(){for(var V=[],ie=0;ie<arguments.length;ie++)V.push(arguments[ie]);var z=V.pop();if(typeof z!="function")throw new TypeError("The last argument must be of type Function");var $=this,W=function(){return z.apply($,arguments)};G.apply(this,V).then(function(te){process.nextTick(W.bind(null,null,te))},function(te){process.nextTick(P.bind(null,te,W))})}return Object.setPrototypeOf(X,Object.getPrototypeOf(G)),Object.defineProperties(X,U(G)),X}q.callbackify=Z}(Xt)),Xt}/*! For license information please see xterm-addon-ligatures.js.LICENSE.txt */(function(q,U){(function(Q,ne){q.exports=ne(Kt,Kt,no(),Kt)})(self,function(Q,ne,ue,pe){return(()=>{var j={185:(f,d)=>{function u(m){const n={};for(const[t,a]of Object.entries(m.individual))n[t]=w(a);for(const{range:t,entry:a}of m.range){const s=w(a);for(let i=t[0];i<t[1];i++)n[i]=s}return n}function w(m){const n={};return m.forward&&(n.forward=u(m.forward)),m.reverse&&(n.reverse=u(m.reverse)),m.lookup&&(n.lookup=m.lookup),n}Object.defineProperty(d,"__esModule",{value:!0}),d.default=u},98:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(602),m=u(593),n=u(233),t=u(694),a=u(532),s=u(595),i=u(223),h=u(439),p=u(349),g=u(185);class C{constructor(E,A){this._lookupTrees=[],this._glyphLookups={},this._font=E,A.cacheSize>0&&(this._cache=new m({max:A.cacheSize,length:(M,N)=>N.length}));const T=(this._font.tables.gsub&&this._font.tables.gsub.features.filter(M=>M.tag==="calt")||[]).reduce((M,N)=>[...M,...N.feature.lookupListIndexes],[]),O=this._font.tables.gsub&&this._font.tables.gsub.lookups||[],H=O.filter((M,N)=>T.some(L=>L===N));for(const[M,N]of H.entries()){const L=[];switch(N.lookupType){case 6:for(const[I,P]of N.subtables.entries())switch(P.substFormat){case 1:L.push(s.default(P,O,I));break;case 2:L.push(i.default(P,O,I));break;case 3:L.push(h.default(P,O,I))}break;case 8:for(const[I,P]of N.subtables.entries())L.push(p.default(P,I))}const B=g.default(n.default(L));this._lookupTrees.push({tree:B,processForward:N.lookupType!==8});for(const I of Object.keys(B))this._glyphLookups[I]||(this._glyphLookups[I]=[]),this._glyphLookups[I].push(M)}}findLigatures(E){const A=this._cache&&this._cache.get(E);if(A&&!Array.isArray(A))return A;const T=[];for(const M of E)T.push(this._font.charToGlyphIndex(M));if(this._lookupTrees.length===0)return{inputGlyphs:T,outputGlyphs:T,contextRanges:[]};const O=this._findInternal(T.slice()),H={inputGlyphs:T,outputGlyphs:O.sequence,contextRanges:O.ranges};return this._cache&&this._cache.set(E,H),H}findLigatureRanges(E){if(this._lookupTrees.length===0)return[];const A=this._cache&&this._cache.get(E);if(A)return Array.isArray(A)?A:A.contextRanges;const T=[];for(const H of E)T.push(this._font.charToGlyphIndex(H));const O=this._findInternal(T);return this._cache&&this._cache.set(E,O.ranges),O.ranges}_findInternal(E){const A=[];let T=this._getNextLookup(E,0);for(;T.index!==null;){const O=this._lookupTrees[T.index];if(O.processForward){let H=T.last;for(let M=T.first;M<H;M++){const N=t.default(O.tree,E,M,M);if(N){for(let L=0;L<N.substitutions.length;L++){const B=N.substitutions[L];B!==null&&(E[M+L]=B)}a.default(A,N.contextRange[0]+M,N.contextRange[1]+M),M+N.length>=H&&(H=M+N.length+1),M+=N.length-1}}}else for(let H=T.last-1;H>=T.first;H--){const M=t.default(O.tree,E,H,H);if(M){for(let N=0;N<M.substitutions.length;N++){const L=M.substitutions[N];L!==null&&(E[H+N]=L)}a.default(A,M.contextRange[0]+H,M.contextRange[1]+H),H-=M.length-1}}T=this._getNextLookup(E,T.index+1)}return{sequence:E,ranges:A}}_getNextLookup(E,A){const T={index:null,first:1/0,last:-1};for(let O=0;O<E.length;O++){const H=this._glyphLookups[E[O]];if(H)for(let M=0;M<H.length;M++){const N=H[M];if(N>=A){(T.index===null||N<=T.index)&&(T.index=N,T.first>O&&(T.first=O),T.last=O+1);break}}}return T}}async function v(b,E){const A=await Promise.resolve().then(()=>u(269)).then(T=>T.promisify(w.load)(b));return new C(A,Object.assign({cacheSize:0},E))}d.load=async function(b,E){const[A]=await Promise.resolve().then(()=>u(781)).then(T=>T.listVariants(b));if(!A)throw new Error(`Font ${b} not found`);return v(A.path,E)},d.loadFile=v,d.loadBuffer=function(b,E){const A=w.parse(b);return new C(A,Object.assign({cacheSize:0},E))}},233:(f,d)=>{function u(i,h){for(const[p,g]of Object.entries(h.individual))if(i.individual[p])w(i.individual[p],g);else{let C=!1;for(const[v,{range:b,entry:E}]of i.range.entries()){const A=n(Number(p),b);if(A.both!==null){C=!0,i.individual[p]=g,w(i.individual[p],a(E)),i.range.splice(v,1);for(const T of A.second)Array.isArray(T)?i.range.push({range:T,entry:a(E)}):i.individual[T]=a(E)}}C||(i.individual[p]=g)}for(const{range:p,entry:g}of h.range){let C=[p];for(let v=0;v<i.range.length;v++){const{range:b,entry:E}=i.range[v];for(const[A,T]of C.entries()){if(!Array.isArray(T)){const O=n(T,b);if(O.both===null)continue;i.individual[T]=a(g),w(i.individual[T],a(E)),i.range.splice(v,1),v--;for(const H of O.second)Array.isArray(H)?i.range.push({range:H,entry:a(E)}):i.individual[H]=a(E);C.splice(A,1,...O.first);break}{const O=m(T,b);if(O.both===null)continue;i.range.splice(v,1),v--;const H=a(E);Array.isArray(O.both)?i.range.push({range:O.both,entry:H}):i.individual[O.both]=H,w(H,a(g));for(const M of O.second)Array.isArray(M)?i.range.push({range:M,entry:a(E)}):i.individual[M]=a(E);C=O.first}}}for(const v of Object.keys(i.individual))for(const[b,E]of C.entries()){if(Array.isArray(E)){const A=n(Number(v),E);if(A.both===null)continue;w(i.individual[v],a(g)),C.splice(b,1,...A.second);break}if(Number(v)===E){w(i.individual[v],a(g));break}}for(const v of C)Array.isArray(v)?i.range.push({range:v,entry:a(g)}):i.individual[v]=a(g)}}function w(i,h){h.lookup&&(!i.lookup||i.lookup.index>h.lookup.index||i.lookup.index===h.lookup.index&&i.lookup.subIndex>h.lookup.subIndex)&&(i.lookup=h.lookup),h.forward&&(i.forward?u(i.forward,h.forward):i.forward=h.forward),h.reverse&&(i.reverse?u(i.reverse,h.reverse):i.reverse=h.reverse)}function m(i,h){const p={first:[],second:[],both:null};if(i[0]<h[1]&&h[0]<i[1]){const g=Math.max(i[0],h[0]),C=Math.min(i[1],h[1]);p.both=t(g,C)}if(i[0]<h[0]){const g=i[0],C=Math.min(h[0],i[1]);p.first.push(t(g,C))}else if(h[0]<i[0]){const g=h[0],C=Math.min(h[1],i[0]);p.second.push(t(g,C))}if(i[1]>h[1]){const g=Math.max(i[0],h[1]),C=i[1];p.first.push(t(g,C))}else if(h[1]>i[1]){const g=Math.max(i[1],h[0]),C=h[1];p.second.push(t(g,C))}return p}function n(i,h){if(i<h[0]||i>h[1])return{first:[i],second:[h],both:null};const p={first:[],second:[],both:i};return h[0]<i&&p.second.push(t(h[0],i)),h[1]>i&&p.second.push(t(i+1,h[1])),p}function t(i,h){return h-i==1?i:[i,h]}function a(i){const h={};return i.forward&&(h.forward=s(i.forward)),i.reverse&&(h.reverse=s(i.reverse)),i.lookup&&(h.lookup={contextRange:i.lookup.contextRange.slice(),index:i.lookup.index,length:i.lookup.length,subIndex:i.lookup.subIndex,substitutions:i.lookup.substitutions.slice()}),h}function s(i){const h={};for(const[p,g]of Object.entries(i.individual))h[p]=a(g);return{individual:h,range:i.range.map(({range:p,entry:g})=>({range:p.slice(),entry:a(g)}))}}Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(i){const h={individual:{},range:[]};for(const p of i)u(h,p);return h}},532:(f,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(u,w,m){let n=!1;for(let t=0;t<u.length;t++){const a=u[t];if(n){if(m<=a[0])return u[t-1][1]=m,u;if(m<=a[1])return u[t-1][1]=Math.max(m,a[1]),u.splice(t,1),n=!1,u;u.splice(t,1),t--}else{if(m<=a[0])return u.splice(t,0,[w,m]),u;if(m<=a[1])return a[0]=Math.min(w,a[0]),u;if(!(w<a[1]))continue;a[0]=Math.min(w,a[0]),n=!0}}return n?u[u.length-1][1]=m:u.push([w,m]),u}},595:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(283),m=u(267);d.default=function(n,t,a){const s={individual:{},range:[]},i=w.listGlyphsByIndex(n.coverage);for(const{glyphId:h,index:p}of i){const g=n.chainRuleSets[p];if(g)for(const[C,v]of g.entries()){let b=m.getInputTree(s,v.lookupRecords,t,0,h).map(({entry:E,substitution:A})=>({entry:E,substitutions:[A]}));for(const[E,A]of v.input.entries())b=m.processInputPosition([A],E+1,b,v.lookupRecords,t);for(const E of v.lookahead)b=m.processLookaheadPosition([E],b);for(const E of v.backtrack)b=m.processBacktrackPosition([E],b);for(const{entry:E,substitutions:A}of b)E.lookup={substitutions:A,length:v.input.length+1,index:a,subIndex:C,contextRange:[-1*v.backtrack.length,1+v.input.length+v.lookahead.length]}}}return s}},223:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(233),m=u(283),n=u(91),t=u(267);d.default=function(a,s,i){const h=[],p=m.listGlyphsByIndex(a.coverage);for(const{glyphId:g}of p){const C=n.default(a.inputClassDef,g);for(const[v,b]of C.entries()){if(b===null)continue;const E=a.chainClassSet[b];if(E)for(const[A,T]of E.entries()){const O={individual:{},range:[]};let H=t.getInputTree(O,T.lookupRecords,s,0,v).map(({entry:M,substitution:N})=>({entry:M,substitutions:[N]}));for(const[M,N]of T.input.entries())H=t.processInputPosition(n.listClassGlyphs(a.inputClassDef,N),M+1,H,T.lookupRecords,s);for(const M of T.lookahead)H=t.processLookaheadPosition(n.listClassGlyphs(a.lookaheadClassDef,M),H);for(const M of T.backtrack)H=t.processBacktrackPosition(n.listClassGlyphs(a.backtrackClassDef,M),H);for(const{entry:M,substitutions:N}of H)M.lookup={substitutions:N,index:i,subIndex:A,length:T.input.length+1,contextRange:[-1*T.backtrack.length,1+T.input.length+T.lookahead.length]};h.push(O)}}}return w.default(h)}},439:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(283),m=u(267);d.default=function(n,t,a){const s={individual:{},range:[]},i=w.listGlyphsByIndex(n.inputCoverage[0]);for(const{glyphId:h}of i){let p=m.getInputTree(s,n.lookupRecords,t,0,h).map(({entry:g,substitution:C})=>({entry:g,substitutions:[C]}));for(const[g,C]of n.inputCoverage.slice(1).entries())p=m.processInputPosition(w.listGlyphsByIndex(C).map(v=>v.glyphId),g+1,p,n.lookupRecords,t);for(const g of n.lookaheadCoverage)p=m.processLookaheadPosition(w.listGlyphsByIndex(g).map(C=>C.glyphId),p);for(const g of n.backtrackCoverage)p=m.processBacktrackPosition(w.listGlyphsByIndex(g).map(C=>C.glyphId),p);for(const{entry:g,substitutions:C}of p)g.lookup={substitutions:C,index:a,subIndex:0,length:n.inputCoverage.length,contextRange:[-1*n.backtrackCoverage.length,n.inputCoverage.length+n.lookaheadCoverage.length]}}return s}},349:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(283),m=u(267);d.default=function(n,t){const a={individual:{},range:[]},s=w.listGlyphsByIndex(n.coverage);for(const{glyphId:i,index:h}of s){const p={};Array.isArray(i)?a.range.push({entry:p,range:i}):a.individual[i]=p;let g=[{entry:p,substitutions:[n.substitutes[h]]}];for(const C of n.lookaheadCoverage)g=m.processLookaheadPosition(w.listGlyphsByIndex(C).map(v=>v.glyphId),g);for(const C of n.backtrackCoverage)g=m.processBacktrackPosition(w.listGlyphsByIndex(C).map(v=>v.glyphId),g);for(const{entry:C,substitutions:v}of g)C.lookup={substitutions:v,index:t,subIndex:0,length:1,contextRange:[-1*n.backtrackCoverage.length,1+n.lookaheadCoverage.length]}}return a}},91:(f,d)=>{function u(w,m){for(const n of w.ranges)if(n.start<=m&&n.end>=m)return n.classId;return null}Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(w,m){return w.format===2?Array.isArray(m)?function(n,t){let a=t[0],s=u(n,a),i=t[0]+1;const h=new Map;for(;i<t[1];)u(n,i)!==s&&(i-a<=1?h.set(a,s):h.set([a,i],s)),i++;return i-a<=1?h.set(a,s):h.set([a,i],s),h}(w,m):new Map([[m,u(w,m)]]):new Map([[m,null]])},d.listClassGlyphs=function(w,m){if(w.format===2){const n=[];for(const t of w.ranges)t.classId===m&&(t.end===t.start?n.push(t.start):n.push([t.start,t.end+1]));return n}return[]}},283:(f,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(u,w){switch(u.format){case 1:const m=u.glyphs.indexOf(w);return m!==-1?m:null;case 2:const n=u.ranges.find(t=>t.start<=w&&t.end>=w);return n?n.index:null}},d.listGlyphsByIndex=function(u){switch(u.format){case 1:return u.glyphs.map((m,n)=>({glyphId:m,index:n}));case 2:let w=[];for(const[m,n]of u.ranges.entries())n.end===n.start?w.push({glyphId:n.start,index:m}):w.push({glyphId:[n.start,n.end+1],index:m});return w}}},267:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(603);function m(t,a,s,i,h){const p=[];if(Array.isArray(h)){const g=function(C,v,b,E){for(const A of C.filter(T=>T.sequenceIndex===b))for(const T of v[A.lookupListIndex].subtables){const O=w.getRangeSubstitutionGlyphs(T,E);if(!Array.from(O.values()).every(H=>H!==null))return O}return new Map([[E,null]])}(a,s,i,h);for(const[C,v]of g){const b={};Array.isArray(C)?t.range.push({range:C,entry:b}):t.individual[C]={},p.push({entry:b,substitution:v})}}else t.individual[h]={},p.push({entry:t.individual[h],substitution:n(a,s,i,h)});return p}function n(t,a,s,i){for(const h of t.filter(p=>p.sequenceIndex===s))for(const p of a[h.lookupListIndex].subtables){const g=w.getIndividualSubstitutionGlyph(p,i);if(g!==null)return g}return null}d.processInputPosition=function(t,a,s,i,h){const p=[];for(const g of s){g.entry.forward={individual:{},range:[]};for(const C of t)p.push(...m(g.entry.forward,i,h,a,C).map(({entry:v,substitution:b})=>({entry:v,substitutions:[...g.substitutions,b]})))}return p},d.processLookaheadPosition=function(t,a){const s=[];for(const i of a)for(const h of t){const p={};i.entry.forward||(i.entry.forward={individual:{},range:[]}),s.push({entry:p,substitutions:i.substitutions}),Array.isArray(h)?i.entry.forward.range.push({entry:p,range:h}):i.entry.forward.individual[h]=p}return s},d.processBacktrackPosition=function(t,a){const s=[];for(const i of a)for(const h of t){const p={};i.entry.reverse||(i.entry.reverse={individual:{},range:[]}),s.push({entry:p,substitutions:i.substitutions}),Array.isArray(h)?i.entry.reverse.range.push({entry:p,range:h}):i.entry.reverse.individual[h]=p}return s},d.getInputTree=m},603:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(283);function m(n,t){const a=w.default(n.coverage,t);if(a===null)return null;switch(n.substFormat){case 1:return(t+n.deltaGlyphId)%65536;case 2:return n.substitute[a]!=null?n.substitute[a]:null}}d.getRangeSubstitutionGlyphs=function(n,t){let a=t[0],s=m(n,a),i=t[0]+1;const h=new Map;for(;i<t[1];)m(n,i)!==s&&(i-a<=1?h.set(a,s):h.set([a,i],s)),i++;return i-a<=1?h.set(a,s):h.set([a,i],s),h},d.getIndividualSubstitutionGlyph=m},694:(f,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function u(w,m,n,t){let a=w[m[t]];if(!a)return;let s=a.lookup;if(a.reverse){const h=function(p,g,C){let v=p[g[--C]],b=v&&v.lookup;for(;v&&((!b&&v.lookup||v.lookup&&b&&b.index>v.lookup.index)&&(b=v.lookup),!(--C<0)&&v.reverse);)v=v.reverse[g[C]];return b}(a.reverse,m,n);(!s&&h||h&&s&&(s.index>h.index||s.index===h.index&&s.subIndex>h.subIndex))&&(s=h)}if(++t>=m.length||!a.forward)return s;const i=u(a.forward,m,n,t);return(!s&&i||i&&s&&(s.index>i.index||s.index===i.index&&s.subIndex>i.subIndex))&&(s=i),s}},814:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(82);var m,n;(function(i){i.Serif="serif",i.SansSerif="sansSerif",i.Monospace="monospace",i.Cursive="cursive",i.Unknown="unknown"})(m=d.Type||(d.Type={})),function(i){i.Regular="regular",i.Italic="italic",i.Oblique="oblique",i.Bold="bold",i.BoldItalic="boldItalic",i.BoldOblique="boldOblique",i.Other="other"}(n=d.Style||(d.Style={}));const t=[" Regular"," Bold"," Bold Italic"," Bold Oblique"," Italic"," Oblique"];function a(i){if(!i.os2&&!i.head)return n.Other;const h=i.os2?32&i.os2.fsSelection:1&i.head.macStyle,p=i.os2?1&i.os2.fsSelection:i.post?i.post.italicAngle<0:2&i.head.macStyle,g=i.os2?512&i.os2.fsSelection:i.post?i.post.italicAngle>0:0,C=i.os2?320&i.os2.fsSelection:1;return h?g?n.BoldOblique:p?n.BoldItalic:n.Bold:g?n.Oblique:p?n.Italic:C?n.Regular:n.Other}d.name=function(i,h){const p=i.names.preferredFamily&&i.names.preferredFamily[h]?i.names.preferredFamily[h]:i.names.fontFamily[h];if(w.platform()==="win32"){const g=`${p} ${i.names.preferredSubfamily&&i.names.preferredSubfamily[h]?i.names.preferredSubfamily[h]:i.names.fontSubfamily[h]}`;let C=-1;for(const v of t){const b=g.lastIndexOf(v);if(b!==-1){C=b;break}}return C!==-1?g.substring(0,C):g}return p},d.type=function(i){if(i.os2)switch(i.os2.panose[0]){case 2:return i.os2.panose[3]===9?m.Monospace:i.os2.panose[1]>=11&&i.os2.panose[1]<=15||i.os2.panose[1]===0?m.SansSerif:m.Serif;case 3:return m.Cursive}else if(i.post&&i.post.isFixedPitch)return m.Monospace;return m.Unknown},d.style=a;const s=[n.Bold,n.BoldItalic,n.BoldOblique];d.weight=function(i){return i.os2?i.os2.usWeightClass:s.includes(a(i))?700:400}},781:function(f,d,u){var w=this&&this.__rest||function(h,p){var g={};for(var C in h)Object.prototype.hasOwnProperty.call(h,C)&&p.indexOf(C)<0&&(g[C]=h[C]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var v=0;for(C=Object.getOwnPropertySymbols(h);v<C.length;v++)p.indexOf(C[v])<0&&(g[C[v]]=h[C[v]])}return g};Object.defineProperty(d,"__esModule",{value:!0});const m=u(459),n=u(934),t=u(814);var a=u(814);async function s(h){const p=Object.assign({concurrency:4,language:"en"},h),g=await m.default({extensions:["ttf","otf"]}),C=await async function(b,E,A){const T=[];let O=0;const H=async N=>{T.push(await(async L=>{try{return i(L,await n.default(L),p.language)}catch(B){if(["TypeError","SyntaxError","ReferenceError","RangeError","AssertionError"].includes(B.name))throw B}})(E[N])),O<E.length&&await H(O++)},M=[];for(;O<E.length&&O<A;O++)M.push(H(O));return await Promise.all(M),T}(0,g,p.concurrency),v={};for(let b of C.filter(E=>E)){const{name:E}=b,A=w(b,["name"]);v[E]||(v[E]=[]),v[E].push(A)}return v}function i(h,p,g){return{name:t.name(p,g),path:h,type:t.type(p),weight:t.weight(p),style:t.style(p)}}d.Type=a.Type,d.Style=a.Style,d.list=s,d.listVariants=async function(h,p){return(await s(p))[h]||[]},d.get=async function(h,p){const g=Object.assign({language:"en"},p);return i(h,await n.default(h),g.language)}},934:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(89),m=u(896),n=u(380),t=u(879),a=u(130),s=u(731),i=u(954);var h;(function(C){C[C.TrueType=0]="TrueType",C[C.CFF=1]="CFF",C[C.Woff=2]="Woff"})(h||(h={}));const p={name:{tag:Buffer.from("name"),parse:n.default},ltag:{tag:Buffer.from("ltag"),parse:t.default},os2:{tag:Buffer.from("OS/2"),parse:a.default},head:{tag:Buffer.from("head"),parse:s.default},post:{tag:Buffer.from("post"),parse:i.default}};d.default=async function(C){return new Promise((v,b)=>{(async()=>{const E=m.default(),A=w.createReadStream(C);let T=!1;const O=()=>{T=!0};A.once("close",O),A.once("end",O),A.once("error",H=>{T=!0,b(H)}),A.pipe(E);try{switch(function(H){if(H.equals(g.one)||H.equals(g.true)||H.equals(g.typ1))return h.TrueType;if(H.equals(g.otto))return h.CFF;if(H.equals(g.woff))return h.Woff;throw new Error(`Unsupported signature type: ${H}`)}(await E.read(4))){case h.TrueType:case h.CFF:const H=(await E.read(2)).readUInt16BE(0);await E.skip(6);const M=await async function(I,P){const Z={};for(let G=0;G<P;G++){const X=await I.read(4),V=await I.read(12);for(const[ie,z]of Object.entries(p))if(X.equals(z.tag)&&(Z[ie]={offset:V.readUInt32BE(4),length:V.readUInt32BE(8)},Z.name&&Z.ltag&&Z.os2))return Z}return Z}(E,H),N=Object.entries(M).sort((I,P)=>I[1].offset-P[1].offset),L={};for(const[I,P]of N)await E.skip(P.offset-E.offset),L[I]=await E.read(P.length);let B=[];if(L.ltag&&(B=p.ltag.parse(L.ltag)),!L.name)throw new Error(`missing required OpenType table 'name' in font file: ${C}`);return{names:p.name.parse(L.name,B),os2:L.os2&&p.os2.parse(L.os2),head:L.head&&p.head.parse(L.head),post:L.post&&p.post.parse(L.post)};case h.Woff:default:throw new Error("provided font type is not supported yet")}}finally{A.unpipe(E),T||(A.destroy(),E.destroy())}})().then(v,b)})};const g={one:Buffer.from([0,1,0,0]),otto:Buffer.from("OTTO"),true:Buffer.from("true"),typ1:Buffer.from("typ1"),woff:Buffer.from("wOFF")}},731:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(980);d.default=function(m){return{version:w.formatFixed(m.readUInt16BE(0),m.readUInt16BE(2)),fontRevision:w.formatFixed(m.readUInt16BE(4),m.readUInt16BE(6)),checkSumAdjustment:m.readUInt32BE(8),magicNumber:m.readUInt32BE(12),flags:m.readUInt16BE(16),unitsPerEm:m.readUInt16BE(18),created:w.formatLongDateTime(m.readUInt32BE(20),m.readUInt32BE(24)),modified:w.formatLongDateTime(m.readUInt32BE(28),m.readUInt32BE(32)),xMin:m.readInt16BE(36),yMin:m.readInt16BE(38),xMax:m.readInt16BE(40),yMax:m.readInt16BE(42),macStyle:m.readUInt16BE(44),lowestRecPPEM:m.readUInt16BE(46),fontDirectionHint:m.readInt16BE(48),indexToLocFormat:m.readInt16BE(50),glyphDataFormat:m.readInt16BE(52)}}},879:(f,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(u){if(u.readUInt32BE(0)!==1)throw new Error("Unsupported ltag table version.");const w=u.readUInt32BE(8),m=[];for(let n=0;n<w;n++){let t="";const a=u.readUInt16BE(12+4*n),s=u.readUInt16BE(14+4*n);for(let i=a;i<a+s;++i)t+=String.fromCharCode(u.readInt8(i));m.push(t)}return m}},380:(f,d)=>{Object.defineProperty(d,"__esModule",{value:!0});const u=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],w={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},m={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function n(g,C,v){switch(g){case 0:if(C===65535)return"und";if(v)return v[C];break;case 1:return w[C];case 3:return m[C]}}const t="utf-16",a={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},s={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function i(g,C,v){switch(g){case 0:return t;case 1:return s[v]||a[C];case 3:if(C===1||C===10)return t}}d.default=function(g,C){const v={},b=g.readUInt16BE(2),E=g.readUInt16BE(4);let A=6;for(let T=0;T<b;T++){const O=g.readUInt16BE(A+0),H=g.readUInt16BE(A+2),M=g.readUInt16BE(A+4),N=g.readUInt16BE(A+6),L=u[N]||String(N),B=g.readUInt16BE(A+8),I=g.readUInt16BE(A+10),P=n(O,M,C),Z=i(O,H,M);if(A+=12,Z!==void 0&&P!==void 0){let G;if(Z===t){const X=B/2,V=Array(X);for(let ie=0;ie<X;ie++)V[ie]=g.readUInt16BE(E+I+2*ie);G=String.fromCharCode(...V)}else G=p(g,E+I,B,Z);if(G){let X=v[L];X===void 0&&(X=v[L]={}),X[P]=G}}}return v};const h={"x-mac-croatian":" ","x-mac-cyrillic":" ","x-mac-gaelic":" ","x-mac-greek":" ","x-mac-icelandic":" ","x-mac-inuit":" ","x-mac-ce":" ",macintosh:" ","x-mac-romanian":" ","x-mac-turkish":" "};function p(g,C,v,b){const E=h[b];if(E===void 0)return;let A="";for(let T=0;T<v;T++){const O=g.readUInt8(C+T);A+=O<=127?String.fromCharCode(O):E[127&O]}return A}},130:(f,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(u){const w={version:u.readUInt16BE(0),xAvgCharWidth:u.readUInt16BE(2),usWeightClass:u.readUInt16BE(4),usWidthClass:u.readUInt16BE(6),fsType:u.readUInt16BE(8),ySubscriptXSize:u.readInt16BE(10),ySubscriptYSize:u.readInt16BE(12),ySubscriptXOffset:u.readInt16BE(14),ySubscriptYOffset:u.readInt16BE(16),ySuperscriptXSize:u.readInt16BE(18),ySuperscriptYSize:u.readInt16BE(20),ySuperscriptXOffset:u.readInt16BE(22),ySuperscriptYOffset:u.readInt16BE(24),yStrikeoutSize:u.readInt16BE(26),yStrikeoutPosition:u.readInt16BE(28),sFamilyClass:u.readInt16BE(30),panose:[u.readUInt8(32),u.readUInt8(33),u.readUInt8(34),u.readUInt8(35),u.readUInt8(36),u.readUInt8(37),u.readUInt8(38),u.readUInt8(39),u.readUInt8(40),u.readUInt8(41)],ulUnicodeRange1:u.readUInt32BE(42),ulUnicodeRange2:u.readUInt32BE(46),ulUnicodeRange3:u.readUInt32BE(50),ulUnicodeRange4:u.readUInt32BE(54),achVendID:String.fromCharCode(u.readUInt8(58),u.readUInt8(59),u.readUInt8(60),u.readUInt8(61)),fsSelection:u.readUInt16BE(62),usFirstCharIndex:u.readUInt16BE(64),usLastCharIndex:u.readUInt16BE(66),sTypoAscender:u.readInt16BE(68),sTypoDescender:u.readInt16BE(70),sTypoLineGap:u.readInt16BE(72),usWinAscent:u.readUInt16BE(74),usWinDescent:u.readUInt16BE(76)};return w.version>=1&&(w.ulCodePageRange1=u.readUInt32BE(78),w.ulCodePageRange2=u.readUInt32BE(82)),w.version>=2&&(w.sxHeight=u.readInt16BE(86),w.sCapHeight=u.readInt16BE(88),w.usDefaultChar=u.readUInt16BE(90),w.usBreakChar=u.readUInt16BE(92),w.usMaxContent=u.readUInt16BE(94)),w}},954:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(980);d.default=function(m){return{version:w.formatFixed(m.readUInt16BE(0),m.readUInt16BE(2)),italicAngle:w.formatFixed(m.readUInt16BE(4),m.readUInt16BE(6)),underlinePosition:m.readInt16BE(8),underlineThickness:m.readInt16BE(10),isFixedPitch:m.readUInt32BE(12),minMemType42:m.readUInt32BE(16),maxMemType42:m.readUInt32BE(20),minMemType1:m.readUInt32BE(24),maxMemType1:m.readUInt32BE(28)}}},980:(f,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.formatFixed=function(u,w){return u+w/65536},d.formatLongDateTime=function(u,w){return 1e3*(u*4294967296+w-2082844800)}},459:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(56),m=u(456),n=u(49),t={win32:()=>({}).WINDIR?[w.join({}.WINDIR,"Fonts")]:["C:\\Windows\\Fonts"],darwin:()=>{const s=m.homedir();return[...s?[w.join(s,"/Library/Fonts")]:[],"/Library/Fonts","/Network/Library/Fonts","/System/Library/Fonts","/System Folder/Fonts"]},linux:()=>{const s=m.homedir();return["/usr/share/fonts","/usr/local/share/fonts",...s?[w.join(s,".fonts"),w.join(s,".local/share/fonts")]:[]]}};function a(s){const i=Object.assign({extensions:["ttf","otf","ttc","woff","woff2"],additionalFolders:[]},s),h=m.platform(),p=t[h];if(!p)throw new Error(`Unsupported platform: ${h}`);const g=p();return n.default([...g,...i.additionalFolders],i.extensions)}f.exports=Object.assign(a,{default:a}),d.default=a},49:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(89),m=u(269),n=u(56),t=m.promisify(w.readdir),a=m.promisify(w.stat);async function s(i,h,p=10){if(p<=0)return[];let g;try{g=await t(i)}catch{return[]}const C=[];return await Promise.all(g.map(async v=>{const b=n.join(i,v);let E;try{E=await a(b)}catch{return}E.isFile()&&h.test(b)?C.push(b):E.isDirectory()&&C.push(...await s(b,h,p-1))})),C}d.default=async function(i,h){const p=new Set;return await Promise.all(i.map(async g=>{const C=await s(n.resolve(g),new RegExp(`\\.${h.map(v=>`(?:${v})`).join("|")}$`));for(const v of C)p.add(v)})),[...p]}},593:(f,d,u)=>{const w=u(411),m=Symbol("max"),n=Symbol("length"),t=Symbol("lengthCalculator"),a=Symbol("allowStale"),s=Symbol("maxAge"),i=Symbol("dispose"),h=Symbol("noDisposeOnSet"),p=Symbol("lruList"),g=Symbol("cache"),C=Symbol("updateAgeOnGet"),v=()=>1,b=(M,N,L)=>{const B=M[g].get(N);if(B){const I=B.value;if(E(M,I)){if(T(M,B),!M[a])return}else L&&(M[C]&&(B.value.now=Date.now()),M[p].unshiftNode(B));return I.value}},E=(M,N)=>{if(!N||!N.maxAge&&!M[s])return!1;const L=Date.now()-N.now;return N.maxAge?L>N.maxAge:M[s]&&L>M[s]},A=M=>{if(M[n]>M[m])for(let N=M[p].tail;M[n]>M[m]&&N!==null;){const L=N.prev;T(M,N),N=L}},T=(M,N)=>{if(N){const L=N.value;M[i]&&M[i](L.key,L.value),M[n]-=L.length,M[g].delete(L.key),M[p].removeNode(N)}};class O{constructor(N,L,B,I,P){this.key=N,this.value=L,this.length=B,this.now=I,this.maxAge=P||0}}const H=(M,N,L,B)=>{let I=L.value;E(M,I)&&(T(M,L),M[a]||(I=void 0)),I&&N.call(B,I.value,I.key,M)};f.exports=class{constructor(M){if(typeof M=="number"&&(M={max:M}),M||(M={}),M.max&&(typeof M.max!="number"||M.max<0))throw new TypeError("max must be a non-negative number");this[m]=M.max||1/0;const N=M.length||v;if(this[t]=typeof N!="function"?v:N,this[a]=M.stale||!1,M.maxAge&&typeof M.maxAge!="number")throw new TypeError("maxAge must be a number");this[s]=M.maxAge||0,this[i]=M.dispose,this[h]=M.noDisposeOnSet||!1,this[C]=M.updateAgeOnGet||!1,this.reset()}set max(M){if(typeof M!="number"||M<0)throw new TypeError("max must be a non-negative number");this[m]=M||1/0,A(this)}get max(){return this[m]}set allowStale(M){this[a]=!!M}get allowStale(){return this[a]}set maxAge(M){if(typeof M!="number")throw new TypeError("maxAge must be a non-negative number");this[s]=M,A(this)}get maxAge(){return this[s]}set lengthCalculator(M){typeof M!="function"&&(M=v),M!==this[t]&&(this[t]=M,this[n]=0,this[p].forEach(N=>{N.length=this[t](N.value,N.key),this[n]+=N.length})),A(this)}get lengthCalculator(){return this[t]}get length(){return this[n]}get itemCount(){return this[p].length}rforEach(M,N){N=N||this;for(let L=this[p].tail;L!==null;){const B=L.prev;H(this,M,L,N),L=B}}forEach(M,N){N=N||this;for(let L=this[p].head;L!==null;){const B=L.next;H(this,M,L,N),L=B}}keys(){return this[p].toArray().map(M=>M.key)}values(){return this[p].toArray().map(M=>M.value)}reset(){this[i]&&this[p]&&this[p].length&&this[p].forEach(M=>this[i](M.key,M.value)),this[g]=new Map,this[p]=new w,this[n]=0}dump(){return this[p].map(M=>!E(this,M)&&{k:M.key,v:M.value,e:M.now+(M.maxAge||0)}).toArray().filter(M=>M)}dumpLru(){return this[p]}set(M,N,L){if((L=L||this[s])&&typeof L!="number")throw new TypeError("maxAge must be a number");const B=L?Date.now():0,I=this[t](N,M);if(this[g].has(M)){if(I>this[m])return T(this,this[g].get(M)),!1;const Z=this[g].get(M).value;return this[i]&&(this[h]||this[i](M,Z.value)),Z.now=B,Z.maxAge=L,Z.value=N,this[n]+=I-Z.length,Z.length=I,this.get(M),A(this),!0}const P=new O(M,N,I,B,L);return P.length>this[m]?(this[i]&&this[i](M,N),!1):(this[n]+=P.length,this[p].unshift(P),this[g].set(M,this[p].head),A(this),!0)}has(M){if(!this[g].has(M))return!1;const N=this[g].get(M).value;return!E(this,N)}get(M){return b(this,M,!0)}peek(M){return b(this,M,!1)}pop(){const M=this[p].tail;return M?(T(this,M),M.value):null}del(M){T(this,this[g].get(M))}load(M){this.reset();const N=Date.now();for(let L=M.length-1;L>=0;L--){const B=M[L],I=B.e||0;if(I===0)this.set(B.k,B.v);else{const P=I-N;P>0&&this.set(B.k,B.v,P)}}}prune(){this[g].forEach((M,N)=>b(this,N,!1))}}},602:(f,d,u)=>{u.r(d),u.d(d,{BoundingBox:()=>a,Font:()=>Di,Glyph:()=>At,Path:()=>i,_parse:()=>fe,load:()=>Ln,loadSync:()=>kn,parse:()=>Vt});var w=u(311),m=u.n(w);function n(e,r,o,l,S){return Math.pow(1-S,3)*e+3*Math.pow(1-S,2)*S*r+3*(1-S)*Math.pow(S,2)*o+Math.pow(S,3)*l}function t(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}t.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},t.prototype.addPoint=function(e,r){typeof e=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),typeof r=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=r,this.y2=r),r<this.y1&&(this.y1=r),r>this.y2&&(this.y2=r))},t.prototype.addX=function(e){this.addPoint(e,null)},t.prototype.addY=function(e){this.addPoint(null,e)},t.prototype.addBezier=function(e,r,o,l,S,x,k,D){const R=[e,r],F=[o,l],K=[S,x],Y=[k,D];this.addPoint(e,r),this.addPoint(k,D);for(let J=0;J<=1;J++){const de=6*R[J]-12*F[J]+6*K[J],ae=-3*R[J]+9*F[J]-9*K[J]+3*Y[J],ye=3*F[J]-3*R[J];if(ae===0){if(de===0)continue;const Se=-ye/de;0<Se&&Se<1&&(J===0&&this.addX(n(R[J],F[J],K[J],Y[J],Se)),J===1&&this.addY(n(R[J],F[J],K[J],Y[J],Se)));continue}const oe=Math.pow(de,2)-4*ye*ae;if(oe<0)continue;const le=(-de+Math.sqrt(oe))/(2*ae);0<le&&le<1&&(J===0&&this.addX(n(R[J],F[J],K[J],Y[J],le)),J===1&&this.addY(n(R[J],F[J],K[J],Y[J],le)));const me=(-de-Math.sqrt(oe))/(2*ae);0<me&&me<1&&(J===0&&this.addX(n(R[J],F[J],K[J],Y[J],me)),J===1&&this.addY(n(R[J],F[J],K[J],Y[J],me)))}},t.prototype.addQuad=function(e,r,o,l,S,x){const k=e+.6666666666666666*(o-e),D=r+2/3*(l-r),R=k+1/3*(S-e),F=D+1/3*(x-r);this.addBezier(e,r,k,D,R,F,S,x)};const a=t;function s(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}s.prototype.moveTo=function(e,r){this.commands.push({type:"M",x:e,y:r})},s.prototype.lineTo=function(e,r){this.commands.push({type:"L",x:e,y:r})},s.prototype.curveTo=s.prototype.bezierCurveTo=function(e,r,o,l,S,x){this.commands.push({type:"C",x1:e,y1:r,x2:o,y2:l,x:S,y:x})},s.prototype.quadTo=s.prototype.quadraticCurveTo=function(e,r,o,l){this.commands.push({type:"Q",x1:e,y1:r,x:o,y:l})},s.prototype.close=s.prototype.closePath=function(){this.commands.push({type:"Z"})},s.prototype.extend=function(e){if(e.commands)e=e.commands;else if(e instanceof a){const r=e;return this.moveTo(r.x1,r.y1),this.lineTo(r.x2,r.y1),this.lineTo(r.x2,r.y2),this.lineTo(r.x1,r.y2),void this.close()}Array.prototype.push.apply(this.commands,e)},s.prototype.getBoundingBox=function(){const e=new a;let r=0,o=0,l=0,S=0;for(let x=0;x<this.commands.length;x++){const k=this.commands[x];switch(k.type){case"M":e.addPoint(k.x,k.y),r=l=k.x,o=S=k.y;break;case"L":e.addPoint(k.x,k.y),l=k.x,S=k.y;break;case"Q":e.addQuad(l,S,k.x1,k.y1,k.x,k.y),l=k.x,S=k.y;break;case"C":e.addBezier(l,S,k.x1,k.y1,k.x2,k.y2,k.x,k.y),l=k.x,S=k.y;break;case"Z":l=r,S=o;break;default:throw new Error("Unexpected path command "+k.type)}}return e.isEmpty()&&e.addPoint(0,0),e},s.prototype.draw=function(e){e.beginPath();for(let r=0;r<this.commands.length;r+=1){const o=this.commands[r];o.type==="M"?e.moveTo(o.x,o.y):o.type==="L"?e.lineTo(o.x,o.y):o.type==="C"?e.bezierCurveTo(o.x1,o.y1,o.x2,o.y2,o.x,o.y):o.type==="Q"?e.quadraticCurveTo(o.x1,o.y1,o.x,o.y):o.type==="Z"&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},s.prototype.toPathData=function(e){function r(S){return Math.round(S)===S?""+Math.round(S):S.toFixed(e)}function o(){let S="";for(let x=0;x<arguments.length;x+=1){const k=arguments[x];k>=0&&x>0&&(S+=" "),S+=r(k)}return S}e=e!==void 0?e:2;let l="";for(let S=0;S<this.commands.length;S+=1){const x=this.commands[S];x.type==="M"?l+="M"+o(x.x,x.y):x.type==="L"?l+="L"+o(x.x,x.y):x.type==="C"?l+="C"+o(x.x1,x.y1,x.x2,x.y2,x.x,x.y):x.type==="Q"?l+="Q"+o(x.x1,x.y1,x.x,x.y):x.type==="Z"&&(l+="Z")}return l},s.prototype.toSVG=function(e){let r='<path d="';return r+=this.toPathData(e),r+='"',this.fill&&this.fill!=="black"&&(this.fill===null?r+=' fill="none"':r+=' fill="'+this.fill+'"'),this.stroke&&(r+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),r+="/>",r},s.prototype.toDOMElement=function(e){const r=this.toPathData(e),o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",r),o};const i=s;function h(e){throw new Error(e)}function p(e,r){e||h(r)}const g={fail:h,argument:p,assert:p},C=2147483648,v={},b={},E={};function A(e){return function(){return e}}b.BYTE=function(e){return g.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},E.BYTE=A(1),b.CHAR=function(e){return[e.charCodeAt(0)]},E.CHAR=A(1),b.CHARARRAY=function(e){const r=[];for(let o=0;o<e.length;o+=1)r[o]=e.charCodeAt(o);return r},E.CHARARRAY=function(e){return e.length},b.USHORT=function(e){return[e>>8&255,255&e]},E.USHORT=A(2),b.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},E.SHORT=A(2),b.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},E.UINT24=A(3),b.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},E.ULONG=A(4),b.LONG=function(e){return e>=C&&(e=-(2*C-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},E.LONG=A(4),b.FIXED=b.ULONG,E.FIXED=E.ULONG,b.FWORD=b.SHORT,E.FWORD=E.SHORT,b.UFWORD=b.USHORT,E.UFWORD=E.USHORT,b.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},E.LONGDATETIME=A(8),b.TAG=function(e){return g.argument(e.length===4,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},E.TAG=A(4),b.Card8=b.BYTE,E.Card8=E.BYTE,b.Card16=b.USHORT,E.Card16=E.USHORT,b.OffSize=b.BYTE,E.OffSize=E.BYTE,b.SID=b.USHORT,E.SID=E.USHORT,b.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?[247+((e-=108)>>8),255&e]:e>=-1131&&e<=-108?[251+((e=-e-108)>>8),255&e]:e>=-32768&&e<=32767?b.NUMBER16(e):b.NUMBER32(e)},E.NUMBER=function(e){return b.NUMBER(e).length},b.NUMBER16=function(e){return[28,e>>8&255,255&e]},E.NUMBER16=A(3),b.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},E.NUMBER32=A(5),b.REAL=function(e){let r=e.toString();const o=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(r);if(o){const x=parseFloat("1e"+((o[2]?+o[2]:0)+o[1].length));r=(Math.round(e*x)/x).toString()}let l="";for(let x=0,k=r.length;x<k;x+=1){const D=r[x];l+=D==="e"?r[++x]==="-"?"c":"b":D==="."?"a":D==="-"?"e":D}l+=1&l.length?"f":"ff";const S=[30];for(let x=0,k=l.length;x<k;x+=2)S.push(parseInt(l.substr(x,2),16));return S},E.REAL=function(e){return b.REAL(e).length},b.NAME=b.CHARARRAY,E.NAME=E.CHARARRAY,b.STRING=b.CHARARRAY,E.STRING=E.CHARARRAY,v.UTF8=function(e,r,o){const l=[],S=o;for(let x=0;x<S;x++,r+=1)l[x]=e.getUint8(r);return String.fromCharCode.apply(null,l)},v.UTF16=function(e,r,o){const l=[],S=o/2;for(let x=0;x<S;x++,r+=2)l[x]=e.getUint16(r);return String.fromCharCode.apply(null,l)},b.UTF16=function(e){const r=[];for(let o=0;o<e.length;o+=1){const l=e.charCodeAt(o);r[r.length]=l>>8&255,r[r.length]=255&l}return r},E.UTF16=function(e){return 2*e.length};const T={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};v.MACSTRING=function(e,r,o,l){const S=T[l];if(S===void 0)return;let x="";for(let k=0;k<o;k++){const D=e.getUint8(r+k);x+=D<=127?String.fromCharCode(D):S[127&D]}return x};const O=typeof WeakMap=="function"&&new WeakMap;let H;function M(e){return e>=-128&&e<=127}function N(e,r,o){let l=0;const S=e.length;for(;r<S&&l<64&&e[r]===0;)++r,++l;return o.push(128|l-1),r}function L(e,r,o){let l=0;const S=e.length;let x=r;for(;x<S&&l<64;){const k=e[x];if(!M(k)||k===0&&x+1<S&&e[x+1]===0)break;++x,++l}o.push(l-1);for(let k=r;k<x;++k)o.push(e[k]+256&255);return x}function B(e,r,o){let l=0;const S=e.length;let x=r;for(;x<S&&l<64;){const k=e[x];if(k===0||M(k)&&x+1<S&&M(e[x+1]))break;++x,++l}o.push(64|l-1);for(let k=r;k<x;++k){const D=e[k];o.push(D+65536>>8&255,D+256&255)}return x}b.MACSTRING=function(e,r){const o=function(S){if(!H){H={};for(let R in T)H[R]=new String(R)}const x=H[S];if(x===void 0)return;if(O){const R=O.get(x);if(R!==void 0)return R}const k=T[S];if(k===void 0)return;const D={};for(let R=0;R<k.length;R++)D[k.charCodeAt(R)]=R+128;return O&&O.set(x,D),D}(r);if(o===void 0)return;const l=[];for(let S=0;S<e.length;S++){let x=e.charCodeAt(S);if(x>=128&&(x=o[x],x===void 0))return;l[S]=x}return l},E.MACSTRING=function(e,r){const o=b.MACSTRING(e,r);return o!==void 0?o.length:0},b.VARDELTAS=function(e){let r=0;const o=[];for(;r<e.length;){const l=e[r];r=l===0?N(e,r,o):l>=-128&&l<=127?L(e,r,o):B(e,r,o)}return o},b.INDEX=function(e){let r=1;const o=[r],l=[];for(let D=0;D<e.length;D+=1){const R=b.OBJECT(e[D]);Array.prototype.push.apply(l,R),r+=R.length,o.push(r)}if(l.length===0)return[0,0];const S=[],x=1+Math.floor(Math.log(r)/Math.log(2))/8|0,k=[void 0,b.BYTE,b.USHORT,b.UINT24,b.ULONG][x];for(let D=0;D<o.length;D+=1){const R=k(o[D]);Array.prototype.push.apply(S,R)}return Array.prototype.concat(b.Card16(e.length),b.OffSize(x),S,l)},E.INDEX=function(e){return b.INDEX(e).length},b.DICT=function(e){let r=[];const o=Object.keys(e),l=o.length;for(let S=0;S<l;S+=1){const x=parseInt(o[S],0),k=e[x];r=r.concat(b.OPERAND(k.value,k.type)),r=r.concat(b.OPERATOR(x))}return r},E.DICT=function(e){return b.DICT(e).length},b.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},b.OPERAND=function(e,r){let o=[];if(Array.isArray(r))for(let l=0;l<r.length;l+=1)g.argument(e.length===r.length,"Not enough arguments given for type"+r),o=o.concat(b.OPERAND(e[l],r[l]));else if(r==="SID")o=o.concat(b.NUMBER(e));else if(r==="offset")o=o.concat(b.NUMBER32(e));else if(r==="number")o=o.concat(b.NUMBER(e));else{if(r!=="real")throw new Error("Unknown operand type "+r);o=o.concat(b.REAL(e))}return o},b.OP=b.BYTE,E.OP=E.BYTE;const I=typeof WeakMap=="function"&&new WeakMap;function P(e,r,o){for(let l=0;l<r.length;l+=1){const S=r[l];this[S.name]=S.value}if(this.tableName=e,this.fields=r,o){const l=Object.keys(o);for(let S=0;S<l.length;S+=1){const x=l[S],k=o[x];this[x]!==void 0&&(this[x]=k)}}}function Z(e,r,o){o===void 0&&(o=r.length);const l=new Array(r.length+1);l[0]={name:e+"Count",type:"USHORT",value:o};for(let S=0;S<r.length;S++)l[S+1]={name:e+S,type:"USHORT",value:r[S]};return l}function G(e,r,o){const l=r.length,S=new Array(l+1);S[0]={name:e+"Count",type:"USHORT",value:l};for(let x=0;x<l;x++)S[x+1]={name:e+x,type:"TABLE",value:o(r[x],x)};return S}function X(e,r,o){const l=r.length;let S=[];S[0]={name:e+"Count",type:"USHORT",value:l};for(let x=0;x<l;x++)S=S.concat(o(r[x],x));return S}function V(e){e.format===1?P.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(Z("glyph",e.glyphs))):g.assert(!1,"Can't create coverage table format 2 yet.")}function ie(e){P.call(this,"scriptListTable",X("scriptRecord",e,function(r,o){const l=r.script;let S=l.defaultLangSys;return g.assert(!!S,"Unable to write GSUB: script "+r.tag+" has no default language system."),[{name:"scriptTag"+o,type:"TAG",value:r.tag},{name:"script"+o,type:"TABLE",value:new P("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new P("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:S.reqFeatureIndex}].concat(Z("featureIndex",S.featureIndexes)))}].concat(X("langSys",l.langSysRecords,function(x,k){const D=x.langSys;return[{name:"langSysTag"+k,type:"TAG",value:x.tag},{name:"langSys"+k,type:"TABLE",value:new P("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:D.reqFeatureIndex}].concat(Z("featureIndex",D.featureIndexes)))}]})))}]}))}function z(e){P.call(this,"featureListTable",X("featureRecord",e,function(r,o){const l=r.feature;return[{name:"featureTag"+o,type:"TAG",value:r.tag},{name:"feature"+o,type:"TABLE",value:new P("featureTable",[{name:"featureParams",type:"USHORT",value:l.featureParams}].concat(Z("lookupListIndex",l.lookupListIndexes)))}]}))}function $(e,r){P.call(this,"lookupListTable",G("lookup",e,function(o){let l=r[o.lookupType];return g.assert(!!l,"Unable to write GSUB lookup type "+o.lookupType+" tables."),new P("lookupTable",[{name:"lookupType",type:"USHORT",value:o.lookupType},{name:"lookupFlag",type:"USHORT",value:o.lookupFlag}].concat(G("subtable",o.subtables,l)))}))}b.CHARSTRING=function(e){if(I){const l=I.get(e);if(l!==void 0)return l}let r=[];const o=e.length;for(let l=0;l<o;l+=1){const S=e[l];r=r.concat(b[S.type](S.value))}return I&&I.set(e,r),r},E.CHARSTRING=function(e){return b.CHARSTRING(e).length},b.OBJECT=function(e){const r=b[e.type];return g.argument(r!==void 0,"No encoding function for type "+e.type),r(e.value)},E.OBJECT=function(e){const r=E[e.type];return g.argument(r!==void 0,"No sizeOf function for type "+e.type),r(e.value)},b.TABLE=function(e){let r=[];const o=e.fields.length,l=[],S=[];for(let x=0;x<o;x+=1){const k=e.fields[x],D=b[k.type];g.argument(D!==void 0,"No encoding function for field type "+k.type+" ("+k.name+")");let R=e[k.name];R===void 0&&(R=k.value);const F=D(R);k.type==="TABLE"?(S.push(r.length),r=r.concat([0,0]),l.push(F)):r=r.concat(F)}for(let x=0;x<l.length;x+=1){const k=S[x],D=r.length;g.argument(D<65536,"Table "+e.tableName+" too big."),r[k]=D>>8,r[k+1]=255&D,r=r.concat(l[x])}return r},E.TABLE=function(e){let r=0;const o=e.fields.length;for(let l=0;l<o;l+=1){const S=e.fields[l],x=E[S.type];g.argument(x!==void 0,"No sizeOf function for field type "+S.type+" ("+S.name+")");let k=e[S.name];k===void 0&&(k=S.value),r+=x(k),S.type==="TABLE"&&(r+=2)}return r},b.RECORD=b.TABLE,E.RECORD=E.TABLE,b.LITERAL=function(e){return e},E.LITERAL=function(e){return e.length},P.prototype.encode=function(){return b.TABLE(this)},P.prototype.sizeOf=function(){return E.TABLE(this)},V.prototype=Object.create(P.prototype),V.prototype.constructor=V,ie.prototype=Object.create(P.prototype),ie.prototype.constructor=ie,z.prototype=Object.create(P.prototype),z.prototype.constructor=z,$.prototype=Object.create(P.prototype),$.prototype.constructor=$;const W={Table:P,Record:P,Coverage:V,ScriptList:ie,FeatureList:z,LookupList:$,ushortList:Z,tableList:G,recordList:X};function te(e,r){return e.getUint8(r)}function se(e,r){return e.getUint16(r,!1)}function be(e,r){return e.getUint32(r,!1)}function ce(e,r){return e.getInt16(r,!1)+e.getUint16(r+2,!1)/65535}const ke={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function ee(e,r){this.data=e,this.offset=r,this.relativeOffset=0}ee.prototype.parseByte=function(){const e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},ee.prototype.parseChar=function(){const e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},ee.prototype.parseCard8=ee.prototype.parseByte,ee.prototype.parseUShort=function(){const e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},ee.prototype.parseCard16=ee.prototype.parseUShort,ee.prototype.parseSID=ee.prototype.parseUShort,ee.prototype.parseOffset16=ee.prototype.parseUShort,ee.prototype.parseShort=function(){const e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},ee.prototype.parseF2Dot14=function(){const e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},ee.prototype.parseULong=function(){const e=be(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},ee.prototype.parseOffset32=ee.prototype.parseULong,ee.prototype.parseFixed=function(){const e=ce(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},ee.prototype.parseString=function(e){const r=this.data,o=this.offset+this.relativeOffset;let l="";this.relativeOffset+=e;for(let S=0;S<e;S++)l+=String.fromCharCode(r.getUint8(o+S));return l},ee.prototype.parseTag=function(){return this.parseString(4)},ee.prototype.parseLongDateTime=function(){let e=be(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},ee.prototype.parseVersion=function(e){const r=se(this.data,this.offset+this.relativeOffset),o=se(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,e===void 0&&(e=4096),r+o/e/10},ee.prototype.skip=function(e,r){r===void 0&&(r=1),this.relativeOffset+=ke[e]*r},ee.prototype.parseULongList=function(e){e===void 0&&(e=this.parseULong());const r=new Array(e),o=this.data;let l=this.offset+this.relativeOffset;for(let S=0;S<e;S++)r[S]=o.getUint32(l),l+=4;return this.relativeOffset+=4*e,r},ee.prototype.parseOffset16List=ee.prototype.parseUShortList=function(e){e===void 0&&(e=this.parseUShort());const r=new Array(e),o=this.data;let l=this.offset+this.relativeOffset;for(let S=0;S<e;S++)r[S]=o.getUint16(l),l+=2;return this.relativeOffset+=2*e,r},ee.prototype.parseShortList=function(e){const r=new Array(e),o=this.data;let l=this.offset+this.relativeOffset;for(let S=0;S<e;S++)r[S]=o.getInt16(l),l+=2;return this.relativeOffset+=2*e,r},ee.prototype.parseByteList=function(e){const r=new Array(e),o=this.data;let l=this.offset+this.relativeOffset;for(let S=0;S<e;S++)r[S]=o.getUint8(l++);return this.relativeOffset+=e,r},ee.prototype.parseList=function(e,r){r||(r=e,e=this.parseUShort());const o=new Array(e);for(let l=0;l<e;l++)o[l]=r.call(this);return o},ee.prototype.parseList32=function(e,r){r||(r=e,e=this.parseULong());const o=new Array(e);for(let l=0;l<e;l++)o[l]=r.call(this);return o},ee.prototype.parseRecordList=function(e,r){r||(r=e,e=this.parseUShort());const o=new Array(e),l=Object.keys(r);for(let S=0;S<e;S++){const x={};for(let k=0;k<l.length;k++){const D=l[k],R=r[D];x[D]=R.call(this)}o[S]=x}return o},ee.prototype.parseRecordList32=function(e,r){r||(r=e,e=this.parseULong());const o=new Array(e),l=Object.keys(r);for(let S=0;S<e;S++){const x={};for(let k=0;k<l.length;k++){const D=l[k],R=r[D];x[D]=R.call(this)}o[S]=x}return o},ee.prototype.parseStruct=function(e){if(typeof e=="function")return e.call(this);{const r=Object.keys(e),o={};for(let l=0;l<r.length;l++){const S=r[l],x=e[S];o[S]=x.call(this)}return o}},ee.prototype.parseValueRecord=function(e){if(e===void 0&&(e=this.parseUShort()),e===0)return;const r={};return 1&e&&(r.xPlacement=this.parseShort()),2&e&&(r.yPlacement=this.parseShort()),4&e&&(r.xAdvance=this.parseShort()),8&e&&(r.yAdvance=this.parseShort()),16&e&&(r.xPlaDevice=void 0,this.parseShort()),32&e&&(r.yPlaDevice=void 0,this.parseShort()),64&e&&(r.xAdvDevice=void 0,this.parseShort()),128&e&&(r.yAdvDevice=void 0,this.parseShort()),r},ee.prototype.parseValueRecordList=function(){const e=this.parseUShort(),r=this.parseUShort(),o=new Array(r);for(let l=0;l<r;l++)o[l]=this.parseValueRecord(e);return o},ee.prototype.parsePointer=function(e){const r=this.parseOffset16();if(r>0)return new ee(this.data,this.offset+r).parseStruct(e)},ee.prototype.parsePointer32=function(e){const r=this.parseOffset32();if(r>0)return new ee(this.data,this.offset+r).parseStruct(e)},ee.prototype.parseListOfLists=function(e){const r=this.parseOffset16List(),o=r.length,l=this.relativeOffset,S=new Array(o);for(let x=0;x<o;x++){const k=r[x];if(k!==0)if(this.relativeOffset=k,e){const D=this.parseOffset16List(),R=new Array(D.length);for(let F=0;F<D.length;F++)this.relativeOffset=k+D[F],R[F]=e.call(this);S[x]=R}else S[x]=this.parseUShortList();else S[x]=void 0}return this.relativeOffset=l,S},ee.prototype.parseCoverage=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort(),o=this.parseUShort();if(r===1)return{format:1,glyphs:this.parseUShortList(o)};if(r===2){const l=new Array(o);for(let S=0;S<o;S++)l[S]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:l}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},ee.prototype.parseClassDef=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(r===2)return{format:2,ranges:this.parseRecordList({start:ee.uShort,end:ee.uShort,classId:ee.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},ee.list=function(e,r){return function(){return this.parseList(e,r)}},ee.list32=function(e,r){return function(){return this.parseList32(e,r)}},ee.recordList=function(e,r){return function(){return this.parseRecordList(e,r)}},ee.recordList32=function(e,r){return function(){return this.parseRecordList32(e,r)}},ee.pointer=function(e){return function(){return this.parsePointer(e)}},ee.pointer32=function(e){return function(){return this.parsePointer32(e)}},ee.tag=ee.prototype.parseTag,ee.byte=ee.prototype.parseByte,ee.uShort=ee.offset16=ee.prototype.parseUShort,ee.uShortList=ee.prototype.parseUShortList,ee.uLong=ee.offset32=ee.prototype.parseULong,ee.uLongList=ee.prototype.parseULongList,ee.struct=ee.prototype.parseStruct,ee.coverage=ee.prototype.parseCoverage,ee.classDef=ee.prototype.parseClassDef;const Ee={reserved:ee.uShort,reqFeatureIndex:ee.uShort,featureIndexes:ee.uShortList};ee.prototype.parseScriptList=function(){return this.parsePointer(ee.recordList({tag:ee.tag,script:ee.pointer({defaultLangSys:ee.pointer(Ee),langSysRecords:ee.recordList({tag:ee.tag,langSys:ee.pointer(Ee)})})}))||[]},ee.prototype.parseFeatureList=function(){return this.parsePointer(ee.recordList({tag:ee.tag,feature:ee.pointer({featureParams:ee.offset16,lookupListIndexes:ee.uShortList})}))||[]},ee.prototype.parseLookupList=function(e){return this.parsePointer(ee.list(ee.pointer(function(){const r=this.parseUShort();g.argument(1<=r&&r<=9,"GPOS/GSUB lookup type "+r+" unknown.");const o=this.parseUShort(),l=16&o;return{lookupType:r,lookupFlag:o,subtables:this.parseList(ee.pointer(e[r])),markFilteringSet:l?this.parseUShort():void 0}})))||[]},ee.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){const e=this.parseUShort(),r=this.parseUShort();return g.argument(e===1&&r<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:ee.offset32,featureTableSubstitutionOffset:ee.offset32})})||[]};const fe={getByte:te,getCard8:te,getUShort:se,getCard16:se,getShort:function(e,r){return e.getInt16(r,!1)},getULong:be,getFixed:ce,getTag:function(e,r){let o="";for(let l=r;l<r+4;l+=1)o+=String.fromCharCode(e.getInt8(l));return o},getOffset:function(e,r,o){let l=0;for(let S=0;S<o;S+=1)l<<=8,l+=e.getUint8(r+S);return l},getBytes:function(e,r,o){const l=[];for(let S=r;S<o;S+=1)l.push(e.getUint8(S));return l},bytesToString:function(e){let r="";for(let o=0;o<e.length;o+=1)r+=String.fromCharCode(e[o]);return r},Parser:ee};function st(e,r,o){e.segments.push({end:r,start:r,delta:-(r-o),offset:0,glyphIndex:o})}const Re=function(e,r){const o={};o.version=fe.getUShort(e,r),g.argument(o.version===0,"cmap table version should be 0."),o.numTables=fe.getUShort(e,r+2);let l=-1;for(let x=o.numTables-1;x>=0;x-=1){const k=fe.getUShort(e,r+4+8*x),D=fe.getUShort(e,r+4+8*x+2);if(k===3&&(D===0||D===1||D===10)){l=fe.getULong(e,r+4+8*x+4);break}}if(l===-1)throw new Error("No valid cmap sub-tables found.");const S=new fe.Parser(e,r+l);if(o.format=S.parseUShort(),o.format===12)(function(x,k){let D;k.parseUShort(),x.length=k.parseULong(),x.language=k.parseULong(),x.groupCount=D=k.parseULong(),x.glyphIndexMap={};for(let R=0;R<D;R+=1){const F=k.parseULong(),K=k.parseULong();let Y=k.parseULong();for(let J=F;J<=K;J+=1)x.glyphIndexMap[J]=Y,Y++}})(o,S);else{if(o.format!==4)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+o.format+").");(function(x,k,D,R,F){let K;x.length=k.parseUShort(),x.language=k.parseUShort(),x.segCount=K=k.parseUShort()>>1,k.skip("uShort",3),x.glyphIndexMap={};const Y=new fe.Parser(D,R+F+14),J=new fe.Parser(D,R+F+16+2*K),de=new fe.Parser(D,R+F+16+4*K),ae=new fe.Parser(D,R+F+16+6*K);let ye=R+F+16+8*K;for(let oe=0;oe<K-1;oe+=1){let le;const me=Y.parseUShort(),Se=J.parseUShort(),Le=de.parseShort(),_e=ae.parseUShort();for(let he=Se;he<=me;he+=1)_e!==0?(ye=ae.offset+ae.relativeOffset-2,ye+=_e,ye+=2*(he-Se),le=fe.getUShort(D,ye),le!==0&&(le=le+Le&65535)):le=he+Le&65535,x.glyphIndexMap[he]=le}})(o,S,e,r,l)}return o},re=function(e){let r,o=!0;for(r=e.length-1;r>0;r-=1)if(e.get(r).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),o=!1;break}let l=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:o?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:o?12:20}];o||(l=l.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),l=l.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);const S=new W.Table("cmap",l);for(S.segments=[],r=0;r<e.length;r+=1){const de=e.get(r);for(let ae=0;ae<de.unicodes.length;ae+=1)st(S,de.unicodes[ae],r);S.segments=S.segments.sort(function(ae,ye){return ae.start-ye.start})}(function(de){de.segments.push({end:65535,start:65535,delta:1,offset:0})})(S);const x=S.segments.length;let k=0,D=[],R=[],F=[],K=[],Y=[],J=[];for(r=0;r<x;r+=1){const de=S.segments[r];de.end<=65535&&de.start<=65535?(D=D.concat({name:"end_"+r,type:"USHORT",value:de.end}),R=R.concat({name:"start_"+r,type:"USHORT",value:de.start}),F=F.concat({name:"idDelta_"+r,type:"SHORT",value:de.delta}),K=K.concat({name:"idRangeOffset_"+r,type:"USHORT",value:de.offset}),de.glyphId!==void 0&&(Y=Y.concat({name:"glyph_"+r,type:"USHORT",value:de.glyphId}))):k+=1,o||de.glyphIndex===void 0||(J=J.concat({name:"cmap12Start_"+r,type:"ULONG",value:de.start}),J=J.concat({name:"cmap12End_"+r,type:"ULONG",value:de.end}),J=J.concat({name:"cmap12Glyph_"+r,type:"ULONG",value:de.glyphIndex}))}if(S.segCountX2=2*(x-k),S.searchRange=2*Math.pow(2,Math.floor(Math.log(x-k)/Math.log(2))),S.entrySelector=Math.log(S.searchRange/2)/Math.log(2),S.rangeShift=S.segCountX2-S.searchRange,S.fields=S.fields.concat(D),S.fields.push({name:"reservedPad",type:"USHORT",value:0}),S.fields=S.fields.concat(R),S.fields=S.fields.concat(F),S.fields=S.fields.concat(K),S.fields=S.fields.concat(Y),S.cmap4Length=14+2*D.length+2+2*R.length+2*F.length+2*K.length+2*Y.length,!o){const de=16+4*J.length;S.cmap12Offset=20+S.cmap4Length,S.fields=S.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:de},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:J.length/3}]),S.fields=S.fields.concat(J)}return S},xe=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],Ce=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],Ae=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Pe=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function Ne(e){this.font=e}function nt(e){this.cmap=e}function Qe(e,r){this.encoding=e,this.charset=r}function ze(e){switch(e.version){case 1:this.names=Pe.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(let r=0;r<e.numberOfGlyphs;r++)e.glyphNameIndex[r]<Pe.length?this.names[r]=Pe[e.glyphNameIndex[r]]:this.names[r]=e.names[e.glyphNameIndex[r]-Pe.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(let r=0;r<e.numberOfGlyphs;r++)this.names[r]=Pe[r+e.glyphNameIndex[r]];break;default:this.names=[]}}Ne.prototype.charToGlyphIndex=function(e){const r=e.charCodeAt(0),o=this.font.glyphs;if(o)for(let l=0;l<o.length;l+=1){const S=o.get(l);for(let x=0;x<S.unicodes.length;x+=1)if(S.unicodes[x]===r)return l}return null},nt.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.charCodeAt(0)]||0},Qe.prototype.charToGlyphIndex=function(e){const r=e.charCodeAt(0),o=this.encoding[r];return this.charset.indexOf(o)},ze.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},ze.prototype.glyphIndexToName=function(e){return this.names[e]};const Me=function(e,r,o,l,S){e.beginPath(),e.moveTo(r,o),e.lineTo(l,S),e.stroke()};function Ve(e,r,o,l,S){let x;return(r&l)>0?(x=e.parseByte(),!(r&S)&&(x=-x),x=o+x):x=(r&S)>0?o:o+e.parseShort(),x}function St(e,r,o){const l=new fe.Parser(r,o);let S,x;if(e.numberOfContours=l.parseShort(),e._xMin=l.parseShort(),e._yMin=l.parseShort(),e._xMax=l.parseShort(),e._yMax=l.parseShort(),e.numberOfContours>0){const k=e.endPointIndices=[];for(let R=0;R<e.numberOfContours;R+=1)k.push(l.parseUShort());e.instructionLength=l.parseUShort(),e.instructions=[];for(let R=0;R<e.instructionLength;R+=1)e.instructions.push(l.parseByte());const D=k[k.length-1]+1;S=[];for(let R=0;R<D;R+=1)if(x=l.parseByte(),S.push(x),(8&x)>0){const F=l.parseByte();for(let K=0;K<F;K+=1)S.push(x),R+=1}if(g.argument(S.length===D,"Bad flags."),k.length>0){const R=[];let F;if(D>0){for(let J=0;J<D;J+=1)x=S[J],F={},F.onCurve=!!(1&x),F.lastPointOfContour=k.indexOf(J)>=0,R.push(F);let K=0;for(let J=0;J<D;J+=1)x=S[J],F=R[J],F.x=Ve(l,x,K,2,16),K=F.x;let Y=0;for(let J=0;J<D;J+=1)x=S[J],F=R[J],F.y=Ve(l,x,Y,4,32),Y=F.y}e.points=R}else e.points=[]}else if(e.numberOfContours===0)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];let k=!0;for(;k;){S=l.parseUShort();const D={glyphIndex:l.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&S)>0?(2&S)>0?(D.dx=l.parseShort(),D.dy=l.parseShort()):D.matchedPoints=[l.parseUShort(),l.parseUShort()]:(2&S)>0?(D.dx=l.parseChar(),D.dy=l.parseChar()):D.matchedPoints=[l.parseByte(),l.parseByte()],(8&S)>0?D.xScale=D.yScale=l.parseF2Dot14():(64&S)>0?(D.xScale=l.parseF2Dot14(),D.yScale=l.parseF2Dot14()):(128&S)>0&&(D.xScale=l.parseF2Dot14(),D.scale01=l.parseF2Dot14(),D.scale10=l.parseF2Dot14(),D.yScale=l.parseF2Dot14()),e.components.push(D),k=!!(32&S)}if(256&S){e.instructionLength=l.parseUShort(),e.instructions=[];for(let D=0;D<e.instructionLength;D+=1)e.instructions.push(l.parseByte())}}}function ot(e,r){const o=[];for(let l=0;l<e.length;l+=1){const S=e[l],x={x:r.xScale*S.x+r.scale01*S.y+r.dx,y:r.scale10*S.x+r.yScale*S.y+r.dy,onCurve:S.onCurve,lastPointOfContour:S.lastPointOfContour};o.push(x)}return o}function ft(e){const r=new i;if(!e)return r;const o=function(l){const S=[];let x=[];for(let k=0;k<l.length;k+=1){const D=l[k];x.push(D),D.lastPointOfContour&&(S.push(x),x=[])}return g.argument(x.length===0,"There are still points left in the current contour."),S}(e);for(let l=0;l<o.length;++l){const S=o[l];let x=null,k=S[S.length-1],D=S[0];if(k.onCurve)r.moveTo(k.x,k.y);else if(D.onCurve)r.moveTo(D.x,D.y);else{const R={x:.5*(k.x+D.x),y:.5*(k.y+D.y)};r.moveTo(R.x,R.y)}for(let R=0;R<S.length;++R)if(x=k,k=D,D=S[(R+1)%S.length],k.onCurve)r.lineTo(k.x,k.y);else{let F=x,K=D;x.onCurve||(F={x:.5*(k.x+x.x),y:.5*(k.y+x.y)},r.lineTo(F.x,F.y)),D.onCurve||(K={x:.5*(k.x+D.x),y:.5*(k.y+D.y)}),r.lineTo(F.x,F.y),r.quadraticCurveTo(k.x,k.y,K.x,K.y)}r.closePath()}return r}function Rt(e,r){if(r.isComposite)for(let o=0;o<r.components.length;o+=1){const l=r.components[o],S=e.get(l.glyphIndex);if(S.getPath(),S.points){let x;if(l.matchedPoints===void 0)x=ot(S.points,l);else{if(l.matchedPoints[0]>r.points.length-1||l.matchedPoints[1]>S.points.length-1)throw Error("Matched points out of range in "+r.name);const k=r.points[l.matchedPoints[0]];let D=S.points[l.matchedPoints[1]];const R={xScale:l.xScale,scale01:l.scale01,scale10:l.scale10,yScale:l.yScale,dx:0,dy:0};D=ot([D],R)[0],R.dx=k.x-D.x,R.dy=k.y-D.y,x=ot(S.points,R)}r.points=r.points.concat(x)}}return ft(r.points)}const Pr={getPath:ft,parse:function(e,r,o,l){const S=new _t.GlyphSet(l);for(let x=0;x<o.length-1;x+=1){const k=o[x];k!==o[x+1]?S.push(x,_t.ttfGlyphLoader(l,x,St,e,r+k,Rt)):S.push(x,_t.glyphLoader(l,x))}return S}};function et(e){this.bindConstructorValues(e)}et.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||e.unicode!==void 0?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",function(r,o){let l=o||new i;return{configurable:!0,get:function(){return typeof l=="function"&&(l=l()),l},set:function(S){l=S}}}(0,e.path))},et.prototype.addUnicode=function(e){this.unicodes.length===0&&(this.unicode=e),this.unicodes.push(e)},et.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},et.prototype.getPath=function(e,r,o,l,S){let x,k;e=e!==void 0?e:0,r=r!==void 0?r:0,o=o!==void 0?o:72,l||(l={});let D=l.xScale,R=l.yScale;if(l.hinting&&S&&S.hinting&&(k=this.path&&S.hinting.exec(this,o)),k)x=Pr.getPath(k).commands,e=Math.round(e),r=Math.round(r),D=R=1;else{x=this.path.commands;const K=1/this.path.unitsPerEm*o;D===void 0&&(D=K),R===void 0&&(R=K)}const F=new i;for(let K=0;K<x.length;K+=1){const Y=x[K];Y.type==="M"?F.moveTo(e+Y.x*D,r+-Y.y*R):Y.type==="L"?F.lineTo(e+Y.x*D,r+-Y.y*R):Y.type==="Q"?F.quadraticCurveTo(e+Y.x1*D,r+-Y.y1*R,e+Y.x*D,r+-Y.y*R):Y.type==="C"?F.curveTo(e+Y.x1*D,r+-Y.y1*R,e+Y.x2*D,r+-Y.y2*R,e+Y.x*D,r+-Y.y*R):Y.type==="Z"&&F.closePath()}return F},et.prototype.getContours=function(){if(this.points===void 0)return[];const e=[];let r=[];for(let o=0;o<this.points.length;o+=1){const l=this.points[o];r.push(l),l.lastPointOfContour&&(e.push(r),r=[])}return g.argument(r.length===0,"There are still points left in the current contour."),e},et.prototype.getMetrics=function(){const e=this.path.commands,r=[],o=[];for(let S=0;S<e.length;S+=1){const x=e[S];x.type!=="Z"&&(r.push(x.x),o.push(x.y)),x.type!=="Q"&&x.type!=="C"||(r.push(x.x1),o.push(x.y1)),x.type==="C"&&(r.push(x.x2),o.push(x.y2))}const l={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,o),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,o),leftSideBearing:this.leftSideBearing};return isFinite(l.xMin)||(l.xMin=0),isFinite(l.xMax)||(l.xMax=this.advanceWidth),isFinite(l.yMin)||(l.yMin=0),isFinite(l.yMax)||(l.yMax=0),l.rightSideBearing=this.advanceWidth-l.leftSideBearing-(l.xMax-l.xMin),l},et.prototype.draw=function(e,r,o,l,S){this.getPath(r,o,l,S).draw(e)},et.prototype.drawPoints=function(e,r,o,l){function S(F,K,Y,J){const de=2*Math.PI;e.beginPath();for(let ae=0;ae<F.length;ae+=1)e.moveTo(K+F[ae].x*J,Y+F[ae].y*J),e.arc(K+F[ae].x*J,Y+F[ae].y*J,2,0,de,!1);e.closePath(),e.fill()}r=r!==void 0?r:0,o=o!==void 0?o:0,l=l!==void 0?l:24;const x=1/this.path.unitsPerEm*l,k=[],D=[],R=this.path;for(let F=0;F<R.commands.length;F+=1){const K=R.commands[F];K.x!==void 0&&k.push({x:K.x,y:-K.y}),K.x1!==void 0&&D.push({x:K.x1,y:-K.y1}),K.x2!==void 0&&D.push({x:K.x2,y:-K.y2})}e.fillStyle="blue",S(k,r,o,x),e.fillStyle="red",S(D,r,o,x)},et.prototype.drawMetrics=function(e,r,o,l){let S;r=r!==void 0?r:0,o=o!==void 0?o:0,l=l!==void 0?l:24,S=1/this.path.unitsPerEm*l,e.lineWidth=1,e.strokeStyle="black",Me(e,r,-1e4,r,1e4),Me(e,-1e4,o,1e4,o);const x=this.xMin||0;let k=this.yMin||0;const D=this.xMax||0;let R=this.yMax||0;const F=this.advanceWidth||0;e.strokeStyle="blue",Me(e,r+x*S,-1e4,r+x*S,1e4),Me(e,r+D*S,-1e4,r+D*S,1e4),Me(e,-1e4,o+-k*S,1e4,o+-k*S),Me(e,-1e4,o+-R*S,1e4,o+-R*S),e.strokeStyle="green",Me(e,r+F*S,-1e4,r+F*S,1e4)};const At=et;function Tt(e,r,o){Object.defineProperty(e,r,{get:function(){return e.path,e[o]},set:function(l){e[o]=l},enumerable:!0,configurable:!0})}function Ft(e,r){if(this.font=e,this.glyphs={},Array.isArray(r))for(let o=0;o<r.length;o++)this.glyphs[o]=r[o];this.length=r&&r.length||0}Ft.prototype.get=function(e){return typeof this.glyphs[e]=="function"&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},Ft.prototype.push=function(e,r){this.glyphs[e]=r,this.length++};const _t={GlyphSet:Ft,glyphLoader:function(e,r){return new At({index:r,font:e})},ttfGlyphLoader:function(e,r,o,l,S,x){return function(){const k=new At({index:r,font:e});return k.path=function(){o(k,l,S);const D=x(e.glyphs,k);return D.unitsPerEm=e.unitsPerEm,D},Tt(k,"xMin","_xMin"),Tt(k,"xMax","_xMax"),Tt(k,"yMin","_yMin"),Tt(k,"yMax","_yMax"),k}},cffGlyphLoader:function(e,r,o,l){return function(){const S=new At({index:r,font:e});return S.path=function(){const x=o(e,S,l);return x.unitsPerEm=e.unitsPerEm,x},S}}};function Ur(e,r){if(e===r)return!0;if(Array.isArray(e)&&Array.isArray(r)){if(e.length!==r.length)return!1;for(let o=0;o<e.length;o+=1)if(!Ur(e[o],r[o]))return!1;return!0}return!1}function Ht(e){let r;return r=e.length<1240?107:e.length<33900?1131:32768,r}function at(e,r,o){const l=[],S=[],x=fe.getCard16(e,r);let k,D;if(x!==0){const R=fe.getByte(e,r+2);k=r+(x+1)*R+2;let F=r+3;for(let K=0;K<x+1;K+=1)l.push(fe.getOffset(e,F,R)),F+=R;D=k+l[x]}else D=r+2;for(let R=0;R<l.length-1;R+=1){let F=fe.getBytes(e,k+l[R],k+l[R+1]);o&&(F=o(F)),S.push(F)}return{objects:S,startOffset:r,endOffset:D}}function ks(e,r){let o,l,S,x;if(r===28)return o=e.parseByte(),l=e.parseByte(),o<<8|l;if(r===29)return o=e.parseByte(),l=e.parseByte(),S=e.parseByte(),x=e.parseByte(),o<<24|l<<16|S<<8|x;if(r===30)return function(k){let D="";const R=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];for(;;){const F=k.parseByte(),K=F>>4,Y=15&F;if(K===15||(D+=R[K],Y===15))break;D+=R[Y]}return parseFloat(D)}(e);if(r>=32&&r<=246)return r-139;if(r>=247&&r<=250)return o=e.parseByte(),256*(r-247)+o+108;if(r>=251&&r<=254)return o=e.parseByte(),256*-(r-251)-o-108;throw new Error("Invalid b0 "+r)}function Fr(e,r,o){r=r!==void 0?r:0;const l=new fe.Parser(e,r),S=[];let x=[];for(o=o!==void 0?o:e.length;l.relativeOffset<o;){let k=l.parseByte();k<=21?(k===12&&(k=1200+l.parseByte()),S.push([k,x]),x=[]):x.push(ks(l,k))}return function(k){const D={};for(let R=0;R<k.length;R+=1){const F=k[R][0],K=k[R][1];let Y;if(Y=K.length===1?K[0]:K,D.hasOwnProperty(F)&&!isNaN(D[F]))throw new Error("Object "+D+" already has key "+F);D[F]=Y}return D}(S)}function Ct(e,r){return r<=390?xe[r]:e[r-391]}function Hr(e,r,o){const l={};let S;for(let x=0;x<r.length;x+=1){const k=r[x];if(Array.isArray(k.type)){const D=[];D.length=k.type.length;for(let R=0;R<k.type.length;R++)S=e[k.op]!==void 0?e[k.op][R]:void 0,S===void 0&&(S=k.value!==void 0&&k.value[R]!==void 0?k.value[R]:null),k.type[R]==="SID"&&(S=Ct(o,S)),D[R]=S;l[k.name]=D}else S=e[k.op],S===void 0&&(S=k.value!==void 0?k.value:null),k.type==="SID"&&(S=Ct(o,S)),l[k.name]=S}return l}const Nr=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Wr=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function Rs(e,r){return Hr(Fr(e,0,e.byteLength),Nr,r)}function Gr(e,r,o,l){return Hr(Fr(e,r,o),Wr,l)}function zr(e,r,o,l){const S=[];for(let x=0;x<o.length;x+=1){const k=Rs(new DataView(new Uint8Array(o[x]).buffer),l);k._subrs=[],k._subrsBias=0;const D=k.private[0],R=k.private[1];if(D!==0&&R!==0){const F=Gr(e,R+r,D,l);if(k._defaultWidthX=F.defaultWidthX,k._nominalWidthX=F.nominalWidthX,F.subrs!==0){const K=at(e,R+F.subrs+r);k._subrs=K.objects,k._subrsBias=Ht(k._subrs)}k._privateDict=F}S.push(k)}return S}function As(e,r,o){let l,S,x,k;const D=new i,R=[];let F,K,Y,J,de=0,ae=!1,ye=!1,oe=0,le=0;if(e.isCIDFont){const _e=e.tables.cff.topDict._fdSelect[r.index],he=e.tables.cff.topDict._fdArray[_e];F=he._subrs,K=he._subrsBias,Y=he._defaultWidthX,J=he._nominalWidthX}else F=e.tables.cff.topDict._subrs,K=e.tables.cff.topDict._subrsBias,Y=e.tables.cff.topDict._defaultWidthX,J=e.tables.cff.topDict._nominalWidthX;let me=Y;function Se(_e,he){ye&&D.closePath(),D.moveTo(_e,he),ye=!0}function Le(){let _e;_e=R.length%2!=0,_e&&!ae&&(me=R.shift()+J),de+=R.length>>1,R.length=0,ae=!0}return function _e(he){let ge,Te,we,Ie,We,qe,Fe,$e,Ue,Ge,He,Ke,Be=0;for(;Be<he.length;){let je=he[Be];switch(Be+=1,je){case 1:case 3:case 18:case 23:Le();break;case 4:R.length>1&&!ae&&(me=R.shift()+J,ae=!0),le+=R.pop(),Se(oe,le);break;case 5:for(;R.length>0;)oe+=R.shift(),le+=R.shift(),D.lineTo(oe,le);break;case 6:for(;R.length>0&&(oe+=R.shift(),D.lineTo(oe,le),R.length!==0);)le+=R.shift(),D.lineTo(oe,le);break;case 7:for(;R.length>0&&(le+=R.shift(),D.lineTo(oe,le),R.length!==0);)oe+=R.shift(),D.lineTo(oe,le);break;case 8:for(;R.length>0;)l=oe+R.shift(),S=le+R.shift(),x=l+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+R.shift(),D.curveTo(l,S,x,k,oe,le);break;case 10:We=R.pop()+K,qe=F[We],qe&&_e(qe);break;case 11:return;case 12:switch(je=he[Be],Be+=1,je){case 35:l=oe+R.shift(),S=le+R.shift(),x=l+R.shift(),k=S+R.shift(),Fe=x+R.shift(),$e=k+R.shift(),Ue=Fe+R.shift(),Ge=$e+R.shift(),He=Ue+R.shift(),Ke=Ge+R.shift(),oe=He+R.shift(),le=Ke+R.shift(),R.shift(),D.curveTo(l,S,x,k,Fe,$e),D.curveTo(Ue,Ge,He,Ke,oe,le);break;case 34:l=oe+R.shift(),S=le,x=l+R.shift(),k=S+R.shift(),Fe=x+R.shift(),$e=k,Ue=Fe+R.shift(),Ge=k,He=Ue+R.shift(),Ke=le,oe=He+R.shift(),D.curveTo(l,S,x,k,Fe,$e),D.curveTo(Ue,Ge,He,Ke,oe,le);break;case 36:l=oe+R.shift(),S=le+R.shift(),x=l+R.shift(),k=S+R.shift(),Fe=x+R.shift(),$e=k,Ue=Fe+R.shift(),Ge=k,He=Ue+R.shift(),Ke=Ge+R.shift(),oe=He+R.shift(),D.curveTo(l,S,x,k,Fe,$e),D.curveTo(Ue,Ge,He,Ke,oe,le);break;case 37:l=oe+R.shift(),S=le+R.shift(),x=l+R.shift(),k=S+R.shift(),Fe=x+R.shift(),$e=k+R.shift(),Ue=Fe+R.shift(),Ge=$e+R.shift(),He=Ue+R.shift(),Ke=Ge+R.shift(),Math.abs(He-oe)>Math.abs(Ke-le)?oe=He+R.shift():le=Ke+R.shift(),D.curveTo(l,S,x,k,Fe,$e),D.curveTo(Ue,Ge,He,Ke,oe,le);break;default:console.log("Glyph "+r.index+": unknown operator 1200"+je),R.length=0}break;case 14:R.length>0&&!ae&&(me=R.shift()+J,ae=!0),ye&&(D.closePath(),ye=!1);break;case 19:case 20:Le(),Be+=de+7>>3;break;case 21:R.length>2&&!ae&&(me=R.shift()+J,ae=!0),le+=R.pop(),oe+=R.pop(),Se(oe,le);break;case 22:R.length>1&&!ae&&(me=R.shift()+J,ae=!0),oe+=R.pop(),Se(oe,le);break;case 24:for(;R.length>2;)l=oe+R.shift(),S=le+R.shift(),x=l+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+R.shift(),D.curveTo(l,S,x,k,oe,le);oe+=R.shift(),le+=R.shift(),D.lineTo(oe,le);break;case 25:for(;R.length>6;)oe+=R.shift(),le+=R.shift(),D.lineTo(oe,le);l=oe+R.shift(),S=le+R.shift(),x=l+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+R.shift(),D.curveTo(l,S,x,k,oe,le);break;case 26:for(R.length%2&&(oe+=R.shift());R.length>0;)l=oe,S=le+R.shift(),x=l+R.shift(),k=S+R.shift(),oe=x,le=k+R.shift(),D.curveTo(l,S,x,k,oe,le);break;case 27:for(R.length%2&&(le+=R.shift());R.length>0;)l=oe+R.shift(),S=le,x=l+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k,D.curveTo(l,S,x,k,oe,le);break;case 28:ge=he[Be],Te=he[Be+1],R.push((ge<<24|Te<<16)>>16),Be+=2;break;case 29:We=R.pop()+e.gsubrsBias,qe=e.gsubrs[We],qe&&_e(qe);break;case 30:for(;R.length>0&&(l=oe,S=le+R.shift(),x=l+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+(R.length===1?R.shift():0),D.curveTo(l,S,x,k,oe,le),R.length!==0);)l=oe+R.shift(),S=le,x=l+R.shift(),k=S+R.shift(),le=k+R.shift(),oe=x+(R.length===1?R.shift():0),D.curveTo(l,S,x,k,oe,le);break;case 31:for(;R.length>0&&(l=oe+R.shift(),S=le,x=l+R.shift(),k=S+R.shift(),le=k+R.shift(),oe=x+(R.length===1?R.shift():0),D.curveTo(l,S,x,k,oe,le),R.length!==0);)l=oe,S=le+R.shift(),x=l+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+(R.length===1?R.shift():0),D.curveTo(l,S,x,k,oe,le);break;default:je<32?console.log("Glyph "+r.index+": unknown operator "+je):je<247?R.push(je-139):je<251?(ge=he[Be],Be+=1,R.push(256*(je-247)+ge+108)):je<255?(ge=he[Be],Be+=1,R.push(256*-(je-251)-ge-108)):(ge=he[Be],Te=he[Be+1],we=he[Be+2],Ie=he[Be+3],Be+=4,R.push((ge<<24|Te<<16|we<<8|Ie)/65536))}}}(o),r.advanceWidth=me,D}function $r(e,r){let o,l=xe.indexOf(e);return l>=0&&(o=l),l=r.indexOf(e),l>=0?o=l+xe.length:(o=xe.length+r.length,r.push(e)),o}function jr(e,r,o){const l={};for(let S=0;S<e.length;S+=1){const x=e[S];let k=r[x.name];k===void 0||Ur(k,x.value)||(x.type==="SID"&&(k=$r(k,o)),l[x.op]={name:x.name,type:x.type,value:k})}return l}function qr(e,r){const o=new W.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return o.dict=jr(Nr,e,r),o}function Vr(e){const r=new W.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return r.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],r}function Ts(e){const r=[],o=e.path;r.push({name:"width",type:"NUMBER",value:e.advanceWidth});let l=0,S=0;for(let x=0;x<o.commands.length;x+=1){let k,D,R=o.commands[x];if(R.type==="Q"){const F=.3333333333333333,K=2/3;R={type:"C",x:R.x,y:R.y,x1:F*l+K*R.x1,y1:F*S+K*R.y1,x2:F*R.x+K*R.x1,y2:F*R.y+K*R.y1}}if(R.type==="M")k=Math.round(R.x-l),D=Math.round(R.y-S),r.push({name:"dx",type:"NUMBER",value:k}),r.push({name:"dy",type:"NUMBER",value:D}),r.push({name:"rmoveto",type:"OP",value:21}),l=Math.round(R.x),S=Math.round(R.y);else if(R.type==="L")k=Math.round(R.x-l),D=Math.round(R.y-S),r.push({name:"dx",type:"NUMBER",value:k}),r.push({name:"dy",type:"NUMBER",value:D}),r.push({name:"rlineto",type:"OP",value:5}),l=Math.round(R.x),S=Math.round(R.y);else if(R.type==="C"){const F=Math.round(R.x1-l),K=Math.round(R.y1-S),Y=Math.round(R.x2-R.x1),J=Math.round(R.y2-R.y1);k=Math.round(R.x-R.x2),D=Math.round(R.y-R.y2),r.push({name:"dx1",type:"NUMBER",value:F}),r.push({name:"dy1",type:"NUMBER",value:K}),r.push({name:"dx2",type:"NUMBER",value:Y}),r.push({name:"dy2",type:"NUMBER",value:J}),r.push({name:"dx",type:"NUMBER",value:k}),r.push({name:"dy",type:"NUMBER",value:D}),r.push({name:"rrcurveto",type:"OP",value:8}),l=Math.round(R.x),S=Math.round(R.y)}}return r.push({name:"endchar",type:"OP",value:14}),r}const Ds=function(e,r,o){o.tables.cff={};const l=function(ae,ye){const oe={};return oe.formatMajor=fe.getCard8(ae,ye),oe.formatMinor=fe.getCard8(ae,ye+1),oe.size=fe.getCard8(ae,ye+2),oe.offsetSize=fe.getCard8(ae,ye+3),oe.startOffset=ye,oe.endOffset=ye+4,oe}(e,r),S=at(e,l.endOffset,fe.bytesToString),x=at(e,S.endOffset),k=at(e,x.endOffset,fe.bytesToString),D=at(e,k.endOffset);o.gsubrs=D.objects,o.gsubrsBias=Ht(o.gsubrs);const R=zr(e,r,x.objects,k.objects);if(R.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+R.length);const F=R[0];if(o.tables.cff.topDict=F,F._privateDict&&(o.defaultWidthX=F._privateDict.defaultWidthX,o.nominalWidthX=F._privateDict.nominalWidthX),F.ros[0]!==void 0&&F.ros[1]!==void 0&&(o.isCIDFont=!0),o.isCIDFont){let ae=F.fdArray,ye=F.fdSelect;if(ae===0||ye===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");ae+=r;const oe=zr(e,r,at(e,ae).objects,k.objects);F._fdArray=oe,ye+=r,F._fdSelect=function(le,me,Se,Le){const _e=[];let he;const ge=new fe.Parser(le,me),Te=ge.parseCard8();if(Te===0)for(let we=0;we<Se;we++){if(he=ge.parseCard8(),he>=Le)throw new Error("CFF table CID Font FDSelect has bad FD index value "+he+" (FD count "+Le+")");_e.push(he)}else{if(Te!==3)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+Te);{const we=ge.parseCard16();let Ie,We=ge.parseCard16();if(We!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+We);for(let qe=0;qe<we;qe++){if(he=ge.parseCard8(),Ie=ge.parseCard16(),he>=Le)throw new Error("CFF table CID Font FDSelect has bad FD index value "+he+" (FD count "+Le+")");if(Ie>Se)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+Ie);for(;We<Ie;We++)_e.push(he);We=Ie}if(Ie!==Se)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+Ie)}}return _e}(e,ye,o.numGlyphs,oe.length)}const K=r+F.private[1],Y=Gr(e,K,F.private[0],k.objects);if(o.defaultWidthX=Y.defaultWidthX,o.nominalWidthX=Y.nominalWidthX,Y.subrs!==0){const ae=at(e,K+Y.subrs);o.subrs=ae.objects,o.subrsBias=Ht(o.subrs)}else o.subrs=[],o.subrsBias=0;const J=at(e,r+F.charStrings);o.nGlyphs=J.objects.length;const de=function(ae,ye,oe,le){let me,Se;const Le=new fe.Parser(ae,ye);oe-=1;const _e=[".notdef"],he=Le.parseCard8();if(he===0)for(let ge=0;ge<oe;ge+=1)me=Le.parseSID(),_e.push(Ct(le,me));else if(he===1)for(;_e.length<=oe;){me=Le.parseSID(),Se=Le.parseCard8();for(let ge=0;ge<=Se;ge+=1)_e.push(Ct(le,me)),me+=1}else{if(he!==2)throw new Error("Unknown charset format "+he);for(;_e.length<=oe;){me=Le.parseSID(),Se=Le.parseCard16();for(let ge=0;ge<=Se;ge+=1)_e.push(Ct(le,me)),me+=1}}return _e}(e,r+F.charset,o.nGlyphs,k.objects);F.encoding===0?o.cffEncoding=new Qe(Ce,de):F.encoding===1?o.cffEncoding=new Qe(Ae,de):o.cffEncoding=function(ae,ye,oe){let le;const me={},Se=new fe.Parser(ae,ye),Le=Se.parseCard8();if(Le===0){const _e=Se.parseCard8();for(let he=0;he<_e;he+=1)le=Se.parseCard8(),me[le]=he}else{if(Le!==1)throw new Error("Unknown encoding format "+Le);{const _e=Se.parseCard8();le=1;for(let he=0;he<_e;he+=1){const ge=Se.parseCard8(),Te=Se.parseCard8();for(let we=ge;we<=ge+Te;we+=1)me[we]=le,le+=1}}}return new Qe(me,oe)}(e,r+F.encoding,de),o.encoding=o.encoding||o.cffEncoding,o.glyphs=new _t.GlyphSet(o);for(let ae=0;ae<o.nGlyphs;ae+=1){const ye=J.objects[ae];o.glyphs.push(ae,_t.cffGlyphLoader(o,ae,As,ye))}},Ms=function(e,r){const o=new W.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),l=1/r.unitsPerEm,S={version:r.version,fullName:r.fullName,familyName:r.familyName,weight:r.weightName,fontBBox:r.fontBBox||[0,0,0,0],fontMatrix:[l,0,0,l,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},x=[];let k;for(let K=1;K<e.length;K+=1)k=e.get(K),x.push(k.name);const D=[];o.header=new W.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),o.nameIndex=function(K){const Y=new W.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);Y.names=[];for(let J=0;J<K.length;J+=1)Y.names.push({name:"name_"+J,type:"NAME",value:K[J]});return Y}([r.postScriptName]);let R=qr(S,D);o.topDictIndex=Vr(R),o.globalSubrIndex=new W.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),o.charsets=function(K,Y){const J=new W.Record("Charsets",[{name:"format",type:"Card8",value:0}]);for(let de=0;de<K.length;de+=1){const ae=$r(K[de],Y);J.fields.push({name:"glyph_"+de,type:"SID",value:ae})}return J}(x,D),o.charStringsIndex=function(K){const Y=new W.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]);for(let J=0;J<K.length;J+=1){const de=K.get(J),ae=Ts(de);Y.charStrings.push({name:de.name,type:"CHARSTRING",value:ae})}return Y}(e),o.privateDict=function(K,Y){const J=new W.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return J.dict=jr(Wr,{},Y),J}(0,D),o.stringIndex=function(K){const Y=new W.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);Y.strings=[];for(let J=0;J<K.length;J+=1)Y.strings.push({name:"string_"+J,type:"STRING",value:K[J]});return Y}(D);const F=o.header.sizeOf()+o.nameIndex.sizeOf()+o.topDictIndex.sizeOf()+o.stringIndex.sizeOf()+o.globalSubrIndex.sizeOf();return S.charset=F,S.encoding=0,S.charStrings=S.charset+o.charsets.sizeOf(),S.private[1]=S.charStrings+o.charStringsIndex.sizeOf(),R=qr(S,D),o.topDictIndex=Vr(R),o},Bs=function(e,r){const o={},l=new fe.Parser(e,r);return o.version=l.parseVersion(),o.fontRevision=Math.round(1e3*l.parseFixed())/1e3,o.checkSumAdjustment=l.parseULong(),o.magicNumber=l.parseULong(),g.argument(o.magicNumber===1594834165,"Font header has wrong magic number."),o.flags=l.parseUShort(),o.unitsPerEm=l.parseUShort(),o.created=l.parseLongDateTime(),o.modified=l.parseLongDateTime(),o.xMin=l.parseShort(),o.yMin=l.parseShort(),o.xMax=l.parseShort(),o.yMax=l.parseShort(),o.macStyle=l.parseUShort(),o.lowestRecPPEM=l.parseUShort(),o.fontDirectionHint=l.parseShort(),o.indexToLocFormat=l.parseShort(),o.glyphDataFormat=l.parseShort(),o},Os=function(e){const r=Math.round(new Date().getTime()/1e3)+2082844800;let o=r;return e.createdTimestamp&&(o=e.createdTimestamp+2082844800),new W.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:o},{name:"modified",type:"LONGDATETIME",value:r},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)},Is=function(e,r){const o={},l=new fe.Parser(e,r);return o.version=l.parseVersion(),o.ascender=l.parseShort(),o.descender=l.parseShort(),o.lineGap=l.parseShort(),o.advanceWidthMax=l.parseUShort(),o.minLeftSideBearing=l.parseShort(),o.minRightSideBearing=l.parseShort(),o.xMaxExtent=l.parseShort(),o.caretSlopeRise=l.parseShort(),o.caretSlopeRun=l.parseShort(),o.caretOffset=l.parseShort(),l.relativeOffset+=8,o.metricDataFormat=l.parseShort(),o.numberOfHMetrics=l.parseUShort(),o},Ps=function(e){return new W.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)},Us=function(e,r,o,l,S){let x,k;const D=new fe.Parser(e,r);for(let R=0;R<l;R+=1){R<o&&(x=D.parseUShort(),k=D.parseShort());const F=S.get(R);F.advanceWidth=x,F.leftSideBearing=k}},Fs=function(e){const r=new W.Table("hmtx",[]);for(let o=0;o<e.length;o+=1){const l=e.get(o),S=l.advanceWidth||0,x=l.leftSideBearing||0;r.fields.push({name:"advanceWidth_"+o,type:"USHORT",value:S}),r.fields.push({name:"leftSideBearing_"+o,type:"SHORT",value:x})}return r},Hs=function(e){const r=new W.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]);let o="";const l=12+4*e.length;for(let S=0;S<e.length;++S){let x=o.indexOf(e[S]);x<0&&(x=o.length,o+=e[S]),r.fields.push({name:"offset "+S,type:"USHORT",value:l+x}),r.fields.push({name:"length "+S,type:"USHORT",value:e[S].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:o}),r},Ns=function(e,r){const o=new fe.Parser(e,r),l=o.parseULong();g.argument(l===1,"Unsupported ltag table version."),o.skip("uLong",1);const S=o.parseULong(),x=[];for(let k=0;k<S;k++){let D="";const R=r+o.parseUShort(),F=o.parseUShort();for(let K=R;K<R+F;++K)D+=String.fromCharCode(e.getInt8(K));x.push(D)}return x},Ws=function(e,r){const o={},l=new fe.Parser(e,r);return o.version=l.parseVersion(),o.numGlyphs=l.parseUShort(),o.version===1&&(o.maxPoints=l.parseUShort(),o.maxContours=l.parseUShort(),o.maxCompositePoints=l.parseUShort(),o.maxCompositeContours=l.parseUShort(),o.maxZones=l.parseUShort(),o.maxTwilightPoints=l.parseUShort(),o.maxStorage=l.parseUShort(),o.maxFunctionDefs=l.parseUShort(),o.maxInstructionDefs=l.parseUShort(),o.maxStackElements=l.parseUShort(),o.maxSizeOfInstructions=l.parseUShort(),o.maxComponentElements=l.parseUShort(),o.maxComponentDepth=l.parseUShort()),o},Gs=function(e){return new W.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])},Kr=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Xr={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},zs={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Yr={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function $s(e,r,o){switch(e){case 0:if(r===65535)return"und";if(o)return o[r];break;case 1:return Xr[r];case 3:return Yr[r]}}const Nt="utf-16",js={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},qs={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Zr(e,r,o){switch(e){case 0:return Nt;case 1:return qs[o]||js[r];case 3:if(r===1||r===10)return Nt}}function Wt(e){const r={};for(let o in e)r[e[o]]=parseInt(o);return r}function Jr(e,r,o,l,S,x){return new W.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:r},{name:"languageID",type:"USHORT",value:o},{name:"nameID",type:"USHORT",value:l},{name:"length",type:"USHORT",value:S},{name:"offset",type:"USHORT",value:x}])}function Qr(e,r){let o=function(l,S){const x=l.length,k=S.length-x+1;e:for(let D=0;D<k;D++)for(;D<k;D++){for(let R=0;R<x;R++)if(S[D+R]!==l[R])continue e;return D}return-1}(e,r);if(o<0){o=r.length;let l=0;const S=e.length;for(;l<S;++l)r.push(e[l])}return o}const Vs=function(e,r,o){const l={},S=new fe.Parser(e,r),x=S.parseUShort(),k=S.parseUShort(),D=S.offset+S.parseUShort();for(let R=0;R<k;R++){const F=S.parseUShort(),K=S.parseUShort(),Y=S.parseUShort(),J=S.parseUShort(),de=Kr[J]||J,ae=S.parseUShort(),ye=S.parseUShort(),oe=$s(F,Y,o),le=Zr(F,K,Y);if(le!==void 0&&oe!==void 0){let me;if(me=le===Nt?v.UTF16(e,D+ye,ae):v.MACSTRING(e,D+ye,ae,le),me){let Se=l[de];Se===void 0&&(Se=l[de]={}),Se[oe]=me}}}return x===1&&S.parseUShort(),l},Ks=function(e,r){let o;const l=[],S={},x=Wt(Kr);for(let Y in e){let J=x[Y];if(J===void 0&&(J=Y),o=parseInt(J),isNaN(o))throw new Error('Name table entry "'+Y+'" does not exist, see nameTableNames for complete list.');S[o]=e[Y],l.push(o)}const k=Wt(Xr),D=Wt(Yr),R=[],F=[];for(let Y=0;Y<l.length;Y++){o=l[Y];const J=S[o];for(let de in J){const ae=J[de];let ye=1,oe=k[de],le=zs[oe];const me=Zr(ye,le,oe);let Se=b.MACSTRING(ae,me);Se===void 0&&(ye=0,oe=r.indexOf(de),oe<0&&(oe=r.length,r.push(de)),le=4,Se=b.UTF16(ae));const Le=Qr(Se,F);R.push(Jr(ye,le,oe,o,Se.length,Le));const _e=D[de];if(_e!==void 0){const he=b.UTF16(ae),ge=Qr(he,F);R.push(Jr(3,1,_e,o,he.length,ge))}}}R.sort(function(Y,J){return Y.platformID-J.platformID||Y.encodingID-J.encodingID||Y.languageID-J.languageID||Y.nameID-J.nameID});const K=new W.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:R.length},{name:"stringOffset",type:"USHORT",value:6+12*R.length}]);for(let Y=0;Y<R.length;Y++)K.fields.push({name:"record_"+Y,type:"RECORD",value:R[Y]});return K.fields.push({name:"strings",type:"LITERAL",value:F}),K},ei=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],Xs=function(e,r){const o={},l=new fe.Parser(e,r);o.version=l.parseUShort(),o.xAvgCharWidth=l.parseShort(),o.usWeightClass=l.parseUShort(),o.usWidthClass=l.parseUShort(),o.fsType=l.parseUShort(),o.ySubscriptXSize=l.parseShort(),o.ySubscriptYSize=l.parseShort(),o.ySubscriptXOffset=l.parseShort(),o.ySubscriptYOffset=l.parseShort(),o.ySuperscriptXSize=l.parseShort(),o.ySuperscriptYSize=l.parseShort(),o.ySuperscriptXOffset=l.parseShort(),o.ySuperscriptYOffset=l.parseShort(),o.yStrikeoutSize=l.parseShort(),o.yStrikeoutPosition=l.parseShort(),o.sFamilyClass=l.parseShort(),o.panose=[];for(let S=0;S<10;S++)o.panose[S]=l.parseByte();return o.ulUnicodeRange1=l.parseULong(),o.ulUnicodeRange2=l.parseULong(),o.ulUnicodeRange3=l.parseULong(),o.ulUnicodeRange4=l.parseULong(),o.achVendID=String.fromCharCode(l.parseByte(),l.parseByte(),l.parseByte(),l.parseByte()),o.fsSelection=l.parseUShort(),o.usFirstCharIndex=l.parseUShort(),o.usLastCharIndex=l.parseUShort(),o.sTypoAscender=l.parseShort(),o.sTypoDescender=l.parseShort(),o.sTypoLineGap=l.parseShort(),o.usWinAscent=l.parseUShort(),o.usWinDescent=l.parseUShort(),o.version>=1&&(o.ulCodePageRange1=l.parseULong(),o.ulCodePageRange2=l.parseULong()),o.version>=2&&(o.sxHeight=l.parseShort(),o.sCapHeight=l.parseShort(),o.usDefaultChar=l.parseUShort(),o.usBreakChar=l.parseUShort(),o.usMaxContent=l.parseUShort()),o},Ys=function(e){return new W.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)},Zs=function(e){for(let r=0;r<ei.length;r+=1){const o=ei[r];if(e>=o.begin&&e<o.end)return r}return-1},Js=function(e,r){const o={},l=new fe.Parser(e,r);switch(o.version=l.parseVersion(),o.italicAngle=l.parseFixed(),o.underlinePosition=l.parseShort(),o.underlineThickness=l.parseShort(),o.isFixedPitch=l.parseULong(),o.minMemType42=l.parseULong(),o.maxMemType42=l.parseULong(),o.minMemType1=l.parseULong(),o.maxMemType1=l.parseULong(),o.version){case 1:o.names=Pe.slice();break;case 2:o.numberOfGlyphs=l.parseUShort(),o.glyphNameIndex=new Array(o.numberOfGlyphs);for(let S=0;S<o.numberOfGlyphs;S++)o.glyphNameIndex[S]=l.parseUShort();o.names=[];for(let S=0;S<o.numberOfGlyphs;S++)if(o.glyphNameIndex[S]>=Pe.length){const x=l.parseChar();o.names.push(l.parseString(x))}break;case 2.5:o.numberOfGlyphs=l.parseUShort(),o.offset=new Array(o.numberOfGlyphs);for(let S=0;S<o.numberOfGlyphs;S++)o.offset[S]=l.parseChar()}return o},Qs=function(){return new W.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])},Ye=new Array(9);Ye[1]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();return r===1?{substFormat:1,coverage:this.parsePointer(ee.coverage),deltaGlyphId:this.parseUShort()}:r===2?{substFormat:2,coverage:this.parsePointer(ee.coverage),substitute:this.parseOffset16List()}:void g.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},Ye[2]=function(){const e=this.parseUShort();return g.argument(e===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(ee.coverage),sequences:this.parseListOfLists()}},Ye[3]=function(){const e=this.parseUShort();return g.argument(e===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(ee.coverage),alternateSets:this.parseListOfLists()}},Ye[4]=function(){const e=this.parseUShort();return g.argument(e===1,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(ee.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};const gt={sequenceIndex:ee.uShort,lookupListIndex:ee.uShort};Ye[5]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:r,coverage:this.parsePointer(ee.coverage),ruleSets:this.parseListOfLists(function(){const o=this.parseUShort(),l=this.parseUShort();return{input:this.parseUShortList(o-1),lookupRecords:this.parseRecordList(l,gt)}})};if(r===2)return{substFormat:r,coverage:this.parsePointer(ee.coverage),classDef:this.parsePointer(ee.classDef),classSets:this.parseListOfLists(function(){const o=this.parseUShort(),l=this.parseUShort();return{classes:this.parseUShortList(o-1),lookupRecords:this.parseRecordList(l,gt)}})};if(r===3){const o=this.parseUShort(),l=this.parseUShort();return{substFormat:r,coverages:this.parseList(o,ee.pointer(ee.coverage)),lookupRecords:this.parseRecordList(l,gt)}}g.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},Ye[6]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();return r===1?{substFormat:1,coverage:this.parsePointer(ee.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(gt)}})}:r===2?{substFormat:2,coverage:this.parsePointer(ee.coverage),backtrackClassDef:this.parsePointer(ee.classDef),inputClassDef:this.parsePointer(ee.classDef),lookaheadClassDef:this.parsePointer(ee.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(gt)}})}:r===3?{substFormat:3,backtrackCoverage:this.parseList(ee.pointer(ee.coverage)),inputCoverage:this.parseList(ee.pointer(ee.coverage)),lookaheadCoverage:this.parseList(ee.pointer(ee.coverage)),lookupRecords:this.parseRecordList(gt)}:void g.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},Ye[7]=function(){const e=this.parseUShort();g.argument(e===1,"GSUB Extension Substitution subtable identifier-format must be 1");const r=this.parseUShort(),o=new ee(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:r,extension:Ye[r].call(o)}},Ye[8]=function(){const e=this.parseUShort();return g.argument(e===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(ee.coverage),backtrackCoverage:this.parseList(ee.pointer(ee.coverage)),lookaheadCoverage:this.parseList(ee.pointer(ee.coverage)),substitutes:this.parseUShortList()}};const Dt=new Array(9);Dt[1]=function(e){return e.substFormat===1?new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.ushortList("substitute",e.substitute)))},Dt[3]=function(e){return g.assert(e.substFormat===1,"Lookup type 3 substFormat must be 1."),new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.tableList("altSet",e.alternateSets,function(r){return new W.Table("alternateSetTable",W.ushortList("alternate",r))})))},Dt[4]=function(e){return g.assert(e.substFormat===1,"Lookup type 4 substFormat must be 1."),new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.tableList("ligSet",e.ligatureSets,function(r){return new W.Table("ligatureSetTable",W.tableList("ligature",r,function(o){return new W.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:o.ligGlyph}].concat(W.ushortList("component",o.components,o.components.length+1)))}))})))};const en=function(e,r){const o=new ee(e,r=r||0),l=o.parseVersion(1);return g.argument(l===1||l===1.1,"Unsupported GSUB table version."),l===1?{version:l,scripts:o.parseScriptList(),features:o.parseFeatureList(),lookups:o.parseLookupList(Ye)}:{version:l,scripts:o.parseScriptList(),features:o.parseFeatureList(),lookups:o.parseLookupList(Ye),variations:o.parseFeatureVariationsList()}},tn=function(e){return new W.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new W.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new W.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new W.LookupList(e.lookups,Dt)}])},rn=function(e,r){const o=new fe.Parser(e,r),l=o.parseULong();g.argument(l===1,"Unsupported META table version."),o.parseULong(),o.parseULong();const S=o.parseULong(),x={};for(let k=0;k<S;k++){const D=o.parseTag(),R=o.parseULong(),F=o.parseULong(),K=v.UTF8(e,r+R,F);x[D]=K}return x},sn=function(e){const r=Object.keys(e).length;let o="";const l=16+12*r,S=new W.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:l},{name:"numTags",type:"ULONG",value:r}]);for(let x in e){const k=o.length;o+=e[x],S.fields.push({name:"tag "+x,type:"TAG",value:x}),S.fields.push({name:"offset "+x,type:"ULONG",value:l+k}),S.fields.push({name:"length "+x,type:"ULONG",value:e[x].length})}return S.fields.push({name:"stringPool",type:"CHARARRAY",value:o}),S};function ti(e){return Math.log(e)/Math.log(2)|0}function ri(e){for(;e.length%4!=0;)e.push(0);let r=0;for(let o=0;o<e.length;o+=4)r+=(e[o]<<24)+(e[o+1]<<16)+(e[o+2]<<8)+e[o+3];return r%=Math.pow(2,32),r}function ii(e,r,o,l){return new W.Record("Table Record",[{name:"tag",type:"TAG",value:e!==void 0?e:""},{name:"checkSum",type:"ULONG",value:r!==void 0?r:0},{name:"offset",type:"ULONG",value:o!==void 0?o:0},{name:"length",type:"ULONG",value:l!==void 0?l:0}])}function nn(e){const r=new W.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);r.tables=e,r.numTables=e.length;const o=Math.pow(2,ti(r.numTables));r.searchRange=16*o,r.entrySelector=ti(o),r.rangeShift=16*r.numTables-r.searchRange;const l=[],S=[];let x=r.sizeOf()+ii().sizeOf()*r.numTables;for(;x%4!=0;)x+=1,S.push({name:"padding",type:"BYTE",value:0});for(let k=0;k<e.length;k+=1){const D=e[k];g.argument(D.tableName.length===4,"Table name"+D.tableName+" is invalid.");const R=D.sizeOf(),F=ii(D.tableName,ri(D.encode()),x,R);for(l.push({name:F.tag+" Table Record",type:"RECORD",value:F}),S.push({name:D.tableName+" table",type:"RECORD",value:D}),x+=R,g.argument(!isNaN(x),"Something went wrong calculating the offset.");x%4!=0;)x+=1,S.push({name:"padding",type:"BYTE",value:0})}return l.sort(function(k,D){return k.value.tag>D.value.tag?1:-1}),r.fields=r.fields.concat(l),r.fields=r.fields.concat(S),r}function si(e,r,o){for(let l=0;l<r.length;l+=1){const S=e.charToGlyphIndex(r[l]);if(S>0)return e.glyphs.get(S).getMetrics()}return o}function on(e){let r=0;for(let o=0;o<e.length;o+=1)r+=e[o];return r/e.length}const an=function(e){const r=[],o=[],l=[],S=[],x=[],k=[],D=[];let R,F=0,K=0,Y=0,J=0,de=0;for(let Xe=0;Xe<e.glyphs.length;Xe+=1){const mt=e.glyphs.get(Xe),yt=0|mt.unicode;if(isNaN(mt.advanceWidth))throw new Error("Glyph "+mt.name+" ("+Xe+"): advanceWidth is not a number.");(R>yt||R===void 0)&&yt>0&&(R=yt),F<yt&&(F=yt);const ut=Zs(yt);if(ut<32)K|=1<<ut;else if(ut<64)Y|=1<<ut-32;else if(ut<96)J|=1<<ut-64;else{if(!(ut<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");de|=1<<ut-96}if(mt.name===".notdef")continue;const bt=mt.getMetrics();r.push(bt.xMin),o.push(bt.yMin),l.push(bt.xMax),S.push(bt.yMax),k.push(bt.leftSideBearing),D.push(bt.rightSideBearing),x.push(mt.advanceWidth)}const ae={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,o),xMax:Math.max.apply(null,l),yMax:Math.max.apply(null,S),advanceWidthMax:Math.max.apply(null,x),advanceWidthAvg:on(x),minLeftSideBearing:Math.min.apply(null,k),maxLeftSideBearing:Math.max.apply(null,k),minRightSideBearing:Math.min.apply(null,D)};ae.ascender=e.ascender,ae.descender=e.descender;const ye=Os({flags:3,unitsPerEm:e.unitsPerEm,xMin:ae.xMin,yMin:ae.yMin,xMax:ae.xMax,yMax:ae.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),oe=Ps({ascender:ae.ascender,descender:ae.descender,advanceWidthMax:ae.advanceWidthMax,minLeftSideBearing:ae.minLeftSideBearing,minRightSideBearing:ae.minRightSideBearing,xMaxExtent:ae.maxLeftSideBearing+(ae.xMax-ae.xMin),numberOfHMetrics:e.glyphs.length}),le=Gs(e.glyphs.length),me=Ys({xAvgCharWidth:Math.round(ae.advanceWidthAvg),usWeightClass:e.tables.os2.usWeightClass,usWidthClass:e.tables.os2.usWidthClass,usFirstCharIndex:R,usLastCharIndex:F,ulUnicodeRange1:K,ulUnicodeRange2:Y,ulUnicodeRange3:J,ulUnicodeRange4:de,fsSelection:e.tables.os2.fsSelection,sTypoAscender:ae.ascender,sTypoDescender:ae.descender,sTypoLineGap:0,usWinAscent:ae.yMax,usWinDescent:Math.abs(ae.yMin),ulCodePageRange1:1,sxHeight:si(e,"xyvw",{yMax:Math.round(ae.ascender/2)}).yMax,sCapHeight:si(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",ae).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0}),Se=Fs(e.glyphs),Le=re(e.glyphs),_e=e.getEnglishName("fontFamily"),he=e.getEnglishName("fontSubfamily"),ge=_e+" "+he;let Te=e.getEnglishName("postScriptName");Te||(Te=_e.replace(/\s/g,"")+"-"+he);const we={};for(let Xe in e.names)we[Xe]=e.names[Xe];we.uniqueID||(we.uniqueID={en:e.getEnglishName("manufacturer")+":"+ge}),we.postScriptName||(we.postScriptName={en:Te}),we.preferredFamily||(we.preferredFamily=e.names.fontFamily),we.preferredSubfamily||(we.preferredSubfamily=e.names.fontSubfamily);const Ie=[],We=Ks(we,Ie),qe=Ie.length>0?Hs(Ie):void 0,Fe=Qs(),$e=Ms(e.glyphs,{version:e.getEnglishName("version"),fullName:ge,familyName:_e,weightName:he,postScriptName:Te,unitsPerEm:e.unitsPerEm,fontBBox:[0,ae.yMin,ae.ascender,ae.advanceWidthMax]}),Ue=e.metas&&Object.keys(e.metas).length>0?sn(e.metas):void 0,Ge=[ye,oe,le,me,We,Le,Fe,$e,Se];qe&&Ge.push(qe),e.tables.gsub&&Ge.push(tn(e.tables.gsub)),Ue&&Ge.push(Ue);const He=nn(Ge),Ke=ri(He.encode()),Be=He.fields;let je=!1;for(let Xe=0;Xe<Be.length;Xe+=1)if(Be[Xe].name==="head table"){Be[Xe].value.checkSumAdjustment=2981146554-Ke,je=!0;break}if(!je)throw new Error("Could not find head table with checkSum to adjust.");return He};function Gt(e,r){let o=0,l=e.length-1;for(;o<=l;){const S=o+l>>>1,x=e[S].tag;if(x===r)return S;x<r?o=S+1:l=S-1}return-o-1}function ni(e,r){let o=0,l=e.length-1;for(;o<=l;){const S=o+l>>>1,x=e[S];if(x===r)return S;x<r?o=S+1:l=S-1}return-o-1}function oi(e,r){let o,l=0,S=e.length-1;for(;l<=S;){const x=l+S>>>1;o=e[x];const k=o.start;if(k===r)return o;k<r?l=x+1:S=x-1}if(l>0)return o=e[l-1],r>o.end?0:o}function ai(e,r){this.font=e,this.tableName=r}ai.prototype={searchTag:Gt,binSearch:ni,getTable:function(e){let r=this.font.tables[this.tableName];return!r&&e&&(r=this.font.tables[this.tableName]=this.createDefaultTable()),r},getScriptNames:function(){let e=this.getTable();return e?e.scripts.map(function(r){return r.tag}):[]},getDefaultScriptName:function(){let e=this.getTable();if(!e)return;let r=!1;for(let o=0;o<e.scripts.length;o++){const l=e.scripts[o].tag;if(l==="DFLT")return l;l==="latn"&&(r=!0)}return r?"latn":void 0},getScriptTable:function(e,r){const o=this.getTable(r);if(o){e=e||"DFLT";const l=o.scripts,S=Gt(o.scripts,e);if(S>=0)return l[S].script;if(r){const x={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return l.splice(-1-S,0,x),x.script}}},getLangSysTable:function(e,r,o){const l=this.getScriptTable(e,o);if(l){if(!r||r==="dflt"||r==="DFLT")return l.defaultLangSys;const S=Gt(l.langSysRecords,r);if(S>=0)return l.langSysRecords[S].langSys;if(o){const x={tag:r,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return l.langSysRecords.splice(-1-S,0,x),x.langSys}}},getFeatureTable:function(e,r,o,l){const S=this.getLangSysTable(e,r,l);if(S){let x;const k=S.featureIndexes,D=this.font.tables[this.tableName].features;for(let R=0;R<k.length;R++)if(x=D[k[R]],x.tag===o)return x.feature;if(l){const R=D.length;return g.assert(R===0||o>=D[R-1].tag,"Features must be added in alphabetical order."),x={tag:o,feature:{params:0,lookupListIndexes:[]}},D.push(x),k.push(R),x.feature}}},getLookupTables:function(e,r,o,l,S){const x=this.getFeatureTable(e,r,o,S),k=[];if(x){let D;const R=x.lookupListIndexes,F=this.font.tables[this.tableName].lookups;for(let K=0;K<R.length;K++)D=F[R[K]],D.lookupType===l&&k.push(D);if(k.length===0&&S){D={lookupType:l,lookupFlag:0,subtables:[],markFilteringSet:void 0};const K=F.length;return F.push(D),R.push(K),[D]}}return k},getGlyphClass:function(e,r){switch(e.format){case 1:return e.startGlyph<=r&&r<e.startGlyph+e.classes.length?e.classes[r-e.startGlyph]:0;case 2:const o=oi(e.ranges,r);return o?o.classId:0}},getCoverageIndex:function(e,r){switch(e.format){case 1:const o=ni(e.glyphs,r);return o>=0?o:-1;case 2:const l=oi(e.ranges,r);return l?l.index+r-l.start:-1}},expandCoverage:function(e){if(e.format===1)return e.glyphs;{const r=[],o=e.ranges;for(let l=0;l<o.length;l++){const S=o[l],x=S.start,k=S.end;for(let D=x;D<=k;D++)r.push(D)}return r}}};const Mt=ai;function Bt(e){Mt.call(this,e,"gpos")}Bt.prototype=Mt.prototype,Bt.prototype.getKerningValue=function(e,r,o){for(let l=0;l<e.length;l++){const S=e[l].subtables;for(let x=0;x<S.length;x++){const k=S[x],D=this.getCoverageIndex(k.coverage,r);if(!(D<0))switch(k.posFormat){case 1:let R=k.pairSets[D];for(let J=0;J<R.length;J++){let de=R[J];if(de.secondGlyph===o)return de.value1&&de.value1.xAdvance||0}break;case 2:const F=this.getGlyphClass(k.classDef1,r),K=this.getGlyphClass(k.classDef2,o),Y=k.classRecords[F][K];return Y.value1&&Y.value1.xAdvance||0}}}return 0},Bt.prototype.getKerningTables=function(e,r){if(this.font.tables.gpos)return this.getLookupTables(e,r,"kern",2)};const ln=Bt;function Ze(e){Mt.call(this,e,"gsub")}function cn(e,r){const o=e.length;if(o!==r.length)return!1;for(let l=0;l<o;l++)if(e[l]!==r[l])return!1;return!0}function li(e,r,o){const l=e.subtables;for(let S=0;S<l.length;S++){const x=l[S];if(x.substFormat===r)return x}if(o)return l.push(o),o}Ze.prototype=Mt.prototype,Ze.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Ze.prototype.getSingle=function(e,r,o){const l=[],S=this.getLookupTables(r,o,e,1);for(let x=0;x<S.length;x++){const k=S[x].subtables;for(let D=0;D<k.length;D++){const R=k[D],F=this.expandCoverage(R.coverage);let K;if(R.substFormat===1){const Y=R.deltaGlyphId;for(K=0;K<F.length;K++){const J=F[K];l.push({sub:J,by:J+Y})}}else{const Y=R.substitute;for(K=0;K<F.length;K++)l.push({sub:F[K],by:Y[K]})}}}return l},Ze.prototype.getAlternates=function(e,r,o){const l=[],S=this.getLookupTables(r,o,e,3);for(let x=0;x<S.length;x++){const k=S[x].subtables;for(let D=0;D<k.length;D++){const R=k[D],F=this.expandCoverage(R.coverage),K=R.alternateSets;for(let Y=0;Y<F.length;Y++)l.push({sub:F[Y],by:K[Y]})}}return l},Ze.prototype.getLigatures=function(e,r,o){const l=[],S=this.getLookupTables(r,o,e,4);for(let x=0;x<S.length;x++){const k=S[x].subtables;for(let D=0;D<k.length;D++){const R=k[D],F=this.expandCoverage(R.coverage),K=R.ligatureSets;for(let Y=0;Y<F.length;Y++){const J=F[Y],de=K[Y];for(let ae=0;ae<de.length;ae++){const ye=de[ae];l.push({sub:[J].concat(ye.components),by:ye.ligGlyph})}}}}return l},Ze.prototype.addSingle=function(e,r,o,l){const S=li(this.getLookupTables(o,l,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});g.assert(S.coverage.format===1,"Ligature: unable to modify coverage table format "+S.coverage.format);const x=r.sub;let k=this.binSearch(S.coverage.glyphs,x);k<0&&(k=-1-k,S.coverage.glyphs.splice(k,0,x),S.substitute.splice(k,0,0)),S.substitute[k]=r.by},Ze.prototype.addAlternate=function(e,r,o,l){const S=li(this.getLookupTables(o,l,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});g.assert(S.coverage.format===1,"Ligature: unable to modify coverage table format "+S.coverage.format);const x=r.sub;let k=this.binSearch(S.coverage.glyphs,x);k<0&&(k=-1-k,S.coverage.glyphs.splice(k,0,x),S.alternateSets.splice(k,0,0)),S.alternateSets[k]=r.by},Ze.prototype.addLigature=function(e,r,o,l){const S=this.getLookupTables(o,l,e,4,!0)[0];let x=S.subtables[0];x||(x={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},S.subtables[0]=x),g.assert(x.coverage.format===1,"Ligature: unable to modify coverage table format "+x.coverage.format);const k=r.sub[0],D=r.sub.slice(1),R={ligGlyph:r.by,components:D};let F=this.binSearch(x.coverage.glyphs,k);if(F>=0){const K=x.ligatureSets[F];for(let Y=0;Y<K.length;Y++)if(cn(K[Y].components,D))return;K.push(R)}else F=-1-F,x.coverage.glyphs.splice(F,0,k),x.ligatureSets.splice(F,0,[R])},Ze.prototype.getFeature=function(e,r,o){if(/ss\d\d/.test(e))return this.getSingle(e,r,o);switch(e){case"aalt":case"salt":return this.getSingle(e,r,o).concat(this.getAlternates(e,r,o));case"dlig":case"liga":case"rlig":return this.getLigatures(e,r,o)}},Ze.prototype.add=function(e,r,o,l){if(/ss\d\d/.test(e))return this.addSingle(e,r,o,l);switch(e){case"aalt":case"salt":return typeof r.by=="number"?this.addSingle(e,r,o,l):this.addAlternate(e,r,o,l);case"dlig":case"liga":case"rlig":return this.addLigature(e,r,o,l)}};const hn=Ze;function ci(e){const r=new ArrayBuffer(e.length),o=new Uint8Array(r);for(let l=0;l<e.length;++l)o[l]=e[l];return r}function vt(e,r){if(!e)throw r}let hi,pt,ui,zt;function di(e){this.font=e,this._fpgmState=this._prepState=void 0,this._errorState=0}function un(e){return e}function fi(e){return Math.sign(e)*Math.round(Math.abs(e))}function dn(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function fn(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function pn(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function _n(e){return Math.sign(e)*Math.floor(Math.abs(e))}const pi=function(e){const r=this.srPeriod;let o=this.srPhase,l=1;return e<0&&(e=-e,l=-1),e+=this.srThreshold-o,e=Math.trunc(e/r)*r,(e+=o)<0?o*l:e*l},tt={x:1,y:0,axis:"x",distance:function(e,r,o,l){return(o?e.xo:e.x)-(l?r.xo:r.x)},interpolate:function(e,r,o,l){let S,x,k,D,R,F,K;if(!l||l===this)return S=e.xo-r.xo,x=e.xo-o.xo,R=r.x-r.xo,F=o.x-o.xo,k=Math.abs(S),D=Math.abs(x),K=k+D,K===0?void(e.x=e.xo+(R+F)/2):void(e.x=e.xo+(R*D+F*k)/K);S=l.distance(e,r,!0,!0),x=l.distance(e,o,!0,!0),R=l.distance(r,r,!1,!0),F=l.distance(o,o,!1,!0),k=Math.abs(S),D=Math.abs(x),K=k+D,K!==0?tt.setRelative(e,e,(R*D+F*k)/K,l,!0):tt.setRelative(e,e,(R+F)/2,l,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,r,o,l,S){if(!l||l===this)return void(e.x=(S?r.xo:r.x)+o);const x=S?r.xo:r.x,k=S?r.yo:r.y,D=x+o*l.x,R=k+o*l.y;e.x=D+(e.y-R)/l.normalSlope},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},rt={x:0,y:1,axis:"y",distance:function(e,r,o,l){return(o?e.yo:e.y)-(l?r.yo:r.y)},interpolate:function(e,r,o,l){let S,x,k,D,R,F,K;if(!l||l===this)return S=e.yo-r.yo,x=e.yo-o.yo,R=r.y-r.yo,F=o.y-o.yo,k=Math.abs(S),D=Math.abs(x),K=k+D,K===0?void(e.y=e.yo+(R+F)/2):void(e.y=e.yo+(R*D+F*k)/K);S=l.distance(e,r,!0,!0),x=l.distance(e,o,!0,!0),R=l.distance(r,r,!1,!0),F=l.distance(o,o,!1,!0),k=Math.abs(S),D=Math.abs(x),K=k+D,K!==0?rt.setRelative(e,e,(R*D+F*k)/K,l,!0):rt.setRelative(e,e,(R+F)/2,l,!0)},normalSlope:0,setRelative:function(e,r,o,l,S){if(!l||l===this)return void(e.y=(S?r.yo:r.y)+o);const x=S?r.xo:r.x,k=S?r.yo:r.y,D=x+o*l.x,R=k+o*l.y;e.y=R+l.normalSlope*(e.x-D)},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function wt(e,r){this.x=e,this.y=r,this.axis=void 0,this.slope=r/e,this.normalSlope=-e/r,Object.freeze(this)}function xt(e,r){const o=Math.sqrt(e*e+r*r);return r/=o,(e/=o)==1&&r===0?tt:e===0&&r===1?rt:new wt(e,r)}function it(e,r,o,l){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*r)/64,this.lastPointOfContour=o,this.onCurve=l,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(tt),Object.freeze(rt),wt.prototype.distance=function(e,r,o,l){return this.x*tt.distance(e,r,o,l)+this.y*rt.distance(e,r,o,l)},wt.prototype.interpolate=function(e,r,o,l){let S,x,k,D,R,F,K;k=l.distance(e,r,!0,!0),D=l.distance(e,o,!0,!0),S=l.distance(r,r,!1,!0),x=l.distance(o,o,!1,!0),R=Math.abs(k),F=Math.abs(D),K=R+F,K!==0?this.setRelative(e,e,(S*F+x*R)/K,l,!0):this.setRelative(e,e,(S+x)/2,l,!0)},wt.prototype.setRelative=function(e,r,o,l,S){l=l||this;const x=S?r.xo:r.x,k=S?r.yo:r.y,D=x+o*l.x,R=k+o*l.y,F=l.normalSlope,K=this.slope,Y=e.x,J=e.y;e.x=(K*Y-F*D+R-J)/(K-F),e.y=K*(e.x-Y)+J},wt.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},it.prototype.nextTouched=function(e){let r=this.nextPointOnContour;for(;!e.touched(r)&&r!==this;)r=r.nextPointOnContour;return r},it.prototype.prevTouched=function(e){let r=this.prevPointOnContour;for(;!e.touched(r)&&r!==this;)r=r.prevPointOnContour;return r};const Et=Object.freeze(new it(0,0)),gn={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function lt(e,r){switch(this.env=e,this.stack=[],this.prog=r,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=tt,this.round=fi}}function Ot(e){const r=e.tZone=new Array(e.gZone.length);for(let o=0;o<r.length;o++)r[o]=new it(0,0)}function _i(e,r){const o=e.prog;let l,S=e.ip,x=1;do if(l=o[++S],l===88)x++;else if(l===89)x--;else if(l===64)S+=o[S+1]+1;else if(l===65)S+=2*o[S+1]+1;else if(l>=176&&l<=183)S+=l-176+1;else if(l>=184&&l<=191)S+=2*(l-184+1);else if(r&&x===1&&l===27)break;while(x>0);e.ip=S}function gi(e,r){U.DEBUG&&console.log(r.step,"SVTCA["+e.axis+"]"),r.fv=r.pv=r.dpv=e}function vi(e,r){U.DEBUG&&console.log(r.step,"SPVTCA["+e.axis+"]"),r.pv=r.dpv=e}function mi(e,r){U.DEBUG&&console.log(r.step,"SFVTCA["+e.axis+"]"),r.fv=e}function yi(e,r){const o=r.stack,l=o.pop(),S=o.pop(),x=r.z2[l],k=r.z1[S];let D,R;U.DEBUG&&console.log("SPVTL["+e+"]",l,S),e?(D=x.y-k.y,R=k.x-x.x):(D=k.x-x.x,R=k.y-x.y),r.pv=r.dpv=xt(D,R)}function bi(e,r){const o=r.stack,l=o.pop(),S=o.pop(),x=r.z2[l],k=r.z1[S];let D,R;U.DEBUG&&console.log("SFVTL["+e+"]",l,S),e?(D=x.y-k.y,R=k.x-x.x):(D=k.x-x.x,R=k.y-x.y),r.fv=xt(D,R)}function $t(e){U.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function Si(e,r){const o=r.stack.pop(),l=r.z0[o],S=r.fv,x=r.pv;U.DEBUG&&console.log(r.step,"MDAP["+e+"]",o);let k=x.distance(l,Et);e&&(k=r.round(k)),S.setRelative(l,Et,k,x),S.touch(l),r.rp0=r.rp1=o}function Ci(e,r){const o=r.z2,l=o.length-2;let S,x,k;U.DEBUG&&console.log(r.step,"IUP["+e.axis+"]");for(let D=0;D<l;D++)S=o[D],e.touched(S)||(x=S.prevTouched(e),x!==S&&(k=S.nextTouched(e),x===k&&e.setRelative(S,S,e.distance(x,x,!1,!0),e,!0),e.interpolate(S,x,k,e)))}function wi(e,r){const o=r.stack,l=e?r.rp1:r.rp2,S=(e?r.z0:r.z1)[l],x=r.fv,k=r.pv;let D=r.loop;const R=r.z2;for(;D--;){const F=o.pop(),K=R[F],Y=k.distance(S,S,!1,!0);x.setRelative(K,K,Y,k),x.touch(K),U.DEBUG&&console.log(r.step,(r.loop>1?"loop "+(r.loop-D)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",F)}r.loop=1}function xi(e,r){const o=r.stack,l=e?r.rp1:r.rp2,S=(e?r.z0:r.z1)[l],x=r.fv,k=r.pv,D=o.pop(),R=r.z2[r.contours[D]];let F=R;U.DEBUG&&console.log(r.step,"SHC["+e+"]",D);const K=k.distance(S,S,!1,!0);do F!==S&&x.setRelative(F,F,K,k),F=F.nextPointOnContour;while(F!==R)}function Ei(e,r){const o=r.stack,l=e?r.rp1:r.rp2,S=(e?r.z0:r.z1)[l],x=r.fv,k=r.pv,D=o.pop();let R,F;switch(U.DEBUG&&console.log(r.step,"SHZ["+e+"]",D),D){case 0:R=r.tZone;break;case 1:R=r.gZone;break;default:throw new Error("Invalid zone")}const K=k.distance(S,S,!1,!0),Y=R.length-2;for(let J=0;J<Y;J++)F=R[J],x.setRelative(F,F,K,k)}function Li(e,r){const o=r.stack,l=o.pop()/64,S=o.pop(),x=r.z1[S],k=r.z0[r.rp0],D=r.fv,R=r.pv;D.setRelative(x,k,l,R),D.touch(x),U.DEBUG&&console.log(r.step,"MSIRP["+e+"]",l,S),r.rp1=r.rp0,r.rp2=S,e&&(r.rp0=S)}function ki(e,r){const o=r.stack,l=o.pop(),S=o.pop(),x=r.z0[S],k=r.fv,D=r.pv;let R=r.cvt[l];U.DEBUG&&console.log(r.step,"MIAP["+e+"]",l,"(",R,")",S);let F=D.distance(x,Et);e&&(Math.abs(F-R)<r.cvCutIn&&(F=R),F=r.round(F)),k.setRelative(x,Et,F,D),r.zp0===0&&(x.xo=x.x,x.yo=x.y),k.touch(x),r.rp0=r.rp1=S}function Ri(e,r){const o=r.stack,l=o.pop(),S=r.z2[l];U.DEBUG&&console.log(r.step,"GC["+e+"]",l),o.push(64*r.dpv.distance(S,Et,e,!1))}function Ai(e,r){const o=r.stack,l=o.pop(),S=o.pop(),x=r.z1[l],k=r.z0[S],D=r.dpv.distance(k,x,e,e);U.DEBUG&&console.log(r.step,"MD["+e+"]",l,S,"->",D),r.stack.push(Math.round(64*D))}function jt(e,r){const o=r.stack,l=o.pop(),S=r.fv,x=r.pv,k=r.ppem,D=r.deltaBase+16*(e-1),R=r.deltaShift,F=r.z0;U.DEBUG&&console.log(r.step,"DELTAP["+e+"]",l,o);for(let K=0;K<l;K++){const Y=o.pop(),J=o.pop();if(D+((240&J)>>4)!==k)continue;let de=(15&J)-8;de>=0&&de++,U.DEBUG&&console.log(r.step,"DELTAPFIX",Y,"by",de*R);const ae=F[Y];S.setRelative(ae,ae,de*R,x)}}function It(e,r){const o=r.stack,l=o.pop();U.DEBUG&&console.log(r.step,"ROUND[]"),o.push(64*r.round(l/64))}function qt(e,r){const o=r.stack,l=o.pop(),S=r.ppem,x=r.deltaBase+16*(e-1),k=r.deltaShift;U.DEBUG&&console.log(r.step,"DELTAC["+e+"]",l,o);for(let D=0;D<l;D++){const R=o.pop(),F=o.pop();if(x+((240&F)>>4)!==S)continue;let K=(15&F)-8;K>=0&&K++;const Y=K*k;U.DEBUG&&console.log(r.step,"DELTACFIX",R,"by",Y),r.cvt[R]+=Y}}function Ti(e,r){const o=r.stack,l=o.pop(),S=o.pop(),x=r.z2[l],k=r.z1[S];let D,R;U.DEBUG&&console.log(r.step,"SDPVTL["+e+"]",l,S),e?(D=x.y-k.y,R=k.x-x.x):(D=k.x-x.x,R=k.y-x.y),r.dpv=xt(D,R)}function ct(e,r){const o=r.stack,l=r.prog;let S=r.ip;U.DEBUG&&console.log(r.step,"PUSHB["+e+"]");for(let x=0;x<e;x++)o.push(l[++S]);r.ip=S}function ht(e,r){let o=r.ip;const l=r.prog,S=r.stack;U.DEBUG&&console.log(r.ip,"PUSHW["+e+"]");for(let x=0;x<e;x++){let k=l[++o]<<8|l[++o];32768&k&&(k=-(1+(65535^k))),S.push(k)}r.ip=o}function ve(e,r,o,l,S,x){const k=x.stack,D=e&&k.pop(),R=k.pop(),F=x.rp0,K=x.z0[F],Y=x.z1[R],J=x.minDis,de=x.fv,ae=x.dpv;let ye,oe,le,me;oe=ye=ae.distance(Y,K,!0,!0),le=oe>=0?1:-1,oe=Math.abs(oe),e&&(me=x.cvt[D],l&&Math.abs(oe-me)<x.cvCutIn&&(oe=me)),o&&oe<J&&(oe=J),l&&(oe=x.round(oe)),de.setRelative(Y,K,le*oe,ae),de.touch(Y),U.DEBUG&&console.log(x.step,(e?"MIRP[":"MDRP[")+(r?"M":"m")+(o?">":"_")+(l?"R":"_")+(S===0?"Gr":S===1?"Bl":S===2?"Wh":"")+"]",e?D+"("+x.cvt[D]+","+me+")":"",R,"(d =",ye,"->",le*oe,")"),x.rp1=x.rp0,x.rp2=R,r&&(x.rp0=R)}di.prototype.exec=function(e,r){if(typeof r!="number")throw new Error("Point size is not a number!");if(this._errorState>2)return;const o=this.font;let l=this._prepState;if(!l||l.ppem!==r){let S=this._fpgmState;if(!S){lt.prototype=gn,S=this._fpgmState=new lt("fpgm",o.tables.fpgm),S.funcs=[],S.font=o,U.DEBUG&&(console.log("---EXEC FPGM---"),S.step=-1);try{pt(S)}catch(k){return console.log("Hinting error in FPGM:"+k),void(this._errorState=3)}}lt.prototype=S,l=this._prepState=new lt("prep",o.tables.prep),l.ppem=r;const x=o.tables.cvt;if(x){const k=l.cvt=new Array(x.length),D=r/o.unitsPerEm;for(let R=0;R<x.length;R++)k[R]=x[R]*D}else l.cvt=[];U.DEBUG&&(console.log("---EXEC PREP---"),l.step=-1);try{pt(l)}catch(k){this._errorState<2&&console.log("Hinting error in PREP:"+k),this._errorState=2}}if(!(this._errorState>1))try{return ui(e,l)}catch(S){return this._errorState<1&&(console.log("Hinting error:"+S),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}},ui=function(e,r){const o=r.ppem/r.font.unitsPerEm,l=o;let S,x,k,D=e.components;if(lt.prototype=r,D){const R=r.font;x=[],S=[];for(let F=0;F<D.length;F++){const K=D[F],Y=R.glyphs.get(K.glyphIndex);k=new lt("glyf",Y.instructions),U.DEBUG&&(console.log("---EXEC COMP "+F+"---"),k.step=-1),zt(Y,k,o,l);const J=Math.round(K.dx*o),de=Math.round(K.dy*l),ae=k.gZone,ye=k.contours;for(let le=0;le<ae.length;le++){const me=ae[le];me.xTouched=me.yTouched=!1,me.xo=me.x=me.x+J,me.yo=me.y=me.y+de}const oe=x.length;x.push.apply(x,ae);for(let le=0;le<ye.length;le++)S.push(ye[le]+oe)}e.instructions&&!k.inhibitGridFit&&(k=new lt("glyf",e.instructions),k.gZone=k.z0=k.z1=k.z2=x,k.contours=S,x.push(new it(0,0),new it(Math.round(e.advanceWidth*o),0)),U.DEBUG&&(console.log("---EXEC COMPOSITE---"),k.step=-1),pt(k),x.length-=2)}else k=new lt("glyf",e.instructions),U.DEBUG&&(console.log("---EXEC GLYPH---"),k.step=-1),zt(e,k,o,l),x=k.gZone;return x},zt=function(e,r,o,l){const S=e.points||[],x=S.length,k=r.gZone=r.z0=r.z1=r.z2=[],D=r.contours=[];let R,F,K;for(let Y=0;Y<x;Y++)R=S[Y],k[Y]=new it(R.x*o,R.y*l,R.lastPointOfContour,R.onCurve);for(let Y=0;Y<x;Y++)R=k[Y],F||(F=R,D.push(Y)),R.lastPointOfContour?(R.nextPointOnContour=F,F.prevPointOnContour=R,F=void 0):(K=k[Y+1],R.nextPointOnContour=K,K.prevPointOnContour=R);if(!r.inhibitGridFit){if(U.DEBUG){console.log("PROCESSING GLYPH",r.stack);for(let Y=0;Y<x;Y++)console.log(Y,k[Y].x,k[Y].y)}if(k.push(new it(0,0),new it(Math.round(e.advanceWidth*o),0)),pt(r),k.length-=2,U.DEBUG){console.log("FINISHED GLYPH",r.stack);for(let Y=0;Y<x;Y++)console.log(Y,k[Y].x,k[Y].y)}}},pt=function(e){let r=e.prog;if(!r)return;const o=r.length;let l;for(e.ip=0;e.ip<o;e.ip++){if(U.DEBUG&&e.step++,l=hi[r[e.ip]],!l)throw new Error("unknown instruction: 0x"+Number(r[e.ip]).toString(16));l(e)}},hi=[gi.bind(void 0,rt),gi.bind(void 0,tt),vi.bind(void 0,rt),vi.bind(void 0,tt),mi.bind(void 0,rt),mi.bind(void 0,tt),yi.bind(void 0,0),yi.bind(void 0,1),bi.bind(void 0,0),bi.bind(void 0,1),function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"SPVFS[]",o,l),e.pv=e.dpv=xt(l,o)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"SPVFS[]",o,l),e.fv=xt(l,o)},function(e){const r=e.stack,o=e.pv;U.DEBUG&&console.log(e.step,"GPV[]"),r.push(16384*o.x),r.push(16384*o.y)},function(e){const r=e.stack,o=e.fv;U.DEBUG&&console.log(e.step,"GFV[]"),r.push(16384*o.x),r.push(16384*o.y)},function(e){e.fv=e.pv,U.DEBUG&&console.log(e.step,"SFVTPV[]")},function(e){const r=e.stack,o=r.pop(),l=r.pop(),S=r.pop(),x=r.pop(),k=r.pop(),D=e.z0,R=e.z1,F=D[o],K=D[l],Y=R[S],J=R[x],de=e.z2[k];U.DEBUG&&console.log("ISECT[], ",o,l,S,x,k);const ae=F.x,ye=F.y,oe=K.x,le=K.y,me=Y.x,Se=Y.y,Le=J.x,_e=J.y,he=(ae-oe)*(Se-_e)-(ye-le)*(me-Le),ge=ae*le-ye*oe,Te=me*_e-Se*Le;de.x=(ge*(me-Le)-Te*(ae-oe))/he,de.y=(ge*(Se-_e)-Te*(ye-le))/he},function(e){e.rp0=e.stack.pop(),U.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)},function(e){e.rp1=e.stack.pop(),U.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)},function(e){e.rp2=e.stack.pop(),U.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)},function(e){const r=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SZP0[]",r),e.zp0=r,r){case 0:e.tZone||Ot(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const r=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SZP1[]",r),e.zp1=r,r){case 0:e.tZone||Ot(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const r=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SZP2[]",r),e.zp2=r,r){case 0:e.tZone||Ot(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const r=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SZPS[]",r),e.zp0=e.zp1=e.zp2=r,r){case 0:e.tZone||Ot(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),U.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)},function(e){U.DEBUG&&console.log(e.step,"RTG[]"),e.round=fi},function(e){U.DEBUG&&console.log(e.step,"RTHG[]"),e.round=fn},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SMD[]",r),e.minDis=r/64},function(e){U.DEBUG&&console.log(e.step,"ELSE[]"),_i(e,!1)},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"JMPR[]",r),e.ip+=r-1},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SCVTCI[]",r),e.cvCutIn=r/64},void 0,void 0,function(e){const r=e.stack;U.DEBUG&&console.log(e.step,"DUP[]"),r.push(r[r.length-1])},$t,function(e){U.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"SWAP[]"),r.push(o),r.push(l)},function(e){const r=e.stack;U.DEBUG&&console.log(e.step,"DEPTH[]"),r.push(r.length)},function(e){const r=e.stack,o=r.pop();U.DEBUG&&console.log(e.step,"CINDEX[]",o),r.push(r[r.length-o])},function(e){const r=e.stack,o=r.pop();U.DEBUG&&console.log(e.step,"MINDEX[]",o),r.push(r.splice(r.length-o,1)[0])},void 0,void 0,void 0,function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"LOOPCALL[]",o,l);const S=e.ip,x=e.prog;e.prog=e.funcs[o];for(let k=0;k<l;k++)pt(e),U.DEBUG&&console.log(++e.step,k+1<l?"next loopcall":"done loopcall",k);e.ip=S,e.prog=x},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"CALL[]",r);const o=e.ip,l=e.prog;e.prog=e.funcs[r],pt(e),e.ip=o,e.prog=l,U.DEBUG&&console.log(++e.step,"returning from",r)},function(e){if(e.env!=="fpgm")throw new Error("FDEF not allowed here");const r=e.stack,o=e.prog;let l=e.ip;const S=r.pop(),x=l;for(U.DEBUG&&console.log(e.step,"FDEF[]",S);o[++l]!==45;);e.ip=l,e.funcs[S]=o.slice(x+1,l)},void 0,Si.bind(void 0,0),Si.bind(void 0,1),Ci.bind(void 0,rt),Ci.bind(void 0,tt),wi.bind(void 0,0),wi.bind(void 0,1),xi.bind(void 0,0),xi.bind(void 0,1),Ei.bind(void 0,0),Ei.bind(void 0,1),function(e){const r=e.stack;let o=e.loop;const l=e.fv,S=r.pop()/64,x=e.z2;for(;o--;){const k=r.pop(),D=x[k];U.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-o)+": ":"")+"SHPIX[]",k,S),l.setRelative(D,D,S),l.touch(D)}e.loop=1},function(e){const r=e.stack,o=e.rp1,l=e.rp2;let S=e.loop;const x=e.z0[o],k=e.z1[l],D=e.fv,R=e.dpv,F=e.z2;for(;S--;){const K=r.pop(),Y=F[K];U.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-S)+": ":"")+"IP[]",K,o,"<->",l),D.interpolate(Y,x,k,R),D.touch(Y)}e.loop=1},Li.bind(void 0,0),Li.bind(void 0,1),function(e){const r=e.stack,o=e.rp0,l=e.z0[o];let S=e.loop;const x=e.fv,k=e.pv,D=e.z1;for(;S--;){const R=r.pop(),F=D[R];U.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-S)+": ":"")+"ALIGNRP[]",R),x.setRelative(F,l,0,k),x.touch(F)}e.loop=1},function(e){U.DEBUG&&console.log(e.step,"RTDG[]"),e.round=dn},ki.bind(void 0,0),ki.bind(void 0,1),function(e){const r=e.prog;let o=e.ip;const l=e.stack,S=r[++o];U.DEBUG&&console.log(e.step,"NPUSHB[]",S);for(let x=0;x<S;x++)l.push(r[++o]);e.ip=o},function(e){let r=e.ip;const o=e.prog,l=e.stack,S=o[++r];U.DEBUG&&console.log(e.step,"NPUSHW[]",S);for(let x=0;x<S;x++){let k=o[++r]<<8|o[++r];32768&k&&(k=-(1+(65535^k))),l.push(k)}e.ip=r},function(e){const r=e.stack;let o=e.store;o||(o=e.store=[]);const l=r.pop(),S=r.pop();U.DEBUG&&console.log(e.step,"WS",l,S),o[S]=l},function(e){const r=e.stack,o=e.store,l=r.pop();U.DEBUG&&console.log(e.step,"RS",l);const S=o&&o[l]||0;r.push(S)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"WCVTP",o,l),e.cvt[l]=o/64},function(e){const r=e.stack,o=r.pop();U.DEBUG&&console.log(e.step,"RCVT",o),r.push(64*e.cvt[o])},Ri.bind(void 0,0),Ri.bind(void 0,1),void 0,Ai.bind(void 0,0),Ai.bind(void 0,1),function(e){U.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)},void 0,function(e){U.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0},void 0,void 0,function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"LT[]",o,l),r.push(l<o?1:0)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"LTEQ[]",o,l),r.push(l<=o?1:0)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"GT[]",o,l),r.push(l>o?1:0)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"GTEQ[]",o,l),r.push(l>=o?1:0)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"EQ[]",o,l),r.push(o===l?1:0)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"NEQ[]",o,l),r.push(o!==l?1:0)},function(e){const r=e.stack,o=r.pop();U.DEBUG&&console.log(e.step,"ODD[]",o),r.push(Math.trunc(o)%2?1:0)},function(e){const r=e.stack,o=r.pop();U.DEBUG&&console.log(e.step,"EVEN[]",o),r.push(Math.trunc(o)%2?0:1)},function(e){let r=e.stack.pop();U.DEBUG&&console.log(e.step,"IF[]",r),r||(_i(e,!0),U.DEBUG&&console.log(e.step,"EIF[]"))},function(e){U.DEBUG&&console.log(e.step,"EIF[]")},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"AND[]",o,l),r.push(o&&l?1:0)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"OR[]",o,l),r.push(o||l?1:0)},function(e){const r=e.stack,o=r.pop();U.DEBUG&&console.log(e.step,"NOT[]",o),r.push(o?0:1)},jt.bind(void 0,1),function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SDB[]",r),e.deltaBase=r},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SDS[]",r),e.deltaShift=Math.pow(.5,r)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"ADD[]",o,l),r.push(l+o)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"SUB[]",o,l),r.push(l-o)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"DIV[]",o,l),r.push(64*l/o)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"MUL[]",o,l),r.push(l*o/64)},function(e){const r=e.stack,o=r.pop();U.DEBUG&&console.log(e.step,"ABS[]",o),r.push(Math.abs(o))},function(e){const r=e.stack;let o=r.pop();U.DEBUG&&console.log(e.step,"NEG[]",o),r.push(-o)},function(e){const r=e.stack,o=r.pop();U.DEBUG&&console.log(e.step,"FLOOR[]",o),r.push(64*Math.floor(o/64))},function(e){const r=e.stack,o=r.pop();U.DEBUG&&console.log(e.step,"CEILING[]",o),r.push(64*Math.ceil(o/64))},It.bind(void 0,0),It.bind(void 0,1),It.bind(void 0,2),It.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"WCVTF[]",o,l),e.cvt[l]=o*e.ppem/e.font.unitsPerEm},jt.bind(void 0,2),jt.bind(void 0,3),qt.bind(void 0,1),qt.bind(void 0,2),qt.bind(void 0,3),function(e){let r,o=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SROUND[]",o),e.round=pi,192&o){case 0:r=.5;break;case 64:r=1;break;case 128:r=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=r,48&o){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*r;break;case 32:e.srPhase=.5*r;break;case 48:e.srPhase=.75*r;break;default:throw new Error("invalid SROUND value")}o&=15,e.srThreshold=o===0?0:(o/8-.5)*r},function(e){let r,o=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"S45ROUND[]",o),e.round=pi,192&o){case 0:r=Math.sqrt(2)/2;break;case 64:r=Math.sqrt(2);break;case 128:r=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=r,48&o){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*r;break;case 32:e.srPhase=.5*r;break;case 48:e.srPhase=.75*r;break;default:throw new Error("invalid S45ROUND value")}o&=15,e.srThreshold=o===0?0:(o/8-.5)*r},void 0,void 0,function(e){U.DEBUG&&console.log(e.step,"ROFF[]"),e.round=un},void 0,function(e){U.DEBUG&&console.log(e.step,"RUTG[]"),e.round=pn},function(e){U.DEBUG&&console.log(e.step,"RDTG[]"),e.round=_n},$t,$t,void 0,void 0,void 0,void 0,void 0,function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SCANCTRL[]",r)},Ti.bind(void 0,0),Ti.bind(void 0,1),function(e){const r=e.stack,o=r.pop();let l=0;U.DEBUG&&console.log(e.step,"GETINFO[]",o),1&o&&(l=35),32&o&&(l|=4096),r.push(l)},void 0,function(e){const r=e.stack,o=r.pop(),l=r.pop(),S=r.pop();U.DEBUG&&console.log(e.step,"ROLL[]"),r.push(l),r.push(o),r.push(S)},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"MAX[]",o,l),r.push(Math.max(l,o))},function(e){const r=e.stack,o=r.pop(),l=r.pop();U.DEBUG&&console.log(e.step,"MIN[]",o,l),r.push(Math.min(l,o))},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SCANTYPE[]",r)},function(e){const r=e.stack.pop();let o=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"INSTCTRL[]",r,o),r){case 1:return void(e.inhibitGridFit=!!o);case 2:return void(e.ignoreCvt=!!o);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ct.bind(void 0,1),ct.bind(void 0,2),ct.bind(void 0,3),ct.bind(void 0,4),ct.bind(void 0,5),ct.bind(void 0,6),ct.bind(void 0,7),ct.bind(void 0,8),ht.bind(void 0,1),ht.bind(void 0,2),ht.bind(void 0,3),ht.bind(void 0,4),ht.bind(void 0,5),ht.bind(void 0,6),ht.bind(void 0,7),ht.bind(void 0,8),ve.bind(void 0,0,0,0,0,0),ve.bind(void 0,0,0,0,0,1),ve.bind(void 0,0,0,0,0,2),ve.bind(void 0,0,0,0,0,3),ve.bind(void 0,0,0,0,1,0),ve.bind(void 0,0,0,0,1,1),ve.bind(void 0,0,0,0,1,2),ve.bind(void 0,0,0,0,1,3),ve.bind(void 0,0,0,1,0,0),ve.bind(void 0,0,0,1,0,1),ve.bind(void 0,0,0,1,0,2),ve.bind(void 0,0,0,1,0,3),ve.bind(void 0,0,0,1,1,0),ve.bind(void 0,0,0,1,1,1),ve.bind(void 0,0,0,1,1,2),ve.bind(void 0,0,0,1,1,3),ve.bind(void 0,0,1,0,0,0),ve.bind(void 0,0,1,0,0,1),ve.bind(void 0,0,1,0,0,2),ve.bind(void 0,0,1,0,0,3),ve.bind(void 0,0,1,0,1,0),ve.bind(void 0,0,1,0,1,1),ve.bind(void 0,0,1,0,1,2),ve.bind(void 0,0,1,0,1,3),ve.bind(void 0,0,1,1,0,0),ve.bind(void 0,0,1,1,0,1),ve.bind(void 0,0,1,1,0,2),ve.bind(void 0,0,1,1,0,3),ve.bind(void 0,0,1,1,1,0),ve.bind(void 0,0,1,1,1,1),ve.bind(void 0,0,1,1,1,2),ve.bind(void 0,0,1,1,1,3),ve.bind(void 0,1,0,0,0,0),ve.bind(void 0,1,0,0,0,1),ve.bind(void 0,1,0,0,0,2),ve.bind(void 0,1,0,0,0,3),ve.bind(void 0,1,0,0,1,0),ve.bind(void 0,1,0,0,1,1),ve.bind(void 0,1,0,0,1,2),ve.bind(void 0,1,0,0,1,3),ve.bind(void 0,1,0,1,0,0),ve.bind(void 0,1,0,1,0,1),ve.bind(void 0,1,0,1,0,2),ve.bind(void 0,1,0,1,0,3),ve.bind(void 0,1,0,1,1,0),ve.bind(void 0,1,0,1,1,1),ve.bind(void 0,1,0,1,1,2),ve.bind(void 0,1,0,1,1,3),ve.bind(void 0,1,1,0,0,0),ve.bind(void 0,1,1,0,0,1),ve.bind(void 0,1,1,0,0,2),ve.bind(void 0,1,1,0,0,3),ve.bind(void 0,1,1,0,1,0),ve.bind(void 0,1,1,0,1,1),ve.bind(void 0,1,1,0,1,2),ve.bind(void 0,1,1,0,1,3),ve.bind(void 0,1,1,1,0,0),ve.bind(void 0,1,1,1,0,1),ve.bind(void 0,1,1,1,0,2),ve.bind(void 0,1,1,1,0,3),ve.bind(void 0,1,1,1,1,0),ve.bind(void 0,1,1,1,1,1),ve.bind(void 0,1,1,1,1,2),ve.bind(void 0,1,1,1,1,3)];const vn=di;function De(e){(e=e||{}).empty||(vt(e.familyName,"When creating a new Font object, familyName is required."),vt(e.styleName,"When creating a new Font object, styleName is required."),vt(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),vt(e.ascender,"When creating a new Font object, ascender is required."),vt(e.descender,"When creating a new Font object, descender is required."),vt(e.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||e.familyName+e.styleName},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables={os2:{usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new _t.GlyphSet(this,e.glyphs||[]),this.encoding=new Ne(this),this.position=new ln(this),this.substitution=new hn(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:this.outlinesFormat==="truetype"?this._hinting=new vn(this):void 0}})}De.prototype.hasChar=function(e){return this.encoding.charToGlyphIndex(e)!==null},De.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},De.prototype.charToGlyph=function(e){const r=this.charToGlyphIndex(e);let o=this.glyphs.get(r);return o||(o=this.glyphs.get(0)),o},De.prototype.stringToGlyphs=function(e,r){r=r||this.defaultRenderOptions;const o=[];for(let k=0;k<e.length;k+=1){const D=e[k];o.push(this.charToGlyphIndex(D))}let l=o.length;if(r.features){const k=r.script||this.substitution.getDefaultScriptName();let D=[];r.features.liga&&(D=D.concat(this.substitution.getFeature("liga",k,r.language))),r.features.rlig&&(D=D.concat(this.substitution.getFeature("rlig",k,r.language)));for(let R=0;R<l;R+=1)for(let F=0;F<D.length;F++){const K=D[F],Y=K.sub,J=Y.length;let de=0;for(;de<J&&Y[de]===o[R+de];)de++;de===J&&(o.splice(R,J,K.by),l=l-J+1)}}const S=new Array(l),x=this.glyphs.get(0);for(let k=0;k<l;k+=1)S[k]=this.glyphs.get(o[k])||x;return S},De.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},De.prototype.nameToGlyph=function(e){const r=this.nameToGlyphIndex(e);let o=this.glyphs.get(r);return o||(o=this.glyphs.get(0)),o},De.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},De.prototype.getKerningValue=function(e,r){return e=e.index||e,r=r.index||r,this.kerningPairs[e+","+r]||0},De.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},De.prototype.forEachGlyph=function(e,r,o,l,S,x){r=r!==void 0?r:0,o=o!==void 0?o:0,l=l!==void 0?l:72,S=S||this.defaultRenderOptions;const k=1/this.unitsPerEm*l,D=this.stringToGlyphs(e,S);let R;if(S.kerning){const F=S.script||this.position.getDefaultScriptName();R=this.position.getKerningTables(F,S.language)}for(let F=0;F<D.length;F+=1){const K=D[F];x.call(this,K,r,o,l,S),K.advanceWidth&&(r+=K.advanceWidth*k),S.kerning&&F<D.length-1&&(r+=(R?this.position.getKerningValue(R,K.index,D[F+1].index):this.getKerningValue(K,D[F+1]))*k),S.letterSpacing?r+=S.letterSpacing*l:S.tracking&&(r+=S.tracking/1e3*l)}return r},De.prototype.getPath=function(e,r,o,l,S){const x=new i;return this.forEachGlyph(e,r,o,l,S,function(k,D,R,F){const K=k.getPath(D,R,F,S,this);x.extend(K)}),x},De.prototype.getPaths=function(e,r,o,l,S){const x=[];return this.forEachGlyph(e,r,o,l,S,function(k,D,R,F){const K=k.getPath(D,R,F,S,this);x.push(K)}),x},De.prototype.getAdvanceWidth=function(e,r,o){return this.forEachGlyph(e,0,0,r,o,function(){})},De.prototype.draw=function(e,r,o,l,S,x){this.getPath(r,o,l,S,x).draw(e)},De.prototype.drawPoints=function(e,r,o,l,S,x){this.forEachGlyph(r,o,l,S,x,function(k,D,R,F){k.drawPoints(e,D,R,F)})},De.prototype.drawMetrics=function(e,r,o,l,S,x){this.forEachGlyph(r,o,l,S,x,function(k,D,R,F){k.drawMetrics(e,D,R,F)})},De.prototype.getEnglishName=function(e){const r=this.names[e];if(r)return r.en},De.prototype.validate=function(){const e=this;function r(l,S){}function o(l){const S=e.getEnglishName(l);S&&S.trim().length>0}o("fontFamily"),o("weightName"),o("manufacturer"),o("copyright"),o("version"),this.unitsPerEm>0},De.prototype.toTables=function(){return an(this)},De.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},De.prototype.toArrayBuffer=function(){const e=this.toTables().encode(),r=new ArrayBuffer(e.length),o=new Uint8Array(r);for(let l=0;l<e.length;l++)o[l]=e[l];return r},De.prototype.download=function(e){const r=this.getEnglishName("fontFamily"),o=this.getEnglishName("fontSubfamily");e=e||r.replace(/\s/g,"")+"-"+o+".otf";const l=this.toArrayBuffer();if(typeof window<"u")window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,l.byteLength,function(S){S.root.getFile(e,{create:!0},function(x){x.createWriter(function(k){const D=new DataView(l),R=new Blob([D],{type:"font/opentype"});k.write(R),k.addEventListener("writeend",function(){location.href=x.toURL()},!1)})})},function(S){throw new Error(S.name+": "+S.message)});else{const S=u(89),x=function(k){const D=new Buffer(k.byteLength),R=new Uint8Array(k);for(let F=0;F<D.length;++F)D[F]=R[F];return D}(l);S.writeFileSync(e,x)}},De.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},De.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},De.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};const Di=De;function mn(e,r,o){const l={},S=new fe.Parser(e,r);return l.tag=S.parseTag(),l.minValue=S.parseFixed(),l.defaultValue=S.parseFixed(),l.maxValue=S.parseFixed(),S.skip("uShort",1),l.name=o[S.parseUShort()]||{},l}function yn(e,r,o,l){const S={},x=new fe.Parser(e,r);S.name=l[x.parseUShort()]||{},x.skip("uShort",1),S.coordinates={};for(let k=0;k<o.length;++k)S.coordinates[o[k].tag]=x.parseFixed();return S}const bn=function(e,r,o){const l=new fe.Parser(e,r),S=l.parseULong();g.argument(S===65536,"Unsupported fvar table version.");const x=l.parseOffset16();l.skip("uShort",1);const k=l.parseUShort(),D=l.parseUShort(),R=l.parseUShort(),F=l.parseUShort(),K=[];for(let de=0;de<k;de++)K.push(mn(e,r+x+de*D,o));const Y=[],J=r+x+k*D;for(let de=0;de<R;de++)Y.push(yn(e,J+de*F,K,o));return{axes:K,instances:Y}},Je=new Array(10);Je[1]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();return r===1?{posFormat:1,coverage:this.parsePointer(ee.coverage),value:this.parseValueRecord()}:r===2?{posFormat:2,coverage:this.parsePointer(ee.coverage),values:this.parseValueRecordList()}:void g.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Je[2]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort(),o=this.parsePointer(ee.coverage),l=this.parseUShort(),S=this.parseUShort();if(r===1)return{posFormat:r,coverage:o,valueFormat1:l,valueFormat2:S,pairSets:this.parseList(ee.pointer(ee.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(l),value2:this.parseValueRecord(S)}})))};if(r===2){const x=this.parsePointer(ee.classDef),k=this.parsePointer(ee.classDef),D=this.parseUShort(),R=this.parseUShort();return{posFormat:r,coverage:o,valueFormat1:l,valueFormat2:S,classDef1:x,classDef2:k,class1Count:D,class2Count:R,classRecords:this.parseList(D,ee.list(R,function(){return{value1:this.parseValueRecord(l),value2:this.parseValueRecord(S)}}))}}g.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.")},Je[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Je[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Je[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Je[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Je[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Je[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Je[9]=function(){return{error:"GPOS Lookup 9 not supported"}},new Array(10);const Sn=function(e,r){const o=new ee(e,r=r||0),l=o.parseVersion(1);return g.argument(l===1||l===1.1,"Unsupported GPOS table version "+l),l===1?{version:l,scripts:o.parseScriptList(),features:o.parseFeatureList(),lookups:o.parseLookupList(Je)}:{version:l,scripts:o.parseScriptList(),features:o.parseFeatureList(),lookups:o.parseLookupList(Je),variations:o.parseFeatureVariationsList()}},Cn=function(e,r){const o=new fe.Parser(e,r),l=o.parseUShort();if(l===0)return function(S){const x={};S.skip("uShort");const k=S.parseUShort();g.argument(k===0,"Unsupported kern sub-table version."),S.skip("uShort",2);const D=S.parseUShort();S.skip("uShort",3);for(let R=0;R<D;R+=1){const F=S.parseUShort(),K=S.parseUShort(),Y=S.parseShort();x[F+","+K]=Y}return x}(o);if(l===1)return function(S){const x={};S.skip("uShort"),S.parseULong()>1&&console.warn("Only the first kern subtable is supported."),S.skip("uLong");const k=255&S.parseUShort();if(S.skip("uShort"),k===0){const D=S.parseUShort();S.skip("uShort",3);for(let R=0;R<D;R+=1){const F=S.parseUShort(),K=S.parseUShort(),Y=S.parseShort();x[F+","+K]=Y}}return x}(o);throw new Error("Unsupported kern table version ("+l+").")},wn=function(e,r,o,l){const S=new fe.Parser(e,r),x=l?S.parseUShort:S.parseULong,k=[];for(let D=0;D<o+1;D+=1){let R=x.call(S);l&&(R*=2),k.push(R)}return k};function xn(e,r){u(89).readFile(e,function(o,l){if(o)return r(o.message);r(null,ci(l))})}function En(e,r){const o=new XMLHttpRequest;o.open("get",e,!0),o.responseType="arraybuffer",o.onload=function(){return o.response?r(null,o.response):r("Font could not be loaded: "+o.statusText)},o.onerror=function(){r("Font could not be loaded")},o.send()}function Mi(e,r){const o=[];let l=12;for(let S=0;S<r;S+=1){const x=fe.getTag(e,l),k=fe.getULong(e,l+4),D=fe.getULong(e,l+8),R=fe.getULong(e,l+12);o.push({tag:x,checksum:k,offset:D,length:R,compression:!1}),l+=16}return o}function Oe(e,r){if(r.compression==="WOFF"){const o=new Uint8Array(e.buffer,r.offset+2,r.compressedLength-2),l=new Uint8Array(r.length);if(m()(o,l),l.byteLength!==r.length)throw new Error("Decompression error: "+r.tag+" decompressed length doesn't match recorded length");return{data:new DataView(l.buffer,0),offset:0}}return{data:e,offset:r.offset}}function Vt(e){let r,o;const l=new Di({empty:!0}),S=new DataView(e,0);let x,k=[];const D=fe.getTag(S,0);if(D===String.fromCharCode(0,1,0,0)||D==="true"||D==="typ1")l.outlinesFormat="truetype",x=fe.getUShort(S,4),k=Mi(S,x);else if(D==="OTTO")l.outlinesFormat="cff",x=fe.getUShort(S,4),k=Mi(S,x);else{if(D!=="wOFF")throw new Error("Unsupported OpenType signature "+D);{const _e=fe.getTag(S,4);if(_e===String.fromCharCode(0,1,0,0))l.outlinesFormat="truetype";else{if(_e!=="OTTO")throw new Error("Unsupported OpenType flavor "+D);l.outlinesFormat="cff"}x=fe.getUShort(S,12),k=function(he,ge){const Te=[];let we=44;for(let Ie=0;Ie<ge;Ie+=1){const We=fe.getTag(he,we),qe=fe.getULong(he,we+4),Fe=fe.getULong(he,we+8),$e=fe.getULong(he,we+12);let Ue;Ue=Fe<$e&&"WOFF",Te.push({tag:We,offset:qe,compression:Ue,compressedLength:Fe,length:$e}),we+=20}return Te}(S,x)}}let R,F,K,Y,J,de,ae,ye,oe,le,me;for(let _e=0;_e<x;_e+=1){const he=k[_e];let ge;switch(he.tag){case"cmap":ge=Oe(S,he),l.tables.cmap=Re(ge.data,ge.offset),l.encoding=new nt(l.tables.cmap);break;case"cvt ":ge=Oe(S,he),me=new fe.Parser(ge.data,ge.offset),l.tables.cvt=me.parseShortList(he.length/2);break;case"fvar":F=he;break;case"fpgm":ge=Oe(S,he),me=new fe.Parser(ge.data,ge.offset),l.tables.fpgm=me.parseByteList(he.length);break;case"head":ge=Oe(S,he),l.tables.head=Bs(ge.data,ge.offset),l.unitsPerEm=l.tables.head.unitsPerEm,r=l.tables.head.indexToLocFormat;break;case"hhea":ge=Oe(S,he),l.tables.hhea=Is(ge.data,ge.offset),l.ascender=l.tables.hhea.ascender,l.descender=l.tables.hhea.descender,l.numberOfHMetrics=l.tables.hhea.numberOfHMetrics;break;case"hmtx":de=he;break;case"ltag":ge=Oe(S,he),o=Ns(ge.data,ge.offset);break;case"maxp":ge=Oe(S,he),l.tables.maxp=Ws(ge.data,ge.offset),l.numGlyphs=l.tables.maxp.numGlyphs;break;case"name":oe=he;break;case"OS/2":ge=Oe(S,he),l.tables.os2=Xs(ge.data,ge.offset);break;case"post":ge=Oe(S,he),l.tables.post=Js(ge.data,ge.offset),l.glyphNames=new ze(l.tables.post);break;case"prep":ge=Oe(S,he),me=new fe.Parser(ge.data,ge.offset),l.tables.prep=me.parseByteList(he.length);break;case"glyf":K=he;break;case"loca":ye=he;break;case"CFF ":R=he;break;case"kern":ae=he;break;case"GPOS":Y=he;break;case"GSUB":J=he;break;case"meta":le=he}}const Se=Oe(S,oe);if(l.tables.name=Vs(Se.data,Se.offset,o),l.names=l.tables.name,K&&ye){const _e=r===0,he=Oe(S,ye),ge=wn(he.data,he.offset,l.numGlyphs,_e),Te=Oe(S,K);l.glyphs=Pr.parse(Te.data,Te.offset,ge,l)}else{if(!R)throw new Error("Font doesn't contain TrueType or CFF outlines.");{const _e=Oe(S,R);Ds(_e.data,_e.offset,l)}}const Le=Oe(S,de);if(Us(Le.data,Le.offset,l.numberOfHMetrics,l.numGlyphs,l.glyphs),function(_e){let he;const ge=_e.tables.cmap.glyphIndexMap,Te=Object.keys(ge);for(let we=0;we<Te.length;we+=1){const Ie=Te[we],We=ge[Ie];he=_e.glyphs.get(We),he.addUnicode(parseInt(Ie))}for(let we=0;we<_e.glyphs.length;we+=1)he=_e.glyphs.get(we),_e.cffEncoding?_e.isCIDFont?he.name="gid"+we:he.name=_e.cffEncoding.charset[we]:_e.glyphNames.names&&(he.name=_e.glyphNames.glyphIndexToName(we))}(l),ae){const _e=Oe(S,ae);l.kerningPairs=Cn(_e.data,_e.offset)}else l.kerningPairs={};if(Y){const _e=Oe(S,Y);l.tables.gpos=Sn(_e.data,_e.offset)}if(J){const _e=Oe(S,J);l.tables.gsub=en(_e.data,_e.offset)}if(F){const _e=Oe(S,F);l.tables.fvar=bn(_e.data,_e.offset,l.names)}if(le){const _e=Oe(S,le);l.tables.meta=rn(_e.data,_e.offset),l.metas=l.tables.meta}return l}function Ln(e,r){(typeof window>"u"?xn:En)(e,function(o,l){if(o)return r(o);let S;try{S=Vt(l)}catch(x){return r(x,null)}return r(null,S)})}function kn(e){return Vt(ci(u(89).readFileSync(e)))}},896:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(978);class m extends w.Writable{constructor(){super(...arguments),this.offset=0,this._waiters=[],this._closed=!1}_write(a,s,i){let h=0;const p=()=>{for(;this._waiters.length>0;){const g=this._waiters[0];if(this._buffer){const C=this._buffer.size-this._buffer.offset;if(!(C+a.length>=g.size)){if(!g.skip){const v=Buffer.alloc(C+a.length);this._buffer.buf.copy(v,0,this._buffer.offset,this._buffer.size),a.copy(v,C,0,a.length),this._buffer.buf=v}this._buffer.offset=0,this._buffer.size=C+a.length,i();break}if(g.skip)this._buffer=void 0,g.resolve();else{const v=Math.min(C,g.size),b=Buffer.alloc(g.size);this._buffer.buf.copy(b,0,this._buffer.offset,this._buffer.offset+v),a.copy(b,v,0,g.size-v),g.resolve(b)}if(this.offset+=g.size,this._waiters.shift(),this._buffer=void 0,C+a.length===g.size){i();break}h+=g.size-C}else{if(!(a.length-h>=g.size)){this._buffer={buf:g.skip?void 0:a.slice(h),offset:0,size:a.length-h},h=a.length,i();break}if(g.skip?g.resolve():g.resolve(a.slice(h,h+g.size)),this.offset+=g.size,this._waiters.shift(),h+=g.size,a.length===h){i();break}}}this._processTrigger=a.length-h>0?p:void 0};p()}_destroy(a,s){this._processTrigger=void 0;for(const i of this._waiters)i.reject(a||new Error("stream destroyed"));this._waiters=[],this._closed=!0}_final(a){this._processTrigger=void 0;for(const s of this._waiters)s.reject(new Error("not enough data in stream"));this._waiters=[],this._closed=!0}read(a){return new Promise((s,i)=>{this._closed&&i(new Error("stream is closed")),this._waiters.push({resolve:s,reject:i,size:a,skip:!1}),this._processTrigger&&this._processTrigger()})}skip(a){return new Promise((s,i)=>{this._closed&&i(new Error("stream is closed")),this._waiters.push({resolve:s,reject:i,size:a,skip:!0}),this._processTrigger&&this._processTrigger()})}}function n(){return new m}f.exports=Object.assign(n,{default:n}),d.default=n},311:f=>{function d(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function u(M,N){this.source=M,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=N,this.destLen=0,this.ltree=new d,this.dtree=new d}var w=new d,m=new d,n=new Uint8Array(30),t=new Uint16Array(30),a=new Uint8Array(30),s=new Uint16Array(30),i=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=new d,p=new Uint8Array(320);function g(M,N,L,B){var I,P;for(I=0;I<L;++I)M[I]=0;for(I=0;I<30-L;++I)M[I+L]=I/L|0;for(P=B,I=0;I<30;++I)N[I]=P,P+=1<<M[I]}var C=new Uint16Array(16);function v(M,N,L,B){var I,P;for(I=0;I<16;++I)M.table[I]=0;for(I=0;I<B;++I)M.table[N[L+I]]++;for(M.table[0]=0,P=0,I=0;I<16;++I)C[I]=P,P+=M.table[I];for(I=0;I<B;++I)N[L+I]&&(M.trans[C[N[L+I]]++]=I)}function b(M){M.bitcount--||(M.tag=M.source[M.sourceIndex++],M.bitcount=7);var N=1&M.tag;return M.tag>>>=1,N}function E(M,N,L){if(!N)return L;for(;M.bitcount<24;)M.tag|=M.source[M.sourceIndex++]<<M.bitcount,M.bitcount+=8;var B=M.tag&65535>>>16-N;return M.tag>>>=N,M.bitcount-=N,B+L}function A(M,N){for(;M.bitcount<24;)M.tag|=M.source[M.sourceIndex++]<<M.bitcount,M.bitcount+=8;var L=0,B=0,I=0,P=M.tag;do B=2*B+(1&P),P>>>=1,++I,L+=N.table[I],B-=N.table[I];while(B>=0);return M.tag=P,M.bitcount-=I,N.trans[L+B]}function T(M,N,L){var B,I,P,Z,G,X;for(B=E(M,5,257),I=E(M,5,1),P=E(M,4,4),Z=0;Z<19;++Z)p[Z]=0;for(Z=0;Z<P;++Z){var V=E(M,3,0);p[i[Z]]=V}for(v(h,p,0,19),G=0;G<B+I;){var ie=A(M,h);switch(ie){case 16:var z=p[G-1];for(X=E(M,2,3);X;--X)p[G++]=z;break;case 17:for(X=E(M,3,3);X;--X)p[G++]=0;break;case 18:for(X=E(M,7,11);X;--X)p[G++]=0;break;default:p[G++]=ie}}v(N,p,0,B),v(L,p,B,I)}function O(M,N,L){for(;;){var B,I,P,Z,G=A(M,N);if(G===256)return 0;if(G<256)M.dest[M.destLen++]=G;else for(B=E(M,n[G-=257],t[G]),I=A(M,L),Z=P=M.destLen-E(M,a[I],s[I]);Z<P+B;++Z)M.dest[M.destLen++]=M.dest[Z]}}function H(M){for(var N,L;M.bitcount>8;)M.sourceIndex--,M.bitcount-=8;if((N=256*(N=M.source[M.sourceIndex+1])+M.source[M.sourceIndex])!==(65535&~(256*M.source[M.sourceIndex+3]+M.source[M.sourceIndex+2])))return-3;for(M.sourceIndex+=4,L=N;L;--L)M.dest[M.destLen++]=M.source[M.sourceIndex++];return M.bitcount=0,0}(function(M,N){var L;for(L=0;L<7;++L)M.table[L]=0;for(M.table[7]=24,M.table[8]=152,M.table[9]=112,L=0;L<24;++L)M.trans[L]=256+L;for(L=0;L<144;++L)M.trans[24+L]=L;for(L=0;L<8;++L)M.trans[168+L]=280+L;for(L=0;L<112;++L)M.trans[176+L]=144+L;for(L=0;L<5;++L)N.table[L]=0;for(N.table[5]=32,L=0;L<32;++L)N.trans[L]=L})(w,m),g(n,t,4,3),g(a,s,2,1),n[28]=0,t[28]=258,f.exports=function(M,N){var L,B,I=new u(M,N);do{switch(L=b(I),E(I,2,0)){case 0:B=H(I);break;case 1:B=O(I,w,m);break;case 2:T(I,I.ltree,I.dtree),B=O(I,I.ltree,I.dtree);break;default:B=-3}if(B!==0)throw new Error("Data error")}while(!L);return I.destLen<I.dest.length?typeof I.dest.slice=="function"?I.dest.slice(0,I.destLen):I.dest.subarray(0,I.destLen):I.dest}},371:f=>{f.exports=function(d){d.prototype[Symbol.iterator]=function*(){for(let u=this.head;u;u=u.next)yield u.value}}},411:(f,d,u)=>{function w(s){var i=this;if(i instanceof w||(i=new w),i.tail=null,i.head=null,i.length=0,s&&typeof s.forEach=="function")s.forEach(function(g){i.push(g)});else if(arguments.length>0)for(var h=0,p=arguments.length;h<p;h++)i.push(arguments[h]);return i}function m(s,i,h){var p=i===s.head?new a(h,null,i,s):new a(h,i,i.next,s);return p.next===null&&(s.tail=p),p.prev===null&&(s.head=p),s.length++,p}function n(s,i){s.tail=new a(i,s.tail,null,s),s.head||(s.head=s.tail),s.length++}function t(s,i){s.head=new a(i,null,s.head,s),s.tail||(s.tail=s.head),s.length++}function a(s,i,h,p){if(!(this instanceof a))return new a(s,i,h,p);this.list=p,this.value=s,i?(i.next=this,this.prev=i):this.prev=null,h?(h.prev=this,this.next=h):this.next=null}f.exports=w,w.Node=a,w.create=w,w.prototype.removeNode=function(s){if(s.list!==this)throw new Error("removing node which does not belong to this list");var i=s.next,h=s.prev;return i&&(i.prev=h),h&&(h.next=i),s===this.head&&(this.head=i),s===this.tail&&(this.tail=h),s.list.length--,s.next=null,s.prev=null,s.list=null,i},w.prototype.unshiftNode=function(s){if(s!==this.head){s.list&&s.list.removeNode(s);var i=this.head;s.list=this,s.next=i,i&&(i.prev=s),this.head=s,this.tail||(this.tail=s),this.length++}},w.prototype.pushNode=function(s){if(s!==this.tail){s.list&&s.list.removeNode(s);var i=this.tail;s.list=this,s.prev=i,i&&(i.next=s),this.tail=s,this.head||(this.head=s),this.length++}},w.prototype.push=function(){for(var s=0,i=arguments.length;s<i;s++)n(this,arguments[s]);return this.length},w.prototype.unshift=function(){for(var s=0,i=arguments.length;s<i;s++)t(this,arguments[s]);return this.length},w.prototype.pop=function(){if(this.tail){var s=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,s}},w.prototype.shift=function(){if(this.head){var s=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,s}},w.prototype.forEach=function(s,i){i=i||this;for(var h=this.head,p=0;h!==null;p++)s.call(i,h.value,p,this),h=h.next},w.prototype.forEachReverse=function(s,i){i=i||this;for(var h=this.tail,p=this.length-1;h!==null;p--)s.call(i,h.value,p,this),h=h.prev},w.prototype.get=function(s){for(var i=0,h=this.head;h!==null&&i<s;i++)h=h.next;if(i===s&&h!==null)return h.value},w.prototype.getReverse=function(s){for(var i=0,h=this.tail;h!==null&&i<s;i++)h=h.prev;if(i===s&&h!==null)return h.value},w.prototype.map=function(s,i){i=i||this;for(var h=new w,p=this.head;p!==null;)h.push(s.call(i,p.value,this)),p=p.next;return h},w.prototype.mapReverse=function(s,i){i=i||this;for(var h=new w,p=this.tail;p!==null;)h.push(s.call(i,p.value,this)),p=p.prev;return h},w.prototype.reduce=function(s,i){var h,p=this.head;if(arguments.length>1)h=i;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");p=this.head.next,h=this.head.value}for(var g=0;p!==null;g++)h=s(h,p.value,g),p=p.next;return h},w.prototype.reduceReverse=function(s,i){var h,p=this.tail;if(arguments.length>1)h=i;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");p=this.tail.prev,h=this.tail.value}for(var g=this.length-1;p!==null;g--)h=s(h,p.value,g),p=p.prev;return h},w.prototype.toArray=function(){for(var s=new Array(this.length),i=0,h=this.head;h!==null;i++)s[i]=h.value,h=h.next;return s},w.prototype.toArrayReverse=function(){for(var s=new Array(this.length),i=0,h=this.tail;h!==null;i++)s[i]=h.value,h=h.prev;return s},w.prototype.slice=function(s,i){(i=i||this.length)<0&&(i+=this.length),(s=s||0)<0&&(s+=this.length);var h=new w;if(i<s||i<0)return h;s<0&&(s=0),i>this.length&&(i=this.length);for(var p=0,g=this.head;g!==null&&p<s;p++)g=g.next;for(;g!==null&&p<i;p++,g=g.next)h.push(g.value);return h},w.prototype.sliceReverse=function(s,i){(i=i||this.length)<0&&(i+=this.length),(s=s||0)<0&&(s+=this.length);var h=new w;if(i<s||i<0)return h;s<0&&(s=0),i>this.length&&(i=this.length);for(var p=this.length,g=this.tail;g!==null&&p>i;p--)g=g.prev;for(;g!==null&&p>s;p--,g=g.prev)h.push(g.value);return h},w.prototype.splice=function(s,i,...h){s>this.length&&(s=this.length-1),s<0&&(s=this.length+s);for(var p=0,g=this.head;g!==null&&p<s;p++)g=g.next;var C=[];for(p=0;g&&p<i;p++)C.push(g.value),g=this.removeNode(g);for(g===null&&(g=this.tail),g!==this.head&&g!==this.tail&&(g=g.prev),p=0;p<h.length;p++)g=m(this,g,h[p]);return C},w.prototype.reverse=function(){for(var s=this.head,i=this.tail,h=s;h!==null;h=h.prev){var p=h.prev;h.prev=h.next,h.next=p}return this.head=i,this.tail=s,this};try{u(371)(w)}catch{}},109:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const w=u(98),m=u(104);let n;d.default=async function(a,s){var i,h;if(!n){if(typeof navigator<"u"&&"fonts"in navigator){try{const C=await((h=(i=navigator.permissions).request)===null||h===void 0?void 0:h.call(i,{name:"local-fonts"}));if(C&&C.state!=="granted")throw new Error("Permission to access local fonts not granted.")}catch(C){if(C.name!=="TypeError")throw C}const g={};try{const C=await navigator.fonts.query();for(const v of C)g.hasOwnProperty(v.family)||(g[v.family]=[]),g[v.family].push(v);n=Promise.resolve(g)}catch(C){console.error(C.name,C.message)}}else if(typeof process!="object"&&"queryLocalFonts"in window){const g={};try{const C=await window.queryLocalFonts();for(const v of C)g.hasOwnProperty(v.family)||(g[v.family]=[]),g[v.family].push(v);n=Promise.resolve(g)}catch(C){console.error(C.name,C.message)}}n||(n=Promise.resolve({}))}const p=await n;for(const g of(0,m.default)(a)){if(t.includes(g))return;if(p.hasOwnProperty(g)&&p[g].length>0){const C=p[g][0];if("blob"in C){const v=await C.blob(),b=await v.arrayBuffer();return(0,w.loadBuffer)(b,{cacheSize:s})}return}}};const t=["serif","sans-serif","cursive","fantasy","monospace","system-ui","emoji","math","fangsong"]},833:(f,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.enableLigatures=void 0;const w=u(109);d.enableLigatures=function(m,n=[]){let t,a,s,i=0;return m.registerCharacterJoiner(h=>{const p=m.options.fontFamily;if(p&&(i===0||t!==p)){a=void 0,i=1,t=p;const g=t;(0,w.default)(g,1e5).then(C=>{g===m.options.fontFamily&&(i=2,a=C,C&&m.refresh(0,m.rows-1))}).catch(C=>{g===m.options.fontFamily&&(i=3,m.options.logLevel==="debug"&&console.debug(s,new Error("Failure while loading font")),a=void 0,s=C)})}return a&&i===2?a.findLigatureRanges(h).map(g=>[g[0],g[1]]):function(g,C){const v=[];for(let b=0;b<g.length;b++)for(let E=0;E<C.length;E++)if(g.startsWith(C[E],b)){v.push([b,b+C[E].length]),b+=C[E].length-1;break}return v}(h,n)})}},104:(f,d)=>{function u(t,a){let s="",i=!1;for(;t.offset<t.input.length;){const h=t.input[t.offset++];if(i)/[\dA-Fa-f]/.test(h)?(t.offset--,s+=m(t)):h!==`
`&&(s+=h),i=!1;else switch(h){case a:return s;case"\\":i=!0;break;default:s+=h}}throw new Error("Unterminated string")}function w(t){let a="",s=!1;for(;t.offset<t.input.length;){const i=t.input[t.offset++];if(s)/[\dA-Fa-f]/.test(i)?(t.offset--,a+=m(t)):a+=i,s=!1;else switch(i){case"\\":s=!0;break;case",":return a;default:/\s/.test(i)?a.endsWith(" ")||(a+=" "):a+=i}}return a}function m(t){let a="";for(;t.offset<t.input.length;){const s=t.input[t.offset++];if(/\s/.test(s))return n(a);if(a.length>=6||!/[\dA-Fa-f]/.test(s))return t.offset--,n(a);a+=s}return n(a)}function n(t){return String.fromCodePoint(parseInt(t,16))}Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(t){if(typeof t!="string")throw new Error("Font family must be a string");const a={input:t,offset:0},s=[];let i="";for(;a.offset<a.input.length;){const h=a.input[a.offset++];switch(h){case"'":case'"':i+=u(a,h);break;case",":s.push(i),i="";break;default:/\s/.test(h)||(a.offset--,i+=w(a),s.push(i),i="")}}return s}},89:f=>{f.exports=Q},56:f=>{f.exports=ne},978:f=>{f.exports=pe},269:f=>{f.exports=ue},82:()=>{},456:()=>{}},c={};function y(f){var d=c[f];if(d!==void 0)return d.exports;var u=c[f]={exports:{}};return j[f].call(u.exports,u,u.exports,y),u.exports}y.n=f=>{var d=f&&f.__esModule?()=>f.default:()=>f;return y.d(d,{a:d}),d},y.d=(f,d)=>{for(var u in d)y.o(d,u)&&!y.o(f,u)&&Object.defineProperty(f,u,{enumerable:!0,get:d[u]})},y.o=(f,d)=>Object.prototype.hasOwnProperty.call(f,d),y.r=f=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})};var _={};return(()=>{var f=_;Object.defineProperty(f,"__esModule",{value:!0}),f.LigaturesAddon=void 0;const d=y(833);f.LigaturesAddon=class{constructor(u){this._fallbackLigatures=((u==null?void 0:u.fallbackLigatures)||["<--","<---","<<-","<-","->","->>","-->","--->","<==","<===","<<=","<=","=>","=>>","==>","===>",">=",">>=","<->","<-->","<--->","<---->","<=>","<==>","<===>","<====>","-------->","<~~","<~","~>","~~>","::",":::","==","!=","===","!==",":=",":-",":+","<*","<*>","*>","<|","<|>","|>","+:","-:","=:",":>","++","+++","<!--","<!---","<***>"]).sort((w,m)=>m.length-w.length)}activate(u){this._terminal=u,this._characterJoinerId=(0,d.enableLigatures)(u,this._fallbackLigatures)}dispose(){var u;this._characterJoinerId!==void 0&&((u=this._terminal)===null||u===void 0||u.deregisterCharacterJoiner(this._characterJoinerId),this._characterJoinerId=void 0)}}})(),_})()})})(Tr,Tr.exports);var oo=Tr.exports,Es={exports:{}};(function(q,U){(function(Q,ne){q.exports=ne()})(self,function(){return(()=>{var Q={345:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=y=>(this._listeners.push(y),{dispose:()=>{if(!this._disposed){for(let _=0;_<this._listeners.length;_++)if(this._listeners[_]===y)return void this._listeners.splice(_,1)}}})),this._event}fire(y,_){const f=[];for(let d=0;d<this._listeners.length;d++)f.push(this._listeners[d]);for(let d=0;d<f.length;d++)f[d].call(void 0,y,_)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(y,_){return y(f=>_.fire(f))}}},ne={};function ue(j){var c=ne[j];if(c!==void 0)return c.exports;var y=ne[j]={exports:{}};return Q[j](y,y.exports,ue),y.exports}var pe={};return(()=>{var j=pe;Object.defineProperty(j,"__esModule",{value:!0}),j.SearchAddon=void 0;const c=ue(345),y=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";j.SearchAddon=class{constructor(){this._linesCacheTimeoutId=0,this._onDidChangeResults=new c.EventEmitter,this.onDidChangeResults=this._onDidChangeResults.event}activate(_){this._terminal=_,this._onDataDisposable=this._terminal.onWriteParsed(()=>this._updateMatches()),this._onResizeDisposable=this._terminal.onResize(()=>this._updateMatches())}_updateMatches(){var _;this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&(!((_=this._lastSearchOptions)===null||_===void 0)&&_.decorations)&&(this._highlightTimeout=setTimeout(()=>{var f,d;this.findPrevious(this._cachedSearchTerm,Object.assign(Object.assign({},this._lastSearchOptions),{incremental:!0,noScroll:!0})),this._resultIndex=this._searchResults?this._searchResults.size-1:-1,this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:(d=(f=this._searchResults)===null||f===void 0?void 0:f.size)!==null&&d!==void 0?d:-1})},200))}dispose(){var _,f;this.clearDecorations(),(_=this._onDataDisposable)===null||_===void 0||_.dispose(),(f=this._onResizeDisposable)===null||f===void 0||f.dispose()}clearDecorations(_){var f,d,u,w;(f=this._selectedDecoration)===null||f===void 0||f.dispose(),(d=this._searchResults)===null||d===void 0||d.clear(),(u=this._resultDecorations)===null||u===void 0||u.forEach(m=>{for(const n of m)n.dispose()}),(w=this._resultDecorations)===null||w===void 0||w.clear(),this._searchResults=void 0,this._resultDecorations=void 0,_||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){var _;(_=this._selectedDecoration)===null||_===void 0||_.dispose(),this._selectedDecoration=void 0}findNext(_,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&_===this._cachedSearchTerm||this._highlightAllMatches(_,f)),this._fireResults(_,this._findNextAndSelect(_,f),f)}_highlightAllMatches(_,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!_||_.length===0)return void this.clearDecorations();f=f||{},this.clearDecorations(!0),this._searchResults=new Map,this._resultDecorations=new Map;const d=this._resultDecorations;let u=this._find(_,0,0,f);for(;u&&!this._searchResults.get(`${u.row}-${u.col}`);)if(this._searchResults.set(`${u.row}-${u.col}`,u),u=this._find(_,u.col+u.term.length>=this._terminal.cols?u.row+1:u.row,u.col+u.term.length>=this._terminal.cols?0:u.col+1,f),this._searchResults.size>1e3)return this.clearDecorations(),void(this._resultIndex=void 0);this._searchResults.forEach(w=>{const m=this._createResultDecoration(w,f.decorations);if(m){const n=d.get(m.marker.line)||[];n.push(m),d.set(m.marker.line,n)}})}_find(_,f,d,u){var w;if(!this._terminal||!_||_.length===0)return(w=this._terminal)===null||w===void 0||w.clearSelection(),void this.clearDecorations();if(d>this._terminal.cols)throw new Error(`Invalid col: ${d} to search in terminal of ${this._terminal.cols} cols`);let m;this._initLinesCache();const n={startRow:f,startCol:d};if(m=this._findInLine(_,n,u),!m)for(let t=f+1;t<this._terminal.buffer.active.baseY+this._terminal.rows&&(n.startRow=t,n.startCol=0,m=this._findInLine(_,n,u),!m);t++);return m}_findNextAndSelect(_,f){var d;if(!this._terminal||!_||_.length===0)return(d=this._terminal)===null||d===void 0||d.clearSelection(),this.clearDecorations(),this._cachedSearchTerm=void 0,this._resultIndex=-1,!1;this._cachedSearchTerm!==_&&(this._resultIndex=void 0,this._terminal.clearSelection());let u,w=0,m=0;if(this._terminal.hasSelection()){const a=!!f&&f.incremental;u=this._terminal.getSelectionPosition(),m=a?u.start.y:u.end.y,w=a?u.start.x:u.end.x}this._initLinesCache();const n={startRow:m,startCol:w};let t=this._findInLine(_,n,f);if(!t)for(let a=m+1;a<this._terminal.buffer.active.baseY+this._terminal.rows&&(n.startRow=a,n.startCol=0,t=this._findInLine(_,n,f),!t);a++);if(!t&&m!==0)for(let a=0;a<m&&(n.startRow=a,n.startCol=0,t=this._findInLine(_,n,f),!t);a++);return!t&&u&&(n.startRow=u.start.y,n.startCol=0,t=this._findInLine(_,n,f)),this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0?this._resultIndex=0:(this._resultIndex++,this._resultIndex>=this._searchResults.size&&(this._resultIndex=0))),this._selectResult(t,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}findPrevious(_,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&_===this._cachedSearchTerm||this._highlightAllMatches(_,f)),this._fireResults(_,this._findPreviousAndSelect(_,f),f)}_fireResults(_,f,d){var u;return d!=null&&d.decorations&&(this._resultIndex!==void 0&&((u=this._searchResults)===null||u===void 0?void 0:u.size)!==void 0?this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:this._searchResults.size}):this._onDidChangeResults.fire(void 0)),this._cachedSearchTerm=_,f}_findPreviousAndSelect(_,f){var d;if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let u;if(!this._terminal||!_||_.length===0)return u=void 0,(d=this._terminal)===null||d===void 0||d.clearSelection(),this.clearDecorations(),this._resultIndex=-1,!1;this._cachedSearchTerm!==_&&(this._resultIndex=void 0,this._terminal.clearSelection());let w=this._terminal.buffer.active.baseY+this._terminal.rows,m=this._terminal.cols;const n=!0,t=!!f&&f.incremental;let a;this._terminal.hasSelection()&&(a=this._terminal.getSelectionPosition(),w=a.start.y,m=a.start.x),this._initLinesCache();const s={startRow:w,startCol:m};if(t?(u=this._findInLine(_,s,f,!1),u&&u.row===w&&u.col===m||(a&&(s.startRow=a.end.y,s.startCol=a.end.x),u=this._findInLine(_,s,f,!0))):u=this._findInLine(_,s,f,n),!u){s.startCol=Math.max(s.startCol,this._terminal.cols);for(let i=w-1;i>=0&&(s.startRow=i,u=this._findInLine(_,s,f,n),!u);i--);}if(!u&&w!==this._terminal.buffer.active.baseY+this._terminal.rows)for(let i=this._terminal.buffer.active.baseY+this._terminal.rows;i>=w&&(s.startRow=i,u=this._findInLine(_,s,f,n),!u);i--);return this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0||this._resultIndex<0?this._resultIndex=this._searchResults.size-1:(this._resultIndex--,this._resultIndex===-1&&(this._resultIndex=this._searchResults.size-1))),!(u||!a)||this._selectResult(u,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}_initLinesCache(){const _=this._terminal;this._linesCache||(this._linesCache=new Array(_.buffer.active.length),this._cursorMoveListener=_.onCursorMove(()=>this._destroyLinesCache()),this._resizeListener=_.onResize(()=>this._destroyLinesCache())),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(_,f,d){return(_===0||y.includes(f[_-1]))&&(_+d.length===f.length||y.includes(f[_+d.length]))}_findInLine(_,f,d={},u=!1){var w;const m=this._terminal,n=f.startRow,t=f.startCol,a=m.buffer.active.getLine(n);if(a!=null&&a.isWrapped)return u?void(f.startCol+=m.cols):(f.startRow--,f.startCol+=m.cols,this._findInLine(_,f,d));let s=(w=this._linesCache)===null||w===void 0?void 0:w[n];s||(s=this._translateBufferLineToStringWithWrap(n,!0),this._linesCache&&(this._linesCache[n]=s));const[i,h]=s,p=this._bufferColsToStringOffset(n,t),g=d.caseSensitive?_:_.toLowerCase(),C=d.caseSensitive?i:i.toLowerCase();let v=-1;if(d.regex){const b=RegExp(g,"g");let E;if(u)for(;E=b.exec(C.slice(0,p));)v=b.lastIndex-E[0].length,_=E[0],b.lastIndex-=_.length-1;else E=b.exec(C.slice(p)),E&&E[0].length>0&&(v=p+(b.lastIndex-E[0].length),_=E[0])}else u?p-g.length>=0&&(v=C.lastIndexOf(g,p-g.length)):v=C.indexOf(g,p);if(v>=0){if(d.wholeWord&&!this._isWholeWord(v,C,_))return;let b=0;for(;b<h.length-1&&v>=h[b+1];)b++;let E=b;for(;E<h.length-1&&v+_.length>=h[E+1];)E++;const A=v-h[b],T=v+_.length-h[E],O=this._stringLengthToBufferSize(n+b,A);return{term:_,col:O,row:n+b,size:this._stringLengthToBufferSize(n+E,T)-O+m.cols*(E-b)}}}_stringLengthToBufferSize(_,f){const d=this._terminal.buffer.active.getLine(_);if(!d)return 0;for(let u=0;u<f;u++){const w=d.getCell(u);if(!w)break;const m=w.getChars();m.length>1&&(f-=m.length-1);const n=d.getCell(u+1);n&&n.getWidth()===0&&f++}return f}_bufferColsToStringOffset(_,f){const d=this._terminal;let u=_,w=0,m=d.buffer.active.getLine(u);for(;f>0&&m;){for(let n=0;n<f&&n<d.cols;n++){const t=m.getCell(n);if(!t)break;t.getWidth()&&(w+=t.getCode()===0?1:t.getChars().length)}if(u++,m=d.buffer.active.getLine(u),m&&!m.isWrapped)break;f-=d.cols}return w}_translateBufferLineToStringWithWrap(_,f){var d;const u=this._terminal,w=[],m=[0];let n=u.buffer.active.getLine(_);for(;n;){const t=u.buffer.active.getLine(_+1),a=!!t&&t.isWrapped;let s=n.translateToString(!a&&f);if(a&&t){const i=n.getCell(n.length-1);i&&i.getCode()===0&&i.getWidth()===1&&((d=t.getCell(0))===null||d===void 0?void 0:d.getWidth())===2&&(s=s.slice(0,-1))}if(w.push(s),!a)break;m.push(m[m.length-1]+s.length),_++,n=t}return[w.join(""),m]}_selectResult(_,f,d){var u,w;const m=this._terminal;if(this.clearActiveDecoration(),!_)return m.clearSelection(),!1;if(m.select(_.col,_.row,_.size),f){const n=m.registerMarker(-m.buffer.active.baseY-m.buffer.active.cursorY+_.row);n&&(this._selectedDecoration=m.registerDecoration({marker:n,x:_.col,width:_.size,backgroundColor:f.activeMatchBackground,layer:"top",overviewRulerOptions:{color:f.activeMatchColorOverviewRuler}}),(u=this._selectedDecoration)===null||u===void 0||u.onRender(t=>this._applyStyles(t,f.activeMatchBorder,!0)),(w=this._selectedDecoration)===null||w===void 0||w.onDispose(()=>n.dispose()))}if(!d&&(_.row>=m.buffer.active.viewportY+m.rows||_.row<m.buffer.active.viewportY)){let n=_.row-m.buffer.active.viewportY;n-=Math.floor(m.rows/2),m.scrollLines(n)}return!0}_applyStyles(_,f,d){_.clientWidth<=0||(_.classList.contains("xterm-find-result-decoration")||(_.classList.add("xterm-find-result-decoration"),f&&(_.style.outline=`1px solid ${f}`)),d&&_.classList.add("xterm-find-active-result-decoration"))}_createResultDecoration(_,f){var d;const u=this._terminal,w=u.registerMarker(-u.buffer.active.baseY-u.buffer.active.cursorY+_.row);if(!w)return;const m=u.registerDecoration({marker:w,x:_.col,width:_.size,backgroundColor:f.matchBackground,overviewRulerOptions:!((d=this._resultDecorations)===null||d===void 0)&&d.get(w.line)?void 0:{color:f.matchOverviewRuler,position:"center"}});return m==null||m.onRender(n=>this._applyStyles(n,f.matchBorder,!1)),m==null||m.onDispose(()=>w.dispose()),m}}})(),pe})()})})(Es);var ao=Es.exports,Ls={exports:{}};(function(q,U){(function(Q,ne){q.exports=ne()})(self,function(){return(()=>{var Q={6:(j,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.LinkComputer=c.WebLinkProvider=void 0,c.WebLinkProvider=class{constructor(_,f,d,u={}){this._terminal=_,this._regex=f,this._handler=d,this._options=u}provideLinks(_,f){const d=y.computeLink(_,this._regex,this._terminal,this._handler);f(this._addCallbacks(d))}_addCallbacks(_){return _.map(f=>(f.leave=this._options.leave,f.hover=(d,u)=>{if(this._options.hover){const{range:w}=f;this._options.hover(d,u,w)}},f))}};class y{static computeLink(f,d,u,w){const m=new RegExp(d.source,(d.flags||"")+"g"),[n,t]=y._translateBufferLineToStringWithWrap(f-1,!1,u);let a,s=-1;const i=[];for(;(a=m.exec(n))!==null;){const h=a[1];if(!h){console.log("match found without corresponding matchIndex");break}if(s=n.indexOf(h,s+1),m.lastIndex=s+h.length,s<0)break;let p=s+h.length,g=t+1;for(;p>u.cols;)p-=u.cols,g++;let C=s+1,v=t+1;for(;C>u.cols;)C-=u.cols,v++;const b={start:{x:C,y:v},end:{x:p,y:g}};i.push({range:b,text:h,activate:w})}return i}static _translateBufferLineToStringWithWrap(f,d,u){let w,m,n="";do{const a=u.buffer.active.getLine(f);if(!a)break;a.isWrapped&&f--,m=a.isWrapped}while(m);const t=f;do{const a=u.buffer.active.getLine(f+1);w=!!a&&a.isWrapped;const s=u.buffer.active.getLine(f);if(!s)break;n+=s.translateToString(!w&&d).substring(0,u.cols),f++}while(w);return[n,t]}}c.LinkComputer=y}},ne={};function ue(j){var c=ne[j];if(c!==void 0)return c.exports;var y=ne[j]={exports:{}};return Q[j](y,y.exports,ue),y.exports}var pe={};return(()=>{var j=pe;Object.defineProperty(j,"__esModule",{value:!0}),j.WebLinksAddon=void 0;const c=ue(6),y=new RegExp(`(?:^|[^\\da-z\\.-]+)((https?:\\/\\/)((([\\da-z\\.-]+)\\.([a-z\\.]{2,18}))|((\\d{1,3}\\.){3}\\d{1,3})|(localhost))(:\\d{1,5})?((\\/[\\/\\w\\.\\-%~:+@]*)*([^:"'\\s]))?(\\?[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;~\\=\\.\\-]*)?(#[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;~\\=\\.\\-]*)?)($|[^\\/\\w\\.\\-%]+)`);function _(f,d){const u=window.open();if(u){try{u.opener=null}catch{}u.location.href=d}else console.warn("Opening link blocked as opener could not be cleared")}j.WebLinksAddon=class{constructor(f=_,d={}){this._handler=f,this._options=d}activate(f){this._terminal=f;const d=this._options,u=d.urlRegex||y;this._linkProvider=this._terminal.registerLinkProvider(new c.WebLinkProvider(this._terminal,u,this._handler,d))}dispose(){var f;(f=this._linkProvider)===null||f===void 0||f.dispose()}}})(),pe})()})})(Ls);var lo=Ls.exports;const co={foreground:"#eeeeec",background:"#300a24",cursor:"#bbbbbb",black:"#2e3436",brightBlack:"#555753",red:"#cc0000",brightRed:"#ef2929",green:"#4e9a06",brightGreen:"#8ae234",yellow:"#c4a000",brightYellow:"#fce94f",blue:"#3465a4",brightBlue:"#729fcf",magenta:"#75507b",brightMagenta:"#ad7fa8",cyan:"#06989a",brightCyan:"#34e2e2",white:"#d3d7cf",brightWhite:"#eeeeec"},ho={foreground:"#F8F8F2",background:"#282A36",cursor:"#bbbbbb",selectionBackground:"#44475A",black:"#21222C",brightBlack:"#6272A4",red:"#FF5555",brightRed:"#FF6E6E",green:"#50FA7B",brightGreen:"#69FF94",yellow:"#F1FA8C",brightYellow:"#FFFFA5",blue:"#BD93F9",brightBlue:"#D6ACFF",magenta:"#FF79C6",brightMagenta:"#FF92DF",cyan:"#8BE9FD",brightCyan:"#A4FFFF",white:"#F8F8F2",brightWhite:"#FFFFFF"},uo={foreground:"#abb2bf",background:"#282c34",cursor:"#bbbbbb",selectionBackground:"#abb2bf30",black:"#3f4451",brightBlack:"#4f5666",red:"#e05561",brightRed:"#ff616e",green:"#8cc265",brightGreen:"#a5e075",yellow:"#d18f52",brightYellow:"#f0a45d",blue:"#4aa5f0",brightBlue:"#4dc4ff",magenta:"#c162de",brightMagenta:"#de73ff",cyan:"#42b3c2",brightCyan:"#4cd1e0",white:"#d7dae0",brightWhite:"#e6e6e6"},fo={foreground:"#C5C8C6",background:"#161719",cursor:"#D0D0D0",black:"#000000",brightBlack:"#000000",red:"#FD5FF1",brightRed:"#FD5FF1",green:"#87C38A",brightGreen:"#94FA36",yellow:"#FFD7B1",brightYellow:"#F5FFA8",blue:"#85BEFD",brightBlue:"#96CBFE",magenta:"#B9B6FC",brightMagenta:"#B9B6FC",cyan:"#85BEFD",brightCyan:"#85BEFD",white:"#E0E0E0",brightWhite:"#E0E0E0"},Rr=q=>{switch(q){case"Ubuntu":return co;case"Dracula":return ho;case"Arthur":return fo;case"OneDark":return uo;case"Default":return}const U=document.documentElement.style;function Q(ne){return U.getPropertyValue(ne)}return{cursor:Q("--vscode-editorCursor-foreground"),foreground:Q("--vscode-terminal-foreground"),background:Q("--vscode-editor-background"),black:Q("--vscode-terminal-ansiBlack"),brightBlack:Q("--vscode-terminal-ansiBrightBlack"),blue:Q("--vscode-terminal-ansiBlue"),brightBlue:Q("--vscode-terminal-ansBrightiBlue"),green:Q("--vscode-terminal-ansiGreen"),brightGreen:Q("--vscode-terminal-ansiBrightGreen"),red:Q("--vscode-terminal-ansiRed"),brightRed:Q("--vscode-terminal-ansiBrightRed"),cyan:Q("--vscode-terminal-ansiCyan"),brightCyan:Q("--vscode-terminal-ansiBrightCyan"),magenta:Q("--vscode-terminal-ansiMagenta"),brightMagenta:Q("--vscode-terminal-ansiBrightMagenta"),yellow:Q("--vscode-terminal-ansiYellow"),brightYellow:Q("--vscode-terminal-ansiBrightYellow"),white:Q("--vscode-terminal-ansiWhite"),brightWhite:Q("--vscode-terminal-ansiBrightWhite"),selectionBackground:Q("--vscode-editor-selectionBackground")}};/*!
 * xterm-addon-search-bar.js v0.2.0
 * (c) 2018-2020 yinshuxun
 * Released under the MIT License.
 */function po(q,U){U===void 0&&(U={});var Q=U.insertAt;if(!(!q||typeof document>"u")){var ne=document.head||document.getElementsByTagName("head")[0],ue=document.createElement("style");ue.type="text/css",Q==="top"&&ne.firstChild?ne.insertBefore(ue,ne.firstChild):ne.appendChild(ue),ue.styleSheet?ue.styleSheet.cssText=q:ue.appendChild(document.createTextNode(q))}}var _o='.xterm-search-bar__addon{position:absolute;max-width:1467px;top:0;right:28px;color:#000;background:#fff;padding:5px 10px;box-shadow:0 2px 8px #000;background-color:#252526;z-index:999;display:flex}.xterm-search-bar__addon .search-bar__input{background-color:#3c3c3c;color:#ccc;border:0;padding:2px;height:20px;width:227px}.xterm-search-bar__addon .search-bar__btn{min-width:20px;width:20px;height:20px;display:flex;display:-webkit-flex;flex:initial;background-position:50%;margin-left:3px;background-repeat:no-repeat;background-color:#252526;border:0;cursor:pointer}.xterm-search-bar__addon .search-bar__btn:hover{background-color:#666}.xterm-search-bar__addon .search-bar__btn.prev{margin-left:20px;background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTUuNCA4YS42LjYgMCAwMS4xNzYtLjQyNGw0LTRhLjU5OC41OTggMCAwMS44NDggMCAuNTk4LjU5OCAwIDAxMCAuODQ4TDYuODQ5IDhsMy41NzUgMy41NzZhLjU5OC41OTggMCAwMTAgLjg0OC41OTguNTk4IDAgMDEtLjg0OCAwbC00LTRBLjYuNiAwIDAxNS40IDgiLz48L3N2Zz4=")}.xterm-search-bar__addon .search-bar__btn.next{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTEwLjYgOGEuNi42IDAgMDEtLjE3Ni40MjRsLTQgNGEuNTk4LjU5OCAwIDAxLS44NDggMCAuNTk4LjU5OCAwIDAxMC0uODQ4TDkuMTUxIDggNS41NzYgNC40MjRhLjU5OC41OTggMCAwMTAtLjg0OC41OTguNTk4IDAgMDEuODQ4IDBsNCA0QS42LjYgMCAwMTEwLjYgOCIvPjwvc3ZnPg==")}.xterm-search-bar__addon .search-bar__btn.close{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTcgNmwyLTJhLjcxMS43MTEgMCAwMDAtMSAuNzExLjcxMSAwIDAwLTEgMEw2IDUgNCAzYS43MTEuNzExIDAgMDAtMSAwIC43MTEuNzExIDAgMDAwIDFsMiAyLTIgMmEuNzExLjcxMSAwIDAwMCAxIC43MTEuNzExIDAgMDAxIDBsMi0yIDIgMmEuNzExLjcxMSAwIDAwMSAwIC43MTEuNzExIDAgMDAwLTFMNyA2eiIvPjwvc3ZnPg==")}';po(_o);const Ar="xterm-search-bar__addon";class go{constructor(U){this.options=U||{},this.options&&this.options.searchAddon&&(this.searchAddon=this.options.searchAddon)}activate(U){this.terminal=U,this.searchAddon||console.error("Cannot use search bar addon until search addon has been loaded!")}dispose(){this.hidden()}show(){if(!this.terminal||!this.terminal.element)return;if(this.searchBarElement){this.searchBarElement.style.visibility="visible",this.searchBarElement.querySelector("input").select();return}this.terminal.element.style.position="relative";const U=document.createElement("div");U.innerHTML=`
       <input type="text" class="search-bar__input" name="search-bar__input"/>
       <button class="search-bar__btn prev"></button>
       <button class="search-bar__btn next"></button>
       <button class="search-bar__btn close"></button>
    `,U.className=Ar;const Q=this.terminal.element.parentElement;this.searchBarElement=U,["relative","absoulte","fixed"].includes(Q.style.position)||(Q.style.position="relative"),Q.appendChild(this.searchBarElement),this.on(".search-bar__btn.close","click",()=>{this.hidden()}),this.on(".search-bar__btn.next","click",()=>{this.searchAddon.findNext(this.searchKey,{incremental:!1})}),this.on(".search-bar__btn.prev","click",()=>{this.searchAddon.findPrevious(this.searchKey,{incremental:!1})}),this.on(".search-bar__input","keyup",ne=>{this.searchKey=ne.target.value,this.searchAddon.findNext(this.searchKey,{incremental:ne.key!=="Enter"})}),this.searchBarElement.querySelector("input").select()}hidden(){this.searchBarElement&&this.terminal.element.parentElement&&(this.searchBarElement.style.visibility="hidden")}on(U,Q,ne){const ue=this.terminal.element.parentElement;ue.addEventListener(Q,pe=>{let j=pe.target;for(;j!==document.querySelector(U);){if(j===ue){j=null;break}j=j.parentElement}j===document.querySelector(U)&&(ne.call(this,pe),pe.stopPropagation())})}addNewStyle(U){let Q=document.getElementById(Ar);Q||(Q=document.createElement("style"),Q.type="text/css",Q.id=Ar,document.getElementsByTagName("head")[0].appendChild(Q)),Q.appendChild(document.createTextNode(U))}}const vo={props:["theme","isSSH"],data(){return{themeList:["Auto","Arthur","Dracula","OneDark","Ubuntu","Default"]}},methods:{send(q){this.$emit("send",q)},showProgres(){let q="echo Top Memory Progress: && ps -eo pid,user,rss,pmem,pcpu,cputime,comm,cmd | ";q+=`awk 'NR<2{print $0;next}{print $0| "sort -k 3 -nr"}' | head -16 | `,q+="numfmt --header --to=iec --from-unit=1024 --field 3 | cut -c 1-130",this.send(q)},changeTheme(q){this.$emit("update:theme",q)}}};var mo=function(){var U=this,Q=U._self._c;return Q("div",{staticClass:"terminal-toolbar pl-3 gap-x-4 h-[25px] flex items-center"},[U.isSSH?[Q("div",{staticClass:"terminal-toolbar-selection"},[U._v(" Vim: "),Q("i",{staticClass:"el-icon-edit",attrs:{title:"Edit Profile"},on:{click:function(ne){return U.send("vi /etc/profile")}}}),Q("i",{staticClass:"el-icon-wind-power",attrs:{title:"Show Line Number"},on:{click:function(ne){return U.send(":set nu")}}}),Q("i",{staticClass:"el-icon-set-up",attrs:{title:"Format"},on:{click:function(ne){return U.send("gg=G")}}}),Q("i",{staticClass:"el-icon-check",attrs:{title:"Save"},on:{click:function(ne){return U.send(":wq")}}}),Q("i",{staticClass:"el-icon-close",attrs:{title:"Close"},on:{click:function(ne){return U.send(":q!")}}})]),Q("div",{staticClass:"terminal-toolbar-selection"},[U._v(" "+U._s(U.$t("ssh.util"))+": "),Q("i",{staticClass:"el-icon-coin",attrs:{title:"Disk Usage"},on:{click:function(ne){return U.send("du -h -d 1| sort -h")}}}),Q("i",{staticClass:"el-icon-stopwatch",attrs:{title:"Listening Port"},on:{click:function(ne){return U.send("netstat -anp|grep 'LISTEN\\b'|less")}}}),Q("i",{staticClass:"el-icon-data-line",attrs:{title:"List Progress"},on:{click:U.showProgres}}),Q("i",{staticClass:"el-icon-document-delete",attrs:{title:"Clear Screen"},on:{click:function(ne){return U.send("clear")}}})])]:U._e(),Q("div",{staticClass:"terminal-toolbar-selection"},[U._v(" "+U._s(U.$t("ssh.theme"))+": "),Q("vsc-radio-group",{staticClass:"inline-block",attrs:{value:U.theme,size:"mini"},on:{input:U.changeTheme}},U._l(U.themeList,function(ne,ue){return Q("vsc-radio-button",{key:ue,attrs:{label:ne}})}),1)],1)],2)},yo=[],bo=Dr(vo,mo,yo,!1,null,"f4b169b5",null,null);const So=bo.exports;const Co={mixins:[ps],data(){return{live:!0,lastTime:null,receivedData:!1,option:{query:null,previousMinute:30}}},mounted(){this.on("query",q=>{this.option.query||(this.option.query=q)}).on("lastTime",({lastTime:q,hasLog:U})=>{this.lastTime||setInterval(()=>{!this.live||!this.receivedData||(this.receivedData=!1,this.emit("getLogs",{live:!0,start:this.lastTime,hasLog:U,query:this.option.query}))},3e3),(!this.lastTime||U)&&(this.lastTime=q),this.receivedData=!0})},methods:{loadLogs(){this.emit("getLogs",this.option)},openDocument(){this.emit("openDocument")}}};var wo=function(){var U=this,Q=U._self._c;return Q("div",{staticClass:"terminal-toolbar pl-3 gap-x-4 h-10 flex items-center"},[Q("vsc-input",{staticClass:"ml-1",staticStyle:{width:"300px"},attrs:{theme:"base","prefix-icon":"el-icon-search",size:"mini",placeholder:"Loki queries",clearable:!1},nativeOn:{keyup:function(ne){return!ne.type.indexOf("key")&&U._k(ne.keyCode,"enter",13,ne.key,"Enter")?null:U.loadLogs.apply(null,arguments)}},model:{value:U.option.query,callback:function(ne){U.$set(U.option,"query",ne)},expression:"option.query"}}),Q("i",{staticClass:"el-icon-document",attrs:{title:"Document"},on:{click:U.openDocument}}),Q(Tn,{staticStyle:{width:"130px"},attrs:{placeholder:"Forever",size:"small"},on:{change:U.loadLogs},model:{value:U.option.previousMinute,callback:function(ne){U.$set(U.option,"previousMinute",ne)},expression:"option.previousMinute"}},[Q(dt,{attrs:{value:15,label:"Last 15 minutes"}}),Q(dt,{attrs:{value:30,label:"Last 30 minutes"}}),Q(dt,{attrs:{value:60,label:"Last 1 hours"}}),Q(dt,{attrs:{value:120,label:"Last 2 hours"}}),Q(dt,{attrs:{value:180,label:"Last 3 hours"}}),Q(dt,{attrs:{value:1440,label:"Last 24 hours"}}),Q(dt,{attrs:{value:2880,label:"Last 2 days"}}),Q(dt,{attrs:{value:10080,label:"Last 7 days"}})],1),Q("div",{staticClass:"inline-block ml-[-8px] mr-2"},[Q("label",{staticClass:"mr-2"},[U._v("Live")]),Q(An,{model:{value:U.live,callback:function(ne){U.live=ne},expression:"live"}})],1),Q("i",{staticClass:"el-icon-refresh-left icon",staticStyle:{"margin-left":"-10px"},attrs:{title:"Refresh"},on:{click:U.loadLogs}})],1)},xo=[],Eo=Dr(Co,wo,xo,!1,null,"7afb1dba",null,null);const Lo=Eo.exports;const ko={components:{SSHToolbar:So,LokiToolbar:Lo},mixins:[ps],data(){return{theme:"vscode",dbType:null,terminal:null,isSSH:!1,remainHeight:756,listenThemeChange:!0}},watch:{theme(q){this.terminal.options.theme=Rr(q),this.emit("updateOption",{key:"terminalTheme",value:q})}},mounted(){this.calcHeight(),this.on("terminalConfig",({cursorStyle:q,fontSize:U,fontFamily:Q,theme:ne,dbType:ue})=>{if(this.terminal){this.emit("initTerminal",{cols:this.terminal.cols,rows:this.terminal.rows});return}this.dbType=ue;let pe=!1;ne&&(this.theme=ne),(!q||q=="line")&&(q="bar");const j=new Mn.Terminal({theme:Rr(this.theme),cursorStyle:q,cursorBlink:!0,allowProposedApi:!0,fontSize:U,fontFamily:Q,disableStdin:!1,lineHeight:1.1,cursorBlink:!0,scrollback:1e6,tabStopWidth:8,bellStyle:"sound"});this.terminal=j;const c=new On.FitAddon;new ResizeObserver(()=>this.calcHeight(c)).observe(this.$refs.box);const y=new ao.SearchAddon,_=new go({searchAddon:y}),f=navigator.userAgent.includes("Mac OS");window.onkeydown=n=>{n.code=="Escape"&&(_.hidden(),j.focus()),f&&Lt(n)&&n.altKey&&n.preventDefault()},j.attachCustomKeyEventHandler(n=>{if(n.shiftKey&&n.code=="Insert")return!1;if(Lt(n)&&!n.altKey&&!n.shiftKey){const a=n.code;if(f){if(a=="ArrowLeft")return this.emit("data",""),!1;if(a=="ArrowRight")return this.emit("data",""),!1}if(a=="KeyC"&&!j.hasSelection()&&f)return this.emit("data",""),!1;if(a=="KeyC"&&j.hasSelection())return document.execCommand("copy"),!1;if(a=="KeyV")return!1;if(a=="KeyF")return _.show(),!1;if(["PageDown","PageUp"].includes(a))return!1}else if(Lt(n)&&n.shiftKey&&n.code=="KeyV")return!1;if(!f){const a=new n.constructor(n.type,n);document.body.dispatchEvent(a)}return!0}),ue=="SSH"&&(this.isSSH=!0,window.addEventListener("keyup",n=>{Lt(n)&&n.shiftKey&&n.code=="KeyV"&&this.emit("data",[22])}));const d=document.getElementById("terminal-container");j.open(d),j.loadAddon(c),j.loadAddon(y),j.loadAddon(_),j.loadAddon(new Bn.CanvasAddon),j.loadAddon(new oo.LigaturesAddon);let u;j.loadAddon(new lo.WebLinksAddon((n,t)=>{if(!Lt(n)){const a=u;if(u=new Date().getTime(),!a||u-a>200)return}this.emit("openLink",t)})),c.fit(),j.focus(),j.onData(n=>{this.emit("data",n)});const w=()=>{this.calcHeight(),this.$nextTick(()=>{c.fit(),this.emit("resize",{cols:j.cols,rows:j.rows})})};window.addEventListener("resize",w,!1),window.onfocus=()=>{j.focus()},document.querySelector("#terminal-container").oncontextmenu=async n=>{if(n.stopPropagation(),j.hasSelection())document.execCommand("copy"),j.clearSelection();else{const t=await navigator.clipboard.readText();this.emit("data",t.replace(/\r\n/g,"\r"))}};let m=!1;this.on("connecting",n=>{j.write(n),j.write("\x1B[2K\r")}).on("data",n=>{m||(j.clear(),m=!0),j.write(n)}).on("init-terminal",n=>{w()}).on("error",n=>{pe||(pe=!0,j.write(n))}).on("theme",()=>{this.theme=="Auto"&&(j.options.theme=Rr(this.theme))}),this.emit("initTerminal",{cols:j.cols,rows:j.rows})}).init()},methods:{calcHeight(q){let U=28;this.dbType==Dn.LOKI&&(U+=35),this.remainHeight=window.innerHeight-U,q&&this.$nextTick(()=>{q.fit()})},send(q){this.emit("data",""),setTimeout(()=>{var U;this.emit("data",`${q}
\r`),(U=this.terminal)==null||U.focus()},200)}}};var Ro=function(){var U=this,Q=U._self._c;return Q("div",{ref:"box",staticClass:"box"},[Q("SSHToolbar",{attrs:{theme:U.theme,isSSH:U.isSSH},on:{"update:theme":function(ne){U.theme=ne},send:U.send}}),U.dbType=="Loki"?Q("LokiToolbar",{on:{send:U.send}}):U._e(),Q("div",{style:{height:U.remainHeight+"px"},attrs:{id:"terminal-container"}})],1)},Ao=[],To=Dr(ko,Ro,Ao,!1,null,"0e8e2e63",null,null);const Uo=To.exports;export{Uo as default};
